var _,no,React,Vow,moment;(function(){function n(n,t,e){e=(e||0)-1;for(var r=n?n.length:0;++e<r;)if(n[e]===t)return e;return-1}function t(t,e){var r=typeof e;if(t=t.l,"boolean"==r||null==e)return t[e]?0:-1;"number"!=r&&"string"!=r&&(r="object");var u="number"==r?e:m+e;return t=(t=t[r])&&t[u],"object"==r?t&&-1<n(t,e)?0:-1:t?0:-1}function e(n){var t=this.l,e=typeof n;if("boolean"==e||null==n)t[n]=!0;else{"number"!=e&&"string"!=e&&(e="object");var r="number"==e?n:m+n,t=t[e]||(t[e]={});"object"==e?(t[r]||(t[r]=[])).push(n):t[r]=!0}}function r(n){return n.charCodeAt(0)}function u(n,t){for(var e=n.m,r=t.m,u=-1,o=e.length;++u<o;){var i=e[u],a=r[u];if(i!==a){if(i>a||"undefined"==typeof i)return 1;if(a>i||"undefined"==typeof a)return-1}}return n.n-t.n}function o(n){var t=-1,r=n.length,u=n[0],o=n[r/2|0],i=n[r-1];if(u&&"object"==typeof u&&o&&"object"==typeof o&&i&&"object"==typeof i)return!1;for(u=f(),u["false"]=u["null"]=u["true"]=u.undefined=!1,o=f(),o.k=n,o.l=u,o.push=e;++t<r;)o.push(n[t]);return o}function i(n){return"\\"+U[n]}function a(){return h.pop()||[]}function f(){return g.pop()||{k:null,l:null,m:null,"false":!1,n:0,"null":!1,number:null,object:null,push:null,string:null,"true":!1,undefined:!1,o:null}}function l(n){n.length=0,h.length<_&&h.push(n)}function c(n){var t=n.l;t&&c(t),n.k=n.l=n.m=n.object=n.number=n.string=n.o=null,g.length<_&&g.push(n)}function p(n,t,e){t||(t=0),"undefined"==typeof e&&(e=n?n.length:0);var r=-1;e=e-t||0;for(var u=Array(0>e?0:e);++r<e;)u[r]=n[t+r];return u}function s(e){function h(n,t,e){if(!n||!V[typeof n])return n;t=t&&"undefined"==typeof e?t:tt(t,e,3);for(var r=-1,u=V[typeof n]&&Fe(n),o=u?u.length:0;++r<o&&(e=u[r],!1!==t(n[e],e,n)););return n}function g(n,t,e){var r;if(!n||!V[typeof n])return n;t=t&&"undefined"==typeof e?t:tt(t,e,3);for(r in n)if(!1===t(n[r],r,n))break;return n}function _(n,t,e){var r,u=n,o=u;if(!u)return o;for(var i=arguments,a=0,f="number"==typeof e?2:i.length;++a<f;)if((u=i[a])&&V[typeof u])for(var l=-1,c=V[typeof u]&&Fe(u),p=c?c.length:0;++l<p;)r=c[l],"undefined"==typeof o[r]&&(o[r]=u[r]);return o}function U(n,t,e){var r,u=n,o=u;if(!u)return o;var i=arguments,a=0,f="number"==typeof e?2:i.length;if(f>3&&"function"==typeof i[f-2])var l=tt(i[--f-1],i[f--],2);else f>2&&"function"==typeof i[f-1]&&(l=i[--f]);for(;++a<f;)if((u=i[a])&&V[typeof u])for(var c=-1,p=V[typeof u]&&Fe(u),s=p?p.length:0;++c<s;)r=p[c],o[r]=l?l(o[r],u[r]):u[r];return o}function H(n){var t,e=[];if(!n||!V[typeof n])return e;for(t in n)me.call(n,t)&&e.push(t);return e}function J(n){return n&&"object"==typeof n&&!Te(n)&&me.call(n,"__wrapped__")?n:new Q(n)}function Q(n,t){this.__chain__=!!t,this.__wrapped__=n}function X(n){function t(){if(r){var n=p(r);be.apply(n,arguments)}if(this instanceof t){var o=nt(e.prototype),n=e.apply(o,n||arguments);return wt(n)?n:o}return e.apply(u,n||arguments)}var e=n[0],r=n[2],u=n[4];return $e(t,n),t}function Z(n,t,e,r,u){if(e){var o=e(n);if("undefined"!=typeof o)return o}if(!wt(n))return n;var i=ce.call(n);if(!K[i])return n;var f=Ae[i];switch(i){case T:case F:return new f(+n);case W:case P:return new f(n);case z:return o=f(n.source,C.exec(n)),o.lastIndex=n.lastIndex,o}if(i=Te(n),t){var c=!r;r||(r=a()),u||(u=a());for(var s=r.length;s--;)if(r[s]==n)return u[s];o=i?f(n.length):{}}else o=i?p(n):U({},n);return i&&(me.call(n,"index")&&(o.index=n.index),me.call(n,"input")&&(o.input=n.input)),t?(r.push(n),u.push(o),(i?St:h)(n,function(n,i){o[i]=Z(n,t,e,r,u)}),c&&(l(r),l(u)),o):o}function nt(n){return wt(n)?ke(n):{}}function tt(n,t,e){if("function"!=typeof n)return Ut;if("undefined"==typeof t||!("prototype"in n))return n;var r=n.__bindData__;if("undefined"==typeof r&&(De.funcNames&&(r=!n.name),r=r||!De.funcDecomp,!r)){var u=ge.call(n);De.funcNames||(r=!O.test(u)),r||(r=E.test(u),$e(n,r))}if(!1===r||!0!==r&&1&r[1])return n;switch(e){case 1:return function(e){return n.call(t,e)};case 2:return function(e,r){return n.call(t,e,r)};case 3:return function(e,r,u){return n.call(t,e,r,u)};case 4:return function(e,r,u,o){return n.call(t,e,r,u,o)}}return Mt(n,t)}function et(n){function t(){var n=f?i:this;if(u){var h=p(u);be.apply(h,arguments)}return(o||c)&&(h||(h=p(arguments)),o&&be.apply(h,o),c&&h.length<a)?(r|=16,et([e,s?r:-4&r,h,null,i,a])):(h||(h=arguments),l&&(e=n[v]),this instanceof t?(n=nt(e.prototype),h=e.apply(n,h),wt(h)?h:n):e.apply(n,h))}var e=n[0],r=n[1],u=n[2],o=n[3],i=n[4],a=n[5],f=1&r,l=2&r,c=4&r,s=8&r,v=e;return $e(t,n),t}function rt(e,r){var u=-1,i=st(),a=e?e.length:0,f=a>=b&&i===n,l=[];if(f){var p=o(r);p?(i=t,r=p):f=!1}for(;++u<a;)p=e[u],0>i(r,p)&&l.push(p);return f&&c(r),l}function ut(n,t,e,r){r=(r||0)-1;for(var u=n?n.length:0,o=[];++r<u;){var i=n[r];if(i&&"object"==typeof i&&"number"==typeof i.length&&(Te(i)||yt(i))){t||(i=ut(i,t,e));var a=-1,f=i.length,l=o.length;for(o.length+=f;++a<f;)o[l++]=i[a]}else e||o.push(i)}return o}function ot(n,t,e,r,u,o){if(e){var i=e(n,t);if("undefined"!=typeof i)return!!i}if(n===t)return 0!==n||1/n==1/t;if(n===n&&!(n&&V[typeof n]||t&&V[typeof t]))return!1;if(null==n||null==t)return n===t;var f=ce.call(n),c=ce.call(t);if(f==D&&(f=q),c==D&&(c=q),f!=c)return!1;switch(f){case T:case F:return+n==+t;case W:return n!=+n?t!=+t:0==n?1/n==1/t:n==+t;case z:case P:return n==oe(t)}if(c=f==$,!c){var p=me.call(n,"__wrapped__"),s=me.call(t,"__wrapped__");if(p||s)return ot(p?n.__wrapped__:n,s?t.__wrapped__:t,e,r,u,o);if(f!=q)return!1;if(f=n.constructor,p=t.constructor,f!=p&&!(dt(f)&&f instanceof f&&dt(p)&&p instanceof p)&&"constructor"in n&&"constructor"in t)return!1}for(f=!u,u||(u=a()),o||(o=a()),p=u.length;p--;)if(u[p]==n)return o[p]==t;var v=0,i=!0;if(u.push(n),o.push(t),c){if(p=n.length,v=t.length,(i=v==p)||r)for(;v--;)if(c=p,s=t[v],r)for(;c--&&!(i=ot(n[c],s,e,r,u,o)););else if(!(i=ot(n[v],s,e,r,u,o)))break}else g(t,function(t,a,f){return me.call(f,a)?(v++,i=me.call(n,a)&&ot(n[a],t,e,r,u,o)):void 0}),i&&!r&&g(n,function(n,t,e){return me.call(e,t)?i=-1<--v:void 0});return u.pop(),o.pop(),f&&(l(u),l(o)),i}function it(n,t,e,r,u){(Te(t)?St:h)(t,function(t,o){var i,a,f=t,l=n[o];if(t&&((a=Te(t))||Pe(t))){for(f=r.length;f--;)if(i=r[f]==t){l=u[f];break}if(!i){var c;e&&(f=e(l,t),c="undefined"!=typeof f)&&(l=f),c||(l=a?Te(l)?l:[]:Pe(l)?l:{}),r.push(t),u.push(l),c||it(l,t,e,r,u)}}else e&&(f=e(l,t),"undefined"==typeof f&&(f=t)),"undefined"!=typeof f&&(l=f);n[o]=l})}function at(n,t){return n+he(Re()*(t-n+1))}function ft(e,r,u){var i=-1,f=st(),p=e?e.length:0,s=[],v=!r&&p>=b&&f===n,h=u||v?a():s;for(v&&(h=o(h),f=t);++i<p;){var g=e[i],y=u?u(g,i,e):g;(r?!i||h[h.length-1]!==y:0>f(h,y))&&((u||v)&&h.push(y),s.push(g))}return v?(l(h.k),c(h)):u&&l(h),s}function lt(n){return function(t,e,r){var u={};e=J.createCallback(e,r,3),r=-1;var o=t?t.length:0;if("number"==typeof o)for(;++r<o;){var i=t[r];n(u,i,e(i,r,t),t)}else h(t,function(t,r,o){n(u,t,e(t,r,o),o)});return u}}function ct(n,t,e,r,u,o){var i=1&t,a=4&t,f=16&t,l=32&t;if(!(2&t||dt(n)))throw new ie;f&&!e.length&&(t&=-17,f=e=!1),l&&!r.length&&(t&=-33,l=r=!1);var c=n&&n.__bindData__;return c&&!0!==c?(c=p(c),c[2]&&(c[2]=p(c[2])),c[3]&&(c[3]=p(c[3])),!i||1&c[1]||(c[4]=u),!i&&1&c[1]&&(t|=8),!a||4&c[1]||(c[5]=o),f&&be.apply(c[2]||(c[2]=[]),e),l&&we.apply(c[3]||(c[3]=[]),r),c[1]|=t,ct.apply(null,c)):(1==t||17===t?X:et)([n,t,e,r,u,o])}function pt(n){return Be[n]}function st(){var t=(t=J.indexOf)===Wt?n:t;return t}function vt(n){return"function"==typeof n&&pe.test(n)}function ht(n){var t,e;return n&&ce.call(n)==q&&(t=n.constructor,!dt(t)||t instanceof t)?(g(n,function(n,t){e=t}),"undefined"==typeof e||me.call(n,e)):!1}function gt(n){return We[n]}function yt(n){return n&&"object"==typeof n&&"number"==typeof n.length&&ce.call(n)==D||!1}function mt(n,t,e){var r=Fe(n),u=r.length;for(t=tt(t,e,3);u--&&(e=r[u],!1!==t(n[e],e,n)););return n}function bt(n){var t=[];return g(n,function(n,e){dt(n)&&t.push(e)}),t.sort()}function _t(n){for(var t=-1,e=Fe(n),r=e.length,u={};++t<r;){var o=e[t];u[n[o]]=o}return u}function dt(n){return"function"==typeof n}function wt(n){return!(!n||!V[typeof n])}function jt(n){return"number"==typeof n||n&&"object"==typeof n&&ce.call(n)==W||!1}function kt(n){return"string"==typeof n||n&&"object"==typeof n&&ce.call(n)==P||!1}function xt(n){for(var t=-1,e=Fe(n),r=e.length,u=Xt(r);++t<r;)u[t]=n[e[t]];return u}function Ct(n,t,e){var r=-1,u=st(),o=n?n.length:0,i=!1;return e=(0>e?Ie(0,o+e):e)||0,Te(n)?i=-1<u(n,t,e):"number"==typeof o?i=-1<(kt(n)?n.indexOf(t,e):u(n,t,e)):h(n,function(n){return++r<e?void 0:!(i=n===t)}),i}function Ot(n,t,e){var r=!0;t=J.createCallback(t,e,3),e=-1;var u=n?n.length:0;if("number"==typeof u)for(;++e<u&&(r=!!t(n[e],e,n)););else h(n,function(n,e,u){return r=!!t(n,e,u)});return r}function Nt(n,t,e){var r=[];t=J.createCallback(t,e,3),e=-1;var u=n?n.length:0;if("number"==typeof u)for(;++e<u;){var o=n[e];t(o,e,n)&&r.push(o)}else h(n,function(n,e,u){t(n,e,u)&&r.push(n)});return r}function It(n,t,e){t=J.createCallback(t,e,3),e=-1;var r=n?n.length:0;if("number"!=typeof r){var u;return h(n,function(n,e,r){return t(n,e,r)?(u=n,!1):void 0}),u}for(;++e<r;){var o=n[e];if(t(o,e,n))return o}}function St(n,t,e){var r=-1,u=n?n.length:0;if(t=t&&"undefined"==typeof e?t:tt(t,e,3),"number"==typeof u)for(;++r<u&&!1!==t(n[r],r,n););else h(n,t);return n}function Et(n,t,e){var r=n?n.length:0;if(t=t&&"undefined"==typeof e?t:tt(t,e,3),"number"==typeof r)for(;r--&&!1!==t(n[r],r,n););else{var u=Fe(n),r=u.length;h(n,function(n,e,o){return e=u?u[--r]:--r,t(o[e],e,o)})}return n}function Rt(n,t,e){var r=-1,u=n?n.length:0;if(t=J.createCallback(t,e,3),"number"==typeof u)for(var o=Xt(u);++r<u;)o[r]=t(n[r],r,n);else o=[],h(n,function(n,e,u){o[++r]=t(n,e,u)});return o}function At(n,t,e){var u=-1/0,o=u;if("function"!=typeof t&&e&&e[t]===n&&(t=null),null==t&&Te(n)){e=-1;for(var i=n.length;++e<i;){var a=n[e];a>o&&(o=a)}}else t=null==t&&kt(n)?r:J.createCallback(t,e,3),St(n,function(n,e,r){e=t(n,e,r),e>u&&(u=e,o=n)});return o}function Dt(n,t,e,r){if(!n)return e;var u=3>arguments.length;t=J.createCallback(t,r,4);var o=-1,i=n.length;if("number"==typeof i)for(u&&(e=n[++o]);++o<i;)e=t(e,n[o],o,n);else h(n,function(n,r,o){e=u?(u=!1,n):t(e,n,r,o)});return e}function $t(n,t,e,r){var u=3>arguments.length;return t=J.createCallback(t,r,4),Et(n,function(n,r,o){e=u?(u=!1,n):t(e,n,r,o)}),e}function Tt(n){var t=-1,e=n?n.length:0,r=Xt("number"==typeof e?e:0);return St(n,function(n){var e=at(0,++t);r[t]=r[e],r[e]=n}),r}function Ft(n,t,e){var r;t=J.createCallback(t,e,3),e=-1;var u=n?n.length:0;if("number"==typeof u)for(;++e<u&&!(r=t(n[e],e,n)););else h(n,function(n,e,u){return!(r=t(n,e,u))});return!!r}function Bt(n,t,e){var r=0,u=n?n.length:0;if("number"!=typeof t&&null!=t){var o=-1;for(t=J.createCallback(t,e,3);++o<u&&t(n[o],o,n);)r++}else if(r=t,null==r||e)return n?n[0]:v;return p(n,0,Se(Ie(0,r),u))}function Wt(t,e,r){if("number"==typeof r){var u=t?t.length:0;r=0>r?Ie(0,u+r):r||0}else if(r)return r=zt(t,e),t[r]===e?r:-1;return n(t,e,r)}function qt(n,t,e){if("number"!=typeof t&&null!=t){var r=0,u=-1,o=n?n.length:0;for(t=J.createCallback(t,e,3);++u<o&&t(n[u],u,n);)r++}else r=null==t||e?1:Ie(0,t);return p(n,r)}function zt(n,t,e,r){var u=0,o=n?n.length:u;for(e=e?J.createCallback(e,r,1):Ut,t=e(t);o>u;)r=u+o>>>1,e(n[r])<t?u=r+1:o=r;return u}function Pt(n,t,e,r){return"boolean"!=typeof t&&null!=t&&(r=e,e="function"!=typeof t&&r&&r[t]===n?null:t,t=!1),null!=e&&(e=J.createCallback(e,r,3)),ft(n,t,e)}function Kt(){for(var n=1<arguments.length?arguments:arguments[0],t=-1,e=n?At(Ve(n,"length")):0,r=Xt(0>e?0:e);++t<e;)r[t]=Ve(n,t);return r}function Lt(n,t){var e=-1,r=n?n.length:0,u={};for(t||!r||Te(n[0])||(t=[]);++e<r;){var o=n[e];t?u[o]=t[e]:o&&(u[o[0]]=o[1])}return u}function Mt(n,t){return 2<arguments.length?ct(n,17,p(arguments,2),null,t):ct(n,1,null,null,t)}function Vt(n,t,e){function r(){c&&ve(c),i=c=p=v,(g||h!==t)&&(s=Ue(),a=n.apply(l,o),c||i||(o=l=null))}function u(){var e=t-(Ue()-f);e>0?c=_e(u,e):(i&&ve(i),e=p,i=c=p=v,e&&(s=Ue(),a=n.apply(l,o),c||i||(o=l=null)))}var o,i,a,f,l,c,p,s=0,h=!1,g=!0;if(!dt(n))throw new ie;if(t=Ie(0,t)||0,!0===e)var y=!0,g=!1;else wt(e)&&(y=e.leading,h="maxWait"in e&&(Ie(t,e.maxWait)||0),g="trailing"in e?e.trailing:g);return function(){if(o=arguments,f=Ue(),l=this,p=g&&(c||!y),!1===h)var e=y&&!c;else{i||y||(s=f);var v=h-(f-s),m=0>=v;m?(i&&(i=ve(i)),s=f,a=n.apply(l,o)):i||(i=_e(r,v))}return m&&c?c=ve(c):c||t===h||(c=_e(u,t)),e&&(m=!0,a=n.apply(l,o)),!m||c||i||(o=l=null),a}}function Ut(n){return n}function Gt(n,t,e){var r=!0,u=t&&bt(t);t&&(e||u.length)||(null==e&&(e=t),o=Q,t=n,n=J,u=bt(t)),!1===e?r=!1:wt(e)&&"chain"in e&&(r=e.chain);var o=n,i=dt(o);St(u,function(e){var u=n[e]=t[e];i&&(o.prototype[e]=function(){var t=this.__chain__,e=this.__wrapped__,i=[e];if(be.apply(i,arguments),i=u.apply(n,i),r||t){if(e===i&&wt(i))return this;i=new o(i),i.__chain__=t}return i})})}function Ht(){}function Jt(n){return function(t){return t[n]}}function Qt(){return this.__wrapped__}e=e?Y.defaults(G.Object(),e,Y.pick(G,A)):G;var Xt=e.Array,Yt=e.Boolean,Zt=e.Date,ne=e.Function,te=e.Math,ee=e.Number,re=e.Object,ue=e.RegExp,oe=e.String,ie=e.TypeError,ae=[],fe=re.prototype,le=e._,ce=fe.toString,pe=ue("^"+oe(ce).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),se=te.ceil,ve=e.clearTimeout,he=te.floor,ge=ne.prototype.toString,ye=vt(ye=re.getPrototypeOf)&&ye,me=fe.hasOwnProperty,be=ae.push,_e=e.setTimeout,de=ae.splice,we=ae.unshift,je=function(){try{var n={},t=vt(t=re.defineProperty)&&t,e=t(n,n,n)&&t}catch(r){}return e}(),ke=vt(ke=re.create)&&ke,xe=vt(xe=Xt.isArray)&&xe,Ce=e.isFinite,Oe=e.isNaN,Ne=vt(Ne=re.keys)&&Ne,Ie=te.max,Se=te.min,Ee=e.parseInt,Re=te.random,Ae={};Ae[$]=Xt,Ae[T]=Yt,Ae[F]=Zt,Ae[B]=ne,Ae[q]=re,Ae[W]=ee,Ae[z]=ue,Ae[P]=oe,Q.prototype=J.prototype;var De=J.support={};De.funcDecomp=!vt(e.a)&&E.test(s),De.funcNames="string"==typeof ne.name,J.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:N,variable:"",imports:{_:J}},ke||(nt=function(){function n(){}return function(t){if(wt(t)){n.prototype=t;var r=new n;n.prototype=null}return r||e.Object()}}());var $e=je?function(n,t){M.value=t,je(n,"__bindData__",M)}:Ht,Te=xe||function(n){return n&&"object"==typeof n&&"number"==typeof n.length&&ce.call(n)==$||!1},Fe=Ne?function(n){return wt(n)?Ne(n):[]}:H,Be={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},We=_t(Be),qe=ue("("+Fe(We).join("|")+")","g"),ze=ue("["+Fe(Be).join("")+"]","g"),Pe=ye?function(n){if(!n||ce.call(n)!=q)return!1;var t=n.valueOf,e=vt(t)&&(e=ye(t))&&ye(e);return e?n==e||ye(n)==e:ht(n)}:ht,Ke=lt(function(n,t,e){me.call(n,e)?n[e]++:n[e]=1}),Le=lt(function(n,t,e){(me.call(n,e)?n[e]:n[e]=[]).push(t)}),Me=lt(function(n,t,e){n[e]=t}),Ve=Rt,Ue=vt(Ue=Zt.now)&&Ue||function(){return(new Zt).getTime()},Ge=8==Ee(d+"08")?Ee:function(n,t){return Ee(kt(n)?n.replace(I,""):n,t||0)};return J.after=function(n,t){if(!dt(t))throw new ie;return function(){return 1>--n?t.apply(this,arguments):void 0}},J.assign=U,J.at=function(n){for(var t=arguments,e=-1,r=ut(t,!0,!1,1),t=t[2]&&t[2][t[1]]===n?1:r.length,u=Xt(t);++e<t;)u[e]=n[r[e]];return u},J.bind=Mt,J.bindAll=function(n){for(var t=1<arguments.length?ut(arguments,!0,!1,1):bt(n),e=-1,r=t.length;++e<r;){var u=t[e];n[u]=ct(n[u],1,null,null,n)}return n},J.bindKey=function(n,t){return 2<arguments.length?ct(t,19,p(arguments,2),null,n):ct(t,3,null,null,n)},J.chain=function(n){return n=new Q(n),n.__chain__=!0,n},J.compact=function(n){for(var t=-1,e=n?n.length:0,r=[];++t<e;){var u=n[t];u&&r.push(u)}return r},J.compose=function(){for(var n=arguments,t=n.length;t--;)if(!dt(n[t]))throw new ie;return function(){for(var t=arguments,e=n.length;e--;)t=[n[e].apply(this,t)];return t[0]}},J.constant=function(n){return function(){return n}},J.countBy=Ke,J.create=function(n,t){var e=nt(n);return t?U(e,t):e},J.createCallback=function(n,t,e){var r=typeof n;if(null==n||"function"==r)return tt(n,t,e);if("object"!=r)return Jt(n);var u=Fe(n),o=u[0],i=n[o];return 1!=u.length||i!==i||wt(i)?function(t){for(var e=u.length,r=!1;e--&&(r=ot(t[u[e]],n[u[e]],null,!0)););return r}:function(n){return n=n[o],i===n&&(0!==i||1/i==1/n)}},J.curry=function(n,t){return t="number"==typeof t?t:+t||n.length,ct(n,4,null,null,null,t)},J.debounce=Vt,J.defaults=_,J.defer=function(n){if(!dt(n))throw new ie;var t=p(arguments,1);return _e(function(){n.apply(v,t)},1)},J.delay=function(n,t){if(!dt(n))throw new ie;var e=p(arguments,2);return _e(function(){n.apply(v,e)},t)},J.difference=function(n){return rt(n,ut(arguments,!0,!0,1))},J.filter=Nt,J.flatten=function(n,t,e,r){return"boolean"!=typeof t&&null!=t&&(r=e,e="function"!=typeof t&&r&&r[t]===n?null:t,t=!1),null!=e&&(n=Rt(n,e,r)),ut(n,t)},J.forEach=St,J.forEachRight=Et,J.forIn=g,J.forInRight=function(n,t,e){var r=[];g(n,function(n,t){r.push(t,n)});var u=r.length;for(t=tt(t,e,3);u--&&!1!==t(r[u--],r[u],n););return n},J.forOwn=h,J.forOwnRight=mt,J.functions=bt,J.groupBy=Le,J.indexBy=Me,J.initial=function(n,t,e){var r=0,u=n?n.length:0;if("number"!=typeof t&&null!=t){var o=u;for(t=J.createCallback(t,e,3);o--&&t(n[o],o,n);)r++}else r=null==t||e?1:t||r;return p(n,0,Se(Ie(0,u-r),u))},J.intersection=function(){for(var e=[],r=-1,u=arguments.length,i=a(),f=st(),p=f===n,s=a();++r<u;){var v=arguments[r];(Te(v)||yt(v))&&(e.push(v),i.push(p&&v.length>=b&&o(r?e[r]:s)))}var p=e[0],h=-1,g=p?p.length:0,y=[];n:for(;++h<g;){var m=i[0],v=p[h];if(0>(m?t(m,v):f(s,v))){for(r=u,(m||s).push(v);--r;)if(m=i[r],0>(m?t(m,v):f(e[r],v)))continue n;y.push(v)}}for(;u--;)(m=i[u])&&c(m);return l(i),l(s),y},J.invert=_t,J.invoke=function(n,t){var e=p(arguments,2),r=-1,u="function"==typeof t,o=n?n.length:0,i=Xt("number"==typeof o?o:0);return St(n,function(n){i[++r]=(u?t:n[t]).apply(n,e)}),i},J.keys=Fe,J.map=Rt,J.mapValues=function(n,t,e){var r={};return t=J.createCallback(t,e,3),h(n,function(n,e,u){r[e]=t(n,e,u)}),r},J.max=At,J.memoize=function(n,t){function e(){var r=e.cache,u=t?t.apply(this,arguments):m+arguments[0];return me.call(r,u)?r[u]:r[u]=n.apply(this,arguments)}if(!dt(n))throw new ie;return e.cache={},e},J.merge=function(n){var t=arguments,e=2;if(!wt(n))return n;if("number"!=typeof t[2]&&(e=t.length),e>3&&"function"==typeof t[e-2])var r=tt(t[--e-1],t[e--],2);else e>2&&"function"==typeof t[e-1]&&(r=t[--e]);for(var t=p(arguments,1,e),u=-1,o=a(),i=a();++u<e;)it(n,t[u],r,o,i);return l(o),l(i),n},J.min=function(n,t,e){var u=1/0,o=u;if("function"!=typeof t&&e&&e[t]===n&&(t=null),null==t&&Te(n)){e=-1;for(var i=n.length;++e<i;){var a=n[e];o>a&&(o=a)}}else t=null==t&&kt(n)?r:J.createCallback(t,e,3),St(n,function(n,e,r){e=t(n,e,r),u>e&&(u=e,o=n)});return o},J.omit=function(n,t,e){var r={};if("function"!=typeof t){var u=[];g(n,function(n,t){u.push(t)});for(var u=rt(u,ut(arguments,!0,!1,1)),o=-1,i=u.length;++o<i;){var a=u[o];r[a]=n[a]}}else t=J.createCallback(t,e,3),g(n,function(n,e,u){t(n,e,u)||(r[e]=n)});return r},J.once=function(n){var t,e;if(!dt(n))throw new ie;return function(){return t?e:(t=!0,e=n.apply(this,arguments),n=null,e)}},J.pairs=function(n){for(var t=-1,e=Fe(n),r=e.length,u=Xt(r);++t<r;){var o=e[t];u[t]=[o,n[o]]}return u},J.partial=function(n){return ct(n,16,p(arguments,1))},J.partialRight=function(n){return ct(n,32,null,p(arguments,1))},J.pick=function(n,t,e){var r={};if("function"!=typeof t)for(var u=-1,o=ut(arguments,!0,!1,1),i=wt(n)?o.length:0;++u<i;){var a=o[u];a in n&&(r[a]=n[a])}else t=J.createCallback(t,e,3),g(n,function(n,e,u){t(n,e,u)&&(r[e]=n)});return r},J.pluck=Ve,J.property=Jt,J.pull=function(n){for(var t=arguments,e=0,r=t.length,u=n?n.length:0;++e<r;)for(var o=-1,i=t[e];++o<u;)n[o]===i&&(de.call(n,o--,1),u--);return n},J.range=function(n,t,e){n=+n||0,e="number"==typeof e?e:+e||1,null==t&&(t=n,n=0);var r=-1;t=Ie(0,se((t-n)/(e||1)));for(var u=Xt(t);++r<t;)u[r]=n,n+=e;return u},J.reject=function(n,t,e){return t=J.createCallback(t,e,3),Nt(n,function(n,e,r){return!t(n,e,r)})},J.remove=function(n,t,e){var r=-1,u=n?n.length:0,o=[];for(t=J.createCallback(t,e,3);++r<u;)e=n[r],t(e,r,n)&&(o.push(e),de.call(n,r--,1),u--);return o},J.rest=qt,J.shuffle=Tt,J.sortBy=function(n,t,e){var r=-1,o=Te(t),i=n?n.length:0,p=Xt("number"==typeof i?i:0);for(o||(t=J.createCallback(t,e,3)),St(n,function(n,e,u){var i=p[++r]=f();o?i.m=Rt(t,function(t){return n[t]}):(i.m=a())[0]=t(n,e,u),i.n=r,i.o=n}),i=p.length,p.sort(u);i--;)n=p[i],p[i]=n.o,o||l(n.m),c(n);return p},J.tap=function(n,t){return t(n),n},J.throttle=function(n,t,e){var r=!0,u=!0;if(!dt(n))throw new ie;return!1===e?r=!1:wt(e)&&(r="leading"in e?e.leading:r,u="trailing"in e?e.trailing:u),L.leading=r,L.maxWait=t,L.trailing=u,Vt(n,t,L)},J.times=function(n,t,e){n=-1<(n=+n)?n:0;var r=-1,u=Xt(n);for(t=tt(t,e,1);++r<n;)u[r]=t(r);return u},J.toArray=function(n){return n&&"number"==typeof n.length?p(n):xt(n)},J.transform=function(n,t,e,r){var u=Te(n);if(null==e)if(u)e=[];else{var o=n&&n.constructor;e=nt(o&&o.prototype)}return t&&(t=J.createCallback(t,r,4),(u?St:h)(n,function(n,r,u){return t(e,n,r,u)})),e},J.union=function(){return ft(ut(arguments,!0,!0))},J.uniq=Pt,J.values=xt,J.where=Nt,J.without=function(n){return rt(n,p(arguments,1))},J.wrap=function(n,t){return ct(t,16,[n])},J.xor=function(){for(var n=-1,t=arguments.length;++n<t;){var e=arguments[n];if(Te(e)||yt(e))var r=r?ft(rt(r,e).concat(rt(e,r))):e}return r||[]},J.zip=Kt,J.zipObject=Lt,J.collect=Rt,J.drop=qt,J.each=St,J.eachRight=Et,J.extend=U,J.methods=bt,J.object=Lt,J.select=Nt,J.tail=qt,J.unique=Pt,J.unzip=Kt,Gt(J),J.clone=function(n,t,e,r){return"boolean"!=typeof t&&null!=t&&(r=e,e=t,t=!1),Z(n,t,"function"==typeof e&&tt(e,r,1))},J.cloneDeep=function(n,t,e){return Z(n,!0,"function"==typeof t&&tt(t,e,1))},J.contains=Ct,J.escape=function(n){return null==n?"":oe(n).replace(ze,pt)},J.every=Ot,J.find=It,J.findIndex=function(n,t,e){var r=-1,u=n?n.length:0;for(t=J.createCallback(t,e,3);++r<u;)if(t(n[r],r,n))return r;return-1},J.findKey=function(n,t,e){var r;return t=J.createCallback(t,e,3),h(n,function(n,e,u){return t(n,e,u)?(r=e,!1):void 0}),r},J.findLast=function(n,t,e){var r;return t=J.createCallback(t,e,3),Et(n,function(n,e,u){return t(n,e,u)?(r=n,!1):void 0}),r},J.findLastIndex=function(n,t,e){var r=n?n.length:0;for(t=J.createCallback(t,e,3);r--;)if(t(n[r],r,n))return r;return-1},J.findLastKey=function(n,t,e){var r;return t=J.createCallback(t,e,3),mt(n,function(n,e,u){return t(n,e,u)?(r=e,!1):void 0}),r},J.has=function(n,t){return n?me.call(n,t):!1},J.identity=Ut,J.indexOf=Wt,J.isArguments=yt,J.isArray=Te,J.isBoolean=function(n){return!0===n||!1===n||n&&"object"==typeof n&&ce.call(n)==T||!1},J.isDate=function(n){return n&&"object"==typeof n&&ce.call(n)==F||!1},J.isElement=function(n){return n&&1===n.nodeType||!1},J.isEmpty=function(n){var t=!0;if(!n)return t;var e=ce.call(n),r=n.length;return e==$||e==P||e==D||e==q&&"number"==typeof r&&dt(n.splice)?!r:(h(n,function(){return t=!1}),t)},J.isEqual=function(n,t,e,r){return ot(n,t,"function"==typeof e&&tt(e,r,2))},J.isFinite=function(n){return Ce(n)&&!Oe(parseFloat(n))},J.isFunction=dt,J.isNaN=function(n){return jt(n)&&n!=+n},J.isNull=function(n){return null===n},J.isNumber=jt,J.isObject=wt,J.isPlainObject=Pe,J.isRegExp=function(n){return n&&"object"==typeof n&&ce.call(n)==z||!1},J.isString=kt,J.isUndefined=function(n){return"undefined"==typeof n},J.lastIndexOf=function(n,t,e){var r=n?n.length:0;for("number"==typeof e&&(r=(0>e?Ie(0,r+e):Se(e,r-1))+1);r--;)if(n[r]===t)return r;return-1},J.mixin=Gt,J.noConflict=function(){return e._=le,this},J.noop=Ht,J.now=Ue,J.parseInt=Ge,J.random=function(n,t,e){var r=null==n,u=null==t;return null==e&&("boolean"==typeof n&&u?(e=n,n=1):u||"boolean"!=typeof t||(e=t,u=!0)),r&&u&&(t=1),n=+n||0,u?(t=n,n=0):t=+t||0,e||n%1||t%1?(e=Re(),Se(n+e*(t-n+parseFloat("1e-"+((e+"").length-1))),t)):at(n,t)},J.reduce=Dt,J.reduceRight=$t,J.result=function(n,t){if(n){var e=n[t];return dt(e)?n[t]():e}},J.runInContext=s,J.size=function(n){var t=n?n.length:0;return"number"==typeof t?t:Fe(n).length},J.some=Ft,J.sortedIndex=zt,J.template=function(n,t,e){var r=J.templateSettings;n=oe(n||""),e=_({},e,r);var u,o=_({},e.imports,r.imports),r=Fe(o),o=xt(o),a=0,f=e.interpolate||S,l="__p+='",f=ue((e.escape||S).source+"|"+f.source+"|"+(f===N?x:S).source+"|"+(e.evaluate||S).source+"|$","g");n.replace(f,function(t,e,r,o,f,c){return r||(r=o),l+=n.slice(a,c).replace(R,i),e&&(l+="'+__e("+e+")+'"),f&&(u=!0,l+="';"+f+";\n__p+='"),r&&(l+="'+((__t=("+r+"))==null?'':__t)+'"),a=c+t.length,t}),l+="';",f=e=e.variable,f||(e="obj",l="with("+e+"){"+l+"}"),l=(u?l.replace(w,""):l).replace(j,"$1").replace(k,"$1;"),l="function("+e+"){"+(f?"":e+"||("+e+"={});")+"var __t,__p='',__e=_.escape"+(u?",__j=Array.prototype.join;function print(){__p+=__j.call(arguments,'')}":";")+l+"return __p}";try{var c=ne(r,"return "+l).apply(v,o)}catch(p){throw p.source=l,p}return t?c(t):(c.source=l,c)},J.unescape=function(n){return null==n?"":oe(n).replace(qe,gt)},J.uniqueId=function(n){var t=++y;return oe(null==n?"":n)+t},J.all=Ot,J.any=Ft,J.detect=It,J.findWhere=It,J.foldl=Dt,J.foldr=$t,J.include=Ct,J.inject=Dt,Gt(function(){var n={};return h(J,function(t,e){J.prototype[e]||(n[e]=t)}),n}(),!1),J.first=Bt,J.last=function(n,t,e){var r=0,u=n?n.length:0;if("number"!=typeof t&&null!=t){var o=u;for(t=J.createCallback(t,e,3);o--&&t(n[o],o,n);)r++}else if(r=t,null==r||e)return n?n[u-1]:v;return p(n,Ie(0,u-r))},J.sample=function(n,t,e){return n&&"number"!=typeof n.length&&(n=xt(n)),null==t||e?n?n[at(0,n.length-1)]:v:(n=Tt(n),n.length=Se(Ie(0,t),n.length),n)},J.take=Bt,J.head=Bt,h(J,function(n,t){var e="sample"!==t;J.prototype[t]||(J.prototype[t]=function(t,r){var u=this.__chain__,o=n(this.__wrapped__,t,r);return u||null!=t&&(!r||e&&"function"==typeof t)?new Q(o,u):o})}),J.VERSION="2.4.1",J.prototype.chain=function(){return this.__chain__=!0,this},J.prototype.toString=function(){return oe(this.__wrapped__)},J.prototype.value=Qt,J.prototype.valueOf=Qt,St(["join","pop","shift"],function(n){var t=ae[n];J.prototype[n]=function(){var n=this.__chain__,e=t.apply(this.__wrapped__,arguments);return n?new Q(e,n):e}}),St(["push","reverse","sort","unshift"],function(n){var t=ae[n];J.prototype[n]=function(){return t.apply(this.__wrapped__,arguments),this}}),St(["concat","slice","splice"],function(n){var t=ae[n];J.prototype[n]=function(){return new Q(t.apply(this.__wrapped__,arguments),this.__chain__)}}),J}var v,h=[],g=[],y=0,m=+new Date+"",b=75,_=40,d=" 	\f ﻿\n\r\u2028\u2029 ᠎             　",w=/\b__p\+='';/g,j=/\b(__p\+=)''\+/g,k=/(__e\(.*?\)|\b__t\))\+'';/g,x=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,C=/\w*$/,O=/^\s*function[ \n\r\t]+\w/,N=/<%=([\s\S]+?)%>/g,I=RegExp("^["+d+"]*0+(?=.$)"),S=/($^)/,E=/\bthis\b/,R=/['\n\r\t\u2028\u2029\\]/g,A="Array Boolean Date Function Math Number Object RegExp String _ attachEvent clearTimeout isFinite isNaN parseInt setTimeout".split(" "),D="[object Arguments]",$="[object Array]",T="[object Boolean]",F="[object Date]",B="[object Function]",W="[object Number]",q="[object Object]",z="[object RegExp]",P="[object String]",K={};K[B]=!1,K[D]=K[$]=K[T]=K[F]=K[W]=K[q]=K[z]=K[P]=!0;var L={leading:!1,maxWait:0,trailing:!1},M={configurable:!1,enumerable:!1,value:null,writable:!1},V={"boolean":!1,"function":!0,object:!0,number:!1,string:!1,undefined:!1},U={"\\":"\\","'":"'","\n":"n","\r":"r","	":"t","\u2028":"u2028","\u2029":"u2029"},G=V[typeof window]&&window||this,H=V[typeof exports]&&exports&&!exports.nodeType&&exports,J=V[typeof module]&&module&&!module.nodeType&&module,Q=J&&J.exports===H&&H,X=V[typeof global]&&global;!X||X.global!==X&&X.window!==X||(G=X);var Y=s();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(G._=Y,define(function(){return Y})):H&&J?Q?(J.exports=Y)._=Y:H._=Y:G._=Y}).call(this),window._=_,function(a){function b(a,b){return function(c){return i(a.call(this,c),b)}}function c(a,b){return function(c){return this.lang().ordinal(a.call(this,c),b)}}function d(){}function e(a){u(a),g(this,a)}function f(a){var b=o(a),c=b.year||0,d=b.month||0,e=b.week||0,f=b.day||0,g=b.hour||0,h=b.minute||0,i=b.second||0,j=b.millisecond||0;this._input=a,this._milliseconds=+j+1e3*i+6e4*h+36e5*g,this._days=+f+7*e,this._months=+d+12*c,this._data={},this._bubble()}function g(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return b.hasOwnProperty("toString")&&(a.toString=b.toString),b.hasOwnProperty("valueOf")&&(a.valueOf=b.valueOf),a}function h(a){return 0>a?Math.ceil(a):Math.floor(a)}function i(a,b){for(var c=a+"";c.length<b;)c="0"+c;return c}function j(a,b,c,d){var e,f,g=b._milliseconds,h=b._days,i=b._months;g&&a._d.setTime(+a._d+g*c),(h||i)&&(e=a.minute(),f=a.hour()),h&&a.date(a.date()+h*c),i&&a.month(a.month()+i*c),g&&!d&&bb.updateOffset(a),(h||i)&&(a.minute(e),a.hour(f))}function k(a){return"[object Array]"===Object.prototype.toString.call(a)}function l(a){return"[object Date]"===Object.prototype.toString.call(a)||a instanceof Date}function m(a,b,c){var d,e=Math.min(a.length,b.length),f=Math.abs(a.length-b.length),g=0;for(d=0;e>d;d++)(c&&a[d]!==b[d]||!c&&q(a[d])!==q(b[d]))&&g++;return g+f}function n(a){if(a){var b=a.toLowerCase().replace(/(.)s$/,"$1");a=Kb[a]||Lb[b]||b}return a}function o(a){var b,c,d={};for(c in a)a.hasOwnProperty(c)&&(b=n(c),b&&(d[b]=a[c]));return d}function p(b){var c,d;if(0===b.indexOf("week"))c=7,d="day";else{if(0!==b.indexOf("month"))return;c=12,d="month"}bb[b]=function(e,f){var g,h,i=bb.fn._lang[b],j=[];if("number"==typeof e&&(f=e,e=a),h=function(a){var b=bb().utc().set(d,a);return i.call(bb.fn._lang,b,e||"")},null!=f)return h(f);for(g=0;c>g;g++)j.push(h(g));return j}}function q(a){var b=+a,c=0;return 0!==b&&isFinite(b)&&(c=b>=0?Math.floor(b):Math.ceil(b)),c}function r(a,b){return new Date(Date.UTC(a,b+1,0)).getUTCDate()}function s(a){return t(a)?366:365}function t(a){return 0===a%4&&0!==a%100||0===a%400}function u(a){var b;a._a&&-2===a._pf.overflow&&(b=a._a[gb]<0||a._a[gb]>11?gb:a._a[hb]<1||a._a[hb]>r(a._a[fb],a._a[gb])?hb:a._a[ib]<0||a._a[ib]>23?ib:a._a[jb]<0||a._a[jb]>59?jb:a._a[kb]<0||a._a[kb]>59?kb:a._a[lb]<0||a._a[lb]>999?lb:-1,a._pf._overflowDayOfYear&&(fb>b||b>hb)&&(b=hb),a._pf.overflow=b)}function v(a){a._pf={empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function w(a){return null==a._isValid&&(a._isValid=!isNaN(a._d.getTime())&&a._pf.overflow<0&&!a._pf.empty&&!a._pf.invalidMonth&&!a._pf.nullInput&&!a._pf.invalidFormat&&!a._pf.userInvalidated,a._strict&&(a._isValid=a._isValid&&0===a._pf.charsLeftOver&&0===a._pf.unusedTokens.length)),a._isValid}function x(a){return a?a.toLowerCase().replace("_","-"):a}function y(a,b){return b.abbr=a,mb[a]||(mb[a]=new d),mb[a].set(b),mb[a]}function z(a){delete mb[a]}function A(a){var b,c,d,e,f=0,g=function(a){if(!mb[a]&&nb)try{require("./lang/"+a)}catch(b){}return mb[a]};if(!a)return bb.fn._lang;if(!k(a)){if(c=g(a))return c;a=[a]}for(;f<a.length;){for(e=x(a[f]).split("-"),b=e.length,d=x(a[f+1]),d=d?d.split("-"):null;b>0;){if(c=g(e.slice(0,b).join("-")))return c;if(d&&d.length>=b&&m(e,d,!0)>=b-1)break;b--}f++}return bb.fn._lang}function B(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function C(a){var b,c,d=a.match(rb);for(b=0,c=d.length;c>b;b++)d[b]=Pb[d[b]]?Pb[d[b]]:B(d[b]);return function(e){var f="";for(b=0;c>b;b++)f+=d[b]instanceof Function?d[b].call(e,a):d[b];return f}}function D(a,b){return a.isValid()?(b=E(b,a.lang()),Mb[b]||(Mb[b]=C(b)),Mb[b](a)):a.lang().invalidDate()}function E(a,b){function c(a){return b.longDateFormat(a)||a}var d=5;for(sb.lastIndex=0;d>=0&&sb.test(a);)a=a.replace(sb,c),sb.lastIndex=0,d-=1;return a}function F(a,b){var c;switch(a){case"DDDD":return vb;case"YYYY":case"GGGG":case"gggg":return wb;case"YYYYY":case"GGGGG":case"ggggg":return xb;case"S":case"SS":case"SSS":case"DDD":return ub;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return zb;case"a":case"A":return A(b._l)._meridiemParse;case"X":return Cb;case"Z":case"ZZ":return Ab;case"T":return Bb;case"SSSS":return yb;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"ww":case"W":case"WW":case"e":case"E":return tb;
default:return c=new RegExp(N(M(a.replace("\\","")),"i"))}}function G(a){var b=(Ab.exec(a)||[])[0],c=(b+"").match(Hb)||["-",0,0],d=+(60*c[1])+q(c[2]);return"+"===c[0]?-d:d}function H(a,b,c){var d,e=c._a;switch(a){case"M":case"MM":null!=b&&(e[gb]=q(b)-1);break;case"MMM":case"MMMM":d=A(c._l).monthsParse(b),null!=d?e[gb]=d:c._pf.invalidMonth=b;break;case"D":case"DD":null!=b&&(e[hb]=q(b));break;case"DDD":case"DDDD":null!=b&&(c._dayOfYear=q(b));break;case"YY":e[fb]=q(b)+(q(b)>68?1900:2e3);break;case"YYYY":case"YYYYY":e[fb]=q(b);break;case"a":case"A":c._isPm=A(c._l).isPM(b);break;case"H":case"HH":case"h":case"hh":e[ib]=q(b);break;case"m":case"mm":e[jb]=q(b);break;case"s":case"ss":e[kb]=q(b);break;case"S":case"SS":case"SSS":case"SSSS":e[lb]=q(1e3*("0."+b));break;case"X":c._d=new Date(1e3*parseFloat(b));break;case"Z":case"ZZ":c._useUTC=!0,c._tzm=G(b);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":a=a.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":a=a.substr(0,2),b&&(c._w=c._w||{},c._w[a]=b)}}function I(a){var b,c,d,e,f,g,h,i,j,k,l=[];if(!a._d){for(d=K(a),a._w&&null==a._a[hb]&&null==a._a[gb]&&(f=function(b){return b?b.length<3?parseInt(b,10)>68?"19"+b:"20"+b:b:null==a._a[fb]?bb().weekYear():a._a[fb]},g=a._w,null!=g.GG||null!=g.W||null!=g.E?h=X(f(g.GG),g.W||1,g.E,4,1):(i=A(a._l),j=null!=g.d?T(g.d,i):null!=g.e?parseInt(g.e,10)+i._week.dow:0,k=parseInt(g.w,10)||1,null!=g.d&&j<i._week.dow&&k++,h=X(f(g.gg),k,j,i._week.doy,i._week.dow)),a._a[fb]=h.year,a._dayOfYear=h.dayOfYear),a._dayOfYear&&(e=null==a._a[fb]?d[fb]:a._a[fb],a._dayOfYear>s(e)&&(a._pf._overflowDayOfYear=!0),c=S(e,0,a._dayOfYear),a._a[gb]=c.getUTCMonth(),a._a[hb]=c.getUTCDate()),b=0;3>b&&null==a._a[b];++b)a._a[b]=l[b]=d[b];for(;7>b;b++)a._a[b]=l[b]=null==a._a[b]?2===b?1:0:a._a[b];l[ib]+=q((a._tzm||0)/60),l[jb]+=q((a._tzm||0)%60),a._d=(a._useUTC?S:R).apply(null,l)}}function J(a){var b;a._d||(b=o(a._i),a._a=[b.year,b.month,b.day,b.hour,b.minute,b.second,b.millisecond],I(a))}function K(a){var b=new Date;return a._useUTC?[b.getUTCFullYear(),b.getUTCMonth(),b.getUTCDate()]:[b.getFullYear(),b.getMonth(),b.getDate()]}function L(a){a._a=[],a._pf.empty=!0;var b,c,d,e,f,g=A(a._l),h=""+a._i,i=h.length,j=0;for(d=E(a._f,g).match(rb)||[],b=0;b<d.length;b++)e=d[b],c=(F(e,a).exec(h)||[])[0],c&&(f=h.substr(0,h.indexOf(c)),f.length>0&&a._pf.unusedInput.push(f),h=h.slice(h.indexOf(c)+c.length),j+=c.length),Pb[e]?(c?a._pf.empty=!1:a._pf.unusedTokens.push(e),H(e,c,a)):a._strict&&!c&&a._pf.unusedTokens.push(e);a._pf.charsLeftOver=i-j,h.length>0&&a._pf.unusedInput.push(h),a._isPm&&a._a[ib]<12&&(a._a[ib]+=12),a._isPm===!1&&12===a._a[ib]&&(a._a[ib]=0),I(a),u(a)}function M(a){return a.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(a,b,c,d,e){return b||c||d||e})}function N(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function O(a){var b,c,d,e,f;if(0===a._f.length)return a._pf.invalidFormat=!0,void(a._d=new Date(0/0));for(e=0;e<a._f.length;e++)f=0,b=g({},a),v(b),b._f=a._f[e],L(b),w(b)&&(f+=b._pf.charsLeftOver,f+=10*b._pf.unusedTokens.length,b._pf.score=f,(null==d||d>f)&&(d=f,c=b));g(a,c||b)}function P(a){var b,c=a._i,d=Db.exec(c);if(d){for(a._pf.iso=!0,b=4;b>0;b--)if(d[b]){a._f=Fb[b-1]+(d[6]||" ");break}for(b=0;4>b;b++)if(Gb[b][1].exec(c)){a._f+=Gb[b][0];break}Ab.exec(c)&&(a._f+="Z"),L(a)}else a._d=new Date(c)}function Q(b){var c=b._i,d=ob.exec(c);c===a?b._d=new Date:d?b._d=new Date(+d[1]):"string"==typeof c?P(b):k(c)?(b._a=c.slice(0),I(b)):l(c)?b._d=new Date(+c):"object"==typeof c?J(b):b._d=new Date(c)}function R(a,b,c,d,e,f,g){var h=new Date(a,b,c,d,e,f,g);return 1970>a&&h.setFullYear(a),h}function S(a){var b=new Date(Date.UTC.apply(null,arguments));return 1970>a&&b.setUTCFullYear(a),b}function T(a,b){if("string"==typeof a)if(isNaN(a)){if(a=b.weekdaysParse(a),"number"!=typeof a)return null}else a=parseInt(a,10);return a}function U(a,b,c,d,e){return e.relativeTime(b||1,!!c,a,d)}function V(a,b,c){var d=eb(Math.abs(a)/1e3),e=eb(d/60),f=eb(e/60),g=eb(f/24),h=eb(g/365),i=45>d&&["s",d]||1===e&&["m"]||45>e&&["mm",e]||1===f&&["h"]||22>f&&["hh",f]||1===g&&["d"]||25>=g&&["dd",g]||45>=g&&["M"]||345>g&&["MM",eb(g/30)]||1===h&&["y"]||["yy",h];return i[2]=b,i[3]=a>0,i[4]=c,U.apply({},i)}function W(a,b,c){var d,e=c-b,f=c-a.day();return f>e&&(f-=7),e-7>f&&(f+=7),d=bb(a).add("d",f),{week:Math.ceil(d.dayOfYear()/7),year:d.year()}}function X(a,b,c,d,e){var f,g,h=new Date(Date.UTC(a,0)).getUTCDay();return c=null!=c?c:e,f=e-h+(h>d?7:0),g=7*(b-1)+(c-e)+f+1,{year:g>0?a:a-1,dayOfYear:g>0?g:s(a-1)+g}}function Y(a){var b=a._i,c=a._f;return"undefined"==typeof a._pf&&v(a),null===b?bb.invalid({nullInput:!0}):("string"==typeof b&&(a._i=b=A().preparse(b)),bb.isMoment(b)?(a=g({},b),a._d=new Date(+b._d)):c?k(c)?O(a):L(a):Q(a),new e(a))}function Z(a,b){bb.fn[a]=bb.fn[a+"s"]=function(a){var c=this._isUTC?"UTC":"";return null!=a?(this._d["set"+c+b](a),bb.updateOffset(this),this):this._d["get"+c+b]()}}function $(a){bb.duration.fn[a]=function(){return this._data[a]}}function _(a,b){bb.duration.fn["as"+a]=function(){return+this/b}}function ab(a){var b=!1,c=bb;"undefined"==typeof ender&&(this.moment=a?function(){return!b&&console&&console.warn&&(b=!0,console.warn("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.")),c.apply(null,arguments)}:bb)}for(var bb,cb,db="2.4.0",eb=Math.round,fb=0,gb=1,hb=2,ib=3,jb=4,kb=5,lb=6,mb={},nb="undefined"!=typeof module&&module.exports,ob=/^\/?Date\((\-?\d+)/i,pb=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,qb=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,rb=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,sb=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,tb=/\d\d?/,ub=/\d{1,3}/,vb=/\d{3}/,wb=/\d{1,4}/,xb=/[+\-]?\d{1,6}/,yb=/\d+/,zb=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Ab=/Z|[\+\-]\d\d:?\d\d/i,Bb=/T/i,Cb=/[\+\-]?\d+(\.\d{1,3})?/,Db=/^\s*\d{4}-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d:?\d\d|Z)?)?$/,Eb="YYYY-MM-DDTHH:mm:ssZ",Fb=["YYYY-MM-DD","GGGG-[W]WW","GGGG-[W]WW-E","YYYY-DDD"],Gb=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Hb=/([\+\-]|\d\d)/gi,Ib="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),Jb={Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6},Kb={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},Lb={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},Mb={},Nb="DDD w W M D d".split(" "),Ob="M D H h m s w W".split(" "),Pb={M:function(){return this.month()+1},MMM:function(a){return this.lang().monthsShort(this,a)},MMMM:function(a){return this.lang().months(this,a)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(a){return this.lang().weekdaysMin(this,a)},ddd:function(a){return this.lang().weekdaysShort(this,a)},dddd:function(a){return this.lang().weekdays(this,a)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return i(this.year()%100,2)},YYYY:function(){return i(this.year(),4)},YYYYY:function(){return i(this.year(),5)},gg:function(){return i(this.weekYear()%100,2)},gggg:function(){return this.weekYear()},ggggg:function(){return i(this.weekYear(),5)},GG:function(){return i(this.isoWeekYear()%100,2)},GGGG:function(){return this.isoWeekYear()},GGGGG:function(){return i(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return q(this.milliseconds()/100)},SS:function(){return i(q(this.milliseconds()/10),2)},SSS:function(){return i(this.milliseconds(),3)},SSSS:function(){return i(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+i(q(a/60),2)+":"+i(q(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";return 0>a&&(a=-a,b="-"),b+i(q(10*a/6),4)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()}},Qb=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];Nb.length;)cb=Nb.pop(),Pb[cb+"o"]=c(Pb[cb],cb);for(;Ob.length;)cb=Ob.pop(),Pb[cb+cb]=b(Pb[cb],2);for(Pb.DDDD=b(Pb.DDD,3),g(d.prototype,{set:function(a){var b,c;for(c in a)b=a[c],"function"==typeof b?this[c]=b:this["_"+c]=b},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(a){return this._months[a.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(a){return this._monthsShort[a.month()]},monthsParse:function(a){var b,c,d;for(this._monthsParse||(this._monthsParse=[]),b=0;12>b;b++)if(this._monthsParse[b]||(c=bb.utc([2e3,b]),d="^"+this.months(c,"")+"|^"+this.monthsShort(c,""),this._monthsParse[b]=new RegExp(d.replace(".",""),"i")),this._monthsParse[b].test(a))return b},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(a){return this._weekdays[a.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(a){return this._weekdaysShort[a.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(a){return this._weekdaysMin[a.day()]},weekdaysParse:function(a){var b,c,d;for(this._weekdaysParse||(this._weekdaysParse=[]),b=0;7>b;b++)if(this._weekdaysParse[b]||(c=bb([2e3,1]).day(b),d="^"+this.weekdays(c,"")+"|^"+this.weekdaysShort(c,"")+"|^"+this.weekdaysMin(c,""),this._weekdaysParse[b]=new RegExp(d.replace(".",""),"i")),this._weekdaysParse[b].test(a))return b},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(a){var b=this._longDateFormat[a];return!b&&this._longDateFormat[a.toUpperCase()]&&(b=this._longDateFormat[a.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(a){return a.slice(1)}),this._longDateFormat[a]=b),b},isPM:function(a){return"p"===(a+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(a,b,c){return a>11?c?"pm":"PM":c?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendar[a];return"function"==typeof c?c.apply(b):c},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(a,b,c,d){var e=this._relativeTime[c];return"function"==typeof e?e(a,b,c,d):e.replace(/%d/i,a)},pastFuture:function(a,b){var c=this._relativeTime[a>0?"future":"past"];return"function"==typeof c?c(b):c.replace(/%s/i,b)},ordinal:function(a){return this._ordinal.replace("%d",a)},_ordinal:"%d",preparse:function(a){return a},postformat:function(a){return a},week:function(a){return W(a,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),bb=function(b,c,d,e){return"boolean"==typeof d&&(e=d,d=a),Y({_i:b,_f:c,_l:d,_strict:e,_isUTC:!1})},bb.utc=function(b,c,d,e){var f;return"boolean"==typeof d&&(e=d,d=a),f=Y({_useUTC:!0,_isUTC:!0,_l:d,_i:b,_f:c,_strict:e}).utc()},bb.unix=function(a){return bb(1e3*a)},bb.duration=function(a,b){var c,d,e,g=bb.isDuration(a),h="number"==typeof a,i=g?a._input:h?{}:a,j=null;return h?b?i[b]=a:i.milliseconds=a:(j=pb.exec(a))?(c="-"===j[1]?-1:1,i={y:0,d:q(j[hb])*c,h:q(j[ib])*c,m:q(j[jb])*c,s:q(j[kb])*c,ms:q(j[lb])*c}):(j=qb.exec(a))&&(c="-"===j[1]?-1:1,e=function(a){var b=a&&parseFloat(a.replace(",","."));return(isNaN(b)?0:b)*c},i={y:e(j[2]),M:e(j[3]),d:e(j[4]),h:e(j[5]),m:e(j[6]),s:e(j[7]),w:e(j[8])}),d=new f(i),g&&a.hasOwnProperty("_lang")&&(d._lang=a._lang),d},bb.version=db,bb.defaultFormat=Eb,bb.updateOffset=function(){},bb.lang=function(a,b){var c;return a?(b?y(x(a),b):null===b?(z(a),a="en"):mb[a]||A(a),c=bb.duration.fn._lang=bb.fn._lang=A(a),c._abbr):bb.fn._lang._abbr},bb.langData=function(a){return a&&a._lang&&a._lang._abbr&&(a=a._lang._abbr),A(a)},bb.isMoment=function(a){return a instanceof e},bb.isDuration=function(a){return a instanceof f},cb=Qb.length-1;cb>=0;--cb)p(Qb[cb]);for(bb.normalizeUnits=function(a){return n(a)},bb.invalid=function(a){var b=bb.utc(0/0);return null!=a?g(b._pf,a):b._pf.userInvalidated=!0,b},bb.parseZone=function(a){return bb(a).parseZone()},g(bb.fn=e.prototype,{clone:function(){return bb(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){return D(bb(this).utc(),"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var a=this;return[a.year(),a.month(),a.date(),a.hours(),a.minutes(),a.seconds(),a.milliseconds()]},isValid:function(){return w(this)},isDSTShifted:function(){return this._a?this.isValid()&&m(this._a,(this._isUTC?bb.utc(this._a):bb(this._a)).toArray())>0:!1},parsingFlags:function(){return g({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(a){var b=D(this,a||bb.defaultFormat);return this.lang().postformat(b)},add:function(a,b){var c;return c="string"==typeof a?bb.duration(+b,a):bb.duration(a,b),j(this,c,1),this},subtract:function(a,b){var c;return c="string"==typeof a?bb.duration(+b,a):bb.duration(a,b),j(this,c,-1),this},diff:function(a,b,c){var d,e,f=this._isUTC?bb(a).zone(this._offset||0):bb(a).local(),g=6e4*(this.zone()-f.zone());return b=n(b),"year"===b||"month"===b?(d=432e5*(this.daysInMonth()+f.daysInMonth()),e=12*(this.year()-f.year())+(this.month()-f.month()),e+=(this-bb(this).startOf("month")-(f-bb(f).startOf("month")))/d,e-=6e4*(this.zone()-bb(this).startOf("month").zone()-(f.zone()-bb(f).startOf("month").zone()))/d,"year"===b&&(e/=12)):(d=this-f,e="second"===b?d/1e3:"minute"===b?d/6e4:"hour"===b?d/36e5:"day"===b?(d-g)/864e5:"week"===b?(d-g)/6048e5:d),c?e:h(e)},from:function(a,b){return bb.duration(this.diff(a)).lang(this.lang()._abbr).humanize(!b)},fromNow:function(a){return this.from(bb(),a)},calendar:function(){var a=this.diff(bb().zone(this.zone()).startOf("day"),"days",!0),b=-6>a?"sameElse":-1>a?"lastWeek":0>a?"lastDay":1>a?"sameDay":2>a?"nextDay":7>a?"nextWeek":"sameElse";return this.format(this.lang().calendar(b,this))},isLeapYear:function(){return t(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(a){var b=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=a?(a=T(a,this.lang()),this.add({d:a-b})):b},month:function(a){var b,c=this._isUTC?"UTC":"";return null!=a?"string"==typeof a&&(a=this.lang().monthsParse(a),"number"!=typeof a)?this:(b=this.date(),this.date(1),this._d["set"+c+"Month"](a),this.date(Math.min(b,this.daysInMonth())),bb.updateOffset(this),this):this._d["get"+c+"Month"]()},startOf:function(a){switch(a=n(a)){case"year":this.month(0);case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===a?this.weekday(0):"isoWeek"===a&&this.isoWeekday(1),this},endOf:function(a){return a=n(a),this.startOf(a).add("isoWeek"===a?"week":a,1).subtract("ms",1)},isAfter:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)>+bb(a).startOf(b)},isBefore:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)<+bb(a).startOf(b)},isSame:function(a,b){return b="undefined"!=typeof b?b:"millisecond",+this.clone().startOf(b)===+bb(a).startOf(b)},min:function(a){return a=bb.apply(null,arguments),this>a?this:a},max:function(a){return a=bb.apply(null,arguments),a>this?this:a},zone:function(a){var b=this._offset||0;return null==a?this._isUTC?b:this._d.getTimezoneOffset():("string"==typeof a&&(a=G(a)),Math.abs(a)<16&&(a=60*a),this._offset=a,this._isUTC=!0,b!==a&&j(this,bb.duration(b-a,"m"),1,!0),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(a){return a=a?bb(a).zone():0,0===(this.zone()-a)%60},daysInMonth:function(){return r(this.year(),this.month())},dayOfYear:function(a){var b=eb((bb(this).startOf("day")-bb(this).startOf("year"))/864e5)+1;return null==a?b:this.add("d",a-b)},weekYear:function(a){var b=W(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==a?b:this.add("y",a-b)},isoWeekYear:function(a){var b=W(this,1,4).year;return null==a?b:this.add("y",a-b)},week:function(a){var b=this.lang().week(this);return null==a?b:this.add("d",7*(a-b))},isoWeek:function(a){var b=W(this,1,4).week;return null==a?b:this.add("d",7*(a-b))},weekday:function(a){var b=(this.day()+7-this.lang()._week.dow)%7;return null==a?b:this.add("d",a-b)},isoWeekday:function(a){return null==a?this.day()||7:this.day(this.day()%7?a:a-7)},get:function(a){return a=n(a),this[a]()},set:function(a,b){return a=n(a),"function"==typeof this[a]&&this[a](b),this},lang:function(b){return b===a?this._lang:(this._lang=A(b),this)}}),cb=0;cb<Ib.length;cb++)Z(Ib[cb].toLowerCase().replace(/s$/,""),Ib[cb]);Z("year","FullYear"),bb.fn.days=bb.fn.day,bb.fn.months=bb.fn.month,bb.fn.weeks=bb.fn.week,bb.fn.isoWeeks=bb.fn.isoWeek,bb.fn.toJSON=bb.fn.toISOString,g(bb.duration.fn=f.prototype,{_bubble:function(){var a,b,c,d,e=this._milliseconds,f=this._days,g=this._months,i=this._data;i.milliseconds=e%1e3,a=h(e/1e3),i.seconds=a%60,b=h(a/60),i.minutes=b%60,c=h(b/60),i.hours=c%24,f+=h(c/24),i.days=f%30,g+=h(f/30),i.months=g%12,d=h(g/12),i.years=d},weeks:function(){return h(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+2592e6*(this._months%12)+31536e6*q(this._months/12)},humanize:function(a){var b=+this,c=V(b,!a,this.lang());return a&&(c=this.lang().pastFuture(b,c)),this.lang().postformat(c)},add:function(a,b){var c=bb.duration(a,b);return this._milliseconds+=c._milliseconds,this._days+=c._days,this._months+=c._months,this._bubble(),this},subtract:function(a,b){var c=bb.duration(a,b);return this._milliseconds-=c._milliseconds,this._days-=c._days,this._months-=c._months,this._bubble(),this},get:function(a){return a=n(a),this[a.toLowerCase()+"s"]()},as:function(a){return a=n(a),this["as"+a.charAt(0).toUpperCase()+a.slice(1)+"s"]()},lang:bb.fn.lang,toIsoString:function(){var a=Math.abs(this.years()),b=Math.abs(this.months()),c=Math.abs(this.days()),d=Math.abs(this.hours()),e=Math.abs(this.minutes()),f=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(a?a+"Y":"")+(b?b+"M":"")+(c?c+"D":"")+(d||e||f?"T":"")+(d?d+"H":"")+(e?e+"M":"")+(f?f+"S":""):"P0D"}});for(cb in Jb)Jb.hasOwnProperty(cb)&&(_(cb,Jb[cb]),$(cb.toLowerCase()));_("Weeks",6048e5),bb.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},bb.lang("en",{ordinal:function(a){var b=a%10,c=1===q(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}}),function(a){a(bb)}(function(a){return a.lang("ar-ma",{months:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),monthsShort:"يناير_فبراير_مارس_أبريل_ماي_يونيو_يوليوز_غشت_شتنبر_أكتوبر_نونبر_دجنبر".split("_"),weekdays:"الأحد_الإتنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"احد_اتنين_ثلاثاء_اربعاء_خميس_جمعة_سبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){return a.lang("ar",{months:"يناير/ كانون الثاني_فبراير/ شباط_مارس/ آذار_أبريل/ نيسان_مايو/ أيار_يونيو/ حزيران_يوليو/ تموز_أغسطس/ آب_سبتمبر/ أيلول_أكتوبر/ تشرين الأول_نوفمبر/ تشرين الثاني_ديسمبر/ كانون الأول".split("_"),monthsShort:"يناير/ كانون الثاني_فبراير/ شباط_مارس/ آذار_أبريل/ نيسان_مايو/ أيار_يونيو/ حزيران_يوليو/ تموز_أغسطس/ آب_سبتمبر/ أيلول_أكتوبر/ تشرين الأول_نوفمبر/ تشرين الثاني_ديسمبر/ كانون الأول".split("_"),weekdays:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysShort:"الأحد_الإثنين_الثلاثاء_الأربعاء_الخميس_الجمعة_السبت".split("_"),weekdaysMin:"ح_ن_ث_ر_خ_ج_س".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[اليوم على الساعة] LT",nextDay:"[غدا على الساعة] LT",nextWeek:"dddd [على الساعة] LT",lastDay:"[أمس على الساعة] LT",lastWeek:"dddd [على الساعة] LT",sameElse:"L"},relativeTime:{future:"في %s",past:"منذ %s",s:"ثوان",m:"دقيقة",mm:"%d دقائق",h:"ساعة",hh:"%d ساعات",d:"يوم",dd:"%d أيام",M:"شهر",MM:"%d أشهر",y:"سنة",yy:"%d سنوات"},week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){return a.lang("bg",{months:"януари_февруари_март_април_май_юни_юли_август_септември_октомври_ноември_декември".split("_"),monthsShort:"янр_фев_мар_апр_май_юни_юли_авг_сеп_окт_ное_дек".split("_"),weekdays:"неделя_понеделник_вторник_сряда_четвъртък_петък_събота".split("_"),weekdaysShort:"нед_пон_вто_сря_чет_пет_съб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat:{LT:"H:mm",L:"D.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Днес в] LT",nextDay:"[Утре в] LT",nextWeek:"dddd [в] LT",lastDay:"[Вчера в] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[В изминалата] dddd [в] LT";case 1:case 2:case 4:case 5:return"[В изминалия] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"след %s",past:"преди %s",s:"няколко секунди",m:"минута",mm:"%d минути",h:"час",hh:"%d часа",d:"ден",dd:"%d дни",M:"месец",MM:"%d месеца",y:"година",yy:"%d години"},ordinal:function(a){var b=a%10,c=a%100;return 0===a?a+"-ев":0===c?a+"-ен":c>10&&20>c?a+"-ти":1===b?a+"-ви":2===b?a+"-ри":7===b||8===b?a+"-ми":a+"-ти"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(b){function c(a,b,c){var d={mm:"munutenn",MM:"miz",dd:"devezh"};return a+" "+f(d[c],a)}function d(a){switch(e(a)){case 1:case 3:case 4:case 5:case 9:return a+" bloaz";default:return a+" vloaz"}}function e(a){return a>9?e(a%10):a}function f(a,b){return 2===b?g(a):a}function g(b){var c={m:"v",b:"v",d:"z"};return c[b.charAt(0)]===a?b:c[b.charAt(0)]+b.substring(1)}return b.lang("br",{months:"Genver_C'hwevrer_Meurzh_Ebrel_Mae_Mezheven_Gouere_Eost_Gwengolo_Here_Du_Kerzu".split("_"),monthsShort:"Gen_C'hwe_Meu_Ebr_Mae_Eve_Gou_Eos_Gwe_Her_Du_Ker".split("_"),weekdays:"Sul_Lun_Meurzh_Merc'her_Yaou_Gwener_Sadorn".split("_"),weekdaysShort:"Sul_Lun_Meu_Mer_Yao_Gwe_Sad".split("_"),weekdaysMin:"Su_Lu_Me_Mer_Ya_Gw_Sa".split("_"),longDateFormat:{LT:"h[e]mm A",L:"DD/MM/YYYY",LL:"D [a viz] MMMM YYYY",LLL:"D [a viz] MMMM YYYY LT",LLLL:"dddd, D [a viz] MMMM YYYY LT"},calendar:{sameDay:"[Hiziv da] LT",nextDay:"[Warc'hoazh da] LT",nextWeek:"dddd [da] LT",lastDay:"[Dec'h da] LT",lastWeek:"dddd [paset da] LT",sameElse:"L"},relativeTime:{future:"a-benn %s",past:"%s 'zo",s:"un nebeud segondennoù",m:"ur vunutenn",mm:c,h:"un eur",hh:"%d eur",d:"un devezh",dd:c,M:"ur miz",MM:c,y:"ur bloaz",yy:d},ordinal:function(a){var b=1===a?"añ":"vet";return a+b},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("bs",{months:"januar_februar_mart_april_maj_juni_juli_avgust_septembar_oktobar_novembar_decembar".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jučer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prošlu] dddd [u] LT";case 6:return"[prošle] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[prošli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mjesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("ca",{months:"Gener_Febrer_Març_Abril_Maig_Juny_Juliol_Agost_Setembre_Octubre_Novembre_Desembre".split("_"),monthsShort:"Gen._Febr._Mar._Abr._Mai._Jun._Jul._Ag._Set._Oct._Nov._Des.".split("_"),weekdays:"Diumenge_Dilluns_Dimarts_Dimecres_Dijous_Divendres_Dissabte".split("_"),weekdaysShort:"Dg._Dl._Dt._Dc._Dj._Dv._Ds.".split("_"),weekdaysMin:"Dg_Dl_Dt_Dc_Dj_Dv_Ds".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:function(){return"[avui a "+(1!==this.hours()?"les":"la")+"] LT"},nextDay:function(){return"[demà a "+(1!==this.hours()?"les":"la")+"] LT"},nextWeek:function(){return"dddd [a "+(1!==this.hours()?"les":"la")+"] LT"},lastDay:function(){return"[ahir a "+(1!==this.hours()?"les":"la")+"] LT"},lastWeek:function(){return"[el] dddd [passat a "+(1!==this.hours()?"les":"la")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"fa %s",s:"uns segons",m:"un minut",mm:"%d minuts",h:"una hora",hh:"%d hores",d:"un dia",dd:"%d dies",M:"un mes",MM:"%d mesos",y:"un any",yy:"%d anys"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a){return a>1&&5>a&&1!==~~(a/10)}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"pár vteřin":"pár vteřinami";case"m":return c?"minuta":e?"minutu":"minutou";case"mm":return c||e?f+(b(a)?"minuty":"minut"):f+"minutami";case"h":return c?"hodina":e?"hodinu":"hodinou";case"hh":return c||e?f+(b(a)?"hodiny":"hodin"):f+"hodinami";case"d":return c||e?"den":"dnem";case"dd":return c||e?f+(b(a)?"dny":"dní"):f+"dny";case"M":return c||e?"měsíc":"měsícem";case"MM":return c||e?f+(b(a)?"měsíce":"měsíců"):f+"měsíci";case"y":return c||e?"rok":"rokem";case"yy":return c||e?f+(b(a)?"roky":"let"):f+"lety"}}var d="leden_únor_březen_duben_květen_červen_červenec_srpen_září_říjen_listopad_prosinec".split("_"),e="led_úno_bře_dub_kvě_čvn_čvc_srp_zář_říj_lis_pro".split("_");return a.lang("cs",{months:d,monthsShort:e,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(d,e),weekdays:"neděle_pondělí_úterý_středa_čtvrtek_pátek_sobota".split("_"),weekdaysShort:"ne_po_út_st_čt_pá_so".split("_"),weekdaysMin:"ne_po_út_st_čt_pá_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd D. MMMM YYYY LT"},calendar:{sameDay:"[dnes v] LT",nextDay:"[zítra v] LT",nextWeek:function(){switch(this.day()){case 0:return"[v neděli v] LT";case 1:case 2:return"[v] dddd [v] LT";case 3:return"[ve středu v] LT";case 4:return"[ve čtvrtek v] LT";case 5:return"[v pátek v] LT";case 6:return"[v sobotu v] LT"}},lastDay:"[včera v] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulou neděli v] LT";case 1:case 2:return"[minulé] dddd [v] LT";case 3:return"[minulou středu v] LT";case 4:case 5:return"[minulý] dddd [v] LT";case 6:return"[minulou sobotu v] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"před %s",s:c,m:c,mm:c,h:c,hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("cv",{months:"кăрлач_нарăс_пуш_ака_май_çĕртме_утă_çурла_авăн_юпа_чӳк_раштав".split("_"),monthsShort:"кăр_нар_пуш_ака_май_çĕр_утă_çур_ав_юпа_чӳк_раш".split("_"),weekdays:"вырсарникун_тунтикун_ытларикун_юнкун_кĕçнерникун_эрнекун_шăматкун".split("_"),weekdaysShort:"выр_тун_ытл_юн_кĕç_эрн_шăм".split("_"),weekdaysMin:"вр_тн_ыт_юн_кç_эр_шм".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"YYYY [çулхи] MMMM [уйăхĕн] D[-мĕшĕ]",LLL:"YYYY [çулхи] MMMM [уйăхĕн] D[-мĕшĕ], LT",LLLL:"dddd, YYYY [çулхи] MMMM [уйăхĕн] D[-мĕшĕ], LT"},calendar:{sameDay:"[Паян] LT [сехетре]",nextDay:"[Ыран] LT [сехетре]",lastDay:"[Ĕнер] LT [сехетре]",nextWeek:"[Çитес] dddd LT [сехетре]",lastWeek:"[Иртнĕ] dddd LT [сехетре]",sameElse:"L"},relativeTime:{future:function(a){var b=/сехет$/i.exec(a)?"рен":/çул$/i.exec(a)?"тан":"ран";return a+b},past:"%s каялла",s:"пĕр-ик çеккунт",m:"пĕр минут",mm:"%d минут",h:"пĕр сехет",hh:"%d сехет",d:"пĕр кун",dd:"%d кун",M:"пĕр уйăх",MM:"%d уйăх",y:"пĕр çул",yy:"%d çул"},ordinal:"%d-мĕш",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("cy",{months:"Ionawr_Chwefror_Mawrth_Ebrill_Mai_Mehefin_Gorffennaf_Awst_Medi_Hydref_Tachwedd_Rhagfyr".split("_"),monthsShort:"Ion_Chwe_Maw_Ebr_Mai_Meh_Gor_Aws_Med_Hyd_Tach_Rhag".split("_"),weekdays:"Dydd Sul_Dydd Llun_Dydd Mawrth_Dydd Mercher_Dydd Iau_Dydd Gwener_Dydd Sadwrn".split("_"),weekdaysShort:"Sul_Llun_Maw_Mer_Iau_Gwe_Sad".split("_"),weekdaysMin:"Su_Ll_Ma_Me_Ia_Gw_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Heddiw am] LT",nextDay:"[Yfory am] LT",nextWeek:"dddd [am] LT",lastDay:"[Ddoe am] LT",lastWeek:"dddd [diwethaf am] LT",sameElse:"L"},relativeTime:{future:"mewn %s",past:"%s yn &#244;l",s:"ychydig eiliadau",m:"munud",mm:"%d munud",h:"awr",hh:"%d awr",d:"diwrnod",dd:"%d diwrnod",M:"mis",MM:"%d mis",y:"blwyddyn",yy:"%d flynedd"},ordinal:function(a){var b=a,c="",d=["","af","il","ydd","ydd","ed","ed","ed","fed","fed","fed","eg","fed","eg","eg","fed","eg","eg","fed","eg","fed"];return b>20?c=40===b||50===b||60===b||80===b||100===b?"fed":"ain":b>0&&(c=d[b]),a+c},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("da",{months:"januar_februar_marts_april_maj_juni_juli_august_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"søn_man_tir_ons_tor_fre_lør".split("_"),weekdaysMin:"sø_ma_ti_on_to_fr_lø".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D. MMMM, YYYY LT"},calendar:{sameDay:"[I dag kl.] LT",nextDay:"[I morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[I går kl.] LT",lastWeek:"[sidste] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"%s siden",s:"få sekunder",m:"et minut",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dage",M:"en måned",MM:"%d måneder",y:"et år",yy:"%d år"},ordinal:"%d.",week:{dow:1,doy:4}})
}),function(a){a(bb)}(function(a){function b(a,b,c){var d={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[a+" Tage",a+" Tagen"],M:["ein Monat","einem Monat"],MM:[a+" Monate",a+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[a+" Jahre",a+" Jahren"]};return b?d[c][0]:d[c][1]}return a.lang("de",{months:"Januar_Februar_März_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"H:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:b,mm:"%d Minuten",h:b,hh:"%d Stunden",d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("el",{monthsNominativeEl:"Ιανουάριος_Φεβρουάριος_Μάρτιος_Απρίλιος_Μάιος_Ιούνιος_Ιούλιος_Αύγουστος_Σεπτέμβριος_Οκτώβριος_Νοέμβριος_Δεκέμβριος".split("_"),monthsGenitiveEl:"Ιανουαρίου_Φεβρουαρίου_Μαρτίου_Απριλίου_Μαΐου_Ιουνίου_Ιουλίου_Αυγούστου_Σεπτεμβρίου_Οκτωβρίου_Νοεμβρίου_Δεκεμβρίου".split("_"),months:function(a,b){return/D/.test(b.substring(0,b.indexOf("MMMM")))?this._monthsGenitiveEl[a.month()]:this._monthsNominativeEl[a.month()]},monthsShort:"Ιαν_Φεβ_Μαρ_Απρ_Μαϊ_Ιουν_Ιουλ_Αυγ_Σεπ_Οκτ_Νοε_Δεκ".split("_"),weekdays:"Κυριακή_Δευτέρα_Τρίτη_Τετάρτη_Πέμπτη_Παρασκευή_Σάββατο".split("_"),weekdaysShort:"Κυρ_Δευ_Τρι_Τετ_Πεμ_Παρ_Σαβ".split("_"),weekdaysMin:"Κυ_Δε_Τρ_Τε_Πε_Πα_Σα".split("_"),meridiem:function(a,b,c){return a>11?c?"μμ":"ΜΜ":c?"πμ":"ΠΜ"},longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendarEl:{sameDay:"[Σήμερα {}] LT",nextDay:"[Αύριο {}] LT",nextWeek:"dddd [{}] LT",lastDay:"[Χθες {}] LT",lastWeek:"[την προηγούμενη] dddd [{}] LT",sameElse:"L"},calendar:function(a,b){var c=this._calendarEl[a],d=b&&b.hours();return c.replace("{}",1===d%12?"στη":"στις")},relativeTime:{future:"σε %s",past:"%s πριν",s:"δευτερόλεπτα",m:"ένα λεπτό",mm:"%d λεπτά",h:"μία ώρα",hh:"%d ώρες",d:"μία μέρα",dd:"%d μέρες",M:"ένας μήνας",MM:"%d μήνες",y:"ένας χρόνος",yy:"%d χρόνια"},ordinal:function(a){return a+"η"},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("en-au",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("en-ca",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"YYYY-MM-DD",LL:"D MMMM, YYYY",LLL:"D MMMM, YYYY LT",LLLL:"dddd, D MMMM, YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c}})}),function(a){a(bb)}(function(a){return a.lang("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"th":1===b?"st":2===b?"nd":3===b?"rd":"th";return a+c},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("eo",{months:"januaro_februaro_marto_aprilo_majo_junio_julio_aŭgusto_septembro_oktobro_novembro_decembro".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aŭg_sep_okt_nov_dec".split("_"),weekdays:"Dimanĉo_Lundo_Mardo_Merkredo_Ĵaŭdo_Vendredo_Sabato".split("_"),weekdaysShort:"Dim_Lun_Mard_Merk_Ĵaŭ_Ven_Sab".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Ĵa_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D[-an de] MMMM, YYYY",LLL:"D[-an de] MMMM, YYYY LT",LLLL:"dddd, [la] D[-an de] MMMM, YYYY LT"},meridiem:function(a,b,c){return a>11?c?"p.t.m.":"P.T.M.":c?"a.t.m.":"A.T.M."},calendar:{sameDay:"[Hodiaŭ je] LT",nextDay:"[Morgaŭ je] LT",nextWeek:"dddd [je] LT",lastDay:"[Hieraŭ je] LT",lastWeek:"[pasinta] dddd [je] LT",sameElse:"L"},relativeTime:{future:"je %s",past:"antaŭ %s",s:"sekundoj",m:"minuto",mm:"%d minutoj",h:"horo",hh:"%d horoj",d:"tago",dd:"%d tagoj",M:"monato",MM:"%d monatoj",y:"jaro",yy:"%d jaroj"},ordinal:"%da",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:"ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_Sá".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+(1!==this.hours()?"s":"")+"] LT"},nextDay:function(){return"[mañana a la"+(1!==this.hours()?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+(1!==this.hours()?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+(1!==this.hours()?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+(1!==this.hours()?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a,b,c,d){return d||b?"paari sekundi":"paar sekundit"}return a.lang("et",{months:"jaanuar_veebruar_märts_aprill_mai_juuni_juuli_august_september_oktoober_november_detsember".split("_"),monthsShort:"jaan_veebr_märts_apr_mai_juuni_juuli_aug_sept_okt_nov_dets".split("_"),weekdays:"pühapäev_esmaspäev_teisipäev_kolmapäev_neljapäev_reede_laupäev".split("_"),weekdaysShort:"P_E_T_K_N_R_L".split("_"),weekdaysMin:"P_E_T_K_N_R_L".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Täna,] LT",nextDay:"[Homme,] LT",nextWeek:"[Järgmine] dddd LT",lastDay:"[Eile,] LT",lastWeek:"[Eelmine] dddd LT",sameElse:"L"},relativeTime:{future:"%s pärast",past:"%s tagasi",s:b,m:"minut",mm:"%d minutit",h:"tund",hh:"%d tundi",d:"päev",dd:"%d päeva",M:"kuu",MM:"%d kuud",y:"aasta",yy:"%d aastat"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("eu",{months:"urtarrila_otsaila_martxoa_apirila_maiatza_ekaina_uztaila_abuztua_iraila_urria_azaroa_abendua".split("_"),monthsShort:"urt._ots._mar._api._mai._eka._uzt._abu._ira._urr._aza._abe.".split("_"),weekdays:"igandea_astelehena_asteartea_asteazkena_osteguna_ostirala_larunbata".split("_"),weekdaysShort:"ig._al._ar._az._og._ol._lr.".split("_"),weekdaysMin:"ig_al_ar_az_og_ol_lr".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"YYYY[ko] MMMM[ren] D[a]",LLL:"YYYY[ko] MMMM[ren] D[a] LT",LLLL:"dddd, YYYY[ko] MMMM[ren] D[a] LT",l:"YYYY-M-D",ll:"YYYY[ko] MMM D[a]",lll:"YYYY[ko] MMM D[a] LT",llll:"ddd, YYYY[ko] MMM D[a] LT"},calendar:{sameDay:"[gaur] LT[etan]",nextDay:"[bihar] LT[etan]",nextWeek:"dddd LT[etan]",lastDay:"[atzo] LT[etan]",lastWeek:"[aurreko] dddd LT[etan]",sameElse:"L"},relativeTime:{future:"%s barru",past:"duela %s",s:"segundo batzuk",m:"minutu bat",mm:"%d minutu",h:"ordu bat",hh:"%d ordu",d:"egun bat",dd:"%d egun",M:"hilabete bat",MM:"%d hilabete",y:"urte bat",yy:"%d urte"},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){var b={1:"۱",2:"۲",3:"۳",4:"۴",5:"۵",6:"۶",7:"۷",8:"۸",9:"۹",0:"۰"},c={"۱":"1","۲":"2","۳":"3","۴":"4","۵":"5","۶":"6","۷":"7","۸":"8","۹":"9","۰":"0"};return a.lang("fa",{months:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),monthsShort:"ژانویه_فوریه_مارس_آوریل_مه_ژوئن_ژوئیه_اوت_سپتامبر_اکتبر_نوامبر_دسامبر".split("_"),weekdays:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysShort:"یک‌شنبه_دوشنبه_سه‌شنبه_چهارشنبه_پنج‌شنبه_جمعه_شنبه".split("_"),weekdaysMin:"ی_د_س_چ_پ_ج_ش".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},meridiem:function(a){return 12>a?"قبل از ظهر":"بعد از ظهر"},calendar:{sameDay:"[امروز ساعت] LT",nextDay:"[فردا ساعت] LT",nextWeek:"dddd [ساعت] LT",lastDay:"[دیروز ساعت] LT",lastWeek:"dddd [پیش] [ساعت] LT",sameElse:"L"},relativeTime:{future:"در %s",past:"%s پیش",s:"چندین ثانیه",m:"یک دقیقه",mm:"%d دقیقه",h:"یک ساعت",hh:"%d ساعت",d:"یک روز",dd:"%d روز",M:"یک ماه",MM:"%d ماه",y:"یک سال",yy:"%d سال"},preparse:function(a){return a.replace(/[۰-۹]/g,function(a){return c[a]}).replace(/،/g,",")},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]}).replace(/,/g,"،")},ordinal:"%dم",week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){function b(a,b,d,e){var f="";switch(d){case"s":return e?"muutaman sekunnin":"muutama sekunti";case"m":return e?"minuutin":"minuutti";case"mm":f=e?"minuutin":"minuuttia";break;case"h":return e?"tunnin":"tunti";case"hh":f=e?"tunnin":"tuntia";break;case"d":return e?"päivän":"päivä";case"dd":f=e?"päivän":"päivää";break;case"M":return e?"kuukauden":"kuukausi";case"MM":f=e?"kuukauden":"kuukautta";break;case"y":return e?"vuoden":"vuosi";case"yy":f=e?"vuoden":"vuotta"}return f=c(a,e)+" "+f}function c(a,b){return 10>a?b?e[a]:d[a]:a}var d="nolla yksi kaksi kolme neljä viisi kuusi seitsemän kahdeksan yhdeksän".split(" "),e=["nolla","yhden","kahden","kolmen","neljän","viiden","kuuden",d[7],d[8],d[9]];return a.lang("fi",{months:"tammikuu_helmikuu_maaliskuu_huhtikuu_toukokuu_kesäkuu_heinäkuu_elokuu_syyskuu_lokakuu_marraskuu_joulukuu".split("_"),monthsShort:"tammi_helmi_maalis_huhti_touko_kesä_heinä_elo_syys_loka_marras_joulu".split("_"),weekdays:"sunnuntai_maanantai_tiistai_keskiviikko_torstai_perjantai_lauantai".split("_"),weekdaysShort:"su_ma_ti_ke_to_pe_la".split("_"),weekdaysMin:"su_ma_ti_ke_to_pe_la".split("_"),longDateFormat:{LT:"HH.mm",L:"DD.MM.YYYY",LL:"Do MMMM[ta] YYYY",LLL:"Do MMMM[ta] YYYY, [klo] LT",LLLL:"dddd, Do MMMM[ta] YYYY, [klo] LT",l:"D.M.YYYY",ll:"Do MMM YYYY",lll:"Do MMM YYYY, [klo] LT",llll:"ddd, Do MMM YYYY, [klo] LT"},calendar:{sameDay:"[tänään] [klo] LT",nextDay:"[huomenna] [klo] LT",nextWeek:"dddd [klo] LT",lastDay:"[eilen] [klo] LT",lastWeek:"[viime] dddd[na] [klo] LT",sameElse:"L"},relativeTime:{future:"%s päästä",past:"%s sitten",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("fo",{months:"januar_februar_mars_apríl_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sunnudagur_mánadagur_týsdagur_mikudagur_hósdagur_fríggjadagur_leygardagur".split("_"),weekdaysShort:"sun_mán_týs_mik_hós_frí_ley".split("_"),weekdaysMin:"su_má_tý_mi_hó_fr_le".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D. MMMM, YYYY LT"},calendar:{sameDay:"[Í dag kl.] LT",nextDay:"[Í morgin kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[Í gjár kl.] LT",lastWeek:"[síðstu] dddd [kl] LT",sameElse:"L"},relativeTime:{future:"um %s",past:"%s síðani",s:"fá sekund",m:"ein minutt",mm:"%d minuttir",h:"ein tími",hh:"%d tímar",d:"ein dagur",dd:"%d dagar",M:"ein mánaði",MM:"%d mánaðir",y:"eitt ár",yy:"%d ár"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("fr-ca",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(a){return a+(1===a?"er":"")}})}),function(a){a(bb)}(function(a){return a.lang("fr",{months:"janvier_février_mars_avril_mai_juin_juillet_août_septembre_octobre_novembre_décembre".split("_"),monthsShort:"janv._févr._mars_avr._mai_juin_juil._août_sept._oct._nov._déc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui à] LT",nextDay:"[Demain à] LT",nextWeek:"dddd [à] LT",lastDay:"[Hier à] LT",lastWeek:"dddd [dernier à] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(a){return a+(1===a?"er":"")},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("gl",{months:"Xaneiro_Febreiro_Marzo_Abril_Maio_Xuño_Xullo_Agosto_Setembro_Outubro_Novembro_Decembro".split("_"),monthsShort:"Xan._Feb._Mar._Abr._Mai._Xuñ._Xul._Ago._Set._Out._Nov._Dec.".split("_"),weekdays:"Domingo_Luns_Martes_Mércores_Xoves_Venres_Sábado".split("_"),weekdaysShort:"Dom._Lun._Mar._Mér._Xov._Ven._Sáb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mé_Xo_Ve_Sá".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:function(){return"[hoxe "+(1!==this.hours()?"ás":"á")+"] LT"},nextDay:function(){return"[mañá "+(1!==this.hours()?"ás":"á")+"] LT"},nextWeek:function(){return"dddd ["+(1!==this.hours()?"ás":"a")+"] LT"},lastDay:function(){return"[onte "+(1!==this.hours()?"á":"a")+"] LT"},lastWeek:function(){return"[o] dddd [pasado "+(1!==this.hours()?"ás":"a")+"] LT"},sameElse:"L"},relativeTime:{future:function(a){return"uns segundos"===a?"nuns segundos":"en "+a},past:"hai %s",s:"uns segundos",m:"un minuto",mm:"%d minutos",h:"unha hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un ano",yy:"%d anos"},ordinal:"%dº",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("he",{months:"ינואר_פברואר_מרץ_אפריל_מאי_יוני_יולי_אוגוסט_ספטמבר_אוקטובר_נובמבר_דצמבר".split("_"),monthsShort:"ינו׳_פבר׳_מרץ_אפר׳_מאי_יוני_יולי_אוג׳_ספט׳_אוק׳_נוב׳_דצמ׳".split("_"),weekdays:"ראשון_שני_שלישי_רביעי_חמישי_שישי_שבת".split("_"),weekdaysShort:"א׳_ב׳_ג׳_ד׳_ה׳_ו׳_ש׳".split("_"),weekdaysMin:"א_ב_ג_ד_ה_ו_ש".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [ב]MMMM YYYY",LLL:"D [ב]MMMM YYYY LT",LLLL:"dddd, D [ב]MMMM YYYY LT",l:"D/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY LT",llll:"ddd, D MMM YYYY LT"},calendar:{sameDay:"[היום ב־]LT",nextDay:"[מחר ב־]LT",nextWeek:"dddd [בשעה] LT",lastDay:"[אתמול ב־]LT",lastWeek:"[ביום] dddd [האחרון בשעה] LT",sameElse:"L"},relativeTime:{future:"בעוד %s",past:"לפני %s",s:"מספר שניות",m:"דקה",mm:"%d דקות",h:"שעה",hh:function(a){return 2===a?"שעתיים":a+" שעות"},d:"יום",dd:function(a){return 2===a?"יומיים":a+" ימים"},M:"חודש",MM:function(a){return 2===a?"חודשיים":a+" חודשים"},y:"שנה",yy:function(a){return 2===a?"שנתיים":a+" שנים"}}})}),function(a){a(bb)}(function(a){var b={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},c={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"};return a.lang("hi",{months:"जनवरी_फ़रवरी_मार्च_अप्रैल_मई_जून_जुलाई_अगस्त_सितम्बर_अक्टूबर_नवम्बर_दिसम्बर".split("_"),monthsShort:"जन._फ़र._मार्च_अप्रै._मई_जून_जुल._अग._सित._अक्टू._नव._दिस.".split("_"),weekdays:"रविवार_सोमवार_मंगलवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),weekdaysShort:"रवि_सोम_मंगल_बुध_गुरू_शुक्र_शनि".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),longDateFormat:{LT:"A h:mm बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[आज] LT",nextDay:"[कल] LT",nextWeek:"dddd, LT",lastDay:"[कल] LT",lastWeek:"[पिछले] dddd, LT",sameElse:"L"},relativeTime:{future:"%s में",past:"%s पहले",s:"कुछ ही क्षण",m:"एक मिनट",mm:"%d मिनट",h:"एक घंटा",hh:"%d घंटे",d:"एक दिन",dd:"%d दिन",M:"एक महीने",MM:"%d महीने",y:"एक वर्ष",yy:"%d वर्ष"},preparse:function(a){return a.replace(/[१२३४५६७८९०]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 4>a?"रात":10>a?"सुबह":17>a?"दोपहर":20>a?"शाम":"रात"},week:{dow:0,doy:6}})}),function(a){a(bb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"jedna minuta":"jedne minute";case"mm":return d+=1===a?"minuta":2===a||3===a||4===a?"minute":"minuta";case"h":return b?"jedan sat":"jednog sata";case"hh":return d+=1===a?"sat":2===a||3===a||4===a?"sata":"sati";case"dd":return d+=1===a?"dan":"dana";case"MM":return d+=1===a?"mjesec":2===a||3===a||4===a?"mjeseca":"mjeseci";case"yy":return d+=1===a?"godina":2===a||3===a||4===a?"godine":"godina"}}return a.lang("hr",{months:"sječanj_veljača_ožujak_travanj_svibanj_lipanj_srpanj_kolovoz_rujan_listopad_studeni_prosinac".split("_"),monthsShort:"sje._vel._ožu._tra._svi._lip._srp._kol._ruj._lis._stu._pro.".split("_"),weekdays:"nedjelja_ponedjeljak_utorak_srijeda_četvrtak_petak_subota".split("_"),weekdaysShort:"ned._pon._uto._sri._čet._pet._sub.".split("_"),weekdaysMin:"ne_po_ut_sr_če_pe_su".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danas u] LT",nextDay:"[sutra u] LT",nextWeek:function(){switch(this.day()){case 0:return"[u] [nedjelju] [u] LT";case 3:return"[u] [srijedu] [u] LT";case 6:return"[u] [subotu] [u] LT";case 1:case 2:case 4:case 5:return"[u] dddd [u] LT"}},lastDay:"[jučer u] LT",lastWeek:function(){switch(this.day()){case 0:case 3:return"[prošlu] dddd [u] LT";case 6:return"[prošle] [subote] [u] LT";case 1:case 2:case 4:case 5:return"[prošli] dddd [u] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"prije %s",s:"par sekundi",m:b,mm:b,h:b,hh:b,d:"dan",dd:b,M:"mjesec",MM:b,y:"godinu",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){function b(a,b,c,d){var e=a;switch(c){case"s":return d||b?"néhány másodperc":"néhány másodperce";case"m":return"egy"+(d||b?" perc":" perce");case"mm":return e+(d||b?" perc":" perce");case"h":return"egy"+(d||b?" óra":" órája");case"hh":return e+(d||b?" óra":" órája");case"d":return"egy"+(d||b?" nap":" napja");case"dd":return e+(d||b?" nap":" napja");case"M":return"egy"+(d||b?" hónap":" hónapja");case"MM":return e+(d||b?" hónap":" hónapja");case"y":return"egy"+(d||b?" év":" éve");case"yy":return e+(d||b?" év":" éve")}return""}function c(a){return(a?"":"[múlt] ")+"["+d[this.day()]+"] LT[-kor]"}var d="vasárnap hétfőn kedden szerdán csütörtökön pénteken szombaton".split(" ");return a.lang("hu",{months:"január_február_március_április_május_június_július_augusztus_szeptember_október_november_december".split("_"),monthsShort:"jan_feb_márc_ápr_máj_jún_júl_aug_szept_okt_nov_dec".split("_"),weekdays:"vasárnap_hétfő_kedd_szerda_csütörtök_péntek_szombat".split("_"),weekdaysShort:"vas_hét_kedd_sze_csüt_pén_szo".split("_"),weekdaysMin:"v_h_k_sze_cs_p_szo".split("_"),longDateFormat:{LT:"H:mm",L:"YYYY.MM.DD.",LL:"YYYY. MMMM D.",LLL:"YYYY. MMMM D., LT",LLLL:"YYYY. MMMM D., dddd LT"},calendar:{sameDay:"[ma] LT[-kor]",nextDay:"[holnap] LT[-kor]",nextWeek:function(){return c.call(this,!0)},lastDay:"[tegnap] LT[-kor]",lastWeek:function(){return c.call(this,!1)},sameElse:"L"},relativeTime:{future:"%s múlva",past:"%s",s:b,m:b,mm:b,h:b,hh:b,d:b,dd:b,M:b,MM:b,y:b,yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("id",{months:"Januari_Februari_Maret_April_Mei_Juni_Juli_Agustus_September_Oktober_November_Desember".split("_"),monthsShort:"Jan_Feb_Mar_Apr_Mei_Jun_Jul_Ags_Sep_Okt_Nov_Des".split("_"),weekdays:"Minggu_Senin_Selasa_Rabu_Kamis_Jumat_Sabtu".split("_"),weekdaysShort:"Min_Sen_Sel_Rab_Kam_Jum_Sab".split("_"),weekdaysMin:"Mg_Sn_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] LT",LLLL:"dddd, D MMMM YYYY [pukul] LT"},meridiem:function(a){return 11>a?"pagi":15>a?"siang":19>a?"sore":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Besok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kemarin pukul] LT",lastWeek:"dddd [lalu pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lalu",s:"beberapa detik",m:"semenit",mm:"%d menit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){function b(a){return 11===a%100?!0:1===a%10?!1:!0}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"nokkrar sekúndur":"nokkrum sekúndum";case"m":return c?"mínúta":"mínútu";case"mm":return b(a)?f+(c||e?"mínútur":"mínútum"):c?f+"mínúta":f+"mínútu";case"hh":return b(a)?f+(c||e?"klukkustundir":"klukkustundum"):f+"klukkustund";case"d":return c?"dagur":e?"dag":"degi";case"dd":return b(a)?c?f+"dagar":f+(e?"daga":"dögum"):c?f+"dagur":f+(e?"dag":"degi");case"M":return c?"mánuður":e?"mánuð":"mánuði";case"MM":return b(a)?c?f+"mánuðir":f+(e?"mánuði":"mánuðum"):c?f+"mánuður":f+(e?"mánuð":"mánuði");case"y":return c||e?"ár":"ári";case"yy":return b(a)?f+(c||e?"ár":"árum"):f+(c||e?"ár":"ári")}}return a.lang("is",{months:"janúar_febrúar_mars_apríl_maí_júní_júlí_ágúst_september_október_nóvember_desember".split("_"),monthsShort:"jan_feb_mar_apr_maí_jún_júl_ágú_sep_okt_nóv_des".split("_"),weekdays:"sunnudagur_mánudagur_þriðjudagur_miðvikudagur_fimmtudagur_föstudagur_laugardagur".split("_"),weekdaysShort:"sun_mán_þri_mið_fim_fös_lau".split("_"),weekdaysMin:"Su_Má_Þr_Mi_Fi_Fö_La".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] LT",LLLL:"dddd, D. MMMM YYYY [kl.] LT"},calendar:{sameDay:"[í dag kl.] LT",nextDay:"[á morgun kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[í gær kl.] LT",lastWeek:"[síðasta] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"eftir %s",past:"fyrir %s síðan",s:c,m:c,mm:c,h:"klukkustund",hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("it",{months:"Gennaio_Febbraio_Marzo_Aprile_Maggio_Giugno_Luglio_Agosto_Settembre_Ottobre_Novembre_Dicembre".split("_"),monthsShort:"Gen_Feb_Mar_Apr_Mag_Giu_Lug_Ago_Set_Ott_Nov_Dic".split("_"),weekdays:"Domenica_Lunedì_Martedì_Mercoledì_Giovedì_Venerdì_Sabato".split("_"),weekdaysShort:"Dom_Lun_Mar_Mer_Gio_Ven_Sab".split("_"),weekdaysMin:"D_L_Ma_Me_G_V_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Oggi alle] LT",nextDay:"[Domani alle] LT",nextWeek:"dddd [alle] LT",lastDay:"[Ieri alle] LT",lastWeek:"[lo scorso] dddd [alle] LT",sameElse:"L"},relativeTime:{future:function(a){return(/^[0-9].+$/.test(a)?"tra":"in")+" "+a},past:"%s fa",s:"secondi",m:"un minuto",mm:"%d minuti",h:"un'ora",hh:"%d ore",d:"un giorno",dd:"%d giorni",M:"un mese",MM:"%d mesi",y:"un anno",yy:"%d anni"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("ja",{months:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"日曜日_月曜日_火曜日_水曜日_木曜日_金曜日_土曜日".split("_"),weekdaysShort:"日_月_火_水_木_金_土".split("_"),weekdaysMin:"日_月_火_水_木_金_土".split("_"),longDateFormat:{LT:"Ah時m分",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日LT",LLLL:"YYYY年M月D日LT dddd"},meridiem:function(a){return 12>a?"午前":"午後"},calendar:{sameDay:"[今日] LT",nextDay:"[明日] LT",nextWeek:"[来週]dddd LT",lastDay:"[昨日] LT",lastWeek:"[前週]dddd LT",sameElse:"L"},relativeTime:{future:"%s後",past:"%s前",s:"数秒",m:"1分",mm:"%d分",h:"1時間",hh:"%d時間",d:"1日",dd:"%d日",M:"1ヶ月",MM:"%dヶ月",y:"1年",yy:"%d年"}})}),function(a){a(bb)}(function(a){function b(a,b){var c={nominative:"იანვარი_თებერვალი_მარტი_აპრილი_მაისი_ივნისი_ივლისი_აგვისტო_სექტემბერი_ოქტომბერი_ნოემბერი_დეკემბერი".split("_"),accusative:"იანვარს_თებერვალს_მარტს_აპრილის_მაისს_ივნისს_ივლისს_აგვისტს_სექტემბერს_ოქტომბერს_ნოემბერს_დეკემბერს".split("_")},d=/D[oD] *MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function c(a,b){var c={nominative:"კვირა_ორშაბათი_სამშაბათი_ოთხშაბათი_ხუთშაბათი_პარასკევი_შაბათი".split("_"),accusative:"კვირას_ორშაბათს_სამშაბათს_ოთხშაბათს_ხუთშაბათს_პარასკევს_შაბათს".split("_")},d=/(წინა|შემდეგ)/.test(b)?"accusative":"nominative";return c[d][a.day()]}return a.lang("ka",{months:b,monthsShort:"იან_თებ_მარ_აპრ_მაი_ივნ_ივლ_აგვ_სექ_ოქტ_ნოე_დეკ".split("_"),weekdays:c,weekdaysShort:"კვი_ორშ_სამ_ოთხ_ხუთ_პარ_შაბ".split("_"),weekdaysMin:"კვ_ორ_სა_ოთ_ხუ_პა_შა".split("_"),longDateFormat:{LT:"h:mm A",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[დღეს] LT[-ზე]",nextDay:"[ხვალ] LT[-ზე]",lastDay:"[გუშინ] LT[-ზე]",nextWeek:"[შემდეგ] dddd LT[-ზე]",lastWeek:"[წინა] dddd LT-ზე",sameElse:"L"},relativeTime:{future:function(a){return/(წამი|წუთი|საათი|წელი)/.test(a)?a.replace(/ი$/,"ში"):a+"ში"},past:function(a){return/(წამი|წუთი|საათი|დღე|თვე)/.test(a)?a.replace(/(ი|ე)$/,"ის წინ"):/წელი/.test(a)?a.replace(/წელი$/,"წლის წინ"):void 0},s:"რამდენიმე წამი",m:"წუთი",mm:"%d წუთი",h:"საათი",hh:"%d საათი",d:"დღე",dd:"%d დღე",M:"თვე",MM:"%d თვე",y:"წელი",yy:"%d წელი"},ordinal:function(a){return 0===a?a:1===a?a+"-ლი":20>a||100>=a&&0===a%20||0===a%100?"მე-"+a:a+"-ე"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("ko",{months:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),monthsShort:"1월_2월_3월_4월_5월_6월_7월_8월_9월_10월_11월_12월".split("_"),weekdays:"일요일_월요일_화요일_수요일_목요일_금요일_토요일".split("_"),weekdaysShort:"일_월_화_수_목_금_토".split("_"),weekdaysMin:"일_월_화_수_목_금_토".split("_"),longDateFormat:{LT:"A h시 mm분",L:"YYYY.MM.DD",LL:"YYYY년 MMMM D일",LLL:"YYYY년 MMMM D일 LT",LLLL:"YYYY년 MMMM D일 dddd LT"},meridiem:function(a){return 12>a?"오전":"오후"},calendar:{sameDay:"오늘 LT",nextDay:"내일 LT",nextWeek:"dddd LT",lastDay:"어제 LT",lastWeek:"지난주 dddd LT",sameElse:"L"},relativeTime:{future:"%s 후",past:"%s 전",s:"몇초",ss:"%d초",m:"일분",mm:"%d분",h:"한시간",hh:"%d시간",d:"하루",dd:"%d일",M:"한달",MM:"%d달",y:"일년",yy:"%d년"},ordinal:"%d일"})}),function(a){a(bb)}(function(a){function b(a,b,c,d){return b?"kelios sekundės":d?"kelių sekundžių":"kelias sekundes"}function c(a,b,c,d){return b?e(c)[0]:d?e(c)[1]:e(c)[2]}function d(a){return 0===a%10||a>10&&20>a}function e(a){return h[a].split("_")}function f(a,b,f,g){var h=a+" ";return 1===a?h+c(a,b,f[0],g):b?h+(d(a)?e(f)[1]:e(f)[0]):g?h+e(f)[1]:h+(d(a)?e(f)[1]:e(f)[2])}function g(a,b){var c=-1===b.indexOf("dddd LT"),d=i[a.weekday()];return c?d:d.substring(0,d.length-2)+"į"}var h={m:"minutė_minutės_minutę",mm:"minutės_minučių_minutes",h:"valanda_valandos_valandą",hh:"valandos_valandų_valandas",d:"diena_dienos_dieną",dd:"dienos_dienų_dienas",M:"mėnuo_mėnesio_mėnesį",MM:"mėnesiai_mėnesių_mėnesius",y:"metai_metų_metus",yy:"metai_metų_metus"},i="pirmadienis_antradienis_trečiadienis_ketvirtadienis_penktadienis_šeštadienis_sekmadienis".split("_");return a.lang("lt",{months:"sausio_vasario_kovo_balandžio_gegužės_biržėlio_liepos_rugpjūčio_rugsėjo_spalio_lapkričio_gruodžio".split("_"),monthsShort:"sau_vas_kov_bal_geg_bir_lie_rgp_rgs_spa_lap_grd".split("_"),weekdays:g,weekdaysShort:"Sek_Pir_Ant_Tre_Ket_Pen_Šeš".split("_"),weekdaysMin:"S_P_A_T_K_Pn_Š".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"YYYY [m.] MMMM D [d.]",LLL:"YYYY [m.] MMMM D [d.], LT [val.]",LLLL:"YYYY [m.] MMMM D [d.], dddd, LT [val.]",l:"YYYY-MM-DD",ll:"YYYY [m.] MMMM D [d.]",lll:"YYYY [m.] MMMM D [d.], LT [val.]",llll:"YYYY [m.] MMMM D [d.], ddd, LT [val.]"},calendar:{sameDay:"[Šiandien] LT",nextDay:"[Rytoj] LT",nextWeek:"dddd LT",lastDay:"[Vakar] LT",lastWeek:"[Praėjusį] dddd LT",sameElse:"L"},relativeTime:{future:"po %s",past:"prieš %s",s:b,m:c,mm:f,h:c,hh:f,d:c,dd:f,M:c,MM:f,y:c,yy:f},ordinal:function(a){return a+"-oji"},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a,b,c){var d=a.split("_");return c?1===b%10&&11!==b?d[2]:d[3]:1===b%10&&11!==b?d[0]:d[1]}function c(a,c,e){return a+" "+b(d[e],a,c)}var d={mm:"minūti_minūtes_minūte_minūtes",hh:"stundu_stundas_stunda_stundas",dd:"dienu_dienas_diena_dienas",MM:"mēnesi_mēnešus_mēnesis_mēneši",yy:"gadu_gadus_gads_gadi"};return a.lang("lv",{months:"janvāris_februāris_marts_aprīlis_maijs_jūnijs_jūlijs_augusts_septembris_oktobris_novembris_decembris".split("_"),monthsShort:"jan_feb_mar_apr_mai_jūn_jūl_aug_sep_okt_nov_dec".split("_"),weekdays:"svētdiena_pirmdiena_otrdiena_trešdiena_ceturtdiena_piektdiena_sestdiena".split("_"),weekdaysShort:"Sv_P_O_T_C_Pk_S".split("_"),weekdaysMin:"Sv_P_O_T_C_Pk_S".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"YYYY. [gada] D. MMMM",LLL:"YYYY. [gada] D. MMMM, LT",LLLL:"YYYY. [gada] D. MMMM, dddd, LT"},calendar:{sameDay:"[Šodien pulksten] LT",nextDay:"[Rīt pulksten] LT",nextWeek:"dddd [pulksten] LT",lastDay:"[Vakar pulksten] LT",lastWeek:"[Pagājušā] dddd [pulksten] LT",sameElse:"L"},relativeTime:{future:"%s vēlāk",past:"%s agrāk",s:"dažas sekundes",m:"minūti",mm:c,h:"stundu",hh:c,d:"dienu",dd:c,M:"mēnesi",MM:c,y:"gadu",yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("ml",{months:"ജനുവരി_ഫെബ്രുവരി_മാർച്ച്_ഏപ്രിൽ_മേയ്_ജൂൺ_ജൂലൈ_ഓഗസ്റ്റ്_സെപ്റ്റംബർ_ഒക്ടോബർ_നവംബർ_ഡിസംബർ".split("_"),monthsShort:"ജനു._ഫെബ്രു._മാർ._ഏപ്രി._മേയ്_ജൂൺ_ജൂലൈ._ഓഗ._സെപ്റ്റ._ഒക്ടോ._നവം._ഡിസം.".split("_"),weekdays:"ഞായറാഴ്ച_തിങ്കളാഴ്ച_ചൊവ്വാഴ്ച_ബുധനാഴ്ച_വ്യാഴാഴ്ച_വെള്ളിയാഴ്ച_ശനിയാഴ്ച".split("_"),weekdaysShort:"ഞായർ_തിങ്കൾ_ചൊവ്വ_ബുധൻ_വ്യാഴം_വെള്ളി_ശനി".split("_"),weekdaysMin:"ഞാ_തി_ചൊ_ബു_വ്യാ_വെ_ശ".split("_"),longDateFormat:{LT:"A h:mm -നു",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[ഇന്ന്] LT",nextDay:"[നാളെ] LT",nextWeek:"dddd, LT",lastDay:"[ഇന്നലെ] LT",lastWeek:"[കഴിഞ്ഞ] dddd, LT",sameElse:"L"},relativeTime:{future:"%s കഴിഞ്ഞ്",past:"%s മുൻപ്",s:"അൽപ നിമിഷങ്ങൾ",m:"ഒരു മിനിറ്റ്",mm:"%d മിനിറ്റ്",h:"ഒരു മണിക്കൂർ",hh:"%d മണിക്കൂർ",d:"ഒരു ദിവസം",dd:"%d ദിവസം",M:"ഒരു മാസം",MM:"%d മാസം",y:"ഒരു വർഷം",yy:"%d വർഷം"},meridiem:function(a){return 4>a?"രാത്രി":12>a?"രാവിലെ":17>a?"ഉച്ച കഴിഞ്ഞ്":20>a?"വൈകുന്നേരം":"രാത്രി"
}})}),function(a){a(bb)}(function(a){var b={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},c={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"};return a.lang("mr",{months:"जानेवारी_फेब्रुवारी_मार्च_एप्रिल_मे_जून_जुलै_ऑगस्ट_सप्टेंबर_ऑक्टोबर_नोव्हेंबर_डिसेंबर".split("_"),monthsShort:"जाने._फेब्रु._मार्च._एप्रि._मे._जून._जुलै._ऑग._सप्टें._ऑक्टो._नोव्हें._डिसें.".split("_"),weekdays:"रविवार_सोमवार_मंगळवार_बुधवार_गुरूवार_शुक्रवार_शनिवार".split("_"),weekdaysShort:"रवि_सोम_मंगळ_बुध_गुरू_शुक्र_शनि".split("_"),weekdaysMin:"र_सो_मं_बु_गु_शु_श".split("_"),longDateFormat:{LT:"A h:mm वाजता",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},calendar:{sameDay:"[आज] LT",nextDay:"[उद्या] LT",nextWeek:"dddd, LT",lastDay:"[काल] LT",lastWeek:"[मागील] dddd, LT",sameElse:"L"},relativeTime:{future:"%s नंतर",past:"%s पूर्वी",s:"सेकंद",m:"एक मिनिट",mm:"%d मिनिटे",h:"एक तास",hh:"%d तास",d:"एक दिवस",dd:"%d दिवस",M:"एक महिना",MM:"%d महिने",y:"एक वर्ष",yy:"%d वर्षे"},preparse:function(a){return a.replace(/[१२३४५६७८९०]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 4>a?"रात्री":10>a?"सकाळी":17>a?"दुपारी":20>a?"सायंकाळी":"रात्री"},week:{dow:0,doy:6}})}),function(a){a(bb)}(function(a){return a.lang("ms-my",{months:"Januari_Februari_Mac_April_Mei_Jun_Julai_Ogos_September_Oktober_November_Disember".split("_"),monthsShort:"Jan_Feb_Mac_Apr_Mei_Jun_Jul_Ogs_Sep_Okt_Nov_Dis".split("_"),weekdays:"Ahad_Isnin_Selasa_Rabu_Khamis_Jumaat_Sabtu".split("_"),weekdaysShort:"Ahd_Isn_Sel_Rab_Kha_Jum_Sab".split("_"),weekdaysMin:"Ah_Is_Sl_Rb_Km_Jm_Sb".split("_"),longDateFormat:{LT:"HH.mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY [pukul] LT",LLLL:"dddd, D MMMM YYYY [pukul] LT"},meridiem:function(a){return 11>a?"pagi":15>a?"tengahari":19>a?"petang":"malam"},calendar:{sameDay:"[Hari ini pukul] LT",nextDay:"[Esok pukul] LT",nextWeek:"dddd [pukul] LT",lastDay:"[Kelmarin pukul] LT",lastWeek:"dddd [lepas pukul] LT",sameElse:"L"},relativeTime:{future:"dalam %s",past:"%s yang lepas",s:"beberapa saat",m:"seminit",mm:"%d minit",h:"sejam",hh:"%d jam",d:"sehari",dd:"%d hari",M:"sebulan",MM:"%d bulan",y:"setahun",yy:"%d tahun"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("nb",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan._feb._mars_april_mai_juni_juli_aug._sep._okt._nov._des.".split("_"),weekdays:"søndag_mandag_tirsdag_onsdag_torsdag_fredag_lørdag".split("_"),weekdaysShort:"sø._ma._ti._on._to._fr._lø.".split("_"),weekdaysMin:"sø_ma_ti_on_to_fr_lø".split("_"),longDateFormat:{LT:"H.mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY [kl.] LT",LLLL:"dddd D. MMMM YYYY [kl.] LT"},calendar:{sameDay:"[i dag kl.] LT",nextDay:"[i morgen kl.] LT",nextWeek:"dddd [kl.] LT",lastDay:"[i går kl.] LT",lastWeek:"[forrige] dddd [kl.] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s siden",s:"noen sekunder",m:"ett minutt",mm:"%d minutter",h:"en time",hh:"%d timer",d:"en dag",dd:"%d dager",M:"en måned",MM:"%d måneder",y:"ett år",yy:"%d år"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){var b={1:"१",2:"२",3:"३",4:"४",5:"५",6:"६",7:"७",8:"८",9:"९",0:"०"},c={"१":"1","२":"2","३":"3","४":"4","५":"5","६":"6","७":"7","८":"8","९":"9","०":"0"};return a.lang("ne",{months:"जनवरी_फेब्रुवरी_मार्च_अप्रिल_मई_जुन_जुलाई_अगष्ट_सेप्टेम्बर_अक्टोबर_नोभेम्बर_डिसेम्बर".split("_"),monthsShort:"जन._फेब्रु._मार्च_अप्रि._मई_जुन_जुलाई._अग._सेप्ट._अक्टो._नोभे._डिसे.".split("_"),weekdays:"आइतबार_सोमबार_मङ्गलबार_बुधबार_बिहिबार_शुक्रबार_शनिबार".split("_"),weekdaysShort:"आइत._सोम._मङ्गल._बुध._बिहि._शुक्र._शनि.".split("_"),weekdaysMin:"आइ._सो._मङ्_बु._बि._शु._श.".split("_"),longDateFormat:{LT:"Aको h:mm बजे",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY, LT",LLLL:"dddd, D MMMM YYYY, LT"},preparse:function(a){return a.replace(/[१२३४५६७८९०]/g,function(a){return c[a]})},postformat:function(a){return a.replace(/\d/g,function(a){return b[a]})},meridiem:function(a){return 3>a?"राती":10>a?"बिहान":15>a?"दिउँसो":18>a?"बेलुका":20>a?"साँझ":"राती"},calendar:{sameDay:"[आज] LT",nextDay:"[भोली] LT",nextWeek:"[आउँदो] dddd[,] LT",lastDay:"[हिजो] LT",lastWeek:"[गएको] dddd[,] LT",sameElse:"L"},relativeTime:{future:"%sमा",past:"%s अगाडी",s:"केही समय",m:"एक मिनेट",mm:"%d मिनेट",h:"एक घण्टा",hh:"%d घण्टा",d:"एक दिन",dd:"%d दिन",M:"एक महिना",MM:"%d महिना",y:"एक बर्ष",yy:"%d बर्ष"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){var b="jan._feb._mrt._apr._mei_jun._jul._aug._sep._okt._nov._dec.".split("_"),c="jan_feb_mrt_apr_mei_jun_jul_aug_sep_okt_nov_dec".split("_");return a.lang("nl",{months:"januari_februari_maart_april_mei_juni_juli_augustus_september_oktober_november_december".split("_"),monthsShort:function(a,d){return/-MMM-/.test(d)?c[a.month()]:b[a.month()]},weekdays:"zondag_maandag_dinsdag_woensdag_donderdag_vrijdag_zaterdag".split("_"),weekdaysShort:"zo._ma._di._wo._do._vr._za.".split("_"),weekdaysMin:"Zo_Ma_Di_Wo_Do_Vr_Za".split("_"),longDateFormat:{LT:"HH:mm",L:"DD-MM-YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[vandaag om] LT",nextDay:"[morgen om] LT",nextWeek:"dddd [om] LT",lastDay:"[gisteren om] LT",lastWeek:"[afgelopen] dddd [om] LT",sameElse:"L"},relativeTime:{future:"over %s",past:"%s geleden",s:"een paar seconden",m:"één minuut",mm:"%d minuten",h:"één uur",hh:"%d uur",d:"één dag",dd:"%d dagen",M:"één maand",MM:"%d maanden",y:"één jaar",yy:"%d jaar"},ordinal:function(a){return a+(1===a||8===a||a>=20?"ste":"de")},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("nn",{months:"januar_februar_mars_april_mai_juni_juli_august_september_oktober_november_desember".split("_"),monthsShort:"jan_feb_mar_apr_mai_jun_jul_aug_sep_okt_nov_des".split("_"),weekdays:"sundag_måndag_tysdag_onsdag_torsdag_fredag_laurdag".split("_"),weekdaysShort:"sun_mån_tys_ons_tor_fre_lau".split("_"),weekdaysMin:"su_må_ty_on_to_fr_lø".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[I dag klokka] LT",nextDay:"[I morgon klokka] LT",nextWeek:"dddd [klokka] LT",lastDay:"[I går klokka] LT",lastWeek:"[Føregående] dddd [klokka] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"for %s siden",s:"noen sekund",m:"ett minutt",mm:"%d minutt",h:"en time",hh:"%d timar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a){return 5>a%10&&a%10>1&&1!==~~(a/10)}function c(a,c,d){var e=a+" ";switch(d){case"m":return c?"minuta":"minutę";case"mm":return e+(b(a)?"minuty":"minut");case"h":return c?"godzina":"godzinę";case"hh":return e+(b(a)?"godziny":"godzin");case"MM":return e+(b(a)?"miesiące":"miesięcy");case"yy":return e+(b(a)?"lata":"lat")}}var d="styczeń_luty_marzec_kwiecień_maj_czerwiec_lipiec_sierpień_wrzesień_październik_listopad_grudzień".split("_"),e="stycznia_lutego_marca_kwietnia_maja_czerwca_lipca_sierpnia_września_października_listopada_grudnia".split("_");return a.lang("pl",{months:function(a,b){return/D MMMM/.test(b)?e[a.month()]:d[a.month()]},monthsShort:"sty_lut_mar_kwi_maj_cze_lip_sie_wrz_paź_lis_gru".split("_"),weekdays:"niedziela_poniedziałek_wtorek_środa_czwartek_piątek_sobota".split("_"),weekdaysShort:"nie_pon_wt_śr_czw_pt_sb".split("_"),weekdaysMin:"N_Pn_Wt_Śr_Cz_Pt_So".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Dziś o] LT",nextDay:"[Jutro o] LT",nextWeek:"[W] dddd [o] LT",lastDay:"[Wczoraj o] LT",lastWeek:function(){switch(this.day()){case 0:return"[W zeszłą niedzielę o] LT";case 3:return"[W zeszłą środę o] LT";case 6:return"[W zeszłą sobotę o] LT";default:return"[W zeszły] dddd [o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"%s temu",s:"kilka sekund",m:c,mm:c,h:c,hh:c,d:"1 dzień",dd:"%d dni",M:"miesiąc",MM:c,y:"rok",yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("pt-br",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Terça-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%dº"})}),function(a){a(bb)}(function(a){return a.lang("pt",{months:"Janeiro_Fevereiro_Março_Abril_Maio_Junho_Julho_Agosto_Setembro_Outubro_Novembro_Dezembro".split("_"),monthsShort:"Jan_Fev_Mar_Abr_Mai_Jun_Jul_Ago_Set_Out_Nov_Dez".split("_"),weekdays:"Domingo_Segunda-feira_Terça-feira_Quarta-feira_Quinta-feira_Sexta-feira_Sábado".split("_"),weekdaysShort:"Dom_Seg_Ter_Qua_Qui_Sex_Sáb".split("_"),weekdaysMin:"Dom_2ª_3ª_4ª_5ª_6ª_Sáb".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:"[Hoje às] LT",nextDay:"[Amanhã às] LT",nextWeek:"dddd [às] LT",lastDay:"[Ontem às] LT",lastWeek:function(){return 0===this.day()||6===this.day()?"[Último] dddd [às] LT":"[Última] dddd [às] LT"},sameElse:"L"},relativeTime:{future:"em %s",past:"%s atrás",s:"segundos",m:"um minuto",mm:"%d minutos",h:"uma hora",hh:"%d horas",d:"um dia",dd:"%d dias",M:"um mês",MM:"%d meses",y:"um ano",yy:"%d anos"},ordinal:"%dº",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("ro",{months:"Ianuarie_Februarie_Martie_Aprilie_Mai_Iunie_Iulie_August_Septembrie_Octombrie_Noiembrie_Decembrie".split("_"),monthsShort:"Ian_Feb_Mar_Apr_Mai_Iun_Iul_Aug_Sep_Oct_Noi_Dec".split("_"),weekdays:"Duminică_Luni_Marţi_Miercuri_Joi_Vineri_Sâmbătă".split("_"),weekdaysShort:"Dum_Lun_Mar_Mie_Joi_Vin_Sâm".split("_"),weekdaysMin:"Du_Lu_Ma_Mi_Jo_Vi_Sâ".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY H:mm",LLLL:"dddd, D MMMM YYYY H:mm"},calendar:{sameDay:"[azi la] LT",nextDay:"[mâine la] LT",nextWeek:"dddd [la] LT",lastDay:"[ieri la] LT",lastWeek:"[fosta] dddd [la] LT",sameElse:"L"},relativeTime:{future:"peste %s",past:"%s în urmă",s:"câteva secunde",m:"un minut",mm:"%d minute",h:"o oră",hh:"%d ore",d:"o zi",dd:"%d zile",M:"o lună",MM:"%d luni",y:"un an",yy:"%d ani"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){function b(a,b){var c=a.split("_");return 1===b%10&&11!==b%100?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function c(a,c,d){var e={mm:"минута_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"};return"m"===d?c?"минута":"минуту":a+" "+b(e[d],+a)}function d(a,b){var c={nominative:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),accusative:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")},d=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function e(a,b){var c={nominative:"янв_фев_мар_апр_май_июнь_июль_авг_сен_окт_ноя_дек".split("_"),accusative:"янв_фев_мар_апр_мая_июня_июля_авг_сен_окт_ноя_дек".split("_")},d=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function f(a,b){var c={nominative:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),accusative:"воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")},d=/\[ ?[Вв] ?(?:прошлую|следующую)? ?\] ?dddd/.test(b)?"accusative":"nominative";return c[d][a.day()]}return a.lang("ru",{months:d,monthsShort:e,weekdays:f,weekdaysShort:"вс_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),monthsParse:[/^янв/i,/^фев/i,/^мар/i,/^апр/i,/^ма[й|я]/i,/^июн/i,/^июл/i,/^авг/i,/^сен/i,/^окт/i,/^ноя/i,/^дек/i],longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., LT",LLLL:"dddd, D MMMM YYYY г., LT"},calendar:{sameDay:"[Сегодня в] LT",nextDay:"[Завтра в] LT",lastDay:"[Вчера в] LT",nextWeek:function(){return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT"},lastWeek:function(){switch(this.day()){case 0:return"[В прошлое] dddd [в] LT";case 1:case 2:case 4:return"[В прошлый] dddd [в] LT";case 3:case 5:case 6:return"[В прошлую] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:c,mm:c,h:"час",hh:c,d:"день",dd:c,M:"месяц",MM:c,y:"год",yy:c},meridiem:function(a){return 4>a?"ночи":12>a?"утра":17>a?"дня":"вечера"},ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":return a+"-й";case"D":return a+"-го";case"w":case"W":return a+"-я";default:return a}},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){function b(a){return a>1&&5>a}function c(a,c,d,e){var f=a+" ";switch(d){case"s":return c||e?"pár sekúnd":"pár sekundami";case"m":return c?"minúta":e?"minútu":"minútou";case"mm":return c||e?f+(b(a)?"minúty":"minút"):f+"minútami";case"h":return c?"hodina":e?"hodinu":"hodinou";case"hh":return c||e?f+(b(a)?"hodiny":"hodín"):f+"hodinami";case"d":return c||e?"deň":"dňom";case"dd":return c||e?f+(b(a)?"dni":"dní"):f+"dňami";case"M":return c||e?"mesiac":"mesiacom";case"MM":return c||e?f+(b(a)?"mesiace":"mesiacov"):f+"mesiacmi";case"y":return c||e?"rok":"rokom";case"yy":return c||e?f+(b(a)?"roky":"rokov"):f+"rokmi"}}var d="január_február_marec_apríl_máj_jún_júl_august_september_október_november_december".split("_"),e="jan_feb_mar_apr_máj_jún_júl_aug_sep_okt_nov_dec".split("_");return a.lang("sk",{months:d,monthsShort:e,monthsParse:function(a,b){var c,d=[];for(c=0;12>c;c++)d[c]=new RegExp("^"+a[c]+"$|^"+b[c]+"$","i");return d}(d,e),weekdays:"nedeľa_pondelok_utorok_streda_štvrtok_piatok_sobota".split("_"),weekdaysShort:"ne_po_ut_st_št_pi_so".split("_"),weekdaysMin:"ne_po_ut_st_št_pi_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd D. MMMM YYYY LT"},calendar:{sameDay:"[dnes o] LT",nextDay:"[zajtra o] LT",nextWeek:function(){switch(this.day()){case 0:return"[v nedeľu o] LT";case 1:case 2:return"[v] dddd [o] LT";case 3:return"[v stredu o] LT";case 4:return"[vo štvrtok o] LT";case 5:return"[v piatok o] LT";case 6:return"[v sobotu o] LT"}},lastDay:"[včera o] LT",lastWeek:function(){switch(this.day()){case 0:return"[minulú nedeľu o] LT";case 1:case 2:return"[minulý] dddd [o] LT";case 3:return"[minulú stredu o] LT";case 4:case 5:return"[minulý] dddd [o] LT";case 6:return"[minulú sobotu o] LT"}},sameElse:"L"},relativeTime:{future:"za %s",past:"pred %s",s:c,m:c,mm:c,h:c,hh:c,d:c,dd:c,M:c,MM:c,y:c,yy:c},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){function b(a,b,c){var d=a+" ";switch(c){case"m":return b?"ena minuta":"eno minuto";case"mm":return d+=1===a?"minuta":2===a?"minuti":3===a||4===a?"minute":"minut";case"h":return b?"ena ura":"eno uro";case"hh":return d+=1===a?"ura":2===a?"uri":3===a||4===a?"ure":"ur";case"dd":return d+=1===a?"dan":"dni";case"MM":return d+=1===a?"mesec":2===a?"meseca":3===a||4===a?"mesece":"mesecev";case"yy":return d+=1===a?"leto":2===a?"leti":3===a||4===a?"leta":"let"}}return a.lang("sl",{months:"januar_februar_marec_april_maj_junij_julij_avgust_september_oktober_november_december".split("_"),monthsShort:"jan._feb._mar._apr._maj._jun._jul._avg._sep._okt._nov._dec.".split("_"),weekdays:"nedelja_ponedeljek_torek_sreda_četrtek_petek_sobota".split("_"),weekdaysShort:"ned._pon._tor._sre._čet._pet._sob.".split("_"),weekdaysMin:"ne_po_to_sr_če_pe_so".split("_"),longDateFormat:{LT:"H:mm",L:"DD. MM. YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[danes ob] LT",nextDay:"[jutri ob] LT",nextWeek:function(){switch(this.day()){case 0:return"[v] [nedeljo] [ob] LT";case 3:return"[v] [sredo] [ob] LT";case 6:return"[v] [soboto] [ob] LT";case 1:case 2:case 4:case 5:return"[v] dddd [ob] LT"}},lastDay:"[včeraj ob] LT",lastWeek:function(){switch(this.day()){case 0:case 3:case 6:return"[prejšnja] dddd [ob] LT";case 1:case 2:case 4:case 5:return"[prejšnji] dddd [ob] LT"}},sameElse:"L"},relativeTime:{future:"čez %s",past:"%s nazaj",s:"nekaj sekund",m:b,mm:b,h:b,hh:b,d:"en dan",dd:b,M:"en mesec",MM:b,y:"eno leto",yy:b},ordinal:"%d.",week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("sq",{months:"Janar_Shkurt_Mars_Prill_Maj_Qershor_Korrik_Gusht_Shtator_Tetor_Nëntor_Dhjetor".split("_"),monthsShort:"Jan_Shk_Mar_Pri_Maj_Qer_Kor_Gus_Sht_Tet_Nën_Dhj".split("_"),weekdays:"E Diel_E Hënë_E Marte_E Mërkure_E Enjte_E Premte_E Shtunë".split("_"),weekdaysShort:"Die_Hën_Mar_Mër_Enj_Pre_Sht".split("_"),weekdaysMin:"D_H_Ma_Më_E_P_Sh".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Sot në] LT",nextDay:"[Neser në] LT",nextWeek:"dddd [në] LT",lastDay:"[Dje në] LT",lastWeek:"dddd [e kaluar në] LT",sameElse:"L"},relativeTime:{future:"në %s",past:"%s me parë",s:"disa seconda",m:"një minut",mm:"%d minutea",h:"një orë",hh:"%d orë",d:"një ditë",dd:"%d ditë",M:"një muaj",MM:"%d muaj",y:"një vit",yy:"%d vite"},ordinal:"%d.",week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("sv",{months:"januari_februari_mars_april_maj_juni_juli_augusti_september_oktober_november_december".split("_"),monthsShort:"jan_feb_mar_apr_maj_jun_jul_aug_sep_okt_nov_dec".split("_"),weekdays:"söndag_måndag_tisdag_onsdag_torsdag_fredag_lördag".split("_"),weekdaysShort:"sön_mån_tis_ons_tor_fre_lör".split("_"),weekdaysMin:"sö_må_ti_on_to_fr_lö".split("_"),longDateFormat:{LT:"HH:mm",L:"YYYY-MM-DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Idag] LT",nextDay:"[Imorgon] LT",lastDay:"[Igår] LT",nextWeek:"dddd LT",lastWeek:"[Förra] dddd[en] LT",sameElse:"L"},relativeTime:{future:"om %s",past:"för %s sedan",s:"några sekunder",m:"en minut",mm:"%d minuter",h:"en timme",hh:"%d timmar",d:"en dag",dd:"%d dagar",M:"en månad",MM:"%d månader",y:"ett år",yy:"%d år"},ordinal:function(a){var b=a%10,c=1===~~(a%100/10)?"e":1===b?"a":2===b?"a":"e";return a+c},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("th",{months:"มกราคม_กุมภาพันธ์_มีนาคม_เมษายน_พฤษภาคม_มิถุนายน_กรกฎาคม_สิงหาคม_กันยายน_ตุลาคม_พฤศจิกายน_ธันวาคม".split("_"),monthsShort:"มกรา_กุมภา_มีนา_เมษา_พฤษภา_มิถุนา_กรกฎา_สิงหา_กันยา_ตุลา_พฤศจิกา_ธันวา".split("_"),weekdays:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัสบดี_ศุกร์_เสาร์".split("_"),weekdaysShort:"อาทิตย์_จันทร์_อังคาร_พุธ_พฤหัส_ศุกร์_เสาร์".split("_"),weekdaysMin:"อา._จ._อ._พ._พฤ._ศ._ส.".split("_"),longDateFormat:{LT:"H นาฬิกา m นาที",L:"YYYY/MM/DD",LL:"D MMMM YYYY",LLL:"D MMMM YYYY เวลา LT",LLLL:"วันddddที่ D MMMM YYYY เวลา LT"},meridiem:function(a){return 12>a?"ก่อนเที่ยง":"หลังเที่ยง"},calendar:{sameDay:"[วันนี้ เวลา] LT",nextDay:"[พรุ่งนี้ เวลา] LT",nextWeek:"dddd[หน้า เวลา] LT",lastDay:"[เมื่อวานนี้ เวลา] LT",lastWeek:"[วัน]dddd[ที่แล้ว เวลา] LT",sameElse:"L"},relativeTime:{future:"อีก %s",past:"%sที่แล้ว",s:"ไม่กี่วินาที",m:"1 นาที",mm:"%d นาที",h:"1 ชั่วโมง",hh:"%d ชั่วโมง",d:"1 วัน",dd:"%d วัน",M:"1 เดือน",MM:"%d เดือน",y:"1 ปี",yy:"%d ปี"}})}),function(a){a(bb)}(function(a){return a.lang("tl-ph",{months:"Enero_Pebrero_Marso_Abril_Mayo_Hunyo_Hulyo_Agosto_Setyembre_Oktubre_Nobyembre_Disyembre".split("_"),monthsShort:"Ene_Peb_Mar_Abr_May_Hun_Hul_Ago_Set_Okt_Nob_Dis".split("_"),weekdays:"Linggo_Lunes_Martes_Miyerkules_Huwebes_Biyernes_Sabado".split("_"),weekdaysShort:"Lin_Lun_Mar_Miy_Huw_Biy_Sab".split("_"),weekdaysMin:"Li_Lu_Ma_Mi_Hu_Bi_Sab".split("_"),longDateFormat:{LT:"HH:mm",L:"MM/D/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY LT",LLLL:"dddd, MMMM DD, YYYY LT"},calendar:{sameDay:"[Ngayon sa] LT",nextDay:"[Bukas sa] LT",nextWeek:"dddd [sa] LT",lastDay:"[Kahapon sa] LT",lastWeek:"dddd [huling linggo] LT",sameElse:"L"},relativeTime:{future:"sa loob ng %s",past:"%s ang nakalipas",s:"ilang segundo",m:"isang minuto",mm:"%d minuto",h:"isang oras",hh:"%d oras",d:"isang araw",dd:"%d araw",M:"isang buwan",MM:"%d buwan",y:"isang taon",yy:"%d taon"},ordinal:function(a){return a},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){var b={1:"'inci",5:"'inci",8:"'inci",70:"'inci",80:"'inci",2:"'nci",7:"'nci",20:"'nci",50:"'nci",3:"'üncü",4:"'üncü",100:"'üncü",6:"'ncı",9:"'uncu",10:"'uncu",30:"'uncu",60:"'ıncı",90:"'ıncı"};return a.lang("tr",{months:"Ocak_Şubat_Mart_Nisan_Mayıs_Haziran_Temmuz_Ağustos_Eylül_Ekim_Kasım_Aralık".split("_"),monthsShort:"Oca_Şub_Mar_Nis_May_Haz_Tem_Ağu_Eyl_Eki_Kas_Ara".split("_"),weekdays:"Pazar_Pazartesi_Salı_Çarşamba_Perşembe_Cuma_Cumartesi".split("_"),weekdaysShort:"Paz_Pts_Sal_Çar_Per_Cum_Cts".split("_"),weekdaysMin:"Pz_Pt_Sa_Ça_Pe_Cu_Ct".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[bugün saat] LT",nextDay:"[yarın saat] LT",nextWeek:"[haftaya] dddd [saat] LT",lastDay:"[dün] LT",lastWeek:"[geçen hafta] dddd [saat] LT",sameElse:"L"},relativeTime:{future:"%s sonra",past:"%s önce",s:"birkaç saniye",m:"bir dakika",mm:"%d dakika",h:"bir saat",hh:"%d saat",d:"bir gün",dd:"%d gün",M:"bir ay",MM:"%d ay",y:"bir yıl",yy:"%d yıl"},ordinal:function(a){if(0===a)return a+"'ıncı";var c=a%10,d=a%100-c,e=a>=100?100:null;return a+(b[c]||b[d]||b[e])},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("tzm-la",{months:"innayr_brˤayrˤ_marˤsˤ_ibrir_mayyw_ywnyw_ywlywz_ɣwšt_šwtanbir_ktˤwbrˤ_nwwanbir_dwjnbir".split("_"),monthsShort:"innayr_brˤayrˤ_marˤsˤ_ibrir_mayyw_ywnyw_ywlywz_ɣwšt_šwtanbir_ktˤwbrˤ_nwwanbir_dwjnbir".split("_"),weekdays:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),weekdaysShort:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),weekdaysMin:"asamas_aynas_asinas_akras_akwas_asimwas_asiḍyas".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[asdkh g] LT",nextDay:"[aska g] LT",nextWeek:"dddd [g] LT",lastDay:"[assant g] LT",lastWeek:"dddd [g] LT",sameElse:"L"},relativeTime:{future:"dadkh s yan %s",past:"yan %s",s:"imik",m:"minuḍ",mm:"%d minuḍ",h:"saɛa",hh:"%d tassaɛin",d:"ass",dd:"%d ossan",M:"ayowr",MM:"%d iyyirn",y:"asgas",yy:"%d isgasn"},week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){return a.lang("tzm",{months:"ⵉⵏⵏⴰⵢⵔ_ⴱⵕⴰⵢⵕ_ⵎⴰⵕⵚ_ⵉⴱⵔⵉⵔ_ⵎⴰⵢⵢⵓ_ⵢⵓⵏⵢⵓ_ⵢⵓⵍⵢⵓⵣ_ⵖⵓⵛⵜ_ⵛⵓⵜⴰⵏⴱⵉⵔ_ⴽⵟⵓⴱⵕ_ⵏⵓⵡⴰⵏⴱⵉⵔ_ⴷⵓⵊⵏⴱⵉⵔ".split("_"),monthsShort:"ⵉⵏⵏⴰⵢⵔ_ⴱⵕⴰⵢⵕ_ⵎⴰⵕⵚ_ⵉⴱⵔⵉⵔ_ⵎⴰⵢⵢⵓ_ⵢⵓⵏⵢⵓ_ⵢⵓⵍⵢⵓⵣ_ⵖⵓⵛⵜ_ⵛⵓⵜⴰⵏⴱⵉⵔ_ⴽⵟⵓⴱⵕ_ⵏⵓⵡⴰⵏⴱⵉⵔ_ⴷⵓⵊⵏⴱⵉⵔ".split("_"),weekdays:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),weekdaysShort:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),weekdaysMin:"ⴰⵙⴰⵎⴰⵙ_ⴰⵢⵏⴰⵙ_ⴰⵙⵉⵏⴰⵙ_ⴰⴽⵔⴰⵙ_ⴰⴽⵡⴰⵙ_ⴰⵙⵉⵎⵡⴰⵙ_ⴰⵙⵉⴹⵢⴰⵙ".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[ⴰⵙⴷⵅ ⴴ] LT",nextDay:"[ⴰⵙⴽⴰ ⴴ] LT",nextWeek:"dddd [ⴴ] LT",lastDay:"[ⴰⵚⴰⵏⵜ ⴴ] LT",lastWeek:"dddd [ⴴ] LT",sameElse:"L"},relativeTime:{future:"ⴷⴰⴷⵅ ⵙ ⵢⴰⵏ %s",past:"ⵢⴰⵏ %s",s:"ⵉⵎⵉⴽ",m:"ⵎⵉⵏⵓⴺ",mm:"%d ⵎⵉⵏⵓⴺ",h:"ⵙⴰⵄⴰ",hh:"%d ⵜⴰⵙⵙⴰⵄⵉⵏ",d:"ⴰⵙⵙ",dd:"%d oⵙⵙⴰⵏ",M:"ⴰⵢoⵓⵔ",MM:"%d ⵉⵢⵢⵉⵔⵏ",y:"ⴰⵙⴳⴰⵙ",yy:"%d ⵉⵙⴳⴰⵙⵏ"},week:{dow:6,doy:12}})}),function(a){a(bb)}(function(a){function b(a,b){var c=a.split("_");return 1===b%10&&11!==b%100?c[0]:b%10>=2&&4>=b%10&&(10>b%100||b%100>=20)?c[1]:c[2]}function c(a,c,d){var e={mm:"хвилина_хвилини_хвилин",hh:"година_години_годин",dd:"день_дні_днів",MM:"місяць_місяці_місяців",yy:"рік_роки_років"};return"m"===d?c?"хвилина":"хвилину":"h"===d?c?"година":"годину":a+" "+b(e[d],+a)}function d(a,b){var c={nominative:"січень_лютий_березень_квітень_травень_червень_липень_серпень_вересень_жовтень_листопад_грудень".split("_"),accusative:"січня_лютого_березня_квітня_травня_червня_липня_серпня_вересня_жовтня_листопада_грудня".split("_")},d=/D[oD]? *MMMM?/.test(b)?"accusative":"nominative";return c[d][a.month()]}function e(a,b){var c={nominative:"неділя_понеділок_вівторок_середа_четвер_п’ятниця_субота".split("_"),accusative:"неділю_понеділок_вівторок_середу_четвер_п’ятницю_суботу".split("_"),genitive:"неділі_понеділка_вівторка_середи_четверга_п’ятниці_суботи".split("_")},d=/(\[[ВвУу]\]) ?dddd/.test(b)?"accusative":/\[?(?:минулої|наступної)? ?\] ?dddd/.test(b)?"genitive":"nominative";return c[d][a.day()]}function f(a){return function(){return a+"о"+(11===this.hours()?"б":"")+"] LT"}}return a.lang("uk",{months:d,monthsShort:"січ_лют_бер_квіт_трав_черв_лип_серп_вер_жовт_лист_груд".split("_"),weekdays:e,weekdaysShort:"нд_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"нд_пн_вт_ср_чт_пт_сб".split("_"),longDateFormat:{LT:"HH:mm",L:"DD.MM.YYYY",LL:"D MMMM YYYY р.",LLL:"D MMMM YYYY р., LT",LLLL:"dddd, D MMMM YYYY р., LT"},calendar:{sameDay:f("[Сьогодні "),nextDay:f("[Завтра "),lastDay:f("[Вчора "),nextWeek:f("[У] dddd ["),lastWeek:function(){switch(this.day()){case 0:case 3:case 5:case 6:return f("[Минулої] dddd [").call(this);case 1:case 2:case 4:return f("[Минулого] dddd [").call(this)}},sameElse:"L"},relativeTime:{future:"за %s",past:"%s тому",s:"декілька секунд",m:c,mm:c,h:"годину",hh:c,d:"день",dd:c,M:"місяць",MM:c,y:"рік",yy:c},meridiem:function(a){return 4>a?"ночі":12>a?"ранку":17>a?"дня":"вечора"},ordinal:function(a,b){switch(b){case"M":case"d":case"DDD":case"w":case"W":return a+"-й";case"D":return a+"-го";default:return a}},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("uz",{months:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),monthsShort:"янв_фев_мар_апр_май_июн_июл_авг_сен_окт_ноя_дек".split("_"),weekdays:"Якшанба_Душанба_Сешанба_Чоршанба_Пайшанба_Жума_Шанба".split("_"),weekdaysShort:"Якш_Душ_Сеш_Чор_Пай_Жум_Шан".split("_"),weekdaysMin:"Як_Ду_Се_Чо_Па_Жу_Ша".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"D MMMM YYYY, dddd LT"},calendar:{sameDay:"[Бугун соат] LT [да]",nextDay:"[Эртага] LT [да]",nextWeek:"dddd [куни соат] LT [да]",lastDay:"[Кеча соат] LT [да]",lastWeek:"[Утган] dddd [куни соат] LT [да]",sameElse:"L"},relativeTime:{future:"Якин %s ичида",past:"Бир неча %s олдин",s:"фурсат",m:"бир дакика",mm:"%d дакика",h:"бир соат",hh:"%d соат",d:"бир кун",dd:"%d кун",M:"бир ой",MM:"%d ой",y:"бир йил",yy:"%d йил"},week:{dow:1,doy:7}})}),function(a){a(bb)}(function(a){return a.lang("vn",{months:"tháng 1_tháng 2_tháng 3_tháng 4_tháng 5_tháng 6_tháng 7_tháng 8_tháng 9_tháng 10_tháng 11_tháng 12".split("_"),monthsShort:"Th01_Th02_Th03_Th04_Th05_Th06_Th07_Th08_Th09_Th10_Th11_Th12".split("_"),weekdays:"chủ nhật_thứ hai_thứ ba_thứ tư_thứ năm_thứ sáu_thứ bảy".split("_"),weekdaysShort:"CN_T2_T3_T4_T5_T6_T7".split("_"),weekdaysMin:"CN_T2_T3_T4_T5_T6_T7".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM [năm] YYYY",LLL:"D MMMM [năm] YYYY LT",LLLL:"dddd, D MMMM [năm] YYYY LT",l:"DD/M/YYYY",ll:"D MMM YYYY",lll:"D MMM YYYY LT",llll:"ddd, D MMM YYYY LT"},calendar:{sameDay:"[Hôm nay lúc] LT",nextDay:"[Ngày mai lúc] LT",nextWeek:"dddd [tuần tới lúc] LT",lastDay:"[Hôm qua lúc] LT",lastWeek:"dddd [tuần rồi lúc] LT",sameElse:"L"},relativeTime:{future:"%s tới",past:"%s trước",s:"vài giây",m:"một phút",mm:"%d phút",h:"một giờ",hh:"%d giờ",d:"một ngày",dd:"%d ngày",M:"một tháng",MM:"%d tháng",y:"một năm",yy:"%d năm"},ordinal:function(a){return a},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm",L:"YYYY年MMMD日",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY年MMMD日",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiem:function(a,b){var c=100*a+b;return 600>c?"凌晨":900>c?"早上":1130>c?"上午":1230>c?"中午":1800>c?"下午":"晚上"},calendar:{sameDay:function(){return 0===this.minutes()?"[今天]Ah[点整]":"[今天]LT"},nextDay:function(){return 0===this.minutes()?"[明天]Ah[点整]":"[明天]LT"},lastDay:function(){return 0===this.minutes()?"[昨天]Ah[点整]":"[昨天]LT"},nextWeek:function(){var b,c;return b=a().startOf("week"),c=this.unix()-b.unix()>=604800?"[下]":"[本]",0===this.minutes()?c+"dddAh点整":c+"dddAh点mm"},lastWeek:function(){var b,c;return b=a().startOf("week"),c=this.unix()<b.unix()?"[上]":"[本]",0===this.minutes()?c+"dddAh点整":c+"dddAh点mm"},sameElse:"L"},ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"日";case"M":return a+"月";case"w":case"W":return a+"周";default:return a}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1分钟",mm:"%d分钟",h:"1小时",hh:"%d小时",d:"1天",dd:"%d天",M:"1个月",MM:"%d个月",y:"1年",yy:"%d年"},week:{dow:1,doy:4}})}),function(a){a(bb)}(function(a){return a.lang("zh-tw",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"週日_週一_週二_週三_週四_週五_週六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah點mm",L:"YYYY年MMMD日",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY年MMMD日",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiem:function(a,b){var c=100*a+b;return 900>c?"早上":1130>c?"上午":1230>c?"中午":1800>c?"下午":"晚上"},calendar:{sameDay:"[今天]LT",nextDay:"[明天]LT",nextWeek:"[下]ddddLT",lastDay:"[昨天]LT",lastWeek:"[上]ddddLT",sameElse:"L"},ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"日";case"M":return a+"月";case"w":case"W":return a+"週";default:return a}},relativeTime:{future:"%s內",past:"%s前",s:"幾秒",m:"一分鐘",mm:"%d分鐘",h:"一小時",hh:"%d小時",d:"一天",dd:"%d天",M:"一個月",MM:"%d個月",y:"一年",yy:"%d年"}})}),bb.lang("en"),nb?(module.exports=bb,ab(!0)):"function"==typeof define&&define.amd?define("moment",function(b,c,d){return d.config().noGlobal!==!0&&ab(d.config().noGlobal===a),bb}):ab()}.call(this);var no={};no.de="undefined"==typeof window,no.inherit=function(ctor,base,mixin){var F=function(){};F.prototype=base.prototype;var proto=ctor.prototype=new F;if(mixin)if(Array.isArray(mixin))for(var i=0,l=mixin.length;l>i;i++)no.extend(proto,mixin[i]);else no.extend(proto,mixin);return proto.super_=base.prototype,proto.constructor=ctor,ctor},no.extend=function(dest){for(var i=1,l=arguments.length;l>i;i++){var src=arguments[i];for(var key in src)dest[key]=src[key]}return dest},no.nop=function(){},no["true"]=function(){return!0},no["false"]=function(){return!1},no.value=function(value){return function(){return value}},no.logger=function(msg){return msg?function(){var args=[].slice.call(arguments);console.log.apply(null,[msg].concat(args))}:console.log},no.next=no.de?function(callback){process.nextTick(callback)}:function(callback){setTimeout(callback,0)},no.de&&(module.exports=no);var no=no||require("./no.base.js");no.Parser=function(rules,tokens){this._rules=rules,this._tokens=tokens||{}},no.Parser.prototype.start=function(input,id){this.input=input,this.p=0,this.s=input;var ast=this.parse(id);return this.s&&this.error("End of string expected"),ast},no.Parser.prototype.parse=function(id,params){var rule=this._rules[id],p=this.p,ast=rule.call(this,params);return ast._start=p,ast._end=this.p,ast._input=this.input,ast},no.Parser.prototype.test=function(id){var token=this._tokens[id];if(token){var r=token.exec(this.s);return r&&r[0]
}return this.la(id.length)===id?id:void 0},no.Parser.prototype.match=function(id){var r=this.test(id);return r||this.error("Token "+id+" expected"),this.move(r.length),r},no.Parser.prototype.la=function(n){return this.s.substr(0,n||1)},no.Parser.prototype.move=function(n){n||(n=1),this.s=this.s.substr(n),this.p+=n},no.Parser.prototype.skip=function(){var r=/^\s+/.exec(this.s);r&&this.move(r[0].length)},no.Parser.prototype.error=function(msg){throw Error(msg+" at "+this.p+": "+this.s)};var no=no||require("./no.base.js");no.de&&(require("./no.parser.js"),module.exports=no),function(){function JNode(data){this.data=data}function cmpN(node,nodeset){if(nodeset instanceof JNode)return cmpS(nodeset,node.scalar());for(var nodes=nodeset.nodes,value=node.scalar(),i=0;i<nodes.length;i++)if(value==nodes[i].scalar())return!0;return!1}function cmpS(node,scalar){var data=node.data;if(Array.isArray(data)){for(var i=0;i<data.length;i++)if(new JNode(data[i]).scalar()==scalar)return!0;return!1}return node.scalar()==scalar}function JNodeset(){this.nodes=[]}function compileString(expr,id){var key=expr+"::"+id,cached=_cache[key];return cached||(cached=_cache[key]=compile(parser.start(expr,id))),cached}function compileObject(obj){var items={};for(var key in obj)items[key]=no.jpath.expr(obj[key]);return function(data,vars,funcs){var r={};for(var key in items)r[key]=no.jpath.toScalar(items[key](data,vars,funcs));return r}}function compileArray(arr){for(var items=[],l=arr.length,i=0;l>i;i++)items.push(no.jpath.expr(arr[i]));return function(data,vars,funcs){for(var r=[],i=0;l>i;i++)r.push(no.jpath.toScalar(items[i](data,vars,funcs)));return r}}function compile(ast){for(var exprs=[],p="jpath"===ast._id?jpath2func(ast,exprs):expr2func(ast,exprs),r="",i=0;p>=i;i++)r+="function t"+i+"(node, root, vars, funcs) {\n"+exprs[i]+"\n}\n\n";return r+="return function(data, vars, funcs) {\nvar node = new no.JNode(data);\nreturn t"+p+"(node, node, vars, funcs);\n}\n",Function("no",r)(no)}function expr2func(ast,exprs){var r="return ("+ast2js(ast,exprs)+");";return exprs.push(r)-1}function jpath2func(ast,exprs){var r="";ast.abs&&(r+="node = root;\n");for(var steps=ast.steps,i=0,l=steps.length;l>i;i++){var step=steps[i],id=step._id;switch(id){case"nametest":r+='node = node.nametest("'+step.nametest+'");\n';break;case"star":r+="node = node.startest();\n";break;case"pred":case"index":step.expr._as="pred"===id?TYPE_BOOL:TYPE_SCALAR;var p=expr2func(step.expr,exprs);r+="node = node."+id+"(t"+p+", root, vars, funcs);\n";break;case"guard":r+="if (!("+ast2js(step.expr,exprs)+")) { return node.empty; }\n"}"guard"!==id&&(r+="if (node.isEmpty()) { return node.empty; }\n")}return r+="return node;",exprs.push(r)-1}function ast2js(ast,exprs){var js;switch(ast._id){case"root":js="root";break;case"self":js="node";break;case"number":js=ast.value;break;case"string_literal":js=JSON.stringify(ast.value);break;case"string":js="("+ast.value.map(function(value){return value._as=TYPE_SCALAR,ast2js(value,exprs)}).join(" + ")+")";break;case"var":js='(new no.JNode(vars["'+ast.name+'"]))';break;case"func":js='funcs["'+ast.name+'"](';for(var i=0,l=ast.args.length;l>i;i++){var arg=ast.args[i];arg._as=TYPE_SCALAR,js+=i?",":"",js+=ast2js(arg,exprs)}js+=")";break;case"unop":ast.expr._as="!"===ast.op?TYPE_BOOL:TYPE_SCALAR,js=ast.op+"("+ast2js(ast.expr,exprs)+")";break;case"binop":var as,l=ast.left,r=ast.right,lt=l._type,rt=r._type,op=ast.op;switch(op){case"&&":case"||":as=lt===TYPE_BOOL&&rt===TYPE_BOOL?TYPE_BOOL:TYPE_SCALAR;break;case"==":case"!=":lt===rt||lt!==TYPE_BOOL&&rt!==TYPE_BOOL||(as=TYPE_BOOL);break;default:as=TYPE_SCALAR}as&&(l._as=r._as=as);var ljs=ast2js(l,exprs),rjs=ast2js(r,exprs);if("=="===op||"!="===op){if(lt===TYPE_NODESET||rt===TYPE_NODESET){if(lt===TYPE_SCALAR){var t=rjs;rjs=ljs,ljs=t}var type=lt===rt?"N":"S";js="("+ljs+").cmp"+type+"("+rjs+")"}js&&"!="===op&&(js="!("+js+")")}void 0===js&&(js="("+ljs+" "+ast.op+" "+rjs+")");break;case"subexpr":js="("+ast2js(ast.expr,exprs)+")";break;case"jpath":var p=jpath2func(ast,exprs);js="t"+p+"(node, root, vars, funcs)";break;case"filter":var p=jpath2func(ast.jpath,exprs);js="t"+p+'(new no.JNode(vars["'+ast.name+'"]), root, vars, funcs)'}return ast._as&&ast._as!==ast._type&&(ast._type===TYPE_NODESET?js="("+js+")."+ast._as+"()":ast._type===TYPE_SCALAR&&(js="!!("+js+")")),js}function compileSetter(jpath){for(var parts=jpath.split("."),i=1,l=parts.length-1,body="var r = data; var t;";l>i;i++)body+='t = r["'+parts[i]+'"];',body+='if (t == null) { t = r["'+parts[i]+'"] = {}; }',body+="r = t;";return body+='r["'+parts[i]+'"] = value;',body+="return data;",new Function("data","value",body)}JNode.prototype.empty=new JNodeset,JNode.prototype.isEmpty=function(){return!1},JNode.prototype.nametest=function(name,result){var data=this.data;if(!data)return this.empty;if(Array.isArray(data)){result||(result=new JNodeset);for(var i=0;i<data.length;i++)new JNode(data[i]).nametest(name,result);return result}var r=data[name];if(void 0===r)return this.empty;var node=new JNode(r);return result?result.push(node):node},JNode.prototype.startest=function(result){result||(result=new JNodeset);var data=this.data;if(Array.isArray(data))for(var i=0;i<data.length;i++)new JNode(data[i]).startest(result);else for(var key in data)this.nametest(key,result);return result},JNode.prototype.pred=function(filter,root,vars,funcs){var data=this.data;if(Array.isArray(data)){for(var result=new JNodeset,i=0;i<data.length;i++){var node=new JNode(data[i]);filter(node,root,vars,funcs)&&result.push(node)}return result}return filter(this,root,vars,funcs)?this:this.empty},JNode.prototype.index=function(index,root,vars,funcs){var data=this.data;if(Array.isArray(data)){var r=data[index(this,root,vars,funcs)];return void 0!==r?new JNode(r).toNodeset():this.empty}return 0===index?this:this.empty},JNode.prototype.toArray=function(){return[this.data]},JNode.prototype.toNodeset=function(){return(new JNodeset).push(this)},JNode.prototype.scalar=function(){var data=this.data;return"object"==typeof data?"":data},JNode.prototype["boolean"]=function(){var data=this.data;return Array.isArray(data)?data.length>0:!!data},JNode.prototype.cmpN=function(nodeset){var data=this.data;if(Array.isArray(data)){for(var i=0;i<data.length;i++)if(cmpN(new JNode(data[i]),nodeset))return!0;return!1}return cmpN(this,nodeset)},JNode.prototype.cmpS=function(scalar){return cmpS(this,scalar)},JNodeset.prototype.empty=JNode.prototype.empty,JNodeset.prototype.isEmpty=function(){return!this.nodes.length},JNodeset.prototype.push=function(node){return this.nodes.push(node),this},JNodeset.prototype.nametest=function(name,result){var nodes=this.nodes;result||(result=new JNodeset);for(var i=0;i<nodes.length;i++)nodes[i].nametest(name,result);return result},JNodeset.prototype.startest=function(result){var nodes=this.nodes;result||(result=new JNodeset);for(var i=0;i<nodes.length;i++)nodes[i].startest(result);return result},JNodeset.prototype.pred=function(filter,root,vars,funcs){for(var nodes=this.nodes,result=new JNodeset,i=0;i<nodes.length;i++){var node=nodes[i];filter(node,root,vars,funcs)&&result.push(node)}return result},JNodeset.prototype.index=function(index){var node=this.nodes[index];return void 0!==node?(new JNodeset).push(node):this.empty},JNodeset.prototype.toArray=function(){for(var r=[],nodes=this.nodes,i=0;i<nodes.length;i++)r.push(nodes[i].data);return r},JNodeset.prototype.scalar=function(){var nodes=this.nodes;return nodes.length?nodes[0].scalar():""},JNodeset.prototype["boolean"]=function(){var nodes=this.nodes;return nodes.length?nodes[0]["boolean"]():!1},JNodeset.prototype.cmpN=function(nodeset){for(var nodes=this.nodes,i=0,l=nodes.length;l>i;i++)if(nodes[i].cmpN(nodeset))return!0;return!1},JNodeset.prototype.cmpS=function(scalar){for(var nodes=this.nodes,i=0,l=nodes.length;l>i;i++)if(nodes[i].cmpS(scalar))return!0;return!1},no.JNode=JNode,no.JNodeset=JNodeset;var TYPE_SCALAR="scalar",TYPE_NODESET="nodeset",TYPE_BOOL="boolean",BINOPS={"*":6,"/":6,"%":6,"+":5,"-":5,"<=":4,">=":4,"<":4,">":4,"==":3,"!=":3,"&&":2,"||":1},tokens={};tokens.SELF=/^\.(?![a-zA-Z_*.[])/,tokens.ROOT=/^\/(?![.[])/,tokens.BINOP=/^(?:\+|-|\*|\/|%|==|!=|<=|>=|<|>|&&|\|\|)/,tokens.UNOP=/^(?:\+|-|!)/,tokens.DIGIT=/^[0-9]/,tokens.ID=/^[a-zA-Z_][a-zA-Z0-9-_]*/,tokens.NUMBER=/^[0-9]+(?:\.[0-9]+)?/,tokens.CHARS=/^[^"{}\\]+/;var rules={};rules.expr=function(){function reduce(p){for(var op,left,right;(op=ops[0])&&BINOPS[op]>=p;)right=args.shift(),left=args.shift(),args.unshift({_id:"binop",_type:"+-*/%".indexOf(op)>-1?TYPE_SCALAR:TYPE_BOOL,_local:left._local||right._local,op:ops.shift(),left:left,right:right})}var ops=[],args=[this.parse("unary")];this.skip();for(var op,cp=0;op=this.test("BINOP");){this.move(op.length),this.skip();var p=BINOPS[op];cp>=p&&reduce(p),ops.unshift(op),args.unshift(this.parse("unary")),this.skip(),cp=p}return reduce(0),args[0]},rules.unary=function(){var op;if(op=this.test("UNOP")){this.move();var expr=this.parse("unary");return{_id:"unop",_type:"!"===op?TYPE_BOOL:TYPE_SCALAR,_local:expr._local,op:op,expr:expr}}return this.parse("primary")},rules.primary=function(){var la=this.la();switch(la){case'"':return this.parse("string");case".":case"/":return this.parse("jpath");case"(":return this.parse("subexpr")}if(this.test("DIGIT"))return{_id:"number",_type:TYPE_SCALAR,value:this.match("NUMBER")};var name=this.match("ID");if(this.test("."))return{_id:"filter",_type:TYPE_NODESET,name:name,jpath:this.parse("jpath")};if(this.test("(")){this.move(),this.skip();var args=[];if(!this.test(")"))for(args.push(this.parse("expr")),this.skip();this.test(",");)this.move(),this.skip(),args.push(this.parse("expr")),this.skip();return this.match(")"),{_id:"func",_type:TYPE_SCALAR,name:name,args:args}}return{_id:"var",_type:TYPE_NODESET,name:name}},rules.subexpr=function(){this.move(),this.skip();var expr=this.parse("expr");return this.skip(),this.match(")"),{_id:"subexpr",_type:expr._type,_local:expr._local,expr:expr}},rules.jpath=function(){if(this.test("SELF"))return this.move(),{_id:"self",_type:TYPE_NODESET,_local:!0};if(this.test("ROOT"))return this.move(),{_id:"root",_type:TYPE_NODESET};var abs;this.test("/")&&(this.move(),abs=!0);for(var steps=[];;){var la=this.la();if("."===la)steps.push(this.parse("step"));else{if("["!==la)break;var pred=this.parse("pred");"guard"===pred._id?steps.unshift(pred):steps.push(pred)}}return{_id:"jpath",_type:TYPE_NODESET,_local:!abs,abs:abs,steps:steps}},rules.step=function(){this.move();var la=this.la();return"["===la?this.parse("pred"):"*"===la?(this.move(),{_id:"star"}):{_id:"nametest",nametest:this.match("ID")}},rules.pred=function(){this.move(),this.skip();var expr=this.parse("expr");this.skip(),this.match("]");var _id="index";return expr._local?_id="pred":expr._type===TYPE_BOOL&&(_id="guard"),{_id:_id,expr:expr}},rules.string=function(){this.match('"');var content=this.parse("string_content");return this.match('"'),content};var disymbols={"{{":"{","}}":"}",'\\"':'"',"\\\\":"\\"};rules.string_content=function(){function pushStr(){str&&(parts.push(stringLiteral(str)),str="")}function stringLiteral(s){return{_id:"string_literal",_type:TYPE_SCALAR,value:s}}for(var c,parts=[],str="";this.s;)if(c=disymbols[this.la(2)])str+=c,this.move(2);else{if(c=this.la(),'"'===c)break;"\\"===c?(str+=c,this.move()):"{"===c?(pushStr(),this.move(),this.skip(),parts.push(this.parse("expr")),this.skip(),this.match("}")):str+=this.match("CHARS")}return pushStr(),parts.length||parts.push(stringLiteral("")),{_id:"string",_type:TYPE_SCALAR,value:parts}};var parser=new no.Parser(rules,tokens),_cache={};no.jpath=function(expr,data,vars,funcs){return no.jpath.toScalar(no.jpath.expr(expr)(data,vars,funcs))},no.jpath.raw=function(expr,data,vars,funcs){return no.jpath.expr(expr)(data,vars,funcs)},no.jpath.scalar=function(expr){var compiled=no.jpath.expr(expr);return function(data,vars,funcs){return no.jpath.toScalar(compiled(data,vars,funcs))}},no.jpath["boolean"]=function(expr){var compiled=no.jpath.expr(expr);return function(data,vars,funcs){return no.jpath.toBoolean(compiled(data,vars,funcs))}},no.jpath.string=function(str){return compileString(str,"string_content")},no.jpath.expr=function(expr){var type=typeof expr;return"string"===type?compileString(expr,"expr"):expr&&"object"===type?Array.isArray(expr)?compileArray(expr):compileObject(expr):function(){return expr}},no.jpath.toScalar=function(result){return result instanceof JNode?result.data:result instanceof JNodeset?result.isEmpty()?void 0:result.toArray():result},no.jpath.toBoolean=function(result){return result instanceof JNode||result instanceof JNodeset?result["boolean"]():result};var _setters={};no.jpath.set=function(jpath,data,value){var compiled=_setters[jpath]||(_setters[jpath]=compileSetter(jpath));return compiled(data,value)}}(),window.no=no,function(t,e){"use strict";"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.returnExports=e()}(this,function(){function I(t){var e=typeof t;return null===t||"undefined"===e||"boolean"===e||"number"===e||"string"===e}var h,t=Array.prototype,e=Object.prototype,r=Function.prototype,n=String.prototype,i=Number.prototype,a=t.slice,o=t.splice,u=t.push,l=t.unshift,f=r.call,s=e.toString,c=Array.isArray||function(t){return"[object Array]"===s.call(t)},p="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,v=Function.prototype.toString,g=function(t){try{return v.call(t),!0}catch(e){return!1}},y="[object Function]",d="[object GeneratorFunction]";h=function(t){if("function"!=typeof t)return!1;if(p)return g(t);var e=s.call(t);return e===y||e===d};var m,b=RegExp.prototype.exec,w=function(t){try{return b.call(t),!0}catch(e){return!1}},T="[object RegExp]";m=function(t){return"object"!=typeof t?!1:p?w(t):s.call(t)===T};var x,O=String.prototype.valueOf,j=function(t){try{return O.call(t),!0}catch(e){return!1}},S="[object String]";x=function(t){return"string"==typeof t?!0:"object"!=typeof t?!1:p?j(t):s.call(t)===S};var E=function(t){var e=s.call(t),r="[object Arguments]"===e;return r||(r=!c(t)&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&h(t.callee)),r},N=function(t){var r,e=Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(t){return!1}}();return r=e?function(t,e,r,n){!n&&e in t||Object.defineProperty(t,e,{configurable:!0,enumerable:!1,writable:!0,value:r})}:function(t,e,r,n){!n&&e in t||(t[e]=r)},function(e,i,a){for(var o in i)t.call(i,o)&&r(e,o,i[o],a)}}(e.hasOwnProperty),D={ToInteger:function(t){var e=+t;return e!==e?e=0:0!==e&&e!==1/0&&e!==-(1/0)&&(e=(e>0||-1)*Math.floor(Math.abs(e))),e},ToPrimitive:function(t){var e,r,n;if(I(t))return t;if(r=t.valueOf,h(r)&&(e=r.call(t),I(e)))return e;if(n=t.toString,h(n)&&(e=n.call(t),I(e)))return e;throw new TypeError},ToObject:function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return Object(t)},ToUint32:function(t){return t>>>0}},M=function(){};N(r,{bind:function(t){var e=this;if(!h(e))throw new TypeError("Function.prototype.bind called on incompatible "+e);for(var n,r=a.call(arguments,1),i=function(){if(this instanceof n){var i=e.apply(this,r.concat(a.call(arguments)));return Object(i)===i?i:this}return e.apply(t,r.concat(a.call(arguments)))},o=Math.max(0,e.length-r.length),u=[],l=0;o>l;l++)u.push("$"+l);return n=Function("binder","return function ("+u.join(",")+"){ return binder.apply(this, arguments); }")(i),e.prototype&&(M.prototype=e.prototype,n.prototype=new M,M.prototype=null),n}});var F=f.bind(e.hasOwnProperty),R=function(){var t=[1,2],e=t.splice();return 2===t.length&&c(e)&&0===e.length}();N(t,{splice:function(){return 0===arguments.length?[]:o.apply(this,arguments)}},!R);var U=function(){var e={};return t.splice.call(e,0,0,1),1===e.length}();N(t,{splice:function(t,e){if(0===arguments.length)return[];var r=arguments;return this.length=Math.max(D.ToInteger(this.length),0),arguments.length>0&&"number"!=typeof e&&(r=a.call(arguments),r.length<2?r.push(this.length-t):r[1]=D.ToInteger(e)),o.apply(this,r)}},!U);var k=1!==[].unshift(0);N(t,{unshift:function(){return l.apply(this,arguments),this.length}},k),N(Array,{isArray:c});var A=Object("a"),C="a"!==A[0]||!(0 in A),P=function(t){var e=!0,r=!0;return t&&(t.call("foo",function(t,r,n){"object"!=typeof n&&(e=!1)}),t.call([1],function(){"use strict";r="string"==typeof this},"x")),!!t&&e&&r};N(t,{forEach:function(t){var e=D.ToObject(this),r=C&&x(this)?this.split(""):e,n=arguments[1],i=-1,a=r.length>>>0;if(!h(t))throw new TypeError;for(;++i<a;)i in r&&t.call(n,r[i],i,e)}},!P(t.forEach)),N(t,{map:function(t){var e=D.ToObject(this),r=C&&x(this)?this.split(""):e,n=r.length>>>0,i=Array(n),a=arguments[1];if(!h(t))throw new TypeError(t+" is not a function");for(var o=0;n>o;o++)o in r&&(i[o]=t.call(a,r[o],o,e));return i}},!P(t.map)),N(t,{filter:function(t){var a,e=D.ToObject(this),r=C&&x(this)?this.split(""):e,n=r.length>>>0,i=[],o=arguments[1];if(!h(t))throw new TypeError(t+" is not a function");for(var u=0;n>u;u++)u in r&&(a=r[u],t.call(o,a,u,e)&&i.push(a));return i}},!P(t.filter)),N(t,{every:function(t){var e=D.ToObject(this),r=C&&x(this)?this.split(""):e,n=r.length>>>0,i=arguments[1];if(!h(t))throw new TypeError(t+" is not a function");for(var a=0;n>a;a++)if(a in r&&!t.call(i,r[a],a,e))return!1;return!0}},!P(t.every)),N(t,{some:function(t){var e=D.ToObject(this),r=C&&x(this)?this.split(""):e,n=r.length>>>0,i=arguments[1];if(!h(t))throw new TypeError(t+" is not a function");for(var a=0;n>a;a++)if(a in r&&t.call(i,r[a],a,e))return!0;return!1}},!P(t.some));var Z=!1;t.reduce&&(Z="object"==typeof t.reduce.call("es5",function(t,e,r,n){return n})),N(t,{reduce:function(t){var e=D.ToObject(this),r=C&&x(this)?this.split(""):e,n=r.length>>>0;if(!h(t))throw new TypeError(t+" is not a function");if(!n&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var a,i=0;if(arguments.length>=2)a=arguments[1];else for(;;){if(i in r){a=r[i++];break}if(++i>=n)throw new TypeError("reduce of empty array with no initial value")}for(;n>i;i++)i in r&&(a=t.call(void 0,a,r[i],i,e));return a}},!Z);var J=!1;t.reduceRight&&(J="object"==typeof t.reduceRight.call("es5",function(t,e,r,n){return n})),N(t,{reduceRight:function(t){var e=D.ToObject(this),r=C&&x(this)?this.split(""):e,n=r.length>>>0;if(!h(t))throw new TypeError(t+" is not a function");if(!n&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var i,a=n-1;if(arguments.length>=2)i=arguments[1];else for(;;){if(a in r){i=r[a--];break}if(--a<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>a)return i;do a in r&&(i=t.call(void 0,i,r[a],a,e));while(a--);return i}},!J);var z=Array.prototype.indexOf&&-1!==[0,1].indexOf(1,2);N(t,{indexOf:function(t){var e=C&&x(this)?this.split(""):D.ToObject(this),r=e.length>>>0;if(!r)return-1;var n=0;for(arguments.length>1&&(n=D.ToInteger(arguments[1])),n=n>=0?n:Math.max(0,r+n);r>n;n++)if(n in e&&e[n]===t)return n;return-1}},z);var $=Array.prototype.lastIndexOf&&-1!==[0,1].lastIndexOf(0,-3);N(t,{lastIndexOf:function(t){var e=C&&x(this)?this.split(""):D.ToObject(this),r=e.length>>>0;if(!r)return-1;var n=r-1;for(arguments.length>1&&(n=Math.min(n,D.ToInteger(arguments[1]))),n=n>=0?n:r-Math.abs(n);n>=0;n--)if(n in e&&t===e[n])return n;return-1}},$);var B=!{toString:null}.propertyIsEnumerable("toString"),G=function(){}.propertyIsEnumerable("prototype"),H=!F("x","0"),L=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],X=L.length;N(Object,{keys:function(t){var e=h(t),r=E(t),n=null!==t&&"object"==typeof t,i=n&&x(t);if(!n&&!e&&!r)throw new TypeError("Object.keys called on a non-object");var a=[],o=G&&e;if(i&&H||r)for(var u=0;u<t.length;++u)a.push(String(u));if(!r)for(var l in t)o&&"prototype"===l||!F(t,l)||a.push(String(l));if(B)for(var f=t.constructor,s=f&&f.prototype===t,c=0;X>c;c++){var p=L[c];s&&"constructor"===p||!F(t,p)||a.push(p)}return a}});var Y=Object.keys&&function(){return 2===Object.keys(arguments).length}(1,2),q=Object.keys;N(Object,{keys:function(e){return q(E(e)?t.slice.call(e):e)}},!Y);var K=-621987552e5,Q="-000001",V=Date.prototype.toISOString&&-1===new Date(K).toISOString().indexOf(Q);N(Date.prototype,{toISOString:function(){var t,e,r,n,i;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(n=this.getUTCFullYear(),i=this.getUTCMonth(),n+=Math.floor(i/12),i=(i%12+12)%12,t=[i+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],n=(0>n?"-":n>9999?"+":"")+("00000"+Math.abs(n)).slice(n>=0&&9999>=n?-4:-6),e=t.length;e--;)r=t[e],10>r&&(t[e]="0"+r);return n+"-"+t.slice(0,2).join("-")+"T"+t.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"}},V);var W=!1;try{W=Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(K).toJSON().indexOf(Q)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(_){}W||(Date.prototype.toJSON=function(){var n,e=Object(this),r=D.ToPrimitive(e);if("number"==typeof r&&!isFinite(r))return null;if(n=e.toISOString,"function"!=typeof n)throw new TypeError("toISOString property is not callable");return n.call(e)});var te=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),ee=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z")),re=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));(!Date.parse||re||ee||!te)&&(Date=function(t){function e(r,n,i,a,o,u,l){var f=arguments.length;if(this instanceof t){var s=1===f&&String(r)===r?new t(e.parse(r)):f>=7?new t(r,n,i,a,o,u,l):f>=6?new t(r,n,i,a,o,u):f>=5?new t(r,n,i,a,o):f>=4?new t(r,n,i,a):f>=3?new t(r,n,i):f>=2?new t(r,n):f>=1?new t(r):new t;return s.constructor=e,s}return t.apply(this,arguments)}function i(t,e){var r=e>1?1:0;return n[e]+Math.floor((t-1969+r)/4)-Math.floor((t-1901+r)/100)+Math.floor((t-1601+r)/400)+365*(t-1970)}function a(e){return Number(new t(1970,0,1,0,0,0,e))}var r=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),n=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(var o in t)e[o]=t[o];return e.now=t.now,e.UTC=t.UTC,e.prototype=t.prototype,e.prototype.constructor=e,e.parse=function u(e){var n=r.exec(e);if(n){var d,o=Number(n[1]),u=Number(n[2]||1)-1,l=Number(n[3]||1)-1,f=Number(n[4]||0),s=Number(n[5]||0),c=Number(n[6]||0),p=Math.floor(1e3*Number(n[7]||0)),h=Boolean(n[4]&&!n[8]),v="-"===n[9]?1:-1,g=Number(n[10]||0),y=Number(n[11]||0);return(s>0||c>0||p>0?24:25)>f&&60>s&&60>c&&1e3>p&&u>-1&&12>u&&24>g&&60>y&&l>-1&&l<i(o,u+1)-i(o,u)&&(d=60*(24*(i(o,u)+l)+f+g*v),d=1e3*(60*(d+s+y*v)+c)+p,h&&(d=a(d)),d>=-864e13&&864e13>=d)?d:0/0}return t.parse.apply(this,arguments)},e}(Date)),Date.now||(Date.now=function(){return(new Date).getTime()});var ne=i.toFixed&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==0xde0b6b3a7640080.toFixed(0)),ie={base:1e7,size:6,data:[0,0,0,0,0,0],multiply:function(t,e){for(var r=-1;++r<ie.size;)e+=t*ie.data[r],ie.data[r]=e%ie.base,e=Math.floor(e/ie.base)},divide:function(t){for(var e=ie.size,r=0;--e>=0;)r+=ie.data[e],ie.data[e]=Math.floor(r/t),r=r%t*ie.base},numToString:function(){for(var t=ie.size,e="";--t>=0;)if(""!==e||0===t||0!==ie.data[t]){var r=String(ie.data[t]);""===e?e=r:e+="0000000".slice(0,7-r.length)+r}return e},pow:function Ke(t,e,r){return 0===e?r:e%2===1?Ke(t,e-1,r*t):Ke(t*t,e/2,r)},log:function(t){for(var e=0;t>=4096;)e+=12,t/=4096;for(;t>=2;)e+=1,t/=2;return e}};N(i,{toFixed:function(t){var e,r,n,i,a,o,u,l;if(e=Number(t),e=e!==e?0:Math.floor(e),0>e||e>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(r=Number(this),r!==r)return"NaN";if(-1e21>=r||r>=1e21)return String(r);if(n="",0>r&&(n="-",r=-r),i="0",r>1e-21)if(a=ie.log(r*ie.pow(2,69,1))-69,o=0>a?r*ie.pow(2,-a,1):r/ie.pow(2,a,1),o*=4503599627370496,a=52-a,a>0){for(ie.multiply(0,o),u=e;u>=7;)ie.multiply(1e7,0),u-=7;for(ie.multiply(ie.pow(10,u,1),0),u=a-1;u>=23;)ie.divide(1<<23),u-=23;ie.divide(1<<u),ie.multiply(1,1),ie.divide(2),i=ie.numToString()}else ie.multiply(0,o),ie.multiply(1<<-a,0),i=ie.numToString()+"0.00000000000000000000".slice(2,2+e);return e>0?(l=i.length,i=e>=l?n+"0.0000000000000000000".slice(0,e-l+2)+i:n+i.slice(0,l-e)+"."+i.slice(l-e)):i=n+i,i}},ne);var ae=n.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var t="undefined"==typeof/()??/.exec("")[1];n.split=function(e,r){var n=this;if("undefined"==typeof e&&0===r)return[];if(!m(e))return ae.call(this,e,r);var l,f,s,c,i=[],a=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),o=0;for(e=new RegExp(e.source,a+"g"),n+="",t||(l=new RegExp("^"+e.source+"$(?!\\s)",a)),r="undefined"==typeof r?-1>>>0:D.ToUint32(r),f=e.exec(n);f&&(s=f.index+f[0].length,!(s>o&&(i.push(n.slice(o,f.index)),!t&&f.length>1&&f[0].replace(l,function(){for(var t=1;t<arguments.length-2;t++)"undefined"==typeof arguments[t]&&(f[t]=void 0)}),f.length>1&&f.index<n.length&&u.apply(i,f.slice(1)),c=f[0].length,o=s,i.length>=r)));)e.lastIndex===f.index&&e.lastIndex++,f=e.exec(n);return o===n.length?(c||!e.test(""))&&i.push(""):i.push(n.slice(o)),i.length>r?i.slice(0,r):i}}():"0".split(void 0,0).length&&(n.split=function(t,e){return"undefined"==typeof t&&0===e?[]:ae.call(this,t,e)});var oe=n.replace,ue=function(){var t=[];return"x".replace(/x(.)?/g,function(e,r){t.push(r)}),1===t.length&&"undefined"==typeof t[0]}();ue||(n.replace=function(t,e){var r=h(e),n=m(t)&&/\)[*?]/.test(t.source);if(r&&n){var i=function(r){var n=arguments.length,i=t.lastIndex;t.lastIndex=0;var a=t.exec(r)||[];return t.lastIndex=i,a.push(arguments[n-2],arguments[n-1]),e.apply(this,a)};return oe.call(this,t,i)}return oe.call(this,t,e)});var le=n.substr,fe="".substr&&"b"!=="0b".substr(-1);N(n,{substr:function(t,e){return le.call(this,0>t&&(t=this.length+t)<0?0:t,e)}},fe);var se="	\n\f\r   ᠎             　\u2028\u2029﻿",ce="​",pe="["+se+"]",he=new RegExp("^"+pe+pe+"*"),ve=new RegExp(pe+pe+"*$"),ge=n.trim&&(se.trim()||!ce.trim());N(n,{trim:function(){if("undefined"==typeof this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(he,"").replace(ve,"")}},ge),(8!==parseInt(se+"08")||22!==parseInt(se+"0x16"))&&(parseInt=function(t){var e=/^0[xX]/;return function(n,i){return n=String(n).trim(),Number(i)||(i=e.test(n)?16:10),t(n,i)}}(parseInt))}),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.React=e()}}(function(){return function e(t,n,r){function o(a,s){if(!n[a]){if(!t[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(i)return i(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[a]={exports:{}};t[a][0].call(l.exports,function(e){var n=t[a][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(e,t){"use strict";var n=e("./LinkedStateMixin"),r=e("./React"),o=e("./ReactComponentWithPureRenderMixin"),i=e("./ReactCSSTransitionGroup"),a=e("./ReactTransitionGroup"),s=e("./ReactUpdates"),u=e("./cx"),c=e("./cloneWithProps"),l=e("./update");r.addons={CSSTransitionGroup:i,LinkedStateMixin:n,PureRenderMixin:o,TransitionGroup:a,batchedUpdates:s.batchedUpdates,classSet:u,cloneWithProps:c,update:l},t.exports=r},{"./LinkedStateMixin":25,"./React":31,"./ReactCSSTransitionGroup":34,"./ReactComponentWithPureRenderMixin":39,"./ReactTransitionGroup":87,"./ReactUpdates":88,"./cloneWithProps":110,"./cx":115,"./update":154}],2:[function(e,t){"use strict";var n=e("./focusNode"),r={componentDidMount:function(){this.props.autoFocus&&n(this.getDOMNode())}};t.exports=r},{"./focusNode":122}],3:[function(e,t){"use strict";function n(){var e=window.opera;return"object"==typeof e&&"function"==typeof e.version&&parseInt(e.version(),10)<=12}function r(e){return(e.ctrlKey||e.altKey||e.metaKey)&&!(e.ctrlKey&&e.altKey)}var o=e("./EventConstants"),i=e("./EventPropagators"),a=e("./ExecutionEnvironment"),s=e("./SyntheticInputEvent"),u=e("./keyOf"),c=a.canUseDOM&&"TextEvent"in window&&!("documentMode"in document||n()),l=32,p=String.fromCharCode(l),d=o.topLevelTypes,f={beforeInput:{phasedRegistrationNames:{bubbled:u({onBeforeInput:null}),captured:u({onBeforeInputCapture:null})},dependencies:[d.topCompositionEnd,d.topKeyPress,d.topTextInput,d.topPaste]}},h=null,m=!1,v={eventTypes:f,extractEvents:function(e,t,n,o){var a;if(c)switch(e){case d.topKeyPress:var u=o.which;if(u!==l)return;m=!0,a=p;break;case d.topTextInput:if(a=o.data,a===p&&m)return;break;default:return}else{switch(e){case d.topPaste:h=null;break;case d.topKeyPress:o.which&&!r(o)&&(h=String.fromCharCode(o.which));break;case d.topCompositionEnd:h=o.data}if(null===h)return;a=h}if(a){var v=s.getPooled(f.beforeInput,n,o);return v.data=a,h=null,i.accumulateTwoPhaseDispatches(v),v}}};t.exports=v},{"./EventConstants":17,"./EventPropagators":22,"./ExecutionEnvironment":23,"./SyntheticInputEvent":98,"./keyOf":144}],4:[function(e,t){var n=e("./invariant"),r={addClass:function(e,t){return n(!/\s/.test(t)),t&&(e.classList?e.classList.add(t):r.hasClass(e,t)||(e.className=e.className+" "+t)),e},removeClass:function(e,t){return n(!/\s/.test(t)),t&&(e.classList?e.classList.remove(t):r.hasClass(e,t)&&(e.className=e.className.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,""))),e},conditionClass:function(e,t,n){return(n?r.addClass:r.removeClass)(e,t)},hasClass:function(e,t){return n(!/\s/.test(t)),e.classList?!!t&&e.classList.contains(t):(" "+e.className+" ").indexOf(" "+t+" ")>-1}};t.exports=r},{"./invariant":137}],5:[function(e,t){"use strict";function n(e,t){return e+t.charAt(0).toUpperCase()+t.substring(1)}var r={columnCount:!0,fillOpacity:!0,flex:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},o=["Webkit","ms","Moz","O"];Object.keys(r).forEach(function(e){o.forEach(function(t){r[n(t,e)]=r[e]})});var i={background:{backgroundImage:!0,backgroundPosition:!0,backgroundRepeat:!0,backgroundColor:!0},border:{borderWidth:!0,borderStyle:!0,borderColor:!0},borderBottom:{borderBottomWidth:!0,borderBottomStyle:!0,borderBottomColor:!0},borderLeft:{borderLeftWidth:!0,borderLeftStyle:!0,borderLeftColor:!0},borderRight:{borderRightWidth:!0,borderRightStyle:!0,borderRightColor:!0},borderTop:{borderTopWidth:!0,borderTopStyle:!0,borderTopColor:!0},font:{fontStyle:!0,fontVariant:!0,fontWeight:!0,fontSize:!0,lineHeight:!0,fontFamily:!0}},a={isUnitlessNumber:r,shorthandPropertyExpansions:i};t.exports=a},{}],6:[function(e,t){"use strict";var n=e("./CSSProperty"),r=e("./ExecutionEnvironment"),o=(e("./camelizeStyleName"),e("./dangerousStyleValue")),i=e("./hyphenateStyleName"),a=e("./memoizeStringOnly"),s=(e("./warning"),a(function(e){return i(e)})),u="cssFloat";r.canUseDOM&&void 0===document.documentElement.style.cssFloat&&(u="styleFloat");var c={createMarkupForStyles:function(e){var t="";for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];null!=r&&(t+=s(n)+":",t+=o(n,r)+";")}return t||null},setValueForStyles:function(e,t){var r=e.style;for(var i in t)if(t.hasOwnProperty(i)){var a=o(i,t[i]);if("float"===i&&(i=u),a)r[i]=a;else{var s=n.shorthandPropertyExpansions[i];if(s)for(var c in s)r[c]="";else r[i]=""}}}};t.exports=c},{"./CSSProperty":5,"./ExecutionEnvironment":23,"./camelizeStyleName":109,"./dangerousStyleValue":116,"./hyphenateStyleName":135,"./memoizeStringOnly":146,"./warning":155}],7:[function(e,t){"use strict";
function n(){this._callbacks=null,this._contexts=null}var r=e("./PooledClass"),o=e("./Object.assign"),i=e("./invariant");o(n.prototype,{enqueue:function(e,t){this._callbacks=this._callbacks||[],this._contexts=this._contexts||[],this._callbacks.push(e),this._contexts.push(t)},notifyAll:function(){var e=this._callbacks,t=this._contexts;if(e){i(e.length===t.length),this._callbacks=null,this._contexts=null;for(var n=0,r=e.length;r>n;n++)e[n].call(t[n]);e.length=0,t.length=0}},reset:function(){this._callbacks=null,this._contexts=null},destructor:function(){this.reset()}}),r.addPoolingTo(n),t.exports=n},{"./Object.assign":29,"./PooledClass":30,"./invariant":137}],8:[function(e,t){"use strict";function n(e){return"SELECT"===e.nodeName||"INPUT"===e.nodeName&&"file"===e.type}function r(e){var t=M.getPooled(P.change,w,e);E.accumulateTwoPhaseDispatches(t),R.batchedUpdates(o,t)}function o(e){g.enqueueEvents(e),g.processEventQueue()}function i(e,t){T=e,w=t,T.attachEvent("onchange",r)}function a(){T&&(T.detachEvent("onchange",r),T=null,w=null)}function s(e,t,n){return e===x.topChange?n:void 0}function u(e,t,n){e===x.topFocus?(a(),i(t,n)):e===x.topBlur&&a()}function c(e,t){T=e,w=t,_=e.value,S=Object.getOwnPropertyDescriptor(e.constructor.prototype,"value"),Object.defineProperty(T,"value",k),T.attachEvent("onpropertychange",p)}function l(){T&&(delete T.value,T.detachEvent("onpropertychange",p),T=null,w=null,_=null,S=null)}function p(e){if("value"===e.propertyName){var t=e.srcElement.value;t!==_&&(_=t,r(e))}}function d(e,t,n){return e===x.topInput?n:void 0}function f(e,t,n){e===x.topFocus?(l(),c(t,n)):e===x.topBlur&&l()}function h(e){return e!==x.topSelectionChange&&e!==x.topKeyUp&&e!==x.topKeyDown||!T||T.value===_?void 0:(_=T.value,w)}function m(e){return"INPUT"===e.nodeName&&("checkbox"===e.type||"radio"===e.type)}function v(e,t,n){return e===x.topClick?n:void 0}var y=e("./EventConstants"),g=e("./EventPluginHub"),E=e("./EventPropagators"),C=e("./ExecutionEnvironment"),R=e("./ReactUpdates"),M=e("./SyntheticEvent"),b=e("./isEventSupported"),O=e("./isTextInputElement"),D=e("./keyOf"),x=y.topLevelTypes,P={change:{phasedRegistrationNames:{bubbled:D({onChange:null}),captured:D({onChangeCapture:null})},dependencies:[x.topBlur,x.topChange,x.topClick,x.topFocus,x.topInput,x.topKeyDown,x.topKeyUp,x.topSelectionChange]}},T=null,w=null,_=null,S=null,N=!1;C.canUseDOM&&(N=b("change")&&(!("documentMode"in document)||document.documentMode>8));var I=!1;C.canUseDOM&&(I=b("input")&&(!("documentMode"in document)||document.documentMode>9));var k={get:function(){return S.get.call(this)},set:function(e){_=""+e,S.set.call(this,e)}},A={eventTypes:P,extractEvents:function(e,t,r,o){var i,a;if(n(t)?N?i=s:a=u:O(t)?I?i=d:(i=h,a=f):m(t)&&(i=v),i){var c=i(e,t,r);if(c){var l=M.getPooled(P.change,c,o);return E.accumulateTwoPhaseDispatches(l),l}}a&&a(e,t,r)}};t.exports=A},{"./EventConstants":17,"./EventPluginHub":19,"./EventPropagators":22,"./ExecutionEnvironment":23,"./ReactUpdates":88,"./SyntheticEvent":96,"./isEventSupported":138,"./isTextInputElement":140,"./keyOf":144}],9:[function(e,t){"use strict";var n=0,r={createReactRootIndex:function(){return n++}};t.exports=r},{}],10:[function(e,t){"use strict";function n(e){switch(e){case y.topCompositionStart:return E.compositionStart;case y.topCompositionEnd:return E.compositionEnd;case y.topCompositionUpdate:return E.compositionUpdate}}function r(e,t){return e===y.topKeyDown&&t.keyCode===h}function o(e,t){switch(e){case y.topKeyUp:return-1!==f.indexOf(t.keyCode);case y.topKeyDown:return t.keyCode!==h;case y.topKeyPress:case y.topMouseDown:case y.topBlur:return!0;default:return!1}}function i(e){this.root=e,this.startSelection=c.getSelection(e),this.startValue=this.getText()}var a=e("./EventConstants"),s=e("./EventPropagators"),u=e("./ExecutionEnvironment"),c=e("./ReactInputSelection"),l=e("./SyntheticCompositionEvent"),p=e("./getTextContentAccessor"),d=e("./keyOf"),f=[9,13,27,32],h=229,m=u.canUseDOM&&"CompositionEvent"in window,v=!m||"documentMode"in document&&document.documentMode>8&&document.documentMode<=11,y=a.topLevelTypes,g=null,E={compositionEnd:{phasedRegistrationNames:{bubbled:d({onCompositionEnd:null}),captured:d({onCompositionEndCapture:null})},dependencies:[y.topBlur,y.topCompositionEnd,y.topKeyDown,y.topKeyPress,y.topKeyUp,y.topMouseDown]},compositionStart:{phasedRegistrationNames:{bubbled:d({onCompositionStart:null}),captured:d({onCompositionStartCapture:null})},dependencies:[y.topBlur,y.topCompositionStart,y.topKeyDown,y.topKeyPress,y.topKeyUp,y.topMouseDown]},compositionUpdate:{phasedRegistrationNames:{bubbled:d({onCompositionUpdate:null}),captured:d({onCompositionUpdateCapture:null})},dependencies:[y.topBlur,y.topCompositionUpdate,y.topKeyDown,y.topKeyPress,y.topKeyUp,y.topMouseDown]}};i.prototype.getText=function(){return this.root.value||this.root[p()]},i.prototype.getData=function(){var e=this.getText(),t=this.startSelection.start,n=this.startValue.length-this.startSelection.end;return e.substr(t,e.length-n-t)};var C={eventTypes:E,extractEvents:function(e,t,a,u){var c,p;if(m?c=n(e):g?o(e,u)&&(c=E.compositionEnd):r(e,u)&&(c=E.compositionStart),v&&(g||c!==E.compositionStart?c===E.compositionEnd&&g&&(p=g.getData(),g=null):g=new i(t)),c){var d=l.getPooled(c,a,u);return p&&(d.data=p),s.accumulateTwoPhaseDispatches(d),d}}};t.exports=C},{"./EventConstants":17,"./EventPropagators":22,"./ExecutionEnvironment":23,"./ReactInputSelection":63,"./SyntheticCompositionEvent":94,"./getTextContentAccessor":132,"./keyOf":144}],11:[function(e,t){"use strict";function n(e,t,n){e.insertBefore(t,e.childNodes[n]||null)}var r,o=e("./Danger"),i=e("./ReactMultiChildUpdateTypes"),a=e("./getTextContentAccessor"),s=e("./invariant"),u=a();r="textContent"===u?function(e,t){e.textContent=t}:function(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);if(t){var n=e.ownerDocument||document;e.appendChild(n.createTextNode(t))}};var c={dangerouslyReplaceNodeWithMarkup:o.dangerouslyReplaceNodeWithMarkup,updateTextContent:r,processUpdates:function(e,t){for(var a,u=null,c=null,l=0;a=e[l];l++)if(a.type===i.MOVE_EXISTING||a.type===i.REMOVE_NODE){var p=a.fromIndex,d=a.parentNode.childNodes[p],f=a.parentID;s(d),u=u||{},u[f]=u[f]||[],u[f][p]=d,c=c||[],c.push(d)}var h=o.dangerouslyRenderMarkup(t);if(c)for(var m=0;m<c.length;m++)c[m].parentNode.removeChild(c[m]);for(var v=0;a=e[v];v++)switch(a.type){case i.INSERT_MARKUP:n(a.parentNode,h[a.markupIndex],a.toIndex);break;case i.MOVE_EXISTING:n(a.parentNode,u[a.parentID][a.fromIndex],a.toIndex);break;case i.TEXT_CONTENT:r(a.parentNode,a.textContent);break;case i.REMOVE_NODE:}}};t.exports=c},{"./Danger":14,"./ReactMultiChildUpdateTypes":70,"./getTextContentAccessor":132,"./invariant":137}],12:[function(e,t){"use strict";function n(e,t){return(e&t)===t}var r=e("./invariant"),o={MUST_USE_ATTRIBUTE:1,MUST_USE_PROPERTY:2,HAS_SIDE_EFFECTS:4,HAS_BOOLEAN_VALUE:8,HAS_NUMERIC_VALUE:16,HAS_POSITIVE_NUMERIC_VALUE:48,HAS_OVERLOADED_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(e){var t=e.Properties||{},i=e.DOMAttributeNames||{},s=e.DOMPropertyNames||{},u=e.DOMMutationMethods||{};e.isCustomAttribute&&a._isCustomAttributeFunctions.push(e.isCustomAttribute);for(var c in t){r(!a.isStandardName.hasOwnProperty(c)),a.isStandardName[c]=!0;var l=c.toLowerCase();if(a.getPossibleStandardName[l]=c,i.hasOwnProperty(c)){var p=i[c];a.getPossibleStandardName[p]=c,a.getAttributeName[c]=p}else a.getAttributeName[c]=l;a.getPropertyName[c]=s.hasOwnProperty(c)?s[c]:c,a.getMutationMethod[c]=u.hasOwnProperty(c)?u[c]:null;var d=t[c];a.mustUseAttribute[c]=n(d,o.MUST_USE_ATTRIBUTE),a.mustUseProperty[c]=n(d,o.MUST_USE_PROPERTY),a.hasSideEffects[c]=n(d,o.HAS_SIDE_EFFECTS),a.hasBooleanValue[c]=n(d,o.HAS_BOOLEAN_VALUE),a.hasNumericValue[c]=n(d,o.HAS_NUMERIC_VALUE),a.hasPositiveNumericValue[c]=n(d,o.HAS_POSITIVE_NUMERIC_VALUE),a.hasOverloadedBooleanValue[c]=n(d,o.HAS_OVERLOADED_BOOLEAN_VALUE),r(!a.mustUseAttribute[c]||!a.mustUseProperty[c]),r(a.mustUseProperty[c]||!a.hasSideEffects[c]),r(!!a.hasBooleanValue[c]+!!a.hasNumericValue[c]+!!a.hasOverloadedBooleanValue[c]<=1)}}},i={},a={ID_ATTRIBUTE_NAME:"data-reactid",isStandardName:{},getPossibleStandardName:{},getAttributeName:{},getPropertyName:{},getMutationMethod:{},mustUseAttribute:{},mustUseProperty:{},hasSideEffects:{},hasBooleanValue:{},hasNumericValue:{},hasPositiveNumericValue:{},hasOverloadedBooleanValue:{},_isCustomAttributeFunctions:[],isCustomAttribute:function(e){for(var t=0;t<a._isCustomAttributeFunctions.length;t++){var n=a._isCustomAttributeFunctions[t];if(n(e))return!0}return!1},getDefaultValueForProperty:function(e,t){var n,r=i[e];return r||(i[e]=r={}),t in r||(n=document.createElement(e),r[t]=n[t]),r[t]},injection:o};t.exports=a},{"./invariant":137}],13:[function(e,t){"use strict";function n(e,t){return null==t||r.hasBooleanValue[e]&&!t||r.hasNumericValue[e]&&isNaN(t)||r.hasPositiveNumericValue[e]&&1>t||r.hasOverloadedBooleanValue[e]&&t===!1}var r=e("./DOMProperty"),o=e("./escapeTextForBrowser"),i=e("./memoizeStringOnly"),a=(e("./warning"),i(function(e){return o(e)+'="'})),s={createMarkupForID:function(e){return a(r.ID_ATTRIBUTE_NAME)+o(e)+'"'},createMarkupForProperty:function(e,t){if(r.isStandardName.hasOwnProperty(e)&&r.isStandardName[e]){if(n(e,t))return"";var i=r.getAttributeName[e];return r.hasBooleanValue[e]||r.hasOverloadedBooleanValue[e]&&t===!0?o(i):a(i)+o(t)+'"'}return r.isCustomAttribute(e)?null==t?"":a(e)+o(t)+'"':null},setValueForProperty:function(e,t,o){if(r.isStandardName.hasOwnProperty(t)&&r.isStandardName[t]){var i=r.getMutationMethod[t];if(i)i(e,o);else if(n(t,o))this.deleteValueForProperty(e,t);else if(r.mustUseAttribute[t])e.setAttribute(r.getAttributeName[t],""+o);else{var a=r.getPropertyName[t];r.hasSideEffects[t]&&""+e[a]==""+o||(e[a]=o)}}else r.isCustomAttribute(t)&&(null==o?e.removeAttribute(t):e.setAttribute(t,""+o))},deleteValueForProperty:function(e,t){if(r.isStandardName.hasOwnProperty(t)&&r.isStandardName[t]){var n=r.getMutationMethod[t];if(n)n(e,void 0);else if(r.mustUseAttribute[t])e.removeAttribute(r.getAttributeName[t]);else{var o=r.getPropertyName[t],i=r.getDefaultValueForProperty(e.nodeName,o);r.hasSideEffects[t]&&""+e[o]===i||(e[o]=i)}}else r.isCustomAttribute(t)&&e.removeAttribute(t)}};t.exports=s},{"./DOMProperty":12,"./escapeTextForBrowser":120,"./memoizeStringOnly":146,"./warning":155}],14:[function(e,t){"use strict";function n(e){return e.substring(1,e.indexOf(" "))}var r=e("./ExecutionEnvironment"),o=e("./createNodesFromMarkup"),i=e("./emptyFunction"),a=e("./getMarkupWrap"),s=e("./invariant"),u=/^(<[^ \/>]+)/,c="data-danger-index",l={dangerouslyRenderMarkup:function(e){s(r.canUseDOM);for(var t,l={},p=0;p<e.length;p++)s(e[p]),t=n(e[p]),t=a(t)?t:"*",l[t]=l[t]||[],l[t][p]=e[p];var d=[],f=0;for(t in l)if(l.hasOwnProperty(t)){var h=l[t];for(var m in h)if(h.hasOwnProperty(m)){var v=h[m];h[m]=v.replace(u,"$1 "+c+'="'+m+'" ')}var y=o(h.join(""),i);for(p=0;p<y.length;++p){var g=y[p];g.hasAttribute&&g.hasAttribute(c)&&(m=+g.getAttribute(c),g.removeAttribute(c),s(!d.hasOwnProperty(m)),d[m]=g,f+=1)}}return s(f===d.length),s(d.length===e.length),d},dangerouslyReplaceNodeWithMarkup:function(e,t){s(r.canUseDOM),s(t),s("html"!==e.tagName.toLowerCase());var n=o(t,i)[0];e.parentNode.replaceChild(n,e)}};t.exports=l},{"./ExecutionEnvironment":23,"./createNodesFromMarkup":114,"./emptyFunction":118,"./getMarkupWrap":129,"./invariant":137}],15:[function(e,t){"use strict";var n=e("./keyOf"),r=[n({ResponderEventPlugin:null}),n({SimpleEventPlugin:null}),n({TapEventPlugin:null}),n({EnterLeaveEventPlugin:null}),n({ChangeEventPlugin:null}),n({SelectEventPlugin:null}),n({CompositionEventPlugin:null}),n({BeforeInputEventPlugin:null}),n({AnalyticsEventPlugin:null}),n({MobileSafariClickEventPlugin:null})];t.exports=r},{"./keyOf":144}],16:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./EventPropagators"),o=e("./SyntheticMouseEvent"),i=e("./ReactMount"),a=e("./keyOf"),s=n.topLevelTypes,u=i.getFirstReactDOM,c={mouseEnter:{registrationName:a({onMouseEnter:null}),dependencies:[s.topMouseOut,s.topMouseOver]},mouseLeave:{registrationName:a({onMouseLeave:null}),dependencies:[s.topMouseOut,s.topMouseOver]}},l=[null,null],p={eventTypes:c,extractEvents:function(e,t,n,a){if(e===s.topMouseOver&&(a.relatedTarget||a.fromElement))return null;if(e!==s.topMouseOut&&e!==s.topMouseOver)return null;var p;if(t.window===t)p=t;else{var d=t.ownerDocument;p=d?d.defaultView||d.parentWindow:window}var f,h;if(e===s.topMouseOut?(f=t,h=u(a.relatedTarget||a.toElement)||p):(f=p,h=t),f===h)return null;var m=f?i.getID(f):"",v=h?i.getID(h):"",y=o.getPooled(c.mouseLeave,m,a);y.type="mouseleave",y.target=f,y.relatedTarget=h;var g=o.getPooled(c.mouseEnter,v,a);return g.type="mouseenter",g.target=h,g.relatedTarget=f,r.accumulateEnterLeaveDispatches(y,g,m,v),l[0]=y,l[1]=g,l}};t.exports=p},{"./EventConstants":17,"./EventPropagators":22,"./ReactMount":68,"./SyntheticMouseEvent":100,"./keyOf":144}],17:[function(e,t){"use strict";var n=e("./keyMirror"),r=n({bubbled:null,captured:null}),o=n({topBlur:null,topChange:null,topClick:null,topCompositionEnd:null,topCompositionStart:null,topCompositionUpdate:null,topContextMenu:null,topCopy:null,topCut:null,topDoubleClick:null,topDrag:null,topDragEnd:null,topDragEnter:null,topDragExit:null,topDragLeave:null,topDragOver:null,topDragStart:null,topDrop:null,topError:null,topFocus:null,topInput:null,topKeyDown:null,topKeyPress:null,topKeyUp:null,topLoad:null,topMouseDown:null,topMouseMove:null,topMouseOut:null,topMouseOver:null,topMouseUp:null,topPaste:null,topReset:null,topScroll:null,topSelectionChange:null,topSubmit:null,topTextInput:null,topTouchCancel:null,topTouchEnd:null,topTouchMove:null,topTouchStart:null,topWheel:null}),i={topLevelTypes:o,PropagationPhases:r};t.exports=i},{"./keyMirror":143}],18:[function(e,t){var n=e("./emptyFunction"),r={listen:function(e,t,n){return e.addEventListener?(e.addEventListener(t,n,!1),{remove:function(){e.removeEventListener(t,n,!1)}}):e.attachEvent?(e.attachEvent("on"+t,n),{remove:function(){e.detachEvent("on"+t,n)}}):void 0},capture:function(e,t,r){return e.addEventListener?(e.addEventListener(t,r,!0),{remove:function(){e.removeEventListener(t,r,!0)}}):{remove:n}},registerDefault:function(){}};t.exports=r},{"./emptyFunction":118}],19:[function(e,t){"use strict";var n=e("./EventPluginRegistry"),r=e("./EventPluginUtils"),o=e("./accumulateInto"),i=e("./forEachAccumulated"),a=e("./invariant"),s={},u=null,c=function(e){if(e){var t=r.executeDispatch,o=n.getPluginModuleForEvent(e);o&&o.executeDispatch&&(t=o.executeDispatch),r.executeDispatchesInOrder(e,t),e.isPersistent()||e.constructor.release(e)}},l=null,p={injection:{injectMount:r.injection.injectMount,injectInstanceHandle:function(e){l=e},getInstanceHandle:function(){return l},injectEventPluginOrder:n.injectEventPluginOrder,injectEventPluginsByName:n.injectEventPluginsByName},eventNameDispatchConfigs:n.eventNameDispatchConfigs,registrationNameModules:n.registrationNameModules,putListener:function(e,t,n){a(!n||"function"==typeof n);var r=s[t]||(s[t]={});r[e]=n},getListener:function(e,t){var n=s[t];return n&&n[e]},deleteListener:function(e,t){var n=s[t];n&&delete n[e]},deleteAllListeners:function(e){for(var t in s)delete s[t][e]},extractEvents:function(e,t,r,i){for(var a,s=n.plugins,u=0,c=s.length;c>u;u++){var l=s[u];if(l){var p=l.extractEvents(e,t,r,i);p&&(a=o(a,p))}}return a},enqueueEvents:function(e){e&&(u=o(u,e))},processEventQueue:function(){var e=u;u=null,i(e,c),a(!u)},__purge:function(){s={}},__getListenerBank:function(){return s}};t.exports=p},{"./EventPluginRegistry":20,"./EventPluginUtils":21,"./accumulateInto":106,"./forEachAccumulated":123,"./invariant":137}],20:[function(e,t){"use strict";function n(){if(a)for(var e in s){var t=s[e],n=a.indexOf(e);if(i(n>-1),!u.plugins[n]){i(t.extractEvents),u.plugins[n]=t;var o=t.eventTypes;for(var c in o)i(r(o[c],t,c))}}}function r(e,t,n){i(!u.eventNameDispatchConfigs.hasOwnProperty(n)),u.eventNameDispatchConfigs[n]=e;var r=e.phasedRegistrationNames;if(r){for(var a in r)if(r.hasOwnProperty(a)){var s=r[a];o(s,t,n)}return!0}return e.registrationName?(o(e.registrationName,t,n),!0):!1}function o(e,t,n){i(!u.registrationNameModules[e]),u.registrationNameModules[e]=t,u.registrationNameDependencies[e]=t.eventTypes[n].dependencies}var i=e("./invariant"),a=null,s={},u={plugins:[],eventNameDispatchConfigs:{},registrationNameModules:{},registrationNameDependencies:{},injectEventPluginOrder:function(e){i(!a),a=Array.prototype.slice.call(e),n()},injectEventPluginsByName:function(e){var t=!1;for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];s.hasOwnProperty(r)&&s[r]===o||(i(!s[r]),s[r]=o,t=!0)}t&&n()},getPluginModuleForEvent:function(e){var t=e.dispatchConfig;if(t.registrationName)return u.registrationNameModules[t.registrationName]||null;for(var n in t.phasedRegistrationNames)if(t.phasedRegistrationNames.hasOwnProperty(n)){var r=u.registrationNameModules[t.phasedRegistrationNames[n]];if(r)return r}return null},_resetEventPlugins:function(){a=null;for(var e in s)s.hasOwnProperty(e)&&delete s[e];u.plugins.length=0;var t=u.eventNameDispatchConfigs;for(var n in t)t.hasOwnProperty(n)&&delete t[n];var r=u.registrationNameModules;for(var o in r)r.hasOwnProperty(o)&&delete r[o]}};t.exports=u},{"./invariant":137}],21:[function(e,t){"use strict";function n(e){return e===m.topMouseUp||e===m.topTouchEnd||e===m.topTouchCancel}function r(e){return e===m.topMouseMove||e===m.topTouchMove}function o(e){return e===m.topMouseDown||e===m.topTouchStart}function i(e,t){var n=e._dispatchListeners,r=e._dispatchIDs;if(Array.isArray(n))for(var o=0;o<n.length&&!e.isPropagationStopped();o++)t(e,n[o],r[o]);else n&&t(e,n,r)}function a(e,t,n){e.currentTarget=h.Mount.getNode(n);var r=t(e,n);return e.currentTarget=null,r}function s(e,t){i(e,t),e._dispatchListeners=null,e._dispatchIDs=null}function u(e){var t=e._dispatchListeners,n=e._dispatchIDs;if(Array.isArray(t)){for(var r=0;r<t.length&&!e.isPropagationStopped();r++)if(t[r](e,n[r]))return n[r]}else if(t&&t(e,n))return n;return null}function c(e){var t=u(e);return e._dispatchIDs=null,e._dispatchListeners=null,t}function l(e){var t=e._dispatchListeners,n=e._dispatchIDs;f(!Array.isArray(t));var r=t?t(e,n):null;return e._dispatchListeners=null,e._dispatchIDs=null,r}function p(e){return!!e._dispatchListeners}var d=e("./EventConstants"),f=e("./invariant"),h={Mount:null,injectMount:function(e){h.Mount=e}},m=d.topLevelTypes,v={isEndish:n,isMoveish:r,isStartish:o,executeDirectDispatch:l,executeDispatch:a,executeDispatchesInOrder:s,executeDispatchesInOrderStopAtTrue:c,hasDispatches:p,injection:h,useTouchEvents:!1};t.exports=v},{"./EventConstants":17,"./invariant":137}],22:[function(e,t){"use strict";function n(e,t,n){var r=t.dispatchConfig.phasedRegistrationNames[n];return m(e,r)}function r(e,t,r){var o=t?h.bubbled:h.captured,i=n(e,r,o);i&&(r._dispatchListeners=d(r._dispatchListeners,i),r._dispatchIDs=d(r._dispatchIDs,e))}function o(e){e&&e.dispatchConfig.phasedRegistrationNames&&p.injection.getInstanceHandle().traverseTwoPhase(e.dispatchMarker,r,e)}function i(e,t,n){if(n&&n.dispatchConfig.registrationName){var r=n.dispatchConfig.registrationName,o=m(e,r);o&&(n._dispatchListeners=d(n._dispatchListeners,o),n._dispatchIDs=d(n._dispatchIDs,e))}}function a(e){e&&e.dispatchConfig.registrationName&&i(e.dispatchMarker,null,e)}function s(e){f(e,o)}function u(e,t,n,r){p.injection.getInstanceHandle().traverseEnterLeave(n,r,i,e,t)}function c(e){f(e,a)}var l=e("./EventConstants"),p=e("./EventPluginHub"),d=e("./accumulateInto"),f=e("./forEachAccumulated"),h=l.PropagationPhases,m=p.getListener,v={accumulateTwoPhaseDispatches:s,accumulateDirectDispatches:c,accumulateEnterLeaveDispatches:u};t.exports=v},{"./EventConstants":17,"./EventPluginHub":19,"./accumulateInto":106,"./forEachAccumulated":123}],23:[function(e,t){"use strict";var n=!("undefined"==typeof window||!window.document||!window.document.createElement),r={canUseDOM:n,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:n&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};t.exports=r},{}],24:[function(e,t){"use strict";var n,r=e("./DOMProperty"),o=e("./ExecutionEnvironment"),i=r.injection.MUST_USE_ATTRIBUTE,a=r.injection.MUST_USE_PROPERTY,s=r.injection.HAS_BOOLEAN_VALUE,u=r.injection.HAS_SIDE_EFFECTS,c=r.injection.HAS_NUMERIC_VALUE,l=r.injection.HAS_POSITIVE_NUMERIC_VALUE,p=r.injection.HAS_OVERLOADED_BOOLEAN_VALUE;if(o.canUseDOM){var d=document.implementation;n=d&&d.hasFeature&&d.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")}var f={isCustomAttribute:RegExp.prototype.test.bind(/^(data|aria)-[a-z_][a-z\d_.\-]*$/),Properties:{accept:null,acceptCharset:null,accessKey:null,action:null,allowFullScreen:i|s,allowTransparency:i,alt:null,async:s,autoComplete:null,autoPlay:s,cellPadding:null,cellSpacing:null,charSet:i,checked:a|s,classID:i,className:n?i:a,cols:i|l,colSpan:null,content:null,contentEditable:null,contextMenu:i,controls:a|s,coords:null,crossOrigin:null,data:null,dateTime:i,defer:s,dir:null,disabled:i|s,download:p,draggable:null,encType:null,form:i,formNoValidate:s,frameBorder:i,height:i,hidden:i|s,href:null,hrefLang:null,htmlFor:null,httpEquiv:null,icon:null,id:a,label:null,lang:null,list:i,loop:a|s,manifest:i,max:null,maxLength:i,media:i,mediaGroup:null,method:null,min:null,multiple:a|s,muted:a|s,name:null,noValidate:s,open:null,pattern:null,placeholder:null,poster:null,preload:null,radioGroup:null,readOnly:a|s,rel:null,required:s,role:i,rows:i|l,rowSpan:null,sandbox:null,scope:null,scrolling:null,seamless:i|s,selected:a|s,shape:null,size:i|l,sizes:i,span:l,spellCheck:null,src:null,srcDoc:a,srcSet:i,start:c,step:null,style:null,tabIndex:null,target:null,title:null,type:null,useMap:null,value:a|u,width:i,wmode:i,autoCapitalize:null,autoCorrect:null,itemProp:i,itemScope:i|s,itemType:i,property:null},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMPropertyNames:{autoCapitalize:"autocapitalize",autoComplete:"autocomplete",autoCorrect:"autocorrect",autoFocus:"autofocus",autoPlay:"autoplay",encType:"enctype",hrefLang:"hreflang",radioGroup:"radiogroup",spellCheck:"spellcheck",srcDoc:"srcdoc",srcSet:"srcset"}};t.exports=f},{"./DOMProperty":12,"./ExecutionEnvironment":23}],25:[function(e,t){"use strict";var n=e("./ReactLink"),r=e("./ReactStateSetters"),o={linkState:function(e){return new n(this.state[e],r.createStateKeySetter(this,e))}};t.exports=o},{"./ReactLink":66,"./ReactStateSetters":83}],26:[function(e,t){"use strict";function n(e){u(null==e.props.checkedLink||null==e.props.valueLink)}function r(e){n(e),u(null==e.props.value&&null==e.props.onChange)}function o(e){n(e),u(null==e.props.checked&&null==e.props.onChange)}function i(e){this.props.valueLink.requestChange(e.target.value)}function a(e){this.props.checkedLink.requestChange(e.target.checked)}var s=e("./ReactPropTypes"),u=e("./invariant"),c={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},l={Mixin:{propTypes:{value:function(e,t){return!e[t]||c[e.type]||e.onChange||e.readOnly||e.disabled?void 0:new Error("You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`.")},checked:function(e,t){return!e[t]||e.onChange||e.readOnly||e.disabled?void 0:new Error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")},onChange:s.func}},getValue:function(e){return e.props.valueLink?(r(e),e.props.valueLink.value):e.props.value},getChecked:function(e){return e.props.checkedLink?(o(e),e.props.checkedLink.value):e.props.checked},getOnChange:function(e){return e.props.valueLink?(r(e),i):e.props.checkedLink?(o(e),a):e.props.onChange}};t.exports=l},{"./ReactPropTypes":77,"./invariant":137}],27:[function(e,t){"use strict";function n(e){e.remove()}var r=e("./ReactBrowserEventEmitter"),o=e("./accumulateInto"),i=e("./forEachAccumulated"),a=e("./invariant"),s={trapBubbledEvent:function(e,t){a(this.isMounted());var n=r.trapBubbledEvent(e,t,this.getDOMNode());this._localEventListeners=o(this._localEventListeners,n)},componentWillUnmount:function(){this._localEventListeners&&i(this._localEventListeners,n)}};t.exports=s},{"./ReactBrowserEventEmitter":33,"./accumulateInto":106,"./forEachAccumulated":123,"./invariant":137}],28:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./emptyFunction"),o=n.topLevelTypes,i={eventTypes:null,extractEvents:function(e,t,n,i){if(e===o.topTouchStart){var a=i.target;a&&!a.onclick&&(a.onclick=r)}}};t.exports=i},{"./EventConstants":17,"./emptyFunction":118}],29:[function(e,t){function n(e){if(null==e)throw new TypeError("Object.assign target cannot be null or undefined");for(var t=Object(e),n=Object.prototype.hasOwnProperty,r=1;r<arguments.length;r++){var o=arguments[r];if(null!=o){var i=Object(o);for(var a in i)n.call(i,a)&&(t[a]=i[a])}}return t}t.exports=n},{}],30:[function(e,t){"use strict";var n=e("./invariant"),r=function(e){var t=this;if(t.instancePool.length){var n=t.instancePool.pop();return t.call(n,e),n}return new t(e)},o=function(e,t){var n=this;if(n.instancePool.length){var r=n.instancePool.pop();return n.call(r,e,t),r}return new n(e,t)},i=function(e,t,n){var r=this;if(r.instancePool.length){var o=r.instancePool.pop();return r.call(o,e,t,n),o}return new r(e,t,n)},a=function(e,t,n,r,o){var i=this;if(i.instancePool.length){var a=i.instancePool.pop();return i.call(a,e,t,n,r,o),a}return new i(e,t,n,r,o)},s=function(e){var t=this;n(e instanceof t),e.destructor&&e.destructor(),t.instancePool.length<t.poolSize&&t.instancePool.push(e)},u=10,c=r,l=function(e,t){var n=e;return n.instancePool=[],n.getPooled=t||c,n.poolSize||(n.poolSize=u),n.release=s,n},p={addPoolingTo:l,oneArgumentPooler:r,twoArgumentPooler:o,threeArgumentPooler:i,fiveArgumentPooler:a};t.exports=p},{"./invariant":137}],31:[function(e,t){"use strict";var n=e("./DOMPropertyOperations"),r=e("./EventPluginUtils"),o=e("./ReactChildren"),i=e("./ReactComponent"),a=e("./ReactCompositeComponent"),s=e("./ReactContext"),u=e("./ReactCurrentOwner"),c=e("./ReactElement"),l=(e("./ReactElementValidator"),e("./ReactDOM")),p=e("./ReactDOMComponent"),d=e("./ReactDefaultInjection"),f=e("./ReactInstanceHandles"),h=e("./ReactLegacyElement"),m=e("./ReactMount"),v=e("./ReactMultiChild"),y=e("./ReactPerf"),g=e("./ReactPropTypes"),E=e("./ReactServerRendering"),C=e("./ReactTextComponent"),R=e("./Object.assign"),M=e("./deprecated"),b=e("./onlyChild");d.inject();var O=c.createElement,D=c.createFactory;O=h.wrapCreateElement(O),D=h.wrapCreateFactory(D);var x=y.measure("React","render",m.render),P={Children:{map:o.map,forEach:o.forEach,count:o.count,only:b},DOM:l,PropTypes:g,initializeTouchEvents:function(e){r.useTouchEvents=e},createClass:a.createClass,createElement:O,createFactory:D,constructAndRenderComponent:m.constructAndRenderComponent,constructAndRenderComponentByID:m.constructAndRenderComponentByID,render:x,renderToString:E.renderToString,renderToStaticMarkup:E.renderToStaticMarkup,unmountComponentAtNode:m.unmountComponentAtNode,isValidClass:h.isValidClass,isValidElement:c.isValidElement,withContext:s.withContext,__spread:R,renderComponent:M("React","renderComponent","render",this,x),renderComponentToString:M("React","renderComponentToString","renderToString",this,E.renderToString),renderComponentToStaticMarkup:M("React","renderComponentToStaticMarkup","renderToStaticMarkup",this,E.renderToStaticMarkup),isValidComponent:M("React","isValidComponent","isValidElement",this,c.isValidElement)};"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.inject&&__REACT_DEVTOOLS_GLOBAL_HOOK__.inject({Component:i,CurrentOwner:u,DOMComponent:p,DOMPropertyOperations:n,InstanceHandles:f,Mount:m,MultiChild:v,TextComponent:C}),P.version="0.12.1",t.exports=P},{"./DOMPropertyOperations":13,"./EventPluginUtils":21,"./Object.assign":29,"./ReactChildren":36,"./ReactComponent":37,"./ReactCompositeComponent":40,"./ReactContext":41,"./ReactCurrentOwner":42,"./ReactDOM":43,"./ReactDOMComponent":45,"./ReactDefaultInjection":55,"./ReactElement":56,"./ReactElementValidator":57,"./ReactInstanceHandles":64,"./ReactLegacyElement":65,"./ReactMount":68,"./ReactMultiChild":69,"./ReactPerf":73,"./ReactPropTypes":77,"./ReactServerRendering":81,"./ReactTextComponent":84,"./deprecated":117,"./onlyChild":148}],32:[function(e,t){"use strict";var n=e("./ReactEmptyComponent"),r=e("./ReactMount"),o=e("./invariant"),i={getDOMNode:function(){return o(this.isMounted()),n.isNullComponentID(this._rootNodeID)?null:r.getNode(this._rootNodeID)}};t.exports=i},{"./ReactEmptyComponent":58,"./ReactMount":68,"./invariant":137}],33:[function(e,t){"use strict";function n(e){return Object.prototype.hasOwnProperty.call(e,h)||(e[h]=d++,l[e[h]]={}),l[e[h]]}var r=e("./EventConstants"),o=e("./EventPluginHub"),i=e("./EventPluginRegistry"),a=e("./ReactEventEmitterMixin"),s=e("./ViewportMetrics"),u=e("./Object.assign"),c=e("./isEventSupported"),l={},p=!1,d=0,f={topBlur:"blur",topChange:"change",topClick:"click",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTextInput:"textInput",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topWheel:"wheel"},h="_reactListenersID"+String(Math.random()).slice(2),m=u({},a,{ReactEventListener:null,injection:{injectReactEventListener:function(e){e.setHandleTopLevel(m.handleTopLevel),m.ReactEventListener=e}},setEnabled:function(e){m.ReactEventListener&&m.ReactEventListener.setEnabled(e)},isEnabled:function(){return!(!m.ReactEventListener||!m.ReactEventListener.isEnabled())},listenTo:function(e,t){for(var o=t,a=n(o),s=i.registrationNameDependencies[e],u=r.topLevelTypes,l=0,p=s.length;p>l;l++){var d=s[l];a.hasOwnProperty(d)&&a[d]||(d===u.topWheel?c("wheel")?m.ReactEventListener.trapBubbledEvent(u.topWheel,"wheel",o):c("mousewheel")?m.ReactEventListener.trapBubbledEvent(u.topWheel,"mousewheel",o):m.ReactEventListener.trapBubbledEvent(u.topWheel,"DOMMouseScroll",o):d===u.topScroll?c("scroll",!0)?m.ReactEventListener.trapCapturedEvent(u.topScroll,"scroll",o):m.ReactEventListener.trapBubbledEvent(u.topScroll,"scroll",m.ReactEventListener.WINDOW_HANDLE):d===u.topFocus||d===u.topBlur?(c("focus",!0)?(m.ReactEventListener.trapCapturedEvent(u.topFocus,"focus",o),m.ReactEventListener.trapCapturedEvent(u.topBlur,"blur",o)):c("focusin")&&(m.ReactEventListener.trapBubbledEvent(u.topFocus,"focusin",o),m.ReactEventListener.trapBubbledEvent(u.topBlur,"focusout",o)),a[u.topBlur]=!0,a[u.topFocus]=!0):f.hasOwnProperty(d)&&m.ReactEventListener.trapBubbledEvent(d,f[d],o),a[d]=!0)}},trapBubbledEvent:function(e,t,n){return m.ReactEventListener.trapBubbledEvent(e,t,n)},trapCapturedEvent:function(e,t,n){return m.ReactEventListener.trapCapturedEvent(e,t,n)},ensureScrollValueMonitoring:function(){if(!p){var e=s.refreshScrollValues;m.ReactEventListener.monitorScrollValue(e),p=!0}},eventNameDispatchConfigs:o.eventNameDispatchConfigs,registrationNameModules:o.registrationNameModules,putListener:o.putListener,getListener:o.getListener,deleteListener:o.deleteListener,deleteAllListeners:o.deleteAllListeners});
t.exports=m},{"./EventConstants":17,"./EventPluginHub":19,"./EventPluginRegistry":20,"./Object.assign":29,"./ReactEventEmitterMixin":60,"./ViewportMetrics":105,"./isEventSupported":138}],34:[function(e,t){"use strict";var n=e("./React"),r=e("./Object.assign"),o=n.createFactory(e("./ReactTransitionGroup")),i=n.createFactory(e("./ReactCSSTransitionGroupChild")),a=n.createClass({displayName:"ReactCSSTransitionGroup",propTypes:{transitionName:n.PropTypes.string.isRequired,transitionEnter:n.PropTypes.bool,transitionLeave:n.PropTypes.bool},getDefaultProps:function(){return{transitionEnter:!0,transitionLeave:!0}},_wrapChild:function(e){return i({name:this.props.transitionName,enter:this.props.transitionEnter,leave:this.props.transitionLeave},e)},render:function(){return o(r({},this.props,{childFactory:this._wrapChild}))}});t.exports=a},{"./Object.assign":29,"./React":31,"./ReactCSSTransitionGroupChild":35,"./ReactTransitionGroup":87}],35:[function(e,t){"use strict";var n=e("./React"),r=e("./CSSCore"),o=e("./ReactTransitionEvents"),i=e("./onlyChild"),a=17,s=n.createClass({displayName:"ReactCSSTransitionGroupChild",transition:function(e,t){var n=this.getDOMNode(),i=this.props.name+"-"+e,a=i+"-active",s=function(e){e&&e.target!==n||(r.removeClass(n,i),r.removeClass(n,a),o.removeEndEventListener(n,s),t&&t())};o.addEndEventListener(n,s),r.addClass(n,i),this.queueClass(a)},queueClass:function(e){this.classNameQueue.push(e),this.timeout||(this.timeout=setTimeout(this.flushClassNameQueue,a))},flushClassNameQueue:function(){this.isMounted()&&this.classNameQueue.forEach(r.addClass.bind(r,this.getDOMNode())),this.classNameQueue.length=0,this.timeout=null},componentWillMount:function(){this.classNameQueue=[]},componentWillUnmount:function(){this.timeout&&clearTimeout(this.timeout)},componentWillEnter:function(e){this.props.enter?this.transition("enter",e):e()},componentWillLeave:function(e){this.props.leave?this.transition("leave",e):e()},render:function(){return i(this.props.children)}});t.exports=s},{"./CSSCore":4,"./React":31,"./ReactTransitionEvents":86,"./onlyChild":148}],36:[function(e,t){"use strict";function n(e,t){this.forEachFunction=e,this.forEachContext=t}function r(e,t,n,r){var o=e;o.forEachFunction.call(o.forEachContext,t,r)}function o(e,t,o){if(null==e)return e;var i=n.getPooled(t,o);p(e,r,i),n.release(i)}function i(e,t,n){this.mapResult=e,this.mapFunction=t,this.mapContext=n}function a(e,t,n,r){var o=e,i=o.mapResult,a=!i.hasOwnProperty(n);if(a){var s=o.mapFunction.call(o.mapContext,t,r);i[n]=s}}function s(e,t,n){if(null==e)return e;var r={},o=i.getPooled(r,t,n);return p(e,a,o),i.release(o),r}function u(){return null}function c(e){return p(e,u,null)}var l=e("./PooledClass"),p=e("./traverseAllChildren"),d=(e("./warning"),l.twoArgumentPooler),f=l.threeArgumentPooler;l.addPoolingTo(n,d),l.addPoolingTo(i,f);var h={forEach:o,map:s,count:c};t.exports=h},{"./PooledClass":30,"./traverseAllChildren":153,"./warning":155}],37:[function(e,t){"use strict";var n=e("./ReactElement"),r=e("./ReactOwner"),o=e("./ReactUpdates"),i=e("./Object.assign"),a=e("./invariant"),s=e("./keyMirror"),u=s({MOUNTED:null,UNMOUNTED:null}),c=!1,l=null,p=null,d={injection:{injectEnvironment:function(e){a(!c),p=e.mountImageIntoNode,l=e.unmountIDFromEnvironment,d.BackendIDOperations=e.BackendIDOperations,c=!0}},LifeCycle:u,BackendIDOperations:null,Mixin:{isMounted:function(){return this._lifeCycleState===u.MOUNTED},setProps:function(e,t){var n=this._pendingElement||this._currentElement;this.replaceProps(i({},n.props,e),t)},replaceProps:function(e,t){a(this.isMounted()),a(0===this._mountDepth),this._pendingElement=n.cloneAndReplaceProps(this._pendingElement||this._currentElement,e),o.enqueueUpdate(this,t)},_setPropsInternal:function(e,t){var r=this._pendingElement||this._currentElement;this._pendingElement=n.cloneAndReplaceProps(r,i({},r.props,e)),o.enqueueUpdate(this,t)},construct:function(e){this.props=e.props,this._owner=e._owner,this._lifeCycleState=u.UNMOUNTED,this._pendingCallbacks=null,this._currentElement=e,this._pendingElement=null},mountComponent:function(e,t,n){a(!this.isMounted());var o=this._currentElement.ref;if(null!=o){var i=this._currentElement._owner;r.addComponentAsRefTo(this,o,i)}this._rootNodeID=e,this._lifeCycleState=u.MOUNTED,this._mountDepth=n},unmountComponent:function(){a(this.isMounted());var e=this._currentElement.ref;null!=e&&r.removeComponentAsRefFrom(this,e,this._owner),l(this._rootNodeID),this._rootNodeID=null,this._lifeCycleState=u.UNMOUNTED},receiveComponent:function(e,t){a(this.isMounted()),this._pendingElement=e,this.performUpdateIfNecessary(t)},performUpdateIfNecessary:function(e){if(null!=this._pendingElement){var t=this._currentElement,n=this._pendingElement;this._currentElement=n,this.props=n.props,this._owner=n._owner,this._pendingElement=null,this.updateComponent(e,t)}},updateComponent:function(e,t){var n=this._currentElement;(n._owner!==t._owner||n.ref!==t.ref)&&(null!=t.ref&&r.removeComponentAsRefFrom(this,t.ref,t._owner),null!=n.ref&&r.addComponentAsRefTo(this,n.ref,n._owner))},mountComponentIntoNode:function(e,t,n){var r=o.ReactReconcileTransaction.getPooled();r.perform(this._mountComponentIntoNode,this,e,t,r,n),o.ReactReconcileTransaction.release(r)},_mountComponentIntoNode:function(e,t,n,r){var o=this.mountComponent(e,n,0);p(o,t,r)},isOwnedBy:function(e){return this._owner===e},getSiblingByRef:function(e){var t=this._owner;return t&&t.refs?t.refs[e]:null}}};t.exports=d},{"./Object.assign":29,"./ReactElement":56,"./ReactOwner":72,"./ReactUpdates":88,"./invariant":137,"./keyMirror":143}],38:[function(e,t){"use strict";var n=e("./ReactDOMIDOperations"),r=e("./ReactMarkupChecksum"),o=e("./ReactMount"),i=e("./ReactPerf"),a=e("./ReactReconcileTransaction"),s=e("./getReactRootElementInContainer"),u=e("./invariant"),c=e("./setInnerHTML"),l=1,p=9,d={ReactReconcileTransaction:a,BackendIDOperations:n,unmountIDFromEnvironment:function(e){o.purgeID(e)},mountImageIntoNode:i.measure("ReactComponentBrowserEnvironment","mountImageIntoNode",function(e,t,n){if(u(t&&(t.nodeType===l||t.nodeType===p)),n){if(r.canReuseMarkup(e,s(t)))return;u(t.nodeType!==p)}u(t.nodeType!==p),c(t,e)})};t.exports=d},{"./ReactDOMIDOperations":47,"./ReactMarkupChecksum":67,"./ReactMount":68,"./ReactPerf":73,"./ReactReconcileTransaction":79,"./getReactRootElementInContainer":131,"./invariant":137,"./setInnerHTML":149}],39:[function(e,t){"use strict";var n=e("./shallowEqual"),r={shouldComponentUpdate:function(e,t){return!n(this.props,e)||!n(this.state,t)}};t.exports=r},{"./shallowEqual":150}],40:[function(e,t){"use strict";function n(e){var t=e._owner||null;return t&&t.constructor&&t.constructor.displayName?" Check the render method of `"+t.constructor.displayName+"`.":""}function r(e,t){for(var n in t)t.hasOwnProperty(n)&&D("function"==typeof t[n])}function o(e,t){var n=I.hasOwnProperty(t)?I[t]:null;L.hasOwnProperty(t)&&D(n===S.OVERRIDE_BASE),e.hasOwnProperty(t)&&D(n===S.DEFINE_MANY||n===S.DEFINE_MANY_MERGED)}function i(e){var t=e._compositeLifeCycleState;D(e.isMounted()||t===A.MOUNTING),D(null==f.current),D(t!==A.UNMOUNTING)}function a(e,t){if(t){D(!y.isValidFactory(t)),D(!h.isValidElement(t));var n=e.prototype;t.hasOwnProperty(_)&&k.mixins(e,t.mixins);for(var r in t)if(t.hasOwnProperty(r)&&r!==_){var i=t[r];if(o(n,r),k.hasOwnProperty(r))k[r](e,i);else{var a=I.hasOwnProperty(r),s=n.hasOwnProperty(r),u=i&&i.__reactDontBind,p="function"==typeof i,d=p&&!a&&!s&&!u;if(d)n.__reactAutoBindMap||(n.__reactAutoBindMap={}),n.__reactAutoBindMap[r]=i,n[r]=i;else if(s){var f=I[r];D(a&&(f===S.DEFINE_MANY_MERGED||f===S.DEFINE_MANY)),f===S.DEFINE_MANY_MERGED?n[r]=c(n[r],i):f===S.DEFINE_MANY&&(n[r]=l(n[r],i))}else n[r]=i}}}}function s(e,t){if(t)for(var n in t){var r=t[n];if(t.hasOwnProperty(n)){var o=n in k;D(!o);var i=n in e;D(!i),e[n]=r}}}function u(e,t){return D(e&&t&&"object"==typeof e&&"object"==typeof t),T(t,function(t,n){D(void 0===e[n]),e[n]=t}),e}function c(e,t){return function(){var n=e.apply(this,arguments),r=t.apply(this,arguments);return null==n?r:null==r?n:u(n,r)}}function l(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}var p=e("./ReactComponent"),d=e("./ReactContext"),f=e("./ReactCurrentOwner"),h=e("./ReactElement"),m=(e("./ReactElementValidator"),e("./ReactEmptyComponent")),v=e("./ReactErrorUtils"),y=e("./ReactLegacyElement"),g=e("./ReactOwner"),E=e("./ReactPerf"),C=e("./ReactPropTransferer"),R=e("./ReactPropTypeLocations"),M=(e("./ReactPropTypeLocationNames"),e("./ReactUpdates")),b=e("./Object.assign"),O=e("./instantiateReactComponent"),D=e("./invariant"),x=e("./keyMirror"),P=e("./keyOf"),T=(e("./monitorCodeUse"),e("./mapObject")),w=e("./shouldUpdateReactComponent"),_=(e("./warning"),P({mixins:null})),S=x({DEFINE_ONCE:null,DEFINE_MANY:null,OVERRIDE_BASE:null,DEFINE_MANY_MERGED:null}),N=[],I={mixins:S.DEFINE_MANY,statics:S.DEFINE_MANY,propTypes:S.DEFINE_MANY,contextTypes:S.DEFINE_MANY,childContextTypes:S.DEFINE_MANY,getDefaultProps:S.DEFINE_MANY_MERGED,getInitialState:S.DEFINE_MANY_MERGED,getChildContext:S.DEFINE_MANY_MERGED,render:S.DEFINE_ONCE,componentWillMount:S.DEFINE_MANY,componentDidMount:S.DEFINE_MANY,componentWillReceiveProps:S.DEFINE_MANY,shouldComponentUpdate:S.DEFINE_ONCE,componentWillUpdate:S.DEFINE_MANY,componentDidUpdate:S.DEFINE_MANY,componentWillUnmount:S.DEFINE_MANY,updateComponent:S.OVERRIDE_BASE},k={displayName:function(e,t){e.displayName=t},mixins:function(e,t){if(t)for(var n=0;n<t.length;n++)a(e,t[n])},childContextTypes:function(e,t){r(e,t,R.childContext),e.childContextTypes=b({},e.childContextTypes,t)},contextTypes:function(e,t){r(e,t,R.context),e.contextTypes=b({},e.contextTypes,t)},getDefaultProps:function(e,t){e.getDefaultProps=e.getDefaultProps?c(e.getDefaultProps,t):t},propTypes:function(e,t){r(e,t,R.prop),e.propTypes=b({},e.propTypes,t)},statics:function(e,t){s(e,t)}},A=x({MOUNTING:null,UNMOUNTING:null,RECEIVING_PROPS:null}),L={construct:function(){p.Mixin.construct.apply(this,arguments),g.Mixin.construct.apply(this,arguments),this.state=null,this._pendingState=null,this.context=null,this._compositeLifeCycleState=null},isMounted:function(){return p.Mixin.isMounted.call(this)&&this._compositeLifeCycleState!==A.MOUNTING},mountComponent:E.measure("ReactCompositeComponent","mountComponent",function(e,t,n){p.Mixin.mountComponent.call(this,e,t,n),this._compositeLifeCycleState=A.MOUNTING,this.__reactAutoBindMap&&this._bindAutoBindMethods(),this.context=this._processContext(this._currentElement._context),this.props=this._processProps(this.props),this.state=this.getInitialState?this.getInitialState():null,D("object"==typeof this.state&&!Array.isArray(this.state)),this._pendingState=null,this._pendingForceUpdate=!1,this.componentWillMount&&(this.componentWillMount(),this._pendingState&&(this.state=this._pendingState,this._pendingState=null)),this._renderedComponent=O(this._renderValidatedComponent(),this._currentElement.type),this._compositeLifeCycleState=null;var r=this._renderedComponent.mountComponent(e,t,n+1);return this.componentDidMount&&t.getReactMountReady().enqueue(this.componentDidMount,this),r}),unmountComponent:function(){this._compositeLifeCycleState=A.UNMOUNTING,this.componentWillUnmount&&this.componentWillUnmount(),this._compositeLifeCycleState=null,this._renderedComponent.unmountComponent(),this._renderedComponent=null,p.Mixin.unmountComponent.call(this)},setState:function(e,t){D("object"==typeof e||null==e),this.replaceState(b({},this._pendingState||this.state,e),t)},replaceState:function(e,t){i(this),this._pendingState=e,this._compositeLifeCycleState!==A.MOUNTING&&M.enqueueUpdate(this,t)},_processContext:function(e){var t=null,n=this.constructor.contextTypes;if(n){t={};for(var r in n)t[r]=e[r]}return t},_processChildContext:function(e){var t=this.getChildContext&&this.getChildContext();if(this.constructor.displayName||"ReactCompositeComponent",t){D("object"==typeof this.constructor.childContextTypes);for(var n in t)D(n in this.constructor.childContextTypes);return b({},e,t)}return e},_processProps:function(e){return e},_checkPropTypes:function(e,t,r){var o=this.constructor.displayName;for(var i in e)if(e.hasOwnProperty(i)){var a=e[i](t,i,o,r);a instanceof Error&&n(this)}},performUpdateIfNecessary:function(e){var t=this._compositeLifeCycleState;if(t!==A.MOUNTING&&t!==A.RECEIVING_PROPS&&(null!=this._pendingElement||null!=this._pendingState||this._pendingForceUpdate)){var n=this.context,r=this.props,o=this._currentElement;null!=this._pendingElement&&(o=this._pendingElement,n=this._processContext(o._context),r=this._processProps(o.props),this._pendingElement=null,this._compositeLifeCycleState=A.RECEIVING_PROPS,this.componentWillReceiveProps&&this.componentWillReceiveProps(r,n)),this._compositeLifeCycleState=null;var i=this._pendingState||this.state;this._pendingState=null;var a=this._pendingForceUpdate||!this.shouldComponentUpdate||this.shouldComponentUpdate(r,i,n);a?(this._pendingForceUpdate=!1,this._performComponentUpdate(o,r,i,n,e)):(this._currentElement=o,this.props=r,this.state=i,this.context=n,this._owner=o._owner)}},_performComponentUpdate:function(e,t,n,r,o){var i=this._currentElement,a=this.props,s=this.state,u=this.context;this.componentWillUpdate&&this.componentWillUpdate(t,n,r),this._currentElement=e,this.props=t,this.state=n,this.context=r,this._owner=e._owner,this.updateComponent(o,i),this.componentDidUpdate&&o.getReactMountReady().enqueue(this.componentDidUpdate.bind(this,a,s,u),this)},receiveComponent:function(e,t){(e!==this._currentElement||null==e._owner)&&p.Mixin.receiveComponent.call(this,e,t)},updateComponent:E.measure("ReactCompositeComponent","updateComponent",function(e,t){p.Mixin.updateComponent.call(this,e,t);var n=this._renderedComponent,r=n._currentElement,o=this._renderValidatedComponent();if(w(r,o))n.receiveComponent(o,e);else{var i=this._rootNodeID,a=n._rootNodeID;n.unmountComponent(),this._renderedComponent=O(o,this._currentElement.type);var s=this._renderedComponent.mountComponent(i,e,this._mountDepth+1);p.BackendIDOperations.dangerouslyReplaceNodeWithMarkupByID(a,s)}}),forceUpdate:function(e){var t=this._compositeLifeCycleState;D(this.isMounted()||t===A.MOUNTING),D(t!==A.UNMOUNTING&&null==f.current),this._pendingForceUpdate=!0,M.enqueueUpdate(this,e)},_renderValidatedComponent:E.measure("ReactCompositeComponent","_renderValidatedComponent",function(){var e,t=d.current;d.current=this._processChildContext(this._currentElement._context),f.current=this;try{e=this.render(),null===e||e===!1?(e=m.getEmptyComponent(),m.registerNullComponentID(this._rootNodeID)):m.deregisterNullComponentID(this._rootNodeID)}finally{d.current=t,f.current=null}return D(h.isValidElement(e)),e}),_bindAutoBindMethods:function(){for(var e in this.__reactAutoBindMap)if(this.__reactAutoBindMap.hasOwnProperty(e)){var t=this.__reactAutoBindMap[e];this[e]=this._bindAutoBindMethod(v.guard(t,this.constructor.displayName+"."+e))}},_bindAutoBindMethod:function(e){var t=this,n=e.bind(t);return n}},U=function(){};b(U.prototype,p.Mixin,g.Mixin,C.Mixin,L);var F={LifeCycle:A,Base:U,createClass:function(e){var t=function(){};t.prototype=new U,t.prototype.constructor=t,N.forEach(a.bind(null,t)),a(t,e),t.getDefaultProps&&(t.defaultProps=t.getDefaultProps()),D(t.prototype.render);for(var n in I)t.prototype[n]||(t.prototype[n]=null);return y.wrapFactory(h.createFactory(t))},injection:{injectMixin:function(e){N.push(e)}}};t.exports=F},{"./Object.assign":29,"./ReactComponent":37,"./ReactContext":41,"./ReactCurrentOwner":42,"./ReactElement":56,"./ReactElementValidator":57,"./ReactEmptyComponent":58,"./ReactErrorUtils":59,"./ReactLegacyElement":65,"./ReactOwner":72,"./ReactPerf":73,"./ReactPropTransferer":74,"./ReactPropTypeLocationNames":75,"./ReactPropTypeLocations":76,"./ReactUpdates":88,"./instantiateReactComponent":136,"./invariant":137,"./keyMirror":143,"./keyOf":144,"./mapObject":145,"./monitorCodeUse":147,"./shouldUpdateReactComponent":151,"./warning":155}],41:[function(e,t){"use strict";var n=e("./Object.assign"),r={current:{},withContext:function(e,t){var o,i=r.current;r.current=n({},i,e);try{o=t()}finally{r.current=i}return o}};t.exports=r},{"./Object.assign":29}],42:[function(e,t){"use strict";var n={current:null};t.exports=n},{}],43:[function(e,t){"use strict";function n(e){return o.markNonLegacyFactory(r.createFactory(e))}var r=e("./ReactElement"),o=(e("./ReactElementValidator"),e("./ReactLegacyElement")),i=e("./mapObject"),a=i({a:"a",abbr:"abbr",address:"address",area:"area",article:"article",aside:"aside",audio:"audio",b:"b",base:"base",bdi:"bdi",bdo:"bdo",big:"big",blockquote:"blockquote",body:"body",br:"br",button:"button",canvas:"canvas",caption:"caption",cite:"cite",code:"code",col:"col",colgroup:"colgroup",data:"data",datalist:"datalist",dd:"dd",del:"del",details:"details",dfn:"dfn",dialog:"dialog",div:"div",dl:"dl",dt:"dt",em:"em",embed:"embed",fieldset:"fieldset",figcaption:"figcaption",figure:"figure",footer:"footer",form:"form",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",head:"head",header:"header",hr:"hr",html:"html",i:"i",iframe:"iframe",img:"img",input:"input",ins:"ins",kbd:"kbd",keygen:"keygen",label:"label",legend:"legend",li:"li",link:"link",main:"main",map:"map",mark:"mark",menu:"menu",menuitem:"menuitem",meta:"meta",meter:"meter",nav:"nav",noscript:"noscript",object:"object",ol:"ol",optgroup:"optgroup",option:"option",output:"output",p:"p",param:"param",picture:"picture",pre:"pre",progress:"progress",q:"q",rp:"rp",rt:"rt",ruby:"ruby",s:"s",samp:"samp",script:"script",section:"section",select:"select",small:"small",source:"source",span:"span",strong:"strong",style:"style",sub:"sub",summary:"summary",sup:"sup",table:"table",tbody:"tbody",td:"td",textarea:"textarea",tfoot:"tfoot",th:"th",thead:"thead",time:"time",title:"title",tr:"tr",track:"track",u:"u",ul:"ul","var":"var",video:"video",wbr:"wbr",circle:"circle",defs:"defs",ellipse:"ellipse",g:"g",line:"line",linearGradient:"linearGradient",mask:"mask",path:"path",pattern:"pattern",polygon:"polygon",polyline:"polyline",radialGradient:"radialGradient",rect:"rect",stop:"stop",svg:"svg",text:"text",tspan:"tspan"},n);t.exports=a},{"./ReactElement":56,"./ReactElementValidator":57,"./ReactLegacyElement":65,"./mapObject":145}],44:[function(e,t){"use strict";var n=e("./AutoFocusMixin"),r=e("./ReactBrowserComponentMixin"),o=e("./ReactCompositeComponent"),i=e("./ReactElement"),a=e("./ReactDOM"),s=e("./keyMirror"),u=i.createFactory(a.button.type),c=s({onClick:!0,onDoubleClick:!0,onMouseDown:!0,onMouseMove:!0,onMouseUp:!0,onClickCapture:!0,onDoubleClickCapture:!0,onMouseDownCapture:!0,onMouseMoveCapture:!0,onMouseUpCapture:!0}),l=o.createClass({displayName:"ReactDOMButton",mixins:[n,r],render:function(){var e={};for(var t in this.props)!this.props.hasOwnProperty(t)||this.props.disabled&&c[t]||(e[t]=this.props[t]);return u(e,this.props.children)}});t.exports=l},{"./AutoFocusMixin":2,"./ReactBrowserComponentMixin":32,"./ReactCompositeComponent":40,"./ReactDOM":43,"./ReactElement":56,"./keyMirror":143}],45:[function(e,t){"use strict";function n(e){e&&(y(null==e.children||null==e.dangerouslySetInnerHTML),y(null==e.style||"object"==typeof e.style))}function r(e,t,n,r){var o=d.findReactContainerForID(e);if(o){var i=o.nodeType===O?o.ownerDocument:o;C(t,i)}r.getPutListenerQueue().enqueuePutListener(e,t,n)}function o(e){T.call(P,e)||(y(x.test(e)),P[e]=!0)}function i(e){o(e),this._tag=e,this.tagName=e.toUpperCase()}var a=e("./CSSPropertyOperations"),s=e("./DOMProperty"),u=e("./DOMPropertyOperations"),c=e("./ReactBrowserComponentMixin"),l=e("./ReactComponent"),p=e("./ReactBrowserEventEmitter"),d=e("./ReactMount"),f=e("./ReactMultiChild"),h=e("./ReactPerf"),m=e("./Object.assign"),v=e("./escapeTextForBrowser"),y=e("./invariant"),g=(e("./isEventSupported"),e("./keyOf")),E=(e("./monitorCodeUse"),p.deleteListener),C=p.listenTo,R=p.registrationNameModules,M={string:!0,number:!0},b=g({style:null}),O=1,D={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},x=/^[a-zA-Z][a-zA-Z:_\.\-\d]*$/,P={},T={}.hasOwnProperty;i.displayName="ReactDOMComponent",i.Mixin={mountComponent:h.measure("ReactDOMComponent","mountComponent",function(e,t,r){l.Mixin.mountComponent.call(this,e,t,r),n(this.props);var o=D[this._tag]?"":"</"+this._tag+">";return this._createOpenTagMarkupAndPutListeners(t)+this._createContentMarkup(t)+o}),_createOpenTagMarkupAndPutListeners:function(e){var t=this.props,n="<"+this._tag;for(var o in t)if(t.hasOwnProperty(o)){var i=t[o];if(null!=i)if(R.hasOwnProperty(o))r(this._rootNodeID,o,i,e);else{o===b&&(i&&(i=t.style=m({},t.style)),i=a.createMarkupForStyles(i));var s=u.createMarkupForProperty(o,i);s&&(n+=" "+s)}}if(e.renderToStaticMarkup)return n+">";var c=u.createMarkupForID(this._rootNodeID);return n+" "+c+">"},_createContentMarkup:function(e){var t=this.props.dangerouslySetInnerHTML;if(null!=t){if(null!=t.__html)return t.__html}else{var n=M[typeof this.props.children]?this.props.children:null,r=null!=n?null:this.props.children;if(null!=n)return v(n);if(null!=r){var o=this.mountChildren(r,e);return o.join("")}}return""},receiveComponent:function(e,t){(e!==this._currentElement||null==e._owner)&&l.Mixin.receiveComponent.call(this,e,t)},updateComponent:h.measure("ReactDOMComponent","updateComponent",function(e,t){n(this._currentElement.props),l.Mixin.updateComponent.call(this,e,t),this._updateDOMProperties(t.props,e),this._updateDOMChildren(t.props,e)}),_updateDOMProperties:function(e,t){var n,o,i,a=this.props;for(n in e)if(!a.hasOwnProperty(n)&&e.hasOwnProperty(n))if(n===b){var u=e[n];for(o in u)u.hasOwnProperty(o)&&(i=i||{},i[o]="")}else R.hasOwnProperty(n)?E(this._rootNodeID,n):(s.isStandardName[n]||s.isCustomAttribute(n))&&l.BackendIDOperations.deletePropertyByID(this._rootNodeID,n);for(n in a){var c=a[n],p=e[n];if(a.hasOwnProperty(n)&&c!==p)if(n===b)if(c&&(c=a.style=m({},c)),p){for(o in p)!p.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(i=i||{},i[o]="");for(o in c)c.hasOwnProperty(o)&&p[o]!==c[o]&&(i=i||{},i[o]=c[o])}else i=c;else R.hasOwnProperty(n)?r(this._rootNodeID,n,c,t):(s.isStandardName[n]||s.isCustomAttribute(n))&&l.BackendIDOperations.updatePropertyByID(this._rootNodeID,n,c)}i&&l.BackendIDOperations.updateStylesByID(this._rootNodeID,i)},_updateDOMChildren:function(e,t){var n=this.props,r=M[typeof e.children]?e.children:null,o=M[typeof n.children]?n.children:null,i=e.dangerouslySetInnerHTML&&e.dangerouslySetInnerHTML.__html,a=n.dangerouslySetInnerHTML&&n.dangerouslySetInnerHTML.__html,s=null!=r?null:e.children,u=null!=o?null:n.children,c=null!=r||null!=i,p=null!=o||null!=a;null!=s&&null==u?this.updateChildren(null,t):c&&!p&&this.updateTextContent(""),null!=o?r!==o&&this.updateTextContent(""+o):null!=a?i!==a&&l.BackendIDOperations.updateInnerHTMLByID(this._rootNodeID,a):null!=u&&this.updateChildren(u,t)},unmountComponent:function(){this.unmountChildren(),p.deleteAllListeners(this._rootNodeID),l.Mixin.unmountComponent.call(this)}},m(i.prototype,l.Mixin,i.Mixin,f.Mixin,c),t.exports=i},{"./CSSPropertyOperations":6,"./DOMProperty":12,"./DOMPropertyOperations":13,"./Object.assign":29,"./ReactBrowserComponentMixin":32,"./ReactBrowserEventEmitter":33,"./ReactComponent":37,"./ReactMount":68,"./ReactMultiChild":69,"./ReactPerf":73,"./escapeTextForBrowser":120,"./invariant":137,"./isEventSupported":138,"./keyOf":144,"./monitorCodeUse":147}],46:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./LocalEventTrapMixin"),o=e("./ReactBrowserComponentMixin"),i=e("./ReactCompositeComponent"),a=e("./ReactElement"),s=e("./ReactDOM"),u=a.createFactory(s.form.type),c=i.createClass({displayName:"ReactDOMForm",mixins:[o,r],render:function(){return u(this.props)},componentDidMount:function(){this.trapBubbledEvent(n.topLevelTypes.topReset,"reset"),this.trapBubbledEvent(n.topLevelTypes.topSubmit,"submit")}});t.exports=c},{"./EventConstants":17,"./LocalEventTrapMixin":27,"./ReactBrowserComponentMixin":32,"./ReactCompositeComponent":40,"./ReactDOM":43,"./ReactElement":56}],47:[function(e,t){"use strict";var n=e("./CSSPropertyOperations"),r=e("./DOMChildrenOperations"),o=e("./DOMPropertyOperations"),i=e("./ReactMount"),a=e("./ReactPerf"),s=e("./invariant"),u=e("./setInnerHTML"),c={dangerouslySetInnerHTML:"`dangerouslySetInnerHTML` must be set using `updateInnerHTMLByID()`.",style:"`style` must be set using `updateStylesByID()`."},l={updatePropertyByID:a.measure("ReactDOMIDOperations","updatePropertyByID",function(e,t,n){var r=i.getNode(e);s(!c.hasOwnProperty(t)),null!=n?o.setValueForProperty(r,t,n):o.deleteValueForProperty(r,t)}),deletePropertyByID:a.measure("ReactDOMIDOperations","deletePropertyByID",function(e,t,n){var r=i.getNode(e);s(!c.hasOwnProperty(t)),o.deleteValueForProperty(r,t,n)}),updateStylesByID:a.measure("ReactDOMIDOperations","updateStylesByID",function(e,t){var r=i.getNode(e);n.setValueForStyles(r,t)}),updateInnerHTMLByID:a.measure("ReactDOMIDOperations","updateInnerHTMLByID",function(e,t){var n=i.getNode(e);u(n,t)}),updateTextContentByID:a.measure("ReactDOMIDOperations","updateTextContentByID",function(e,t){var n=i.getNode(e);r.updateTextContent(n,t)}),dangerouslyReplaceNodeWithMarkupByID:a.measure("ReactDOMIDOperations","dangerouslyReplaceNodeWithMarkupByID",function(e,t){var n=i.getNode(e);r.dangerouslyReplaceNodeWithMarkup(n,t)}),dangerouslyProcessChildrenUpdates:a.measure("ReactDOMIDOperations","dangerouslyProcessChildrenUpdates",function(e,t){for(var n=0;n<e.length;n++)e[n].parentNode=i.getNode(e[n].parentID);r.processUpdates(e,t)})};t.exports=l},{"./CSSPropertyOperations":6,"./DOMChildrenOperations":11,"./DOMPropertyOperations":13,"./ReactMount":68,"./ReactPerf":73,"./invariant":137,"./setInnerHTML":149}],48:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./LocalEventTrapMixin"),o=e("./ReactBrowserComponentMixin"),i=e("./ReactCompositeComponent"),a=e("./ReactElement"),s=e("./ReactDOM"),u=a.createFactory(s.img.type),c=i.createClass({displayName:"ReactDOMImg",tagName:"IMG",mixins:[o,r],render:function(){return u(this.props)},componentDidMount:function(){this.trapBubbledEvent(n.topLevelTypes.topLoad,"load"),this.trapBubbledEvent(n.topLevelTypes.topError,"error")}});t.exports=c},{"./EventConstants":17,"./LocalEventTrapMixin":27,"./ReactBrowserComponentMixin":32,"./ReactCompositeComponent":40,"./ReactDOM":43,"./ReactElement":56}],49:[function(e,t){"use strict";function n(){this.isMounted()&&this.forceUpdate()}var r=e("./AutoFocusMixin"),o=e("./DOMPropertyOperations"),i=e("./LinkedValueUtils"),a=e("./ReactBrowserComponentMixin"),s=e("./ReactCompositeComponent"),u=e("./ReactElement"),c=e("./ReactDOM"),l=e("./ReactMount"),p=e("./ReactUpdates"),d=e("./Object.assign"),f=e("./invariant"),h=u.createFactory(c.input.type),m={},v=s.createClass({displayName:"ReactDOMInput",mixins:[r,i.Mixin,a],getInitialState:function(){var e=this.props.defaultValue;return{initialChecked:this.props.defaultChecked||!1,initialValue:null!=e?e:null}},render:function(){var e=d({},this.props);e.defaultChecked=null,e.defaultValue=null;var t=i.getValue(this);e.value=null!=t?t:this.state.initialValue;var n=i.getChecked(this);return e.checked=null!=n?n:this.state.initialChecked,e.onChange=this._handleChange,h(e,this.props.children)},componentDidMount:function(){var e=l.getID(this.getDOMNode());m[e]=this},componentWillUnmount:function(){var e=this.getDOMNode(),t=l.getID(e);delete m[t]},componentDidUpdate:function(){var e=this.getDOMNode();null!=this.props.checked&&o.setValueForProperty(e,"checked",this.props.checked||!1);var t=i.getValue(this);null!=t&&o.setValueForProperty(e,"value",""+t)},_handleChange:function(e){var t,r=i.getOnChange(this);r&&(t=r.call(this,e)),p.asap(n,this);var o=this.props.name;if("radio"===this.props.type&&null!=o){for(var a=this.getDOMNode(),s=a;s.parentNode;)s=s.parentNode;for(var u=s.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),c=0,d=u.length;d>c;c++){var h=u[c];if(h!==a&&h.form===a.form){var v=l.getID(h);f(v);var y=m[v];f(y),p.asap(n,y)}}}return t}});t.exports=v},{"./AutoFocusMixin":2,"./DOMPropertyOperations":13,"./LinkedValueUtils":26,"./Object.assign":29,"./ReactBrowserComponentMixin":32,"./ReactCompositeComponent":40,"./ReactDOM":43,"./ReactElement":56,"./ReactMount":68,"./ReactUpdates":88,"./invariant":137}],50:[function(e,t){"use strict";var n=e("./ReactBrowserComponentMixin"),r=e("./ReactCompositeComponent"),o=e("./ReactElement"),i=e("./ReactDOM"),a=(e("./warning"),o.createFactory(i.option.type)),s=r.createClass({displayName:"ReactDOMOption",mixins:[n],componentWillMount:function(){},render:function(){return a(this.props,this.props.children)}});t.exports=s},{"./ReactBrowserComponentMixin":32,"./ReactCompositeComponent":40,"./ReactDOM":43,"./ReactElement":56,"./warning":155}],51:[function(e,t){"use strict";function n(){this.isMounted()&&(this.setState({value:this._pendingValue}),this._pendingValue=0)}function r(e,t){if(null!=e[t])if(e.multiple){if(!Array.isArray(e[t]))return new Error("The `"+t+"` prop supplied to <select> must be an array if `multiple` is true.")}else if(Array.isArray(e[t]))return new Error("The `"+t+"` prop supplied to <select> must be a scalar value if `multiple` is false.")}function o(e,t){var n,r,o,i=e.props.multiple,a=null!=t?t:e.state.value,s=e.getDOMNode().options;if(i)for(n={},r=0,o=a.length;o>r;++r)n[""+a[r]]=!0;else n=""+a;for(r=0,o=s.length;o>r;r++){var u=i?n.hasOwnProperty(s[r].value):s[r].value===n;u!==s[r].selected&&(s[r].selected=u)}}var i=e("./AutoFocusMixin"),a=e("./LinkedValueUtils"),s=e("./ReactBrowserComponentMixin"),u=e("./ReactCompositeComponent"),c=e("./ReactElement"),l=e("./ReactDOM"),p=e("./ReactUpdates"),d=e("./Object.assign"),f=c.createFactory(l.select.type),h=u.createClass({displayName:"ReactDOMSelect",mixins:[i,a.Mixin,s],propTypes:{defaultValue:r,value:r},getInitialState:function(){return{value:this.props.defaultValue||(this.props.multiple?[]:"")}},componentWillMount:function(){this._pendingValue=null},componentWillReceiveProps:function(e){!this.props.multiple&&e.multiple?this.setState({value:[this.state.value]}):this.props.multiple&&!e.multiple&&this.setState({value:this.state.value[0]})},render:function(){var e=d({},this.props);return e.onChange=this._handleChange,e.value=null,f(e,this.props.children)},componentDidMount:function(){o(this,a.getValue(this))},componentDidUpdate:function(e){var t=a.getValue(this),n=!!e.multiple,r=!!this.props.multiple;(null!=t||n!==r)&&o(this,t)},_handleChange:function(e){var t,r=a.getOnChange(this);r&&(t=r.call(this,e));var o;if(this.props.multiple){o=[];for(var i=e.target.options,s=0,u=i.length;u>s;s++)i[s].selected&&o.push(i[s].value)}else o=e.target.value;return this._pendingValue=o,p.asap(n,this),t}});t.exports=h},{"./AutoFocusMixin":2,"./LinkedValueUtils":26,"./Object.assign":29,"./ReactBrowserComponentMixin":32,"./ReactCompositeComponent":40,"./ReactDOM":43,"./ReactElement":56,"./ReactUpdates":88}],52:[function(e,t){"use strict";function n(e,t,n,r){return e===n&&t===r}function r(e){var t=document.selection,n=t.createRange(),r=n.text.length,o=n.duplicate();o.moveToElementText(e),o.setEndPoint("EndToStart",n);var i=o.text.length,a=i+r;return{start:i,end:a}}function o(e){var t=window.getSelection&&window.getSelection();if(!t||0===t.rangeCount)return null;var r=t.anchorNode,o=t.anchorOffset,i=t.focusNode,a=t.focusOffset,s=t.getRangeAt(0),u=n(t.anchorNode,t.anchorOffset,t.focusNode,t.focusOffset),c=u?0:s.toString().length,l=s.cloneRange();l.selectNodeContents(e),l.setEnd(s.startContainer,s.startOffset);var p=n(l.startContainer,l.startOffset,l.endContainer,l.endOffset),d=p?0:l.toString().length,f=d+c,h=document.createRange();h.setStart(r,o),h.setEnd(i,a);var m=h.collapsed;return{start:m?f:d,end:m?d:f}}function i(e,t){var n,r,o=document.selection.createRange().duplicate();"undefined"==typeof t.end?(n=t.start,r=n):t.start>t.end?(n=t.end,r=t.start):(n=t.start,r=t.end),o.moveToElementText(e),o.moveStart("character",n),o.setEndPoint("EndToStart",o),o.moveEnd("character",r-n),o.select()
}function a(e,t){if(window.getSelection){var n=window.getSelection(),r=e[c()].length,o=Math.min(t.start,r),i="undefined"==typeof t.end?o:Math.min(t.end,r);if(!n.extend&&o>i){var a=i;i=o,o=a}var s=u(e,o),l=u(e,i);if(s&&l){var p=document.createRange();p.setStart(s.node,s.offset),n.removeAllRanges(),o>i?(n.addRange(p),n.extend(l.node,l.offset)):(p.setEnd(l.node,l.offset),n.addRange(p))}}}var s=e("./ExecutionEnvironment"),u=e("./getNodeForCharacterOffset"),c=e("./getTextContentAccessor"),l=s.canUseDOM&&document.selection,p={getOffsets:l?r:o,setOffsets:l?i:a};t.exports=p},{"./ExecutionEnvironment":23,"./getNodeForCharacterOffset":130,"./getTextContentAccessor":132}],53:[function(e,t){"use strict";function n(){this.isMounted()&&this.forceUpdate()}var r=e("./AutoFocusMixin"),o=e("./DOMPropertyOperations"),i=e("./LinkedValueUtils"),a=e("./ReactBrowserComponentMixin"),s=e("./ReactCompositeComponent"),u=e("./ReactElement"),c=e("./ReactDOM"),l=e("./ReactUpdates"),p=e("./Object.assign"),d=e("./invariant"),f=(e("./warning"),u.createFactory(c.textarea.type)),h=s.createClass({displayName:"ReactDOMTextarea",mixins:[r,i.Mixin,a],getInitialState:function(){var e=this.props.defaultValue,t=this.props.children;null!=t&&(d(null==e),Array.isArray(t)&&(d(t.length<=1),t=t[0]),e=""+t),null==e&&(e="");var n=i.getValue(this);return{initialValue:""+(null!=n?n:e)}},render:function(){var e=p({},this.props);return d(null==e.dangerouslySetInnerHTML),e.defaultValue=null,e.value=null,e.onChange=this._handleChange,f(e,this.state.initialValue)},componentDidUpdate:function(){var e=i.getValue(this);if(null!=e){var t=this.getDOMNode();o.setValueForProperty(t,"value",""+e)}},_handleChange:function(e){var t,r=i.getOnChange(this);return r&&(t=r.call(this,e)),l.asap(n,this),t}});t.exports=h},{"./AutoFocusMixin":2,"./DOMPropertyOperations":13,"./LinkedValueUtils":26,"./Object.assign":29,"./ReactBrowserComponentMixin":32,"./ReactCompositeComponent":40,"./ReactDOM":43,"./ReactElement":56,"./ReactUpdates":88,"./invariant":137,"./warning":155}],54:[function(e,t){"use strict";function n(){this.reinitializeTransaction()}var r=e("./ReactUpdates"),o=e("./Transaction"),i=e("./Object.assign"),a=e("./emptyFunction"),s={initialize:a,close:function(){p.isBatchingUpdates=!1}},u={initialize:a,close:r.flushBatchedUpdates.bind(r)},c=[u,s];i(n.prototype,o.Mixin,{getTransactionWrappers:function(){return c}});var l=new n,p={isBatchingUpdates:!1,batchedUpdates:function(e,t,n){var r=p.isBatchingUpdates;p.isBatchingUpdates=!0,r?e(t,n):l.perform(e,null,t,n)}};t.exports=p},{"./Object.assign":29,"./ReactUpdates":88,"./Transaction":104,"./emptyFunction":118}],55:[function(e,t){"use strict";function n(){O.EventEmitter.injectReactEventListener(b),O.EventPluginHub.injectEventPluginOrder(s),O.EventPluginHub.injectInstanceHandle(D),O.EventPluginHub.injectMount(x),O.EventPluginHub.injectEventPluginsByName({SimpleEventPlugin:w,EnterLeaveEventPlugin:u,ChangeEventPlugin:o,CompositionEventPlugin:a,MobileSafariClickEventPlugin:p,SelectEventPlugin:P,BeforeInputEventPlugin:r}),O.NativeComponent.injectGenericComponentClass(m),O.NativeComponent.injectComponentClasses({button:v,form:y,img:g,input:E,option:C,select:R,textarea:M,html:S("html"),head:S("head"),body:S("body")}),O.CompositeComponent.injectMixin(d),O.DOMProperty.injectDOMPropertyConfig(l),O.DOMProperty.injectDOMPropertyConfig(_),O.EmptyComponent.injectEmptyComponent("noscript"),O.Updates.injectReconcileTransaction(f.ReactReconcileTransaction),O.Updates.injectBatchingStrategy(h),O.RootIndex.injectCreateReactRootIndex(c.canUseDOM?i.createReactRootIndex:T.createReactRootIndex),O.Component.injectEnvironment(f)}var r=e("./BeforeInputEventPlugin"),o=e("./ChangeEventPlugin"),i=e("./ClientReactRootIndex"),a=e("./CompositionEventPlugin"),s=e("./DefaultEventPluginOrder"),u=e("./EnterLeaveEventPlugin"),c=e("./ExecutionEnvironment"),l=e("./HTMLDOMPropertyConfig"),p=e("./MobileSafariClickEventPlugin"),d=e("./ReactBrowserComponentMixin"),f=e("./ReactComponentBrowserEnvironment"),h=e("./ReactDefaultBatchingStrategy"),m=e("./ReactDOMComponent"),v=e("./ReactDOMButton"),y=e("./ReactDOMForm"),g=e("./ReactDOMImg"),E=e("./ReactDOMInput"),C=e("./ReactDOMOption"),R=e("./ReactDOMSelect"),M=e("./ReactDOMTextarea"),b=e("./ReactEventListener"),O=e("./ReactInjection"),D=e("./ReactInstanceHandles"),x=e("./ReactMount"),P=e("./SelectEventPlugin"),T=e("./ServerReactRootIndex"),w=e("./SimpleEventPlugin"),_=e("./SVGDOMPropertyConfig"),S=e("./createFullPageComponent");t.exports={inject:n}},{"./BeforeInputEventPlugin":3,"./ChangeEventPlugin":8,"./ClientReactRootIndex":9,"./CompositionEventPlugin":10,"./DefaultEventPluginOrder":15,"./EnterLeaveEventPlugin":16,"./ExecutionEnvironment":23,"./HTMLDOMPropertyConfig":24,"./MobileSafariClickEventPlugin":28,"./ReactBrowserComponentMixin":32,"./ReactComponentBrowserEnvironment":38,"./ReactDOMButton":44,"./ReactDOMComponent":45,"./ReactDOMForm":46,"./ReactDOMImg":48,"./ReactDOMInput":49,"./ReactDOMOption":50,"./ReactDOMSelect":51,"./ReactDOMTextarea":53,"./ReactDefaultBatchingStrategy":54,"./ReactEventListener":61,"./ReactInjection":62,"./ReactInstanceHandles":64,"./ReactMount":68,"./SVGDOMPropertyConfig":89,"./SelectEventPlugin":90,"./ServerReactRootIndex":91,"./SimpleEventPlugin":92,"./createFullPageComponent":113}],56:[function(e,t){"use strict";var n=e("./ReactContext"),r=e("./ReactCurrentOwner"),o=(e("./warning"),{key:!0,ref:!0}),i=function(e,t,n,r,o,i){this.type=e,this.key=t,this.ref=n,this._owner=r,this._context=o,this.props=i};i.prototype={_isReactElement:!0},i.createElement=function(e,t,a){var s,u={},c=null,l=null;if(null!=t){l=void 0===t.ref?null:t.ref,c=null==t.key?null:""+t.key;for(s in t)t.hasOwnProperty(s)&&!o.hasOwnProperty(s)&&(u[s]=t[s])}var p=arguments.length-2;if(1===p)u.children=a;else if(p>1){for(var d=Array(p),f=0;p>f;f++)d[f]=arguments[f+2];u.children=d}if(e.defaultProps){var h=e.defaultProps;for(s in h)"undefined"==typeof u[s]&&(u[s]=h[s])}return new i(e,c,l,r.current,n.current,u)},i.createFactory=function(e){var t=i.createElement.bind(null,e);return t.type=e,t},i.cloneAndReplaceProps=function(e,t){var n=new i(e.type,e.key,e.ref,e._owner,e._context,t);return n},i.isValidElement=function(e){var t=!(!e||!e._isReactElement);return t},t.exports=i},{"./ReactContext":41,"./ReactCurrentOwner":42,"./warning":155}],57:[function(e,t){"use strict";function n(){var e=p.current;return e&&e.constructor.displayName||void 0}function r(e,t){e._store.validated||null!=e.key||(e._store.validated=!0,i("react_key_warning",'Each child in an array should have a unique "key" prop.',e,t))}function o(e,t,n){v.test(e)&&i("react_numeric_key_warning","Child objects should have non-numeric keys so ordering is preserved.",t,n)}function i(e,t,r,o){var i=n(),a=o.displayName,s=i||a,u=f[e];if(!u.hasOwnProperty(s)){u[s]=!0,t+=i?" Check the render method of "+i+".":" Check the renderComponent call using <"+a+">.";var c=null;r._owner&&r._owner!==p.current&&(c=r._owner.constructor.displayName,t+=" It was passed a child from "+c+"."),t+=" See http://fb.me/react-warning-keys for more information.",d(e,{component:s,componentOwner:c}),console.warn(t)}}function a(){var e=n()||"";h.hasOwnProperty(e)||(h[e]=!0,d("react_object_map_children"))}function s(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++){var i=e[n];c.isValidElement(i)&&r(i,t)}else if(c.isValidElement(e))e._store.validated=!0;else if(e&&"object"==typeof e){a();for(var s in e)o(s,e[s],t)}}function u(e,t,n,r){for(var o in t)if(t.hasOwnProperty(o)){var i;try{i=t[o](n,o,e,r)}catch(a){i=a}i instanceof Error&&!(i.message in m)&&(m[i.message]=!0,d("react_failed_descriptor_type_check",{message:i.message}))}}var c=e("./ReactElement"),l=e("./ReactPropTypeLocations"),p=e("./ReactCurrentOwner"),d=e("./monitorCodeUse"),f={react_key_warning:{},react_numeric_key_warning:{}},h={},m={},v=/^\d+$/,y={createElement:function(e){var t=c.createElement.apply(this,arguments);if(null==t)return t;for(var n=2;n<arguments.length;n++)s(arguments[n],e);var r=e.displayName;return e.propTypes&&u(r,e.propTypes,t.props,l.prop),e.contextTypes&&u(r,e.contextTypes,t._context,l.context),t},createFactory:function(e){var t=y.createElement.bind(null,e);return t.type=e,t}};t.exports=y},{"./ReactCurrentOwner":42,"./ReactElement":56,"./ReactPropTypeLocations":76,"./monitorCodeUse":147}],58:[function(e,t){"use strict";function n(){return u(a),a()}function r(e){c[e]=!0}function o(e){delete c[e]}function i(e){return c[e]}var a,s=e("./ReactElement"),u=e("./invariant"),c={},l={injectEmptyComponent:function(e){a=s.createFactory(e)}},p={deregisterNullComponentID:o,getEmptyComponent:n,injection:l,isNullComponentID:i,registerNullComponentID:r};t.exports=p},{"./ReactElement":56,"./invariant":137}],59:[function(e,t){"use strict";var n={guard:function(e){return e}};t.exports=n},{}],60:[function(e,t){"use strict";function n(e){r.enqueueEvents(e),r.processEventQueue()}var r=e("./EventPluginHub"),o={handleTopLevel:function(e,t,o,i){var a=r.extractEvents(e,t,o,i);n(a)}};t.exports=o},{"./EventPluginHub":19}],61:[function(e,t){"use strict";function n(e){var t=l.getID(e),n=c.getReactRootIDFromNodeID(t),r=l.findReactContainerForID(n),o=l.getFirstReactDOM(r);return o}function r(e,t){this.topLevelType=e,this.nativeEvent=t,this.ancestors=[]}function o(e){for(var t=l.getFirstReactDOM(f(e.nativeEvent))||window,r=t;r;)e.ancestors.push(r),r=n(r);for(var o=0,i=e.ancestors.length;i>o;o++){t=e.ancestors[o];var a=l.getID(t)||"";m._handleTopLevel(e.topLevelType,t,a,e.nativeEvent)}}function i(e){var t=h(window);e(t)}var a=e("./EventListener"),s=e("./ExecutionEnvironment"),u=e("./PooledClass"),c=e("./ReactInstanceHandles"),l=e("./ReactMount"),p=e("./ReactUpdates"),d=e("./Object.assign"),f=e("./getEventTarget"),h=e("./getUnboundedScrollPosition");d(r.prototype,{destructor:function(){this.topLevelType=null,this.nativeEvent=null,this.ancestors.length=0}}),u.addPoolingTo(r,u.twoArgumentPooler);var m={_enabled:!0,_handleTopLevel:null,WINDOW_HANDLE:s.canUseDOM?window:null,setHandleTopLevel:function(e){m._handleTopLevel=e},setEnabled:function(e){m._enabled=!!e},isEnabled:function(){return m._enabled},trapBubbledEvent:function(e,t,n){var r=n;return r?a.listen(r,t,m.dispatchEvent.bind(null,e)):void 0},trapCapturedEvent:function(e,t,n){var r=n;return r?a.capture(r,t,m.dispatchEvent.bind(null,e)):void 0},monitorScrollValue:function(e){var t=i.bind(null,e);a.listen(window,"scroll",t),a.listen(window,"resize",t)},dispatchEvent:function(e,t){if(m._enabled){var n=r.getPooled(e,t);try{p.batchedUpdates(o,n)}finally{r.release(n)}}}};t.exports=m},{"./EventListener":18,"./ExecutionEnvironment":23,"./Object.assign":29,"./PooledClass":30,"./ReactInstanceHandles":64,"./ReactMount":68,"./ReactUpdates":88,"./getEventTarget":128,"./getUnboundedScrollPosition":133}],62:[function(e,t){"use strict";var n=e("./DOMProperty"),r=e("./EventPluginHub"),o=e("./ReactComponent"),i=e("./ReactCompositeComponent"),a=e("./ReactEmptyComponent"),s=e("./ReactBrowserEventEmitter"),u=e("./ReactNativeComponent"),c=e("./ReactPerf"),l=e("./ReactRootIndex"),p=e("./ReactUpdates"),d={Component:o.injection,CompositeComponent:i.injection,DOMProperty:n.injection,EmptyComponent:a.injection,EventPluginHub:r.injection,EventEmitter:s.injection,NativeComponent:u.injection,Perf:c.injection,RootIndex:l.injection,Updates:p.injection};t.exports=d},{"./DOMProperty":12,"./EventPluginHub":19,"./ReactBrowserEventEmitter":33,"./ReactComponent":37,"./ReactCompositeComponent":40,"./ReactEmptyComponent":58,"./ReactNativeComponent":71,"./ReactPerf":73,"./ReactRootIndex":80,"./ReactUpdates":88}],63:[function(e,t){"use strict";function n(e){return o(document.documentElement,e)}var r=e("./ReactDOMSelection"),o=e("./containsNode"),i=e("./focusNode"),a=e("./getActiveElement"),s={hasSelectionCapabilities:function(e){return e&&("INPUT"===e.nodeName&&"text"===e.type||"TEXTAREA"===e.nodeName||"true"===e.contentEditable)},getSelectionInformation:function(){var e=a();return{focusedElem:e,selectionRange:s.hasSelectionCapabilities(e)?s.getSelection(e):null}},restoreSelection:function(e){var t=a(),r=e.focusedElem,o=e.selectionRange;t!==r&&n(r)&&(s.hasSelectionCapabilities(r)&&s.setSelection(r,o),i(r))},getSelection:function(e){var t;if("selectionStart"in e)t={start:e.selectionStart,end:e.selectionEnd};else if(document.selection&&"INPUT"===e.nodeName){var n=document.selection.createRange();n.parentElement()===e&&(t={start:-n.moveStart("character",-e.value.length),end:-n.moveEnd("character",-e.value.length)})}else t=r.getOffsets(e);return t||{start:0,end:0}},setSelection:function(e,t){var n=t.start,o=t.end;if("undefined"==typeof o&&(o=n),"selectionStart"in e)e.selectionStart=n,e.selectionEnd=Math.min(o,e.value.length);else if(document.selection&&"INPUT"===e.nodeName){var i=e.createTextRange();i.collapse(!0),i.moveStart("character",n),i.moveEnd("character",o-n),i.select()}else r.setOffsets(e,t)}};t.exports=s},{"./ReactDOMSelection":52,"./containsNode":111,"./focusNode":122,"./getActiveElement":124}],64:[function(e,t){"use strict";function n(e){return d+e.toString(36)}function r(e,t){return e.charAt(t)===d||t===e.length}function o(e){return""===e||e.charAt(0)===d&&e.charAt(e.length-1)!==d}function i(e,t){return 0===t.indexOf(e)&&r(t,e.length)}function a(e){return e?e.substr(0,e.lastIndexOf(d)):""}function s(e,t){if(p(o(e)&&o(t)),p(i(e,t)),e===t)return e;for(var n=e.length+f,a=n;a<t.length&&!r(t,a);a++);return t.substr(0,a)}function u(e,t){var n=Math.min(e.length,t.length);if(0===n)return"";for(var i=0,a=0;n>=a;a++)if(r(e,a)&&r(t,a))i=a;else if(e.charAt(a)!==t.charAt(a))break;var s=e.substr(0,i);return p(o(s)),s}function c(e,t,n,r,o,u){e=e||"",t=t||"",p(e!==t);var c=i(t,e);p(c||i(e,t));for(var l=0,d=c?a:s,f=e;;f=d(f,t)){var m;if(o&&f===e||u&&f===t||(m=n(f,c,r)),m===!1||f===t)break;p(l++<h)}}var l=e("./ReactRootIndex"),p=e("./invariant"),d=".",f=d.length,h=100,m={createReactRootID:function(){return n(l.createReactRootIndex())},createReactID:function(e,t){return e+t},getReactRootIDFromNodeID:function(e){if(e&&e.charAt(0)===d&&e.length>1){var t=e.indexOf(d,1);return t>-1?e.substr(0,t):e}return null},traverseEnterLeave:function(e,t,n,r,o){var i=u(e,t);i!==e&&c(e,i,n,r,!1,!0),i!==t&&c(i,t,n,o,!0,!1)},traverseTwoPhase:function(e,t,n){e&&(c("",e,t,n,!0,!1),c(e,"",t,n,!1,!0))},traverseAncestors:function(e,t,n){c("",e,t,n,!0,!1)},_getFirstCommonAncestorID:u,_getNextDescendantID:s,isAncestorIDOf:i,SEPARATOR:d};t.exports=m},{"./ReactRootIndex":80,"./invariant":137}],65:[function(e,t){"use strict";function n(e,t){if("function"==typeof t)for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if("function"==typeof r){var o=r.bind(t);for(var i in r)r.hasOwnProperty(i)&&(o[i]=r[i]);e[n]=o}else e[n]=r}}var r=(e("./ReactCurrentOwner"),e("./invariant")),o=(e("./monitorCodeUse"),e("./warning"),{}),i={},a={};a.wrapCreateFactory=function(e){var t=function(t){return"function"!=typeof t?e(t):t.isReactNonLegacyFactory?e(t.type):t.isReactLegacyFactory?e(t.type):t};return t},a.wrapCreateElement=function(e){var t=function(t){if("function"!=typeof t)return e.apply(this,arguments);var n;return t.isReactNonLegacyFactory?(n=Array.prototype.slice.call(arguments,0),n[0]=t.type,e.apply(this,n)):t.isReactLegacyFactory?(t._isMockFunction&&(t.type._mockedReactClassConstructor=t),n=Array.prototype.slice.call(arguments,0),n[0]=t.type,e.apply(this,n)):t.apply(null,Array.prototype.slice.call(arguments,1))};return t},a.wrapFactory=function(e){r("function"==typeof e);var t=function(){return e.apply(this,arguments)};return n(t,e.type),t.isReactLegacyFactory=o,t.type=e.type,t},a.markNonLegacyFactory=function(e){return e.isReactNonLegacyFactory=i,e},a.isValidFactory=function(e){return"function"==typeof e&&e.isReactLegacyFactory===o},a.isValidClass=function(e){return a.isValidFactory(e)},a._isLegacyCallWarningEnabled=!0,t.exports=a},{"./ReactCurrentOwner":42,"./invariant":137,"./monitorCodeUse":147,"./warning":155}],66:[function(e,t){"use strict";function n(e,t){this.value=e,this.requestChange=t}function r(e){var t={value:"undefined"==typeof e?o.PropTypes.any.isRequired:e.isRequired,requestChange:o.PropTypes.func.isRequired};return o.PropTypes.shape(t)}var o=e("./React");n.PropTypes={link:r},t.exports=n},{"./React":31}],67:[function(e,t){"use strict";var n=e("./adler32"),r={CHECKSUM_ATTR_NAME:"data-react-checksum",addChecksumToMarkup:function(e){var t=n(e);return e.replace(">"," "+r.CHECKSUM_ATTR_NAME+'="'+t+'">')},canReuseMarkup:function(e,t){var o=t.getAttribute(r.CHECKSUM_ATTR_NAME);o=o&&parseInt(o,10);var i=n(e);return i===o}};t.exports=r},{"./adler32":107}],68:[function(e,t){"use strict";function n(e){var t=E(e);return t&&I.getID(t)}function r(e){var t=o(e);if(t)if(x.hasOwnProperty(t)){var n=x[t];n!==e&&(R(!s(n,t)),x[t]=e)}else x[t]=e;return t}function o(e){return e&&e.getAttribute&&e.getAttribute(D)||""}function i(e,t){var n=o(e);n!==t&&delete x[n],e.setAttribute(D,t),x[t]=e}function a(e){return x.hasOwnProperty(e)&&s(x[e],e)||(x[e]=I.findReactNodeByID(e)),x[e]}function s(e,t){if(e){R(o(e)===t);var n=I.findReactContainerForID(t);if(n&&y(n,e))return!0}return!1}function u(e){delete x[e]}function c(e){var t=x[e];return t&&s(t,e)?void(N=t):!1}function l(e){N=null,m.traverseAncestors(e,c);var t=N;return N=null,t}var p=e("./DOMProperty"),d=e("./ReactBrowserEventEmitter"),f=(e("./ReactCurrentOwner"),e("./ReactElement")),h=e("./ReactLegacyElement"),m=e("./ReactInstanceHandles"),v=e("./ReactPerf"),y=e("./containsNode"),g=e("./deprecated"),E=e("./getReactRootElementInContainer"),C=e("./instantiateReactComponent"),R=e("./invariant"),M=e("./shouldUpdateReactComponent"),b=(e("./warning"),h.wrapCreateElement(f.createElement)),O=m.SEPARATOR,D=p.ID_ATTRIBUTE_NAME,x={},P=1,T=9,w={},_={},S=[],N=null,I={_instancesByReactRootID:w,scrollMonitor:function(e,t){t()},_updateRootComponent:function(e,t,n,r){var o=t.props;return I.scrollMonitor(n,function(){e.replaceProps(o,r)}),e},_registerComponent:function(e,t){R(t&&(t.nodeType===P||t.nodeType===T)),d.ensureScrollValueMonitoring();var n=I.registerContainer(t);return w[n]=e,n},_renderNewRootComponent:v.measure("ReactMount","_renderNewRootComponent",function(e,t,n){var r=C(e,null),o=I._registerComponent(r,t);return r.mountComponentIntoNode(o,t,n),r}),render:function(e,t,r){R(f.isValidElement(e));var o=w[n(t)];if(o){var i=o._currentElement;if(M(i,e))return I._updateRootComponent(o,e,t,r);I.unmountComponentAtNode(t)}var a=E(t),s=a&&I.isRenderedByReact(a),u=s&&!o,c=I._renderNewRootComponent(e,t,u);return r&&r.call(c),c},constructAndRenderComponent:function(e,t,n){var r=b(e,t);return I.render(r,n)},constructAndRenderComponentByID:function(e,t,n){var r=document.getElementById(n);return R(r),I.constructAndRenderComponent(e,t,r)},registerContainer:function(e){var t=n(e);return t&&(t=m.getReactRootIDFromNodeID(t)),t||(t=m.createReactRootID()),_[t]=e,t},unmountComponentAtNode:function(e){var t=n(e),r=w[t];return r?(I.unmountComponentFromNode(r,e),delete w[t],delete _[t],!0):!1},unmountComponentFromNode:function(e,t){for(e.unmountComponent(),t.nodeType===T&&(t=t.documentElement);t.lastChild;)t.removeChild(t.lastChild)},findReactContainerForID:function(e){var t=m.getReactRootIDFromNodeID(e),n=_[t];return n},findReactNodeByID:function(e){var t=I.findReactContainerForID(e);return I.findComponentRoot(t,e)},isRenderedByReact:function(e){if(1!==e.nodeType)return!1;var t=I.getID(e);return t?t.charAt(0)===O:!1},getFirstReactDOM:function(e){for(var t=e;t&&t.parentNode!==t;){if(I.isRenderedByReact(t))return t;t=t.parentNode}return null},findComponentRoot:function(e,t){var n=S,r=0,o=l(t)||e;for(n[0]=o.firstChild,n.length=1;r<n.length;){for(var i,a=n[r++];a;){var s=I.getID(a);s?t===s?i=a:m.isAncestorIDOf(s,t)&&(n.length=r=0,n.push(a.firstChild)):n.push(a.firstChild),a=a.nextSibling}if(i)return n.length=0,i}n.length=0,R(!1)},getReactRootID:n,getID:r,setID:i,getNode:a,purgeID:u};I.renderComponent=g("ReactMount","renderComponent","render",this,I.render),t.exports=I},{"./DOMProperty":12,"./ReactBrowserEventEmitter":33,"./ReactCurrentOwner":42,"./ReactElement":56,"./ReactInstanceHandles":64,"./ReactLegacyElement":65,"./ReactPerf":73,"./containsNode":111,"./deprecated":117,"./getReactRootElementInContainer":131,"./instantiateReactComponent":136,"./invariant":137,"./shouldUpdateReactComponent":151,"./warning":155}],69:[function(e,t){"use strict";function n(e,t,n){h.push({parentID:e,parentNode:null,type:c.INSERT_MARKUP,markupIndex:m.push(t)-1,textContent:null,fromIndex:null,toIndex:n})}function r(e,t,n){h.push({parentID:e,parentNode:null,type:c.MOVE_EXISTING,markupIndex:null,textContent:null,fromIndex:t,toIndex:n})}function o(e,t){h.push({parentID:e,parentNode:null,type:c.REMOVE_NODE,markupIndex:null,textContent:null,fromIndex:t,toIndex:null})}function i(e,t){h.push({parentID:e,parentNode:null,type:c.TEXT_CONTENT,markupIndex:null,textContent:t,fromIndex:null,toIndex:null})}function a(){h.length&&(u.BackendIDOperations.dangerouslyProcessChildrenUpdates(h,m),s())}function s(){h.length=0,m.length=0}var u=e("./ReactComponent"),c=e("./ReactMultiChildUpdateTypes"),l=e("./flattenChildren"),p=e("./instantiateReactComponent"),d=e("./shouldUpdateReactComponent"),f=0,h=[],m=[],v={Mixin:{mountChildren:function(e,t){var n=l(e),r=[],o=0;this._renderedChildren=n;for(var i in n){var a=n[i];if(n.hasOwnProperty(i)){var s=p(a,null);n[i]=s;var u=this._rootNodeID+i,c=s.mountComponent(u,t,this._mountDepth+1);s._mountIndex=o,r.push(c),o++}}return r},updateTextContent:function(e){f++;var t=!0;try{var n=this._renderedChildren;for(var r in n)n.hasOwnProperty(r)&&this._unmountChildByName(n[r],r);this.setTextContent(e),t=!1}finally{f--,f||(t?s():a())}},updateChildren:function(e,t){f++;var n=!0;try{this._updateChildren(e,t),n=!1}finally{f--,f||(n?s():a())}},_updateChildren:function(e,t){var n=l(e),r=this._renderedChildren;if(n||r){var o,i=0,a=0;for(o in n)if(n.hasOwnProperty(o)){var s=r&&r[o],u=s&&s._currentElement,c=n[o];if(d(u,c))this.moveChild(s,a,i),i=Math.max(s._mountIndex,i),s.receiveComponent(c,t),s._mountIndex=a;else{s&&(i=Math.max(s._mountIndex,i),this._unmountChildByName(s,o));var f=p(c,null);this._mountChildByNameAtIndex(f,o,a,t)}a++}for(o in r)!r.hasOwnProperty(o)||n&&n[o]||this._unmountChildByName(r[o],o)}},unmountChildren:function(){var e=this._renderedChildren;for(var t in e){var n=e[t];n.unmountComponent&&n.unmountComponent()}this._renderedChildren=null},moveChild:function(e,t,n){e._mountIndex<n&&r(this._rootNodeID,e._mountIndex,t)},createChild:function(e,t){n(this._rootNodeID,t,e._mountIndex)},removeChild:function(e){o(this._rootNodeID,e._mountIndex)},setTextContent:function(e){i(this._rootNodeID,e)},_mountChildByNameAtIndex:function(e,t,n,r){var o=this._rootNodeID+t,i=e.mountComponent(o,r,this._mountDepth+1);e._mountIndex=n,this.createChild(e,i),this._renderedChildren=this._renderedChildren||{},this._renderedChildren[t]=e},_unmountChildByName:function(e,t){this.removeChild(e),e._mountIndex=null,e.unmountComponent(),delete this._renderedChildren[t]}}};t.exports=v},{"./ReactComponent":37,"./ReactMultiChildUpdateTypes":70,"./flattenChildren":121,"./instantiateReactComponent":136,"./shouldUpdateReactComponent":151}],70:[function(e,t){"use strict";var n=e("./keyMirror"),r=n({INSERT_MARKUP:null,MOVE_EXISTING:null,REMOVE_NODE:null,TEXT_CONTENT:null});t.exports=r},{"./keyMirror":143}],71:[function(e,t){"use strict";function n(e,t,n){var r=a[e];return null==r?(o(i),new i(e,t)):n===e?(o(i),new i(e,t)):new r.type(t)}var r=e("./Object.assign"),o=e("./invariant"),i=null,a={},s={injectGenericComponentClass:function(e){i=e},injectComponentClasses:function(e){r(a,e)}},u={createInstanceForTag:n,injection:s};t.exports=u},{"./Object.assign":29,"./invariant":137}],72:[function(e,t){"use strict";var n=e("./emptyObject"),r=e("./invariant"),o={isValidOwner:function(e){return!(!e||"function"!=typeof e.attachRef||"function"!=typeof e.detachRef)},addComponentAsRefTo:function(e,t,n){r(o.isValidOwner(n)),n.attachRef(t,e)},removeComponentAsRefFrom:function(e,t,n){r(o.isValidOwner(n)),n.refs[t]===e&&n.detachRef(t)},Mixin:{construct:function(){this.refs=n},attachRef:function(e,t){r(t.isOwnedBy(this));var o=this.refs===n?this.refs={}:this.refs;o[e]=t},detachRef:function(e){delete this.refs[e]}}};t.exports=o},{"./emptyObject":119,"./invariant":137}],73:[function(e,t){"use strict";function n(e,t,n){return n}var r={enableMeasure:!1,storedMeasure:n,measure:function(e,t,n){return n},injection:{injectMeasure:function(e){r.storedMeasure=e}}};t.exports=r},{}],74:[function(e,t){"use strict";function n(e){return function(t,n,r){t[n]=t.hasOwnProperty(n)?e(t[n],r):r}}function r(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=c[n];r&&c.hasOwnProperty(n)?r(e,n,t[n]):e.hasOwnProperty(n)||(e[n]=t[n])}return e}var o=e("./Object.assign"),i=e("./emptyFunction"),a=e("./invariant"),s=e("./joinClasses"),u=(e("./warning"),n(function(e,t){return o({},t,e)})),c={children:i,className:n(s),style:u},l={TransferStrategies:c,mergeProps:function(e,t){return r(o({},e),t)},Mixin:{transferPropsTo:function(e){return a(e._owner===this),r(e.props,this.props),e}}};t.exports=l},{"./Object.assign":29,"./emptyFunction":118,"./invariant":137,"./joinClasses":142,"./warning":155}],75:[function(e,t){"use strict";var n={};t.exports=n},{}],76:[function(e,t){"use strict";var n=e("./keyMirror"),r=n({prop:null,context:null,childContext:null});t.exports=r},{"./keyMirror":143}],77:[function(e,t){"use strict";function n(e){function t(t,n,r,o,i){if(o=o||C,null!=n[r])return e(n,r,o,i);var a=y[i];return t?new Error("Required "+a+" `"+r+"` was not specified in "+("`"+o+"`.")):void 0}var n=t.bind(null,!1);return n.isRequired=t.bind(null,!0),n}function r(e){function t(t,n,r,o){var i=t[n],a=h(i);if(a!==e){var s=y[o],u=m(i);return new Error("Invalid "+s+" `"+n+"` of type `"+u+"` "+("supplied to `"+r+"`, expected `"+e+"`."))}}return n(t)}function o(){return n(E.thatReturns())}function i(e){function t(t,n,r,o){var i=t[n];if(!Array.isArray(i)){var a=y[o],s=h(i);return new Error("Invalid "+a+" `"+n+"` of type "+("`"+s+"` supplied to `"+r+"`, expected an array."))}for(var u=0;u<i.length;u++){var c=e(i,u,r,o);if(c instanceof Error)return c}}return n(t)}function a(){function e(e,t,n,r){if(!v.isValidElement(e[t])){var o=y[r];return new Error("Invalid "+o+" `"+t+"` supplied to "+("`"+n+"`, expected a ReactElement."))}}return n(e)}function s(e){function t(t,n,r,o){if(!(t[n]instanceof e)){var i=y[o],a=e.name||C;return new Error("Invalid "+i+" `"+n+"` supplied to "+("`"+r+"`, expected instance of `"+a+"`."))}}return n(t)}function u(e){function t(t,n,r,o){for(var i=t[n],a=0;a<e.length;a++)if(i===e[a])return;var s=y[o],u=JSON.stringify(e);return new Error("Invalid "+s+" `"+n+"` of value `"+i+"` "+("supplied to `"+r+"`, expected one of "+u+"."))}return n(t)}function c(e){function t(t,n,r,o){var i=t[n],a=h(i);if("object"!==a){var s=y[o];return new Error("Invalid "+s+" `"+n+"` of type "+("`"+a+"` supplied to `"+r+"`, expected an object."))}for(var u in i)if(i.hasOwnProperty(u)){var c=e(i,u,r,o);if(c instanceof Error)return c}}return n(t)}function l(e){function t(t,n,r,o){for(var i=0;i<e.length;i++){var a=e[i];if(null==a(t,n,r,o))return}var s=y[o];return new Error("Invalid "+s+" `"+n+"` supplied to "+("`"+r+"`."))}return n(t)}function p(){function e(e,t,n,r){if(!f(e[t])){var o=y[r];return new Error("Invalid "+o+" `"+t+"` supplied to "+("`"+n+"`, expected a ReactNode."))}}return n(e)}function d(e){function t(t,n,r,o){var i=t[n],a=h(i);if("object"!==a){var s=y[o];return new Error("Invalid "+s+" `"+n+"` of type `"+a+"` "+("supplied to `"+r+"`, expected `object`."))}for(var u in e){var c=e[u];if(c){var l=c(i,u,r,o);if(l)return l}}}return n(t,"expected `object`")}function f(e){switch(typeof e){case"number":case"string":return!0;case"boolean":return!e;case"object":if(Array.isArray(e))return e.every(f);if(v.isValidElement(e))return!0;for(var t in e)if(!f(e[t]))return!1;return!0;default:return!1}}function h(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":t}function m(e){var t=h(e);if("object"===t){if(e instanceof Date)return"date";if(e instanceof RegExp)return"regexp"}return t}var v=e("./ReactElement"),y=e("./ReactPropTypeLocationNames"),g=e("./deprecated"),E=e("./emptyFunction"),C="<<anonymous>>",R=a(),M=p(),b={array:r("array"),bool:r("boolean"),func:r("function"),number:r("number"),object:r("object"),string:r("string"),any:o(),arrayOf:i,element:R,instanceOf:s,node:M,objectOf:c,oneOf:u,oneOfType:l,shape:d,component:g("React.PropTypes","component","element",this,R),renderable:g("React.PropTypes","renderable","node",this,M)};t.exports=b},{"./ReactElement":56,"./ReactPropTypeLocationNames":75,"./deprecated":117,"./emptyFunction":118}],78:[function(e,t){"use strict";function n(){this.listenersToPut=[]}var r=e("./PooledClass"),o=e("./ReactBrowserEventEmitter"),i=e("./Object.assign");i(n.prototype,{enqueuePutListener:function(e,t,n){this.listenersToPut.push({rootNodeID:e,propKey:t,propValue:n})},putListeners:function(){for(var e=0;e<this.listenersToPut.length;e++){var t=this.listenersToPut[e];o.putListener(t.rootNodeID,t.propKey,t.propValue)}},reset:function(){this.listenersToPut.length=0},destructor:function(){this.reset()}}),r.addPoolingTo(n),t.exports=n},{"./Object.assign":29,"./PooledClass":30,"./ReactBrowserEventEmitter":33}],79:[function(e,t){"use strict";function n(){this.reinitializeTransaction(),this.renderToStaticMarkup=!1,this.reactMountReady=r.getPooled(null),this.putListenerQueue=s.getPooled()}var r=e("./CallbackQueue"),o=e("./PooledClass"),i=e("./ReactBrowserEventEmitter"),a=e("./ReactInputSelection"),s=e("./ReactPutListenerQueue"),u=e("./Transaction"),c=e("./Object.assign"),l={initialize:a.getSelectionInformation,close:a.restoreSelection},p={initialize:function(){var e=i.isEnabled();return i.setEnabled(!1),e},close:function(e){i.setEnabled(e)}},d={initialize:function(){this.reactMountReady.reset()},close:function(){this.reactMountReady.notifyAll()}},f={initialize:function(){this.putListenerQueue.reset()},close:function(){this.putListenerQueue.putListeners()}},h=[f,l,p,d],m={getTransactionWrappers:function(){return h},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){r.release(this.reactMountReady),this.reactMountReady=null,s.release(this.putListenerQueue),this.putListenerQueue=null}};c(n.prototype,u.Mixin,m),o.addPoolingTo(n),t.exports=n},{"./CallbackQueue":7,"./Object.assign":29,"./PooledClass":30,"./ReactBrowserEventEmitter":33,"./ReactInputSelection":63,"./ReactPutListenerQueue":78,"./Transaction":104}],80:[function(e,t){"use strict";var n={injectCreateReactRootIndex:function(e){r.createReactRootIndex=e}},r={createReactRootIndex:null,injection:n};t.exports=r},{}],81:[function(e,t){"use strict";function n(e){c(o.isValidElement(e));var t;try{var n=i.createReactRootID();return t=s.getPooled(!1),t.perform(function(){var r=u(e,null),o=r.mountComponent(n,t,0);return a.addChecksumToMarkup(o)},null)}finally{s.release(t)}}function r(e){c(o.isValidElement(e));var t;try{var n=i.createReactRootID();return t=s.getPooled(!0),t.perform(function(){var r=u(e,null);return r.mountComponent(n,t,0)},null)}finally{s.release(t)}}var o=e("./ReactElement"),i=e("./ReactInstanceHandles"),a=e("./ReactMarkupChecksum"),s=e("./ReactServerRenderingTransaction"),u=e("./instantiateReactComponent"),c=e("./invariant");t.exports={renderToString:n,renderToStaticMarkup:r}},{"./ReactElement":56,"./ReactInstanceHandles":64,"./ReactMarkupChecksum":67,"./ReactServerRenderingTransaction":82,"./instantiateReactComponent":136,"./invariant":137}],82:[function(e,t){"use strict";function n(e){this.reinitializeTransaction(),this.renderToStaticMarkup=e,this.reactMountReady=o.getPooled(null),this.putListenerQueue=i.getPooled()}var r=e("./PooledClass"),o=e("./CallbackQueue"),i=e("./ReactPutListenerQueue"),a=e("./Transaction"),s=e("./Object.assign"),u=e("./emptyFunction"),c={initialize:function(){this.reactMountReady.reset()
},close:u},l={initialize:function(){this.putListenerQueue.reset()},close:u},p=[l,c],d={getTransactionWrappers:function(){return p},getReactMountReady:function(){return this.reactMountReady},getPutListenerQueue:function(){return this.putListenerQueue},destructor:function(){o.release(this.reactMountReady),this.reactMountReady=null,i.release(this.putListenerQueue),this.putListenerQueue=null}};s(n.prototype,a.Mixin,d),r.addPoolingTo(n),t.exports=n},{"./CallbackQueue":7,"./Object.assign":29,"./PooledClass":30,"./ReactPutListenerQueue":78,"./Transaction":104,"./emptyFunction":118}],83:[function(e,t){"use strict";function n(e,t){var n={};return function(r){n[t]=r,e.setState(n)}}var r={createStateSetter:function(e,t){return function(n,r,o,i,a,s){var u=t.call(e,n,r,o,i,a,s);u&&e.setState(u)}},createStateKeySetter:function(e,t){var r=e.__keySetters||(e.__keySetters={});return r[t]||(r[t]=n(e,t))}};r.Mixin={createStateSetter:function(e){return r.createStateSetter(this,e)},createStateKeySetter:function(e){return r.createStateKeySetter(this,e)}},t.exports=r},{}],84:[function(e,t){"use strict";var n=e("./DOMPropertyOperations"),r=e("./ReactComponent"),o=e("./ReactElement"),i=e("./Object.assign"),a=e("./escapeTextForBrowser"),s=function(){};i(s.prototype,r.Mixin,{mountComponent:function(e,t,o){r.Mixin.mountComponent.call(this,e,t,o);var i=a(this.props);return t.renderToStaticMarkup?i:"<span "+n.createMarkupForID(e)+">"+i+"</span>"},receiveComponent:function(e){var t=e.props;t!==this.props&&(this.props=t,r.BackendIDOperations.updateTextContentByID(this._rootNodeID,t))}});var u=function(e){return new o(s,null,null,null,null,e)};u.type=s,t.exports=u},{"./DOMPropertyOperations":13,"./Object.assign":29,"./ReactComponent":37,"./ReactElement":56,"./escapeTextForBrowser":120}],85:[function(e,t){"use strict";var n=e("./ReactChildren"),r={getChildMapping:function(e){return n.map(e,function(e){return e})},mergeChildMappings:function(e,t){function n(n){return t.hasOwnProperty(n)?t[n]:e[n]}e=e||{},t=t||{};var r={},o=[];for(var i in e)t.hasOwnProperty(i)?o.length&&(r[i]=o,o=[]):o.push(i);var a,s={};for(var u in t){if(r.hasOwnProperty(u))for(a=0;a<r[u].length;a++){var c=r[u][a];s[r[u][a]]=n(c)}s[u]=n(u)}for(a=0;a<o.length;a++)s[o[a]]=n(o[a]);return s}};t.exports=r},{"./ReactChildren":36}],86:[function(e,t){"use strict";function n(){var e=document.createElement("div"),t=e.style;"AnimationEvent"in window||delete a.animationend.animation,"TransitionEvent"in window||delete a.transitionend.transition;for(var n in a){var r=a[n];for(var o in r)if(o in t){s.push(r[o]);break}}}function r(e,t,n){e.addEventListener(t,n,!1)}function o(e,t,n){e.removeEventListener(t,n,!1)}var i=e("./ExecutionEnvironment"),a={transitionend:{transition:"transitionend",WebkitTransition:"webkitTransitionEnd",MozTransition:"mozTransitionEnd",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd"},animationend:{animation:"animationend",WebkitAnimation:"webkitAnimationEnd",MozAnimation:"mozAnimationEnd",OAnimation:"oAnimationEnd",msAnimation:"MSAnimationEnd"}},s=[];i.canUseDOM&&n();var u={addEndEventListener:function(e,t){return 0===s.length?void window.setTimeout(t,0):void s.forEach(function(n){r(e,n,t)})},removeEndEventListener:function(e,t){0!==s.length&&s.forEach(function(n){o(e,n,t)})}};t.exports=u},{"./ExecutionEnvironment":23}],87:[function(e,t){"use strict";var n=e("./React"),r=e("./ReactTransitionChildMapping"),o=e("./Object.assign"),i=e("./cloneWithProps"),a=e("./emptyFunction"),s=n.createClass({displayName:"ReactTransitionGroup",propTypes:{component:n.PropTypes.any,childFactory:n.PropTypes.func},getDefaultProps:function(){return{component:"span",childFactory:a.thatReturnsArgument}},getInitialState:function(){return{children:r.getChildMapping(this.props.children)}},componentWillReceiveProps:function(e){var t=r.getChildMapping(e.children),n=this.state.children;this.setState({children:r.mergeChildMappings(n,t)});var o;for(o in t){var i=n&&n.hasOwnProperty(o);!t[o]||i||this.currentlyTransitioningKeys[o]||this.keysToEnter.push(o)}for(o in n){var a=t&&t.hasOwnProperty(o);!n[o]||a||this.currentlyTransitioningKeys[o]||this.keysToLeave.push(o)}},componentWillMount:function(){this.currentlyTransitioningKeys={},this.keysToEnter=[],this.keysToLeave=[]},componentDidUpdate:function(){var e=this.keysToEnter;this.keysToEnter=[],e.forEach(this.performEnter);var t=this.keysToLeave;this.keysToLeave=[],t.forEach(this.performLeave)},performEnter:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillEnter?t.componentWillEnter(this._handleDoneEntering.bind(this,e)):this._handleDoneEntering(e)},_handleDoneEntering:function(e){var t=this.refs[e];t.componentDidEnter&&t.componentDidEnter(),delete this.currentlyTransitioningKeys[e];var n=r.getChildMapping(this.props.children);n&&n.hasOwnProperty(e)||this.performLeave(e)},performLeave:function(e){this.currentlyTransitioningKeys[e]=!0;var t=this.refs[e];t.componentWillLeave?t.componentWillLeave(this._handleDoneLeaving.bind(this,e)):this._handleDoneLeaving(e)},_handleDoneLeaving:function(e){var t=this.refs[e];t.componentDidLeave&&t.componentDidLeave(),delete this.currentlyTransitioningKeys[e];var n=r.getChildMapping(this.props.children);if(n&&n.hasOwnProperty(e))this.performEnter(e);else{var i=o({},this.state.children);delete i[e],this.setState({children:i})}},render:function(){var e={};for(var t in this.state.children){var r=this.state.children[t];r&&(e[t]=i(this.props.childFactory(r),{ref:t}))}return n.createElement(this.props.component,this.props,e)}});t.exports=s},{"./Object.assign":29,"./React":31,"./ReactTransitionChildMapping":85,"./cloneWithProps":110,"./emptyFunction":118}],88:[function(e,t){"use strict";function n(){h(O.ReactReconcileTransaction&&g)}function r(){this.reinitializeTransaction(),this.dirtyComponentsLength=null,this.callbackQueue=c.getPooled(),this.reconcileTransaction=O.ReactReconcileTransaction.getPooled()}function o(e,t,r){n(),g.batchedUpdates(e,t,r)}function i(e,t){return e._mountDepth-t._mountDepth}function a(e){var t=e.dirtyComponentsLength;h(t===m.length),m.sort(i);for(var n=0;t>n;n++){var r=m[n];if(r.isMounted()){var o=r._pendingCallbacks;if(r._pendingCallbacks=null,r.performUpdateIfNecessary(e.reconcileTransaction),o)for(var a=0;a<o.length;a++)e.callbackQueue.enqueue(o[a],r)}}}function s(e,t){return h(!t||"function"==typeof t),n(),g.isBatchingUpdates?(m.push(e),void(t&&(e._pendingCallbacks?e._pendingCallbacks.push(t):e._pendingCallbacks=[t]))):void g.batchedUpdates(s,e,t)}function u(e,t){h(g.isBatchingUpdates),v.enqueue(e,t),y=!0}var c=e("./CallbackQueue"),l=e("./PooledClass"),p=(e("./ReactCurrentOwner"),e("./ReactPerf")),d=e("./Transaction"),f=e("./Object.assign"),h=e("./invariant"),m=(e("./warning"),[]),v=c.getPooled(),y=!1,g=null,E={initialize:function(){this.dirtyComponentsLength=m.length},close:function(){this.dirtyComponentsLength!==m.length?(m.splice(0,this.dirtyComponentsLength),M()):m.length=0}},C={initialize:function(){this.callbackQueue.reset()},close:function(){this.callbackQueue.notifyAll()}},R=[E,C];f(r.prototype,d.Mixin,{getTransactionWrappers:function(){return R},destructor:function(){this.dirtyComponentsLength=null,c.release(this.callbackQueue),this.callbackQueue=null,O.ReactReconcileTransaction.release(this.reconcileTransaction),this.reconcileTransaction=null},perform:function(e,t,n){return d.Mixin.perform.call(this,this.reconcileTransaction.perform,this.reconcileTransaction,e,t,n)}}),l.addPoolingTo(r);var M=p.measure("ReactUpdates","flushBatchedUpdates",function(){for(;m.length||y;){if(m.length){var e=r.getPooled();e.perform(a,null,e),r.release(e)}if(y){y=!1;var t=v;v=c.getPooled(),t.notifyAll(),c.release(t)}}}),b={injectReconcileTransaction:function(e){h(e),O.ReactReconcileTransaction=e},injectBatchingStrategy:function(e){h(e),h("function"==typeof e.batchedUpdates),h("boolean"==typeof e.isBatchingUpdates),g=e}},O={ReactReconcileTransaction:null,batchedUpdates:o,enqueueUpdate:s,flushBatchedUpdates:M,injection:b,asap:u};t.exports=O},{"./CallbackQueue":7,"./Object.assign":29,"./PooledClass":30,"./ReactCurrentOwner":42,"./ReactPerf":73,"./Transaction":104,"./invariant":137,"./warning":155}],89:[function(e,t){"use strict";var n=e("./DOMProperty"),r=n.injection.MUST_USE_ATTRIBUTE,o={Properties:{cx:r,cy:r,d:r,dx:r,dy:r,fill:r,fillOpacity:r,fontFamily:r,fontSize:r,fx:r,fy:r,gradientTransform:r,gradientUnits:r,markerEnd:r,markerMid:r,markerStart:r,offset:r,opacity:r,patternContentUnits:r,patternUnits:r,points:r,preserveAspectRatio:r,r:r,rx:r,ry:r,spreadMethod:r,stopColor:r,stopOpacity:r,stroke:r,strokeDasharray:r,strokeLinecap:r,strokeOpacity:r,strokeWidth:r,textAnchor:r,transform:r,version:r,viewBox:r,x1:r,x2:r,x:r,y1:r,y2:r,y:r},DOMAttributeNames:{fillOpacity:"fill-opacity",fontFamily:"font-family",fontSize:"font-size",gradientTransform:"gradientTransform",gradientUnits:"gradientUnits",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",patternContentUnits:"patternContentUnits",patternUnits:"patternUnits",preserveAspectRatio:"preserveAspectRatio",spreadMethod:"spreadMethod",stopColor:"stop-color",stopOpacity:"stop-opacity",strokeDasharray:"stroke-dasharray",strokeLinecap:"stroke-linecap",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",textAnchor:"text-anchor",viewBox:"viewBox"}};t.exports=o},{"./DOMProperty":12}],90:[function(e,t){"use strict";function n(e){if("selectionStart"in e&&a.hasSelectionCapabilities(e))return{start:e.selectionStart,end:e.selectionEnd};if(window.getSelection){var t=window.getSelection();return{anchorNode:t.anchorNode,anchorOffset:t.anchorOffset,focusNode:t.focusNode,focusOffset:t.focusOffset}}if(document.selection){var n=document.selection.createRange();return{parentElement:n.parentElement(),text:n.text,top:n.boundingTop,left:n.boundingLeft}}}function r(e){if(!y&&null!=h&&h==u()){var t=n(h);if(!v||!p(v,t)){v=t;var r=s.getPooled(f.select,m,e);return r.type="select",r.target=h,i.accumulateTwoPhaseDispatches(r),r}}}var o=e("./EventConstants"),i=e("./EventPropagators"),a=e("./ReactInputSelection"),s=e("./SyntheticEvent"),u=e("./getActiveElement"),c=e("./isTextInputElement"),l=e("./keyOf"),p=e("./shallowEqual"),d=o.topLevelTypes,f={select:{phasedRegistrationNames:{bubbled:l({onSelect:null}),captured:l({onSelectCapture:null})},dependencies:[d.topBlur,d.topContextMenu,d.topFocus,d.topKeyDown,d.topMouseDown,d.topMouseUp,d.topSelectionChange]}},h=null,m=null,v=null,y=!1,g={eventTypes:f,extractEvents:function(e,t,n,o){switch(e){case d.topFocus:(c(t)||"true"===t.contentEditable)&&(h=t,m=n,v=null);break;case d.topBlur:h=null,m=null,v=null;break;case d.topMouseDown:y=!0;break;case d.topContextMenu:case d.topMouseUp:return y=!1,r(o);case d.topSelectionChange:case d.topKeyDown:case d.topKeyUp:return r(o)}}};t.exports=g},{"./EventConstants":17,"./EventPropagators":22,"./ReactInputSelection":63,"./SyntheticEvent":96,"./getActiveElement":124,"./isTextInputElement":140,"./keyOf":144,"./shallowEqual":150}],91:[function(e,t){"use strict";var n=Math.pow(2,53),r={createReactRootIndex:function(){return Math.ceil(Math.random()*n)}};t.exports=r},{}],92:[function(e,t){"use strict";var n=e("./EventConstants"),r=e("./EventPluginUtils"),o=e("./EventPropagators"),i=e("./SyntheticClipboardEvent"),a=e("./SyntheticEvent"),s=e("./SyntheticFocusEvent"),u=e("./SyntheticKeyboardEvent"),c=e("./SyntheticMouseEvent"),l=e("./SyntheticDragEvent"),p=e("./SyntheticTouchEvent"),d=e("./SyntheticUIEvent"),f=e("./SyntheticWheelEvent"),h=e("./getEventCharCode"),m=e("./invariant"),v=e("./keyOf"),y=(e("./warning"),n.topLevelTypes),g={blur:{phasedRegistrationNames:{bubbled:v({onBlur:!0}),captured:v({onBlurCapture:!0})}},click:{phasedRegistrationNames:{bubbled:v({onClick:!0}),captured:v({onClickCapture:!0})}},contextMenu:{phasedRegistrationNames:{bubbled:v({onContextMenu:!0}),captured:v({onContextMenuCapture:!0})}},copy:{phasedRegistrationNames:{bubbled:v({onCopy:!0}),captured:v({onCopyCapture:!0})}},cut:{phasedRegistrationNames:{bubbled:v({onCut:!0}),captured:v({onCutCapture:!0})}},doubleClick:{phasedRegistrationNames:{bubbled:v({onDoubleClick:!0}),captured:v({onDoubleClickCapture:!0})}},drag:{phasedRegistrationNames:{bubbled:v({onDrag:!0}),captured:v({onDragCapture:!0})}},dragEnd:{phasedRegistrationNames:{bubbled:v({onDragEnd:!0}),captured:v({onDragEndCapture:!0})}},dragEnter:{phasedRegistrationNames:{bubbled:v({onDragEnter:!0}),captured:v({onDragEnterCapture:!0})}},dragExit:{phasedRegistrationNames:{bubbled:v({onDragExit:!0}),captured:v({onDragExitCapture:!0})}},dragLeave:{phasedRegistrationNames:{bubbled:v({onDragLeave:!0}),captured:v({onDragLeaveCapture:!0})}},dragOver:{phasedRegistrationNames:{bubbled:v({onDragOver:!0}),captured:v({onDragOverCapture:!0})}},dragStart:{phasedRegistrationNames:{bubbled:v({onDragStart:!0}),captured:v({onDragStartCapture:!0})}},drop:{phasedRegistrationNames:{bubbled:v({onDrop:!0}),captured:v({onDropCapture:!0})}},focus:{phasedRegistrationNames:{bubbled:v({onFocus:!0}),captured:v({onFocusCapture:!0})}},input:{phasedRegistrationNames:{bubbled:v({onInput:!0}),captured:v({onInputCapture:!0})}},keyDown:{phasedRegistrationNames:{bubbled:v({onKeyDown:!0}),captured:v({onKeyDownCapture:!0})}},keyPress:{phasedRegistrationNames:{bubbled:v({onKeyPress:!0}),captured:v({onKeyPressCapture:!0})}},keyUp:{phasedRegistrationNames:{bubbled:v({onKeyUp:!0}),captured:v({onKeyUpCapture:!0})}},load:{phasedRegistrationNames:{bubbled:v({onLoad:!0}),captured:v({onLoadCapture:!0})}},error:{phasedRegistrationNames:{bubbled:v({onError:!0}),captured:v({onErrorCapture:!0})}},mouseDown:{phasedRegistrationNames:{bubbled:v({onMouseDown:!0}),captured:v({onMouseDownCapture:!0})}},mouseMove:{phasedRegistrationNames:{bubbled:v({onMouseMove:!0}),captured:v({onMouseMoveCapture:!0})}},mouseOut:{phasedRegistrationNames:{bubbled:v({onMouseOut:!0}),captured:v({onMouseOutCapture:!0})}},mouseOver:{phasedRegistrationNames:{bubbled:v({onMouseOver:!0}),captured:v({onMouseOverCapture:!0})}},mouseUp:{phasedRegistrationNames:{bubbled:v({onMouseUp:!0}),captured:v({onMouseUpCapture:!0})}},paste:{phasedRegistrationNames:{bubbled:v({onPaste:!0}),captured:v({onPasteCapture:!0})}},reset:{phasedRegistrationNames:{bubbled:v({onReset:!0}),captured:v({onResetCapture:!0})}},scroll:{phasedRegistrationNames:{bubbled:v({onScroll:!0}),captured:v({onScrollCapture:!0})}},submit:{phasedRegistrationNames:{bubbled:v({onSubmit:!0}),captured:v({onSubmitCapture:!0})}},touchCancel:{phasedRegistrationNames:{bubbled:v({onTouchCancel:!0}),captured:v({onTouchCancelCapture:!0})}},touchEnd:{phasedRegistrationNames:{bubbled:v({onTouchEnd:!0}),captured:v({onTouchEndCapture:!0})}},touchMove:{phasedRegistrationNames:{bubbled:v({onTouchMove:!0}),captured:v({onTouchMoveCapture:!0})}},touchStart:{phasedRegistrationNames:{bubbled:v({onTouchStart:!0}),captured:v({onTouchStartCapture:!0})}},wheel:{phasedRegistrationNames:{bubbled:v({onWheel:!0}),captured:v({onWheelCapture:!0})}}},E={topBlur:g.blur,topClick:g.click,topContextMenu:g.contextMenu,topCopy:g.copy,topCut:g.cut,topDoubleClick:g.doubleClick,topDrag:g.drag,topDragEnd:g.dragEnd,topDragEnter:g.dragEnter,topDragExit:g.dragExit,topDragLeave:g.dragLeave,topDragOver:g.dragOver,topDragStart:g.dragStart,topDrop:g.drop,topError:g.error,topFocus:g.focus,topInput:g.input,topKeyDown:g.keyDown,topKeyPress:g.keyPress,topKeyUp:g.keyUp,topLoad:g.load,topMouseDown:g.mouseDown,topMouseMove:g.mouseMove,topMouseOut:g.mouseOut,topMouseOver:g.mouseOver,topMouseUp:g.mouseUp,topPaste:g.paste,topReset:g.reset,topScroll:g.scroll,topSubmit:g.submit,topTouchCancel:g.touchCancel,topTouchEnd:g.touchEnd,topTouchMove:g.touchMove,topTouchStart:g.touchStart,topWheel:g.wheel};for(var C in E)E[C].dependencies=[C];var R={eventTypes:g,executeDispatch:function(e,t,n){var o=r.executeDispatch(e,t,n);o===!1&&(e.stopPropagation(),e.preventDefault())},extractEvents:function(e,t,n,r){var v=E[e];if(!v)return null;var g;switch(e){case y.topInput:case y.topLoad:case y.topError:case y.topReset:case y.topSubmit:g=a;break;case y.topKeyPress:if(0===h(r))return null;case y.topKeyDown:case y.topKeyUp:g=u;break;case y.topBlur:case y.topFocus:g=s;break;case y.topClick:if(2===r.button)return null;case y.topContextMenu:case y.topDoubleClick:case y.topMouseDown:case y.topMouseMove:case y.topMouseOut:case y.topMouseOver:case y.topMouseUp:g=c;break;case y.topDrag:case y.topDragEnd:case y.topDragEnter:case y.topDragExit:case y.topDragLeave:case y.topDragOver:case y.topDragStart:case y.topDrop:g=l;break;case y.topTouchCancel:case y.topTouchEnd:case y.topTouchMove:case y.topTouchStart:g=p;break;case y.topScroll:g=d;break;case y.topWheel:g=f;break;case y.topCopy:case y.topCut:case y.topPaste:g=i}m(g);var C=g.getPooled(v,n,r);return o.accumulateTwoPhaseDispatches(C),C}};t.exports=R},{"./EventConstants":17,"./EventPluginUtils":21,"./EventPropagators":22,"./SyntheticClipboardEvent":93,"./SyntheticDragEvent":95,"./SyntheticEvent":96,"./SyntheticFocusEvent":97,"./SyntheticKeyboardEvent":99,"./SyntheticMouseEvent":100,"./SyntheticTouchEvent":101,"./SyntheticUIEvent":102,"./SyntheticWheelEvent":103,"./getEventCharCode":125,"./invariant":137,"./keyOf":144,"./warning":155}],93:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),o={clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}};r.augmentClass(n,o),t.exports=n},{"./SyntheticEvent":96}],94:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),o={data:null};r.augmentClass(n,o),t.exports=n},{"./SyntheticEvent":96}],95:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticMouseEvent"),o={dataTransfer:null};r.augmentClass(n,o),t.exports=n},{"./SyntheticMouseEvent":100}],96:[function(e,t){"use strict";function n(e,t,n){this.dispatchConfig=e,this.dispatchMarker=t,this.nativeEvent=n;var r=this.constructor.Interface;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];this[o]=a?a(n):n[o]}var s=null!=n.defaultPrevented?n.defaultPrevented:n.returnValue===!1;this.isDefaultPrevented=s?i.thatReturnsTrue:i.thatReturnsFalse,this.isPropagationStopped=i.thatReturnsFalse}var r=e("./PooledClass"),o=e("./Object.assign"),i=e("./emptyFunction"),a=e("./getEventTarget"),s={type:null,target:a,currentTarget:i.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};o(n.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e.preventDefault?e.preventDefault():e.returnValue=!1,this.isDefaultPrevented=i.thatReturnsTrue},stopPropagation:function(){var e=this.nativeEvent;e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,this.isPropagationStopped=i.thatReturnsTrue},persist:function(){this.isPersistent=i.thatReturnsTrue},isPersistent:i.thatReturnsFalse,destructor:function(){var e=this.constructor.Interface;for(var t in e)this[t]=null;this.dispatchConfig=null,this.dispatchMarker=null,this.nativeEvent=null}}),n.Interface=s,n.augmentClass=function(e,t){var n=this,i=Object.create(n.prototype);o(i,e.prototype),e.prototype=i,e.prototype.constructor=e,e.Interface=o({},n.Interface,t),e.augmentClass=n.augmentClass,r.addPoolingTo(e,r.threeArgumentPooler)},r.addPoolingTo(n,r.threeArgumentPooler),t.exports=n},{"./Object.assign":29,"./PooledClass":30,"./emptyFunction":118,"./getEventTarget":128}],97:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),o={relatedTarget:null};r.augmentClass(n,o),t.exports=n},{"./SyntheticUIEvent":102}],98:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),o={data:null};r.augmentClass(n,o),t.exports=n},{"./SyntheticEvent":96}],99:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),o=e("./getEventCharCode"),i=e("./getEventKey"),a=e("./getEventModifierState"),s={key:i,location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:a,charCode:function(e){return"keypress"===e.type?o(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?o(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}};r.augmentClass(n,s),t.exports=n},{"./SyntheticUIEvent":102,"./getEventCharCode":125,"./getEventKey":126,"./getEventModifierState":127}],100:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),o=e("./ViewportMetrics"),i=e("./getEventModifierState"),a={screenX:null,screenY:null,clientX:null,clientY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:i,button:function(e){var t=e.button;return"which"in e?t:2===t?2:4===t?1:0},buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},pageX:function(e){return"pageX"in e?e.pageX:e.clientX+o.currentScrollLeft},pageY:function(e){return"pageY"in e?e.pageY:e.clientY+o.currentScrollTop}};r.augmentClass(n,a),t.exports=n},{"./SyntheticUIEvent":102,"./ViewportMetrics":105,"./getEventModifierState":127}],101:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticUIEvent"),o=e("./getEventModifierState"),i={touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:o};r.augmentClass(n,i),t.exports=n},{"./SyntheticUIEvent":102,"./getEventModifierState":127}],102:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticEvent"),o=e("./getEventTarget"),i={view:function(e){if(e.view)return e.view;var t=o(e);if(null!=t&&t.window===t)return t;var n=t.ownerDocument;return n?n.defaultView||n.parentWindow:window},detail:function(e){return e.detail||0}};r.augmentClass(n,i),t.exports=n},{"./SyntheticEvent":96,"./getEventTarget":128}],103:[function(e,t){"use strict";function n(e,t,n){r.call(this,e,t,n)}var r=e("./SyntheticMouseEvent"),o={deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null};r.augmentClass(n,o),t.exports=n},{"./SyntheticMouseEvent":100}],104:[function(e,t){"use strict";var n=e("./invariant"),r={reinitializeTransaction:function(){this.transactionWrappers=this.getTransactionWrappers(),this.wrapperInitData?this.wrapperInitData.length=0:this.wrapperInitData=[],this._isInTransaction=!1},_isInTransaction:!1,getTransactionWrappers:null,isInTransaction:function(){return!!this._isInTransaction},perform:function(e,t,r,o,i,a,s,u){n(!this.isInTransaction());var c,l;try{this._isInTransaction=!0,c=!0,this.initializeAll(0),l=e.call(t,r,o,i,a,s,u),c=!1}finally{try{if(c)try{this.closeAll(0)}catch(p){}else this.closeAll(0)}finally{this._isInTransaction=!1}}return l},initializeAll:function(e){for(var t=this.transactionWrappers,n=e;n<t.length;n++){var r=t[n];try{this.wrapperInitData[n]=o.OBSERVED_ERROR,this.wrapperInitData[n]=r.initialize?r.initialize.call(this):null}finally{if(this.wrapperInitData[n]===o.OBSERVED_ERROR)try{this.initializeAll(n+1)}catch(i){}}}},closeAll:function(e){n(this.isInTransaction());for(var t=this.transactionWrappers,r=e;r<t.length;r++){var i,a=t[r],s=this.wrapperInitData[r];try{i=!0,s!==o.OBSERVED_ERROR&&a.close&&a.close.call(this,s),i=!1}finally{if(i)try{this.closeAll(r+1)}catch(u){}}}this.wrapperInitData.length=0}},o={Mixin:r,OBSERVED_ERROR:{}};t.exports=o},{"./invariant":137}],105:[function(e,t){"use strict";var n=e("./getUnboundedScrollPosition"),r={currentScrollLeft:0,currentScrollTop:0,refreshScrollValues:function(){var e=n(window);r.currentScrollLeft=e.x,r.currentScrollTop=e.y}};t.exports=r},{"./getUnboundedScrollPosition":133}],106:[function(e,t){"use strict";function n(e,t){if(r(null!=t),null==e)return t;var n=Array.isArray(e),o=Array.isArray(t);return n&&o?(e.push.apply(e,t),e):n?(e.push(t),e):o?[e].concat(t):[e,t]}var r=e("./invariant");t.exports=n},{"./invariant":137}],107:[function(e,t){"use strict";function n(e){for(var t=1,n=0,o=0;o<e.length;o++)t=(t+e.charCodeAt(o))%r,n=(n+t)%r;return t|n<<16}var r=65521;t.exports=n},{}],108:[function(e,t){function n(e){return e.replace(r,function(e,t){return t.toUpperCase()})}var r=/-(.)/g;t.exports=n},{}],109:[function(e,t){"use strict";function n(e){return r(e.replace(o,"ms-"))}var r=e("./camelize"),o=/^-ms-/;t.exports=n},{"./camelize":108}],110:[function(e,t){"use strict";function n(e,t){var n=o.mergeProps(t,e.props);return!n.hasOwnProperty(a)&&e.props.hasOwnProperty(a)&&(n.children=e.props.children),r.createElement(e.type,n)}var r=e("./ReactElement"),o=e("./ReactPropTransferer"),i=e("./keyOf"),a=(e("./warning"),i({children:null}));t.exports=n},{"./ReactElement":56,"./ReactPropTransferer":74,"./keyOf":144,"./warning":155}],111:[function(e,t){function n(e,t){return e&&t?e===t?!0:r(e)?!1:r(t)?n(e,t.parentNode):e.contains?e.contains(t):e.compareDocumentPosition?!!(16&e.compareDocumentPosition(t)):!1:!1}var r=e("./isTextNode");t.exports=n},{"./isTextNode":141}],112:[function(e,t){function n(e){return!!e&&("object"==typeof e||"function"==typeof e)&&"length"in e&&!("setInterval"in e)&&"number"!=typeof e.nodeType&&(Array.isArray(e)||"callee"in e||"item"in e)}function r(e){return n(e)?Array.isArray(e)?e.slice():o(e):[e]}var o=e("./toArray");t.exports=r},{"./toArray":152}],113:[function(e,t){"use strict";function n(e){var t=o.createFactory(e),n=r.createClass({displayName:"ReactFullPageComponent"+e,componentWillUnmount:function(){i(!1)},render:function(){return t(this.props)}});return n}var r=e("./ReactCompositeComponent"),o=e("./ReactElement"),i=e("./invariant");t.exports=n},{"./ReactCompositeComponent":40,"./ReactElement":56,"./invariant":137}],114:[function(e,t){function n(e){var t=e.match(c);return t&&t[1].toLowerCase()}function r(e,t){var r=u;s(!!u);var o=n(e),c=o&&a(o);if(c){r.innerHTML=c[1]+e+c[2];for(var l=c[0];l--;)r=r.lastChild}else r.innerHTML=e;var p=r.getElementsByTagName("script");p.length&&(s(t),i(p).forEach(t));for(var d=i(r.childNodes);r.lastChild;)r.removeChild(r.lastChild);return d}var o=e("./ExecutionEnvironment"),i=e("./createArrayFrom"),a=e("./getMarkupWrap"),s=e("./invariant"),u=o.canUseDOM?document.createElement("div"):null,c=/^\s*<(\w+)/;t.exports=r},{"./ExecutionEnvironment":23,"./createArrayFrom":112,"./getMarkupWrap":129,"./invariant":137}],115:[function(e,t){function n(e){return"object"==typeof e?Object.keys(e).filter(function(t){return e[t]}).join(" "):Array.prototype.join.call(arguments," ")}t.exports=n},{}],116:[function(e,t){"use strict";function n(e,t){var n=null==t||"boolean"==typeof t||""===t;if(n)return"";var r=isNaN(t);return r||0===t||o.hasOwnProperty(e)&&o[e]?""+t:("string"==typeof t&&(t=t.trim()),t+"px")}var r=e("./CSSProperty"),o=r.isUnitlessNumber;t.exports=n},{"./CSSProperty":5}],117:[function(e,t){function n(e,t,n,r,o){return o}e("./Object.assign"),e("./warning"),t.exports=n},{"./Object.assign":29,"./warning":155}],118:[function(e,t){function n(e){return function(){return e}}function r(){}r.thatReturns=n,r.thatReturnsFalse=n(!1),r.thatReturnsTrue=n(!0),r.thatReturnsNull=n(null),r.thatReturnsThis=function(){return this},r.thatReturnsArgument=function(e){return e},t.exports=r},{}],119:[function(e,t){"use strict";var n={};t.exports=n},{}],120:[function(e,t){"use strict";function n(e){return o[e]}function r(e){return(""+e).replace(i,n)}var o={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},i=/[&><"']/g;t.exports=r},{}],121:[function(e,t){"use strict";function n(e,t,n){var r=e,i=!r.hasOwnProperty(n);if(i&&null!=t){var a,s=typeof t;a="string"===s?o(t):"number"===s?o(""+t):t,r[n]=a}}function r(e){if(null==e)return e;var t={};return i(e,n,t),t}var o=e("./ReactTextComponent"),i=e("./traverseAllChildren");e("./warning"),t.exports=r},{"./ReactTextComponent":84,"./traverseAllChildren":153,"./warning":155}],122:[function(e,t){"use strict";function n(e){try{e.focus()}catch(t){}}t.exports=n},{}],123:[function(e,t){"use strict";var n=function(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)};t.exports=n},{}],124:[function(e,t){function n(){try{return document.activeElement||document.body}catch(e){return document.body}}t.exports=n},{}],125:[function(e,t){"use strict";function n(e){var t,n=e.keyCode;return"charCode"in e?(t=e.charCode,0===t&&13===n&&(t=13)):t=n,t>=32||13===t?t:0}t.exports=n},{}],126:[function(e,t){"use strict";function n(e){if(e.key){var t=o[e.key]||e.key;if("Unidentified"!==t)return t}if("keypress"===e.type){var n=r(e);return 13===n?"Enter":String.fromCharCode(n)}return"keydown"===e.type||"keyup"===e.type?i[e.keyCode]||"Unidentified":""}var r=e("./getEventCharCode"),o={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},i={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};t.exports=n},{"./getEventCharCode":125}],127:[function(e,t){"use strict";function n(e){var t=this,n=t.nativeEvent;if(n.getModifierState)return n.getModifierState(e);var r=o[e];return r?!!n[r]:!1}function r(){return n}var o={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};t.exports=r},{}],128:[function(e,t){"use strict";function n(e){var t=e.target||e.srcElement||window;return 3===t.nodeType?t.parentNode:t}t.exports=n},{}],129:[function(e,t){function n(e){return o(!!i),p.hasOwnProperty(e)||(e="*"),a.hasOwnProperty(e)||(i.innerHTML="*"===e?"<link />":"<"+e+"></"+e+">",a[e]=!i.firstChild),a[e]?p[e]:null}var r=e("./ExecutionEnvironment"),o=e("./invariant"),i=r.canUseDOM?document.createElement("div"):null,a={circle:!0,defs:!0,ellipse:!0,g:!0,line:!0,linearGradient:!0,path:!0,polygon:!0,polyline:!0,radialGradient:!0,rect:!0,stop:!0,text:!0},s=[1,'<select multiple="true">',"</select>"],u=[1,"<table>","</table>"],c=[3,"<table><tbody><tr>","</tr></tbody></table>"],l=[1,"<svg>","</svg>"],p={"*":[1,"?<div>","</div>"],area:[1,"<map>","</map>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],legend:[1,"<fieldset>","</fieldset>"],param:[1,"<object>","</object>"],tr:[2,"<table><tbody>","</tbody></table>"],optgroup:s,option:s,caption:u,colgroup:u,tbody:u,tfoot:u,thead:u,td:c,th:c,circle:l,defs:l,ellipse:l,g:l,line:l,linearGradient:l,path:l,polygon:l,polyline:l,radialGradient:l,rect:l,stop:l,text:l};t.exports=n},{"./ExecutionEnvironment":23,"./invariant":137}],130:[function(e,t){"use strict";function n(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function r(e){for(;e;){if(e.nextSibling)return e.nextSibling;e=e.parentNode}}function o(e,t){for(var o=n(e),i=0,a=0;o;){if(3==o.nodeType){if(a=i+o.textContent.length,t>=i&&a>=t)return{node:o,offset:t-i};i=a}o=n(r(o))}}t.exports=o},{}],131:[function(e,t){"use strict";function n(e){return e?e.nodeType===r?e.documentElement:e.firstChild:null}var r=9;t.exports=n},{}],132:[function(e,t){"use strict";function n(){return!o&&r.canUseDOM&&(o="textContent"in document.documentElement?"textContent":"innerText"),o}var r=e("./ExecutionEnvironment"),o=null;t.exports=n},{"./ExecutionEnvironment":23}],133:[function(e,t){"use strict";function n(e){return e===window?{x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}:{x:e.scrollLeft,y:e.scrollTop}}t.exports=n},{}],134:[function(e,t){function n(e){return e.replace(r,"-$1").toLowerCase()}var r=/([A-Z])/g;t.exports=n},{}],135:[function(e,t){"use strict";function n(e){return r(e).replace(o,"-ms-")}var r=e("./hyphenate"),o=/^ms-/;
t.exports=n},{"./hyphenate":134}],136:[function(e,t){"use strict";function n(e,t){var n;return n="string"==typeof e.type?r.createInstanceForTag(e.type,e.props,t):new e.type(e.props),n.construct(e),n}var r=(e("./warning"),e("./ReactElement"),e("./ReactLegacyElement"),e("./ReactNativeComponent"));e("./ReactEmptyComponent"),t.exports=n},{"./ReactElement":56,"./ReactEmptyComponent":58,"./ReactLegacyElement":65,"./ReactNativeComponent":71,"./warning":155}],137:[function(e,t){"use strict";var n=function(e,t,n,r,o,i,a,s){if(!e){var u;if(void 0===t)u=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,r,o,i,a,s],l=0;u=new Error("Invariant Violation: "+t.replace(/%s/g,function(){return c[l++]}))}throw u.framesToPop=1,u}};t.exports=n},{}],138:[function(e,t){"use strict";function n(e,t){if(!o.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,i=n in document;if(!i){var a=document.createElement("div");a.setAttribute(n,"return;"),i="function"==typeof a[n]}return!i&&r&&"wheel"===e&&(i=document.implementation.hasFeature("Events.wheel","3.0")),i}var r,o=e("./ExecutionEnvironment");o.canUseDOM&&(r=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0),t.exports=n},{"./ExecutionEnvironment":23}],139:[function(e,t){function n(e){return!(!e||!("function"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName))}t.exports=n},{}],140:[function(e,t){"use strict";function n(e){return e&&("INPUT"===e.nodeName&&r[e.type]||"TEXTAREA"===e.nodeName)}var r={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};t.exports=n},{}],141:[function(e,t){function n(e){return r(e)&&3==e.nodeType}var r=e("./isNode");t.exports=n},{"./isNode":139}],142:[function(e,t){"use strict";function n(e){e||(e="");var t,n=arguments.length;if(n>1)for(var r=1;n>r;r++)t=arguments[r],t&&(e=(e?e+" ":"")+t);return e}t.exports=n},{}],143:[function(e,t){"use strict";var n=e("./invariant"),r=function(e){var t,r={};n(e instanceof Object&&!Array.isArray(e));for(t in e)e.hasOwnProperty(t)&&(r[t]=t);return r};t.exports=r},{"./invariant":137}],144:[function(e,t){var n=function(e){var t;for(t in e)if(e.hasOwnProperty(t))return t;return null};t.exports=n},{}],145:[function(e,t){"use strict";function n(e,t,n){if(!e)return null;var o={};for(var i in e)r.call(e,i)&&(o[i]=t.call(n,e[i],i,e));return o}var r=Object.prototype.hasOwnProperty;t.exports=n},{}],146:[function(e,t){"use strict";function n(e){var t={};return function(n){return t.hasOwnProperty(n)?t[n]:t[n]=e.call(this,n)}}t.exports=n},{}],147:[function(e,t){"use strict";function n(e){r(e&&!/[^a-z0-9_]/.test(e))}var r=e("./invariant");t.exports=n},{"./invariant":137}],148:[function(e,t){"use strict";function n(e){return o(r.isValidElement(e)),e}var r=e("./ReactElement"),o=e("./invariant");t.exports=n},{"./ReactElement":56,"./invariant":137}],149:[function(e,t){"use strict";var n=e("./ExecutionEnvironment"),r=/^[ \r\n\t\f]/,o=/<(!--|link|noscript|meta|script|style)[ \r\n\t\f\/>]/,i=function(e,t){e.innerHTML=t};if(n.canUseDOM){var a=document.createElement("div");a.innerHTML=" ",""===a.innerHTML&&(i=function(e,t){if(e.parentNode&&e.parentNode.replaceChild(e,e),r.test(t)||"<"===t[0]&&o.test(t)){e.innerHTML=""+t;var n=e.firstChild;1===n.data.length?e.removeChild(n):n.deleteData(0,1)}else e.innerHTML=t})}t.exports=i},{"./ExecutionEnvironment":23}],150:[function(e,t){"use strict";function n(e,t){if(e===t)return!0;var n;for(n in e)if(e.hasOwnProperty(n)&&(!t.hasOwnProperty(n)||e[n]!==t[n]))return!1;for(n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}t.exports=n},{}],151:[function(e,t){"use strict";function n(e,t){return e&&t&&e.type===t.type&&e.key===t.key&&e._owner===t._owner?!0:!1}t.exports=n},{}],152:[function(e,t){function n(e){var t=e.length;if(r(!Array.isArray(e)&&("object"==typeof e||"function"==typeof e)),r("number"==typeof t),r(0===t||t-1 in e),e.hasOwnProperty)try{return Array.prototype.slice.call(e)}catch(n){}for(var o=Array(t),i=0;t>i;i++)o[i]=e[i];return o}var r=e("./invariant");t.exports=n},{"./invariant":137}],153:[function(e,t){"use strict";function n(e){return d[e]}function r(e,t){return e&&null!=e.key?i(e.key):t.toString(36)}function o(e){return(""+e).replace(f,n)}function i(e){return"$"+o(e)}function a(e,t,n){return null==e?0:h(e,"",0,t,n)}var s=e("./ReactElement"),u=e("./ReactInstanceHandles"),c=e("./invariant"),l=u.SEPARATOR,p=":",d={"=":"=0",".":"=1",":":"=2"},f=/[=.:]/g,h=function(e,t,n,o,a){var u,d,f=0;if(Array.isArray(e))for(var m=0;m<e.length;m++){var v=e[m];u=t+(t?p:l)+r(v,m),d=n+f,f+=h(v,u,d,o,a)}else{var y=typeof e,g=""===t,E=g?l+r(e,0):t;if(null==e||"boolean"===y)o(a,null,E,n),f=1;else if("string"===y||"number"===y||s.isValidElement(e))o(a,e,E,n),f=1;else if("object"===y){c(!e||1!==e.nodeType);for(var C in e)e.hasOwnProperty(C)&&(u=t+(t?p:l)+i(C)+p+r(e[C],0),d=n+f,f+=h(e[C],u,d,o,a))}}return f};t.exports=a},{"./ReactElement":56,"./ReactInstanceHandles":64,"./invariant":137}],154:[function(e,t){"use strict";function n(e){return Array.isArray(e)?e.concat():e&&"object"==typeof e?i(new e.constructor,e):e}function r(e,t,n){s(Array.isArray(e));var r=t[n];s(Array.isArray(r))}function o(e,t){if(s("object"==typeof t),t.hasOwnProperty(p))return s(1===Object.keys(t).length),t[p];var a=n(e);if(t.hasOwnProperty(d)){var h=t[d];s(h&&"object"==typeof h),s(a&&"object"==typeof a),i(a,t[d])}t.hasOwnProperty(u)&&(r(e,t,u),t[u].forEach(function(e){a.push(e)})),t.hasOwnProperty(c)&&(r(e,t,c),t[c].forEach(function(e){a.unshift(e)})),t.hasOwnProperty(l)&&(s(Array.isArray(e)),s(Array.isArray(t[l])),t[l].forEach(function(e){s(Array.isArray(e)),a.splice.apply(a,e)})),t.hasOwnProperty(f)&&(s("function"==typeof t[f]),a=t[f](a));for(var v in t)m.hasOwnProperty(v)&&m[v]||(a[v]=o(e[v],t[v]));return a}var i=e("./Object.assign"),a=e("./keyOf"),s=e("./invariant"),u=a({$push:null}),c=a({$unshift:null}),l=a({$splice:null}),p=a({$set:null}),d=a({$merge:null}),f=a({$apply:null}),h=[u,c,l,p,d,f],m={};h.forEach(function(e){m[e]=!0}),t.exports=o},{"./Object.assign":29,"./invariant":137,"./keyOf":144}],155:[function(e,t){"use strict";var n=e("./emptyFunction"),r=n;t.exports=r},{"./emptyFunction":118}]},{},[1])(1)}),function(global){var Promise=function(val){this._res=val,this._isFulfilled=!!arguments.length,this._isRejected=!1,this._fulfilledCallbacks=[],this._rejectedCallbacks=[],this._progressCallbacks=[]};Promise.prototype={valueOf:function(){return this._res},isFulfilled:function(){return this._isFulfilled},isRejected:function(){return this._isRejected},isResolved:function(){return this._isFulfilled||this._isRejected},fulfill:function(val){this.isResolved()||(this._isFulfilled=!0,this._res=val,this._callCallbacks(this._fulfilledCallbacks,val),this._fulfilledCallbacks=this._rejectedCallbacks=this._progressCallbacks=undef)},reject:function(err){this.isResolved()||(this._isRejected=!0,this._res=err,this._callCallbacks(this._rejectedCallbacks,err),this._fulfilledCallbacks=this._rejectedCallbacks=this._progressCallbacks=undef)},notify:function(val){this.isResolved()||this._callCallbacks(this._progressCallbacks,val)},then:function(onFulfilled,onRejected,onProgress,ctx){onRejected&&!isFunction(onRejected)?(ctx=onRejected,onRejected=undef):onProgress&&!isFunction(onProgress)&&(ctx=onProgress,onProgress=undef);var cb,promise=new Promise;return this._isRejected||(cb={promise:promise,fn:isFunction(onFulfilled)?onFulfilled:undef,ctx:ctx},this._isFulfilled?this._callCallbacks([cb],this._res):this._fulfilledCallbacks.push(cb)),this._isFulfilled||(cb={promise:promise,fn:onRejected,ctx:ctx},this._isRejected?this._callCallbacks([cb],this._res):this._rejectedCallbacks.push(cb)),this.isResolved()||this._progressCallbacks.push({promise:promise,fn:onProgress,ctx:ctx}),promise},fail:function(onRejected,ctx){return this.then(undef,onRejected,ctx)},always:function(onResolved,ctx){var _this=this,cb=function(){return onResolved.call(this,_this)};return this.then(cb,cb,ctx)},progress:function(onProgress,ctx){return this.then(undef,undef,onProgress,ctx)},spread:function(onFulfilled,onRejected,ctx){return this.then(function(val){return onFulfilled.apply(this,val)},onRejected,ctx)},done:function(onFulfilled,onRejected,onProgress,ctx){this.then(onFulfilled,onRejected,onProgress,ctx).fail(throwException)},delay:function(delay){var timer,promise=this.then(function(val){var promise=new Promise;return timer=setTimeout(function(){promise.fulfill(val)},delay),promise});return promise.always(function(){clearTimeout(timer)}),promise},timeout:function(timeout){var promise=new Promise,timer=setTimeout(function(){promise.reject(Error("timed out"))},timeout);return promise.sync(this),promise.always(function(){clearTimeout(timer)}),promise},sync:function(promise){promise.then(this.fulfill,this.reject,this.notify,this)},_callCallbacks:function(callbacks,arg){var len=callbacks.length;if(len){var isResolved=this.isResolved(),isFulfilled=this.isFulfilled();nextTick(function(){for(var cb,promise,fn,i=0;len>i;)if(cb=callbacks[i++],promise=cb.promise,fn=cb.fn){var res,ctx=cb.ctx;try{res=ctx?fn.call(ctx,arg):fn(arg)}catch(e){promise.reject(e);continue}isResolved?Vow.isPromise(res)?function(promise){res.then(function(val){promise.fulfill(val)},function(err){promise.reject(err)},function(val){promise.notify(val)})}(promise):promise.fulfill(res):promise.notify(res)}else isResolved?isFulfilled?promise.fulfill(arg):promise.reject(arg):promise.notify(arg)})}}};var undef,Vow={Promise:Promise,promise:function(val){return arguments.length?Vow.isPromise(val)?val:new Promise(val):new Promise},when:function(obj,onFulfilled,onRejected,onProgress,ctx){return Vow.promise(obj).then(onFulfilled,onRejected,onProgress,ctx)},fail:function(obj,onRejected,ctx){return Vow.when(obj,undef,onRejected,ctx)},always:function(obj,onResolved,ctx){return Vow.promise(obj).always(onResolved,ctx)},progress:function(obj,onProgress,ctx){return Vow.promise(obj).progress(onProgress,ctx)},spread:function(obj,onFulfilled,onRejected,ctx){return Vow.promise(obj).spread(onFulfilled,onRejected,ctx)},done:function(obj,onFulfilled,onRejected,onProgress,ctx){Vow.promise(obj).done(onFulfilled,onRejected,onProgress,ctx)},isPromise:function(obj){return obj&&isFunction(obj.then)},valueOf:function(obj){return Vow.isPromise(obj)?obj.valueOf():obj},isFulfilled:function(obj){return Vow.isPromise(obj)?obj.isFulfilled():!0},isRejected:function(obj){return Vow.isPromise(obj)?obj.isRejected():!1},isResolved:function(obj){return Vow.isPromise(obj)?obj.isResolved():!0},fulfill:function(val){return Vow.when(val,undef,function(err){return err})},reject:function(err){return Vow.when(err,function(val){var promise=new Promise;return promise.reject(val),promise})},resolve:function(val){return Vow.isPromise(val)?val:Vow.when(val)},invoke:function(fn){try{return Vow.promise(fn.apply(global,slice.call(arguments,1)))}catch(e){return Vow.reject(e)}},forEach:function(promises,onFulfilled,onRejected,keys){for(var len=keys?keys.length:promises.length,i=0;len>i;)Vow.when(promises[keys?keys[i]:i],onFulfilled,onRejected),++i},all:function(promises){var resPromise=new Promise,isPromisesArray=isArray(promises),keys=isPromisesArray?getArrayKeys(promises):getObjectKeys(promises),len=keys.length,res=isPromisesArray?[]:{};if(!len)return resPromise.fulfill(res),resPromise;var i=len,onFulfilled=function(){if(!--i){for(var j=0;len>j;)res[keys[j]]=Vow.valueOf(promises[keys[j++]]);resPromise.fulfill(res)}},onRejected=function(err){resPromise.reject(err)};return Vow.forEach(promises,onFulfilled,onRejected,keys),resPromise},allResolved:function(promises){var resPromise=new Promise,isPromisesArray=isArray(promises),keys=isPromisesArray?getArrayKeys(promises):getObjectKeys(promises),i=keys.length,res=isPromisesArray?[]:{};if(!i)return resPromise.fulfill(res),resPromise;var onProgress=function(){--i||resPromise.fulfill(promises)};return Vow.forEach(promises,onProgress,onProgress,keys),resPromise},allPatiently:function(promises){return Vow.allResolved(promises).then(function(){var rejectedPromises,fulfilledPromises,key,promise,isPromisesArray=isArray(promises),keys=isPromisesArray?getArrayKeys(promises):getObjectKeys(promises),len=keys.length,i=0;if(!len)return isPromisesArray?[]:{};for(;len>i;)key=keys[i++],promise=promises[key],Vow.isRejected(promise)?(rejectedPromises||(rejectedPromises=isPromisesArray?[]:{}),isPromisesArray?rejectedPromises.push(promise.valueOf()):rejectedPromises[key]=promise.valueOf()):rejectedPromises||((fulfilledPromises||(fulfilledPromises=isPromisesArray?[]:{}))[key]=Vow.valueOf(promise));if(rejectedPromises)throw rejectedPromises;return fulfilledPromises})},any:function(promises){var resPromise=new Promise,len=promises.length;if(!len)return resPromise.reject(Error()),resPromise;var err,i=0,onFulfilled=function(val){resPromise.fulfill(val)},onRejected=function(e){i||(err=e),++i===len&&resPromise.reject(err)};return Vow.forEach(promises,onFulfilled,onRejected),resPromise},delay:function(val,timeout){return Vow.promise(val).delay(timeout)},timeout:function(val,timeout){return Vow.promise(val).timeout(timeout)}},nextTick=function(){var fns=[],enqueueFn=function(fn){return 1===fns.push(fn)},callFns=function(){var fnsToCall=fns,i=0,len=fns.length;for(fns=[];len>i;)fnsToCall[i++]()};if("function"==typeof setImmediate)return function(fn){enqueueFn(fn)&&setImmediate(callFns)};if("object"==typeof process&&process.nextTick)return function(fn){enqueueFn(fn)&&process.nextTick(callFns)};if(global.postMessage){var isPostMessageAsync=!0;if(global.attachEvent){var checkAsync=function(){isPostMessageAsync=!1};global.attachEvent("onmessage",checkAsync),global.postMessage("__checkAsync","*"),global.detachEvent("onmessage",checkAsync)}if(isPostMessageAsync){var msg="__promise"+ +new Date,onMessage=function(e){e.data===msg&&(e.stopPropagation&&e.stopPropagation(),callFns())};return global.addEventListener?global.addEventListener("message",onMessage,!0):global.attachEvent("onmessage",onMessage),function(fn){enqueueFn(fn)&&global.postMessage(msg,"*")}}}var doc=global.document;if("onreadystatechange"in doc.createElement("script")){var createScript=function(){var script=doc.createElement("script");script.onreadystatechange=function(){script.parentNode.removeChild(script),script=script.onreadystatechange=null,callFns()},(doc.documentElement||doc.body).appendChild(script)};return function(fn){enqueueFn(fn)&&createScript()}}return function(fn){enqueueFn(fn)&&setTimeout(callFns,0)}}(),throwException=function(e){nextTick(function(){throw e})},isFunction=function(obj){return"function"==typeof obj},slice=Array.prototype.slice,toStr=Object.prototype.toString,isArray=Array.isArray||function(obj){return"[object Array]"===toStr.call(obj)},getArrayKeys=function(arr){for(var res=[],i=0,len=arr.length;len>i;)res.push(i++);return res},getObjectKeys=Object.keys||function(obj){var res=[];for(var i in obj)obj.hasOwnProperty(i)&&res.push(i);return res},defineAsGlobal=!0;"object"==typeof exports&&(module.exports=Vow,defineAsGlobal=!1),"object"==typeof modules&&(modules.define("vow",function(provide){provide(Vow)}),defineAsGlobal=!1),"function"==typeof define&&(define(function(require,exports,module){module.exports=Vow}),defineAsGlobal=!1),defineAsGlobal&&(global.Vow=Vow)}(this),function(factory){"function"==typeof define&&define.amd?define(["jquery"],factory):"object"==typeof exports?module.exports=factory:factory(jQuery)}(function($){function handler(event){var orgEvent=event||window.event,args=slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,offsetX=0,offsetY=0;if(event=$.event.fix(orgEvent),event.type="mousewheel","detail"in orgEvent&&(deltaY=-1*orgEvent.detail),"wheelDelta"in orgEvent&&(deltaY=orgEvent.wheelDelta),"wheelDeltaY"in orgEvent&&(deltaY=orgEvent.wheelDeltaY),"wheelDeltaX"in orgEvent&&(deltaX=-1*orgEvent.wheelDeltaX),"axis"in orgEvent&&orgEvent.axis===orgEvent.HORIZONTAL_AXIS&&(deltaX=-1*deltaY,deltaY=0),delta=0===deltaY?deltaX:deltaY,"deltaY"in orgEvent&&(deltaY=-1*orgEvent.deltaY,delta=deltaY),"deltaX"in orgEvent&&(deltaX=orgEvent.deltaX,0===deltaY&&(delta=-1*deltaX)),0!==deltaY||0!==deltaX){if(1===orgEvent.deltaMode){var lineHeight=$.data(this,"mousewheel-line-height");delta*=lineHeight,deltaY*=lineHeight,deltaX*=lineHeight}else if(2===orgEvent.deltaMode){var pageHeight=$.data(this,"mousewheel-page-height");delta*=pageHeight,deltaY*=pageHeight,deltaX*=pageHeight}if(absDelta=Math.max(Math.abs(deltaY),Math.abs(deltaX)),(!lowestDelta||lowestDelta>absDelta)&&(lowestDelta=absDelta,shouldAdjustOldDeltas(orgEvent,absDelta)&&(lowestDelta/=40)),shouldAdjustOldDeltas(orgEvent,absDelta)&&(delta/=40,deltaX/=40,deltaY/=40),delta=Math[delta>=1?"floor":"ceil"](delta/lowestDelta),deltaX=Math[deltaX>=1?"floor":"ceil"](deltaX/lowestDelta),deltaY=Math[deltaY>=1?"floor":"ceil"](deltaY/lowestDelta),special.settings.normalizeOffset&&this.getBoundingClientRect){var boundingRect=this.getBoundingClientRect();offsetX=event.clientX-boundingRect.left,offsetY=event.clientY-boundingRect.top}return event.deltaX=deltaX,event.deltaY=deltaY,event.deltaFactor=lowestDelta,event.offsetX=offsetX,event.offsetY=offsetY,event.deltaMode=0,args.unshift(event,delta,deltaX,deltaY),nullLowestDeltaTimeout&&clearTimeout(nullLowestDeltaTimeout),nullLowestDeltaTimeout=setTimeout(nullLowestDelta,200),($.event.dispatch||$.event.handle).apply(this,args)}}function nullLowestDelta(){lowestDelta=null}function shouldAdjustOldDeltas(orgEvent,absDelta){return special.settings.adjustOldDeltas&&"mousewheel"===orgEvent.type&&absDelta%120===0}var nullLowestDeltaTimeout,lowestDelta,toFix=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],toBind="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],slice=Array.prototype.slice;if($.event.fixHooks)for(var i=toFix.length;i;)$.event.fixHooks[toFix[--i]]=$.event.mouseHooks;var special=$.event.special.mousewheel={version:"3.1.13-pre",setup:function(){if(this.addEventListener)for(var i=toBind.length;i;)this.addEventListener(toBind[--i],handler,!1);else this.onmousewheel=handler;$.data(this,"mousewheel-line-height",special.getLineHeight(this)),$.data(this,"mousewheel-page-height",special.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=toBind.length;i;)this.removeEventListener(toBind[--i],handler,!1);else this.onmousewheel=null;$.removeData(this,"mousewheel-line-height"),$.removeData(this,"mousewheel-page-height")},getLineHeight:function(elem){var $elem=$(elem),$parent=$elem["offsetParent"in $.fn?"offsetParent":"parent"]();return $parent.length||($parent=$("body")),parseInt($parent.css("fontSize"),10)||parseInt($elem.css("fontSize"),10)||16},getPageHeight:function(elem){return $(elem).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}})}),!function(t,e){function n(t,e,n){var r=t.children(),o=!1;t.empty();for(var i=0,d=r.length;d>i;i++){var l=r.eq(i);if(t.append(l),n&&t.append(n),a(t,e)){l.remove(),o=!0;break}n&&n.detach()}return o}function r(e,n,i,d,l){var s=!1,c="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",u="script";return e.contents().detach().each(function(){var f=this,h=t(f);if("undefined"==typeof f||3==f.nodeType&&0==t.trim(f.data).length)return!0;if(h.is(u))e.append(h);else{if(s)return!0;e.append(h),l&&e[e.is(c)?"after":"append"](l),a(i,d)&&(s=3==f.nodeType?o(h,n,i,d,l):r(h,n,i,d,l),s||(h.detach(),s=!0)),s||l&&l.detach()}}),s}function o(e,n,r,o,d){var c=e[0];if(!c)return!1;var f=s(c),h=-1!==f.indexOf(" ")?" ":"　",p="letter"==o.wrap?"":h,g=f.split(p),v=-1,w=-1,b=0,y=g.length-1;for(o.fallbackToLetter&&0==b&&0==y&&(p="",g=f.split(p),y=g.length-1);y>=b&&(0!=b||0!=y);){var m=Math.floor((b+y)/2);if(m==w)break;w=m,l(c,g.slice(0,w+1).join(p)+o.ellipsis),a(r,o)?(y=w,o.fallbackToLetter&&0==b&&0==y&&(p="",g=g[0].split(p),v=-1,w=-1,b=0,y=g.length-1)):(v=w,b=w)}if(-1==v||1==g.length&&0==g[0].length){var x=e.parent();e.detach();var T=d&&d.closest(x).length?d.length:0;x.contents().length>T?c=u(x.contents().eq(-1-T),n):(c=u(x,n,!0),T||x.detach()),c&&(f=i(s(c),o),l(c,f),T&&d&&t(c).parent().append(d))}else f=i(g.slice(0,v+1).join(p),o),l(c,f);return!0}function a(t,e){return t.innerHeight()>e.maxHeight}function i(e,n){for(;t.inArray(e.slice(-1),n.lastCharacter.remove)>-1;)e=e.slice(0,-1);return t.inArray(e.slice(-1),n.lastCharacter.noEllipsis)<0&&(e+=n.ellipsis),e}function d(t){return{width:t.innerWidth(),height:t.innerHeight()}}function l(t,e){t.innerText?t.innerText=e:t.nodeValue?t.nodeValue=e:t.textContent&&(t.textContent=e)}function s(t){return t.innerText?t.innerText:t.nodeValue?t.nodeValue:t.textContent?t.textContent:""}function c(t){do t=t.previousSibling;while(t&&1!==t.nodeType&&3!==t.nodeType);return t}function u(e,n,r){var o,a=e&&e[0];if(a){if(!r){if(3===a.nodeType)return a;if(t.trim(e.text()))return u(e.contents().last(),n)}for(o=c(a);!o;){if(e=e.parent(),e.is(n)||!e.length)return!1;o=c(e[0])}if(o)return u(t(o),n)}return!1}function f(e,n){return e?"string"==typeof e?(e=t(e,n),e.length?e:!1):e.jquery?e:!1:!1}function h(t){for(var e=t.innerHeight(),n=["paddingTop","paddingBottom"],r=0,o=n.length;o>r;r++){var a=parseInt(t.css(n[r]),10);isNaN(a)&&(a=0),e-=a}return e}if(!t.fn.dotdotdot){t.fn.dotdotdot=function(e){if(0==this.length)return t.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){t(this).dotdotdot(e)});var o=this;o.data("dotdotdot")&&o.trigger("destroy.dot"),o.data("dotdotdot-style",o.attr("style")||""),o.css("word-wrap","break-word"),"nowrap"===o.css("white-space")&&o.css("white-space","normal"),o.bind_events=function(){return o.bind("update.dot",function(e,d){e.preventDefault(),e.stopPropagation(),l.maxHeight="number"==typeof l.height?l.height:h(o),l.maxHeight+=l.tolerance,"undefined"!=typeof d&&(("string"==typeof d||d instanceof HTMLElement)&&(d=t("<div />").append(d).contents()),d instanceof t&&(i=d)),g=o.wrapInner('<div class="dotdotdot" />').children(),g.contents().detach().end().append(i.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var c=!1,u=!1;return s.afterElement&&(c=s.afterElement.clone(!0),c.show(),s.afterElement.detach()),a(g,l)&&(u="children"==l.wrap?n(g,l,c):r(g,o,g,l,c)),g.replaceWith(g.contents()),g=null,t.isFunction(l.callback)&&l.callback.call(o[0],u,i),s.isTruncated=u,u}).bind("isTruncated.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(o[0],s.isTruncated),s.isTruncated}).bind("originalContent.dot",function(t,e){return t.preventDefault(),t.stopPropagation(),"function"==typeof e&&e.call(o[0],i),i}).bind("destroy.dot",function(t){t.preventDefault(),t.stopPropagation(),o.unwatch().unbind_events().contents().detach().end().append(i).attr("style",o.data("dotdotdot-style")||"").data("dotdotdot",!1)}),o},o.unbind_events=function(){return o.unbind(".dot"),o},o.watch=function(){if(o.unwatch(),"window"==l.watch){var e=t(window),n=e.width(),r=e.height();e.bind("resize.dot"+s.dotId,function(){n==e.width()&&r==e.height()&&l.windowResizeFix||(n=e.width(),r=e.height(),u&&clearInterval(u),u=setTimeout(function(){o.trigger("update.dot")},100))})}else c=d(o),u=setInterval(function(){if(o.is(":visible")){var t=d(o);(c.width!=t.width||c.height!=t.height)&&(o.trigger("update.dot"),c=t)}},500);return o},o.unwatch=function(){return t(window).unbind("resize.dot"+s.dotId),u&&clearInterval(u),o};var i=o.contents(),l=t.extend(!0,{},t.fn.dotdotdot.defaults,e),s={},c={},u=null,g=null;return l.lastCharacter.remove instanceof Array||(l.lastCharacter.remove=t.fn.dotdotdot.defaultArrays.lastCharacter.remove),l.lastCharacter.noEllipsis instanceof Array||(l.lastCharacter.noEllipsis=t.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),s.afterElement=f(l.after,o),s.isTruncated=!1,s.dotId=p++,o.data("dotdotdot",!0).bind_events().trigger("update.dot"),l.watch&&o.watch(),o},t.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},t.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","　",",",";",".","!","?"],noEllipsis:[]}},t.fn.dotdotdot.debug=function(){};var p=1,g=t.fn.html;t.fn.html=function(n){return n!=e&&!t.isFunction(n)&&this.data("dotdotdot")?this.trigger("update",[n]):g.apply(this,arguments)};var v=t.fn.text;t.fn.text=function(n){return n!=e&&!t.isFunction(n)&&this.data("dotdotdot")?(n=t("<div />").text(n).html(),this.trigger("update",[n])):v.apply(this,arguments)}}}(jQuery),function($,document,undefined){function raw(s){return s}function decoded(s){return unRfc2068(decodeURIComponent(s.replace(pluses," ")))}function unRfc2068(value){return 0===value.indexOf('"')&&(value=value.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,"\\")),value}function fromJSON(value){return config.json?JSON.parse(value):value}var pluses=/\+/g,config=$.cookie=function(key,value,options){if(value!==undefined){if(options=$.extend({},config.defaults,options),null===value&&(options.expires=-1),"number"==typeof options.expires){var days=options.expires,t=options.expires=new Date;t.setDate(t.getDate()+days)}return value=config.json?JSON.stringify(value):String(value),document.cookie=[encodeURIComponent(key),"=",config.raw?value:encodeURIComponent(value),options.expires?"; expires="+options.expires.toUTCString():"",options.path?"; path="+options.path:"",options.domain?"; domain="+options.domain:"",options.secure?"; secure":""].join("")}for(var decode=config.raw?raw:decoded,cookies=document.cookie.split("; "),result=key?null:{},i=0,l=cookies.length;l>i;i++){var parts=cookies[i].split("="),name=decode(parts.shift()),cookie=decode(parts.join("="));if(key&&key===name){result=fromJSON(cookie);break}key||(result[name]=fromJSON(cookie))}return result};config.defaults={},$.removeCookie=function(key,options){return null!==$.cookie(key)?($.cookie(key,null,options),!0):!1}}(jQuery,document);var initApp=function(){var ph={};window.ph=ph,ph.R=ph.R||{};var yr={};!function(){function quoteAmp(s){return s.replace(/&/g,"&amp;")}function Doc(data){Array.isArray(data)&&(data={item:data}),this.root={data:data,parent:null,name:"",doc:this},this._vars={},this._keys={}}yr.log=function(){};var modules={},RE_AMP=/&/g,RE_LT=/</g,RE_GT=/>/g,RE_QUOTE=/"/g,RE_E_AMP=/&amp;/g,RE_E_LT=/&lt;/g,RE_E_GT=/&gt;/g;yr.text2xml=function(s){return null==s?"":(""+s).replace(RE_AMP,"&amp;").replace(RE_LT,"&lt;").replace(RE_GT,"&gt;")},yr.xml2text=function(s){return null==s?"":(""+s).replace(RE_E_LT,"<").replace(RE_E_GT,">").replace(RE_E_AMP,"&")},yr.text2attr=function(s){return null==s?"":(""+s).replace(RE_AMP,"&amp;").replace(RE_QUOTE,"&quot;").replace(RE_LT,"&lt;").replace(RE_GT,"&gt;")},yr.xml2attr=function(s){return null==s?"":(""+s).replace(RE_QUOTE,"&quot;").replace(RE_LT,"&lt;").replace(RE_GT,"&gt;")},yr.register=function(id,module){if(yr.isRegistered(id))throw Error('Module "'+id+'" already exists');for(var ids=module.imports||[],imports=[module],i=0,l=ids.length;l>i;i++){var module_=modules[ids[i]];if(!module_)throw Error('Module "'+ids[i]+"\" doesn't exist");imports=imports.concat(module_.imports)}module.imports=imports,modules[id]=module},yr.isRegistered=function(id){return!!modules[id]},yr.run=function(id,data,mode){mode=mode||"";var module=modules[id];if(!module)throw'Module "'+id+'" is undefined';var doc=new Doc(data),r=module.a(module,0,[doc.root],mode,{a:{}});return r},yr.join=function(left,right){return left.concat(right)},yr.nodeValue=function(node){var data=node.data;return"object"==typeof data?"":data},yr.nodeName=function(nodeset){var node=nodeset[0];return node?node.name:""},yr.simpleScalar=function(name,context){var data=context.data;if(!data)return"";if("*"===name){for(var key in data)return yr.simpleScalar(key,context);return""}var r=data[name];return"object"==typeof r?"":void 0===r?"":r},yr.simpleBoolean=function(name,context){var data=context.data;if(!data)return!1;if("*"===name){for(var key in data){var r=yr.simpleBoolean(key,context);if(r)return!0}return!1}var r=data[name];return r?Array.isArray(r)?r.length:!0:!1},yr.nodeset2scalar=function(nodeset){if(!nodeset.length)return"";var data=nodeset[0].data;return"object"==typeof data?"":data},yr.nodeset2boolean=function(nodeset){return nodeset&&nodeset.length>0?!!nodeset[0].data:!1},yr.nodeset2xml=function(nodeset){return yr.scalar2xml(yr.nodeset2scalar(nodeset))},yr.nodeset2attrvalue=function(nodeset){return yr.scalar2attrvalue(yr.nodeset2scalar(nodeset))},yr.scalar2xml=yr.text2xml,yr.xml2scalar=yr.xml2text,yr.xml2attrvalue=yr.xml2attr,yr.scalar2attrvalue=yr.text2attr,yr.object2nodeset=function(object){return[new Doc(object).root]},yr.array2nodeset=function(array){var object={item:array};return[new Doc(object).root]},yr.cmpSN=function(left,right){for(var i=0,l=right.length;l>i;i++)if(left==yr.nodeValue(right[i]))return!0;return!1},yr.cmpNN=function(left,right){var m=right.length;if(0===m)return!1;if(1===m)return yr.cmpSN(yr.nodeValue(right[0]),left);for(var values=[],rv=yr.nodeValue(right[0]),i=0,l=left.length;l>i;i++){var lv=yr.nodeValue(left[i]);if(lv==rv)return!0;values[i]=lv}for(var j=1;m>j;j++){rv=yr.nodeValue(right[j]);for(var i=0,l=left.length;l>i;i++)if(values[i]==rv)return!0}return!1},yr.shortTags={br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,wbr:!0},yr.closeAttrs=function(a){var name=a.s;if(name){var r="",attrs=a.a;for(var attr in attrs)r+=" "+attr+'="'+attrs[attr].quote()+'"';return r+=yr.shortTags[name]?"/>":">",a.s=null,r}return""},yr.copyAttrs=function(to,from){for(var key in from)to[key]=from[key]},yr.scalarAttr=function(s){this.s=null==s?"":""+s},yr.scalarAttr.prototype.quote=function(){return yr.text2attr(this.s)},yr.scalarAttr.prototype.addxml=function(xml){return new yr.xmlAttr(quoteAmp(this.s)+xml)},yr.scalarAttr.prototype.addscalar=function(xml){return new yr.scalarAttr(this.s+xml)},yr.xmlAttr=function(s){this.s=null==s?"":""+s},yr.xmlAttr.prototype.quote=function(){return yr.xml2attr(this.s)},yr.xmlAttr.prototype.addscalar=function(scalar){return new yr.xmlAttr(this.s+quoteAmp(scalar))},yr.slice=function(s,from,to){return s=""+s,to?s.slice(from,to):s.slice(from)},yr.exists=function(nodeset){return nodeset.length>0},yr.grep=function(nodeset,predicate){for(var r=[],index=0,count=nodeset.length;count>index;index++){var node=nodeset[index];predicate(node,index,count)&&r.push(node)}return r},yr.byIndex=function(nodeset,i){return nodeset.slice(i,i+1)},yr.sort=function(nodes,by,desc){for(var values=[],i=0,l=nodes.length;l>i;i++){var node=nodes[i],value=by(node,i,l);values.push({node:node,value:value})}for(var greater=desc?-1:1,less=desc?1:-1,sorted=values.sort(function(a,b){var va=a.value,vb=b.value;return vb>va?less:va>vb?greater:0}),r=[],i=0,l=sorted.length;l>i;i++)r.push(sorted[i].node);return r},yr.nodeset2data=function(nodes){var l=nodes.length;if(0===l)return"";if(1===l)return nodes[0].data;for(var data=[],i=0;l>i;i++)data.push(nodes[i].data);return data},yr.externals={};var Module=function(){};Module.prototype.a=function(M,start,nodeset,mode,a0){var args,r="";arguments.length>5&&(args=Array.prototype.slice.call(arguments,5));for(var imports=M.imports,i0=0,l0=nodeset.length;l0>i0;i0++){for(var module,template,c0=nodeset[i0],found=!1,i2=start,l2=imports.length;!found&&l2>i2;){module=imports[i2++];var names=module.matcher[mode];if(names){var templates=names[c0.name]||names["*"];if(templates)for(var i3=0,l3=templates.length;!found&&l3>i3;){var tid=templates[i3++];
template=module[tid];var selector=template.j;if(selector)module.matched(selector,template.a,c0,i0,l0)&&(found=tid);else for(var selectors=template.s,abs=template.a,i4=0,l4=selectors.length;l4>i4;i4++)if(module.matched(selectors[i4],abs[i4],c0,i0,l0)){found=tid;break}}}}found&&(r+=args?template.apply(M,[M,c0,i0,l0,a0].concat(args)):template(M,c0,i0,l0,a0))}return r},Module.prototype.matched=function(jpath,abs,c0,i0,l0){if(1===jpath)return!c0.parent;for(var l=jpath.length,i=l-2;i>=0;){if(!c0)return!1;var step=jpath[i];switch(step){case 0:var name=jpath[i+1];if("*"!==name&&name!==c0.name)return!1;c0=c0.parent;break;case 2:case 4:var predicate=jpath[i+1];if(!predicate(this,c0,i0,l0))return!1}i-=2}return abs&&c0.parent?!1:!0},Module.prototype.s=function(jpath,node){return this.n(jpath,[node])},Module.prototype.n=function(jpath,nodeset){for(var result,current=nodeset,m=current.length,i=0,n=jpath.length;n>i;i+=2){result=[];var type=jpath[i],step=jpath[i+1];switch(type){case 0:for(var j=0;m>j;j++)yr.selectNametest(step,current[j],result);break;case 1:for(var j=0;m>j;j++){for(var k=0,node=current[j];step>k&&node;)node=node.parent,k++;node&&result.push(node)}break;case 2:for(var j=0;m>j;j++){var node=current[j];step(this,node,j,m)&&result.push(node)}break;case 3:var node=current[step];result=node?[node]:[];break;case 4:if(m>0){var node=current[0];step(this,node.doc.root,0,1)&&(result=result.concat(current))}}if(current=result,m=current.length,!m)return[]}return result},yr.selectNametest=function(step,context,result){var data=context.data;if(!data||"object"!=typeof data)return result;if("*"===step){if(Array.isArray(data))for(var i=0,l=data.length;l>i;i++)yr.selectNametest(i,context,result);else for(step in data)yr.selectNametest(step,context,result);return result}if(data=data[step],void 0===data)return result;var doc=context.doc;if(Array.isArray(data))for(var i=0,l=data.length;l>i;i++)result.push({data:data[i],parent:context,name:step,doc:doc});else result.push({data:data,parent:context,name:step,doc:doc});return result},yr.document=function(nodeset){var doc;return doc=new Doc(nodeset.length?nodeset[0].data:{}),[doc.root]},yr.subnode=function(name,data,context){var doc=context.doc;if(Array.isArray(data)){for(var nodeset=[],i=0,l=data.length;l>i;i++)nodeset.push({data:data[i],name:name,parent:context,doc:doc});return nodeset}return[{data:data,name:name,parent:context,doc:doc}]},Module.prototype.v=function vars(id,c0){var vars=c0.doc._vars,value=vars[id];if(void 0===value){var var_=this.findSymbol(id);value="function"==typeof var_?var_(this,c0,0,1):var_,vars[id]=value}return value},Module.prototype.f=function(id,c0,i0,l0,v0){var func=this.findSymbol(id);if(arguments.length>5){var args=Array.prototype.slice.call(arguments);return args[0]=this,func.apply(this,args)}return void 0!==v0?func(this,c0,i0,l0,v0):func(this,c0,i0,l0)},Module.prototype.k=function keys(id,use,c0,multiple){function getValue(use){var r,nodes_=nodes[use];if(cache.xml){if(r="",nodes_)for(var i=0,l=nodes_.length;l>i;i++){var node=nodes_[i];r+=key.b(that,node.c,node.i,node.l,{})}}else if(r=[],nodes_)for(var i=0,l=nodes_.length;l>i;i++){var node=nodes_[i];r=r.concat(key.b(that,node.c,node.i,node.l))}return values[use]=r,r}var keys=c0.doc._keys,key=this.findSymbol(id),cache=keys[id];cache||(cache=this._initKey(key,id,use,c0));var values=cache.values,nodes=cache.nodes,that=this;if(multiple){var r;if(cache.xml){r="";for(var i=0,l=use.length;l>i;i++){var c0=use[i];r+=getValue(yr.nodeValue(c0))}}else{r=[];for(var i=0,l=use.length;l>i;i++){var c0=use[i];r=r.concat(getValue(yr.nodeValue(c0)))}}return r}var value=values[use];return void 0===value&&(value=getValue(use)),value},Module.prototype._initKey=function(key,id,use,c0){function store(key,info){var items=nodes[key];items||(items=nodes[key]=[]),items.push(info)}var keys=c0.doc._keys,cache=keys[id]={};cache.xml="xml"===key.bt;var matched=key.n(this,c0),nodes=cache.nodes={};if("nodeset"===key.ut)for(var i0=0,l0=matched.length;l0>i0;i0++)for(var c1=matched[i0],use_=key.u(this,c1,i0,l0),j=0,m=use_.length;m>j;j++)store(yr.nodeValue(use_[j]),{c:c1,i:i0,l:l0});else for(var i0=0,l0=matched.length;l0>i0;i0++){var c1=matched[i0],use_=key.u(this,c1,i0,l0);store(use_,{c:c1,i:i0,l:l0})}return cache.values={},cache},Module.prototype.findSymbol=function(id){for(var imports=this.imports,i=0,l=imports.length;l>i;i++){var module=imports[i],symbol=module[id];if(void 0!==symbol)return symbol}},yr.Module=Module}(),"undefined"!=typeof module&&(module.exports=yr),window.yr=yr,function(){var consoleLog;"undefined"!=typeof console&&("function"==typeof console.error?consoleLog=console.error.bind(console):"function"==typeof console.log&&(consoleLog=console.log.bind(console))),consoleLog=consoleLog||function(){},ph._logException=function(name,exception){var stack,errorMessage=name?"["+name+"] ":"";exception&&(exception.message&&(errorMessage+=exception.message),exception.stack&&(stack=exception.stack.split("\n"),stack&&stack.length>1&&(errorMessage+=" ("+stack[0].trim()+"; "+stack[1].trim()+")"))),consoleLog(errorMessage),"undefined"!=typeof window&&window.onerror(errorMessage,window.location.href,void 0,"next")}}(),function(){window.onerror=function(errorMessage,url,lineNumber,errorType){("Script error."!==errorMessage||""!=url||0!=lineNumber)&&((new Image).src=["/favicon.ico?type=js."+(errorType||"common"),"message="+escape(errorMessage),"source="+escape(url+":"+lineNumber),"place="+escape(window.location.href)].join("&amp;"))}}(),function(){var goodErrors=["image not found","image is blocked","user not found","ask password","access denied","no album contents","album not found","validate","auth:need_reset","Forbidden","contest is not active"];"undefined"!=typeof module?module.exports={goodErrors:goodErrors}:(ph.common=ph.common||{},ph.common.goodErrors=goodErrors)}(),function(){var modules={};modules.map={url:"//api-maps.yandex.ru/2.0-stable/?load=package.standard&lang=ru-ru",load:function(promise){ymaps.ready(function(){promise.fulfill()})}},modules.share={url:"//yastatic.net/share/share"},modules.ads={url:"//an.yandex.ru/system/context_test",beforeLoad:function(promise){var w=window,n="yandexContextAsyncCallbacks";w[n]=w[n]||[],w[n].push(function(){promise.fulfill()})},load:function(){}},modules.awaps={url:"//awaps.yandex.ru/0/s01a92305p1v10/jsonlib",load:function(promise){var awaps={render:function(elementId,bannerSection,bannerWidth,bannerHeight,callback){var aw_json=window.aw_json=new AwapsJsonAPI.Json(bannerSection,bannerWidth,bannerHeight,"utf-8",null,0,null,"","",callback);aw_json.setID(elementId),aw_json.refreshAd()}};return promise.fulfill(awaps),promise}},modules.clipboard={url:function(){return ns.router.url("/js/vendor/zeroclipboard.min")},load:function(promise,ZeroClipboard){window.ZeroClipboard=ZeroClipboard,ZeroClipboard.setDefaults({moviePath:ns.router.url("/js/vendor/zeroclipboard.swf")}),ph.clipboard=new ZeroClipboard,ph.clipboard.on("load",function(){promise.fulfill()}),ph.clipboard.on("noflash",function(){promise.reject()}),ph.clipboard.on("wrongflash",function(){promise.reject()}),ph.clipboard.on("complete",function(){var node=this,block=nb.block(node);block&&block.trigger("copied")})}},modules.metrika={url:"//mc.yandex.ru/metrika/watch",beforeLoad:function(promise){var w=window,n="yandex_metrika_callbacks";w[n]=w[n]||[],w[n].push(function(){promise.fulfill()})},load:function(){}},modules.aviary={url:"/next/js/vendor/feather",load:function(promise){return promise.sync((new ph.Editor).init()),promise}};var initModules=function(){var hash={};for(var moduleName in modules){var url=modules[moduleName].url;"function"==typeof url&&(url=url()),hash[moduleName]=url}require.config({paths:hash,waitSeconds:40})},loadModule=function(moduleName){var module=modules[moduleName];if(!module.promise){var promise=module.promise=new Vow.Promise;module.beforeLoad&&module.beforeLoad(promise);var loadCallback=module.load||function(promise){promise.fulfill()};require([moduleName],function(loadedObject){loadCallback(promise,loadedObject)})}return module.promise};ph.initModules=initModules,ph.loadModule=loadModule}(),function(){var hostname,re_host,re_edit_url,re_edit_url2,re_view_url,utils={};utils.init=function(){hostname=utils.getLocation().hostname||"fotki.yandex.ru",re_host=new RegExp("^(https?:)?\\/\\/"+hostname.replace(/\./g,"\\.")+"((\\/|\\?).*)?$","gi"),re_edit_url=/\/(edit[\/?]|edit$)/,re_edit_url2=/\-edit\.xml/,re_view_url=/\/view\//},utils.initDateFunctions=function(){moment.lang("ru")},utils.getLocation=function(){return window.location},utils.param=function(obj){return jQuery.param(obj)},utils.getCookie=function(name){return jQuery.cookie(name)},utils.setCookie=function(name,value,options){return jQuery.cookie(name,value,options)},utils.isAdult=function(uid){uid=uid?uid:0;var isAdultValue="fotki_adult:"+uid;return utils.getCookie("fotki_adult")===isAdultValue},utils.setIsAdult=function(uid){uid=uid?uid:0;var isAdultValue="fotki_adult:"+uid,wasAdult=utils.getCookie("fotki_adult")===isAdultValue;return wasAdult?!1:(utils.setCookie("fotki_adult",isAdultValue,{path:"/"}),!0)},utils.endsWith=function(str,suffix){return str.length>=suffix.length&&str.substring(str.length-suffix.length)===suffix},utils.escape=function(str){return ns.entityify(str)},utils.nl2br=function(str){var _br="<br/>",_str=str.replace(/\n/g,_br);return utils.endsWith(_str,_br)&&(_str+=_br),_str},utils.moveCaretToEnd=function(element){if("number"==typeof element.selectionStart)element.selectionStart=element.selectionEnd=element.value.length;else if("undefined"!=typeof element.createTextRange){element.focus();var range=element.createTextRange();range.collapse(!1),range.select()}},utils.getIndexOfLastChild=function(comments,id){var element,resultIndex=null,selfIndex=null;return comments.forEach(function(model,index){element=model.getData(),element.parentId===id&&(resultIndex=utils.getIndexOfLastChild(comments,element.id)),element.id===id&&(selfIndex=index)}),resultIndex||selfIndex},utils.parseDate=function(date){var parts=date.split("-");return new Date(parseInt(parts[0],10),parseInt(parts[1],10)-1,parseInt(parts[2],10))},utils.timestamp=function(date){return Math.floor(+(date||new Date)/1e3)},utils.nc=function(){return+new Date},utils.lazyCallback=function(timeout,callback,aggregate){var timer=null,value=null,wasCalled=!1,promise=null;callback=callback||function(){},aggregate=aggregate||function(){};var lazyCallback=function(){promise.fulfill({value:value,returned:callback(value)}),value=null,wasCalled=!1},timerCallback=function(){wasCalled?(lazyCallback(),timer=setTimeout(timerCallback,timeout)):timer=null,promise=null};return function(){return value=aggregate(value,Array.prototype.slice.call(arguments,0)),promise=promise||new Vow.Promise,timer?(wasCalled=!0,promise=promise.isResolved()?new Vow.Promise:promise):(lazyCallback(),timer=setTimeout(timerCallback,timeout),promise)}},utils.generateUrl=function(page,params){params=params||ns.page.current.params;var url,loc=utils.getLocation(),authorLogin=params["author-login"],albumId=params["album-id"],imageId=params["image-id"],_page=params.page?"?p="+params.page:"";switch(page){case"album":return albumId?"/"+["users",authorLogin,"album",albumId].join("/")+_page:null;case"photo-edit":return"/"+["users",authorLogin,"edit",imageId].join("/");case"user-profile":return"/"+["users",authorLogin].join("/");case"rights":return"/rights.xml";case"user-tag":return url="/"+["users",authorLogin,"tags",encodeURIComponent(params.tag)].join("/"),params.p&&(url+="?p="+params.p),url;case"tag":return"/tag/"+encodeURIComponent(params.tag);case"contest":return"/contest.xml?id="+params["contest-id"];case"top":return"/top";case"calendar":return params.date?"/calendar?date="+params.date:"/calendar";case"oferta":var queryString="";return params&&params.retpath&&(queryString="?retpath="+encodeURIComponent(params.retpath)),"/oferta.xml"+queryString;case"passport":var retpath,urlParts=["//passport.yandex.ru/"];return params.action&&(retpath="&retpath="+encodeURIComponent(params.retpath||loc.href),"signIn"===params.action?urlParts.push("?mode=auth","&clean=yes","&msg=fotki",retpath):"signOut"===params.action&&urlParts.push("?mode=logout","&yu="+utils.getCookie("yandexuid"),retpath)),urlParts.join("");case"search":return"/search.xml?"+utils.param(ph.params.oldSearchParams(params));case"editor-photo":return authorLogin&&imageId?"/models/?img=true&"+utils.param(utils.pick(params,["author-login","image-id","size"]))+"&_="+utils.nc():"";case"stat":return"/stat/"+params.join("/")+"?_="+utils.nc();case"pdd":return"/pdd";case"map":return"/map";case"vote-start":return"/vote?mode=start";case"tunes":return"/tunes";case"favorites":return"/my/favorites";case"my":return"/my";case"upload":return"/upload";case"root":return"/";case"yandex":return"//yandex.ru";case"mail":return"//mail.yandex.ru";case"mailCompose":return"//mail.yandex.ru/compose";case"disk":return"//mail.yandex.ru/neo2/#disk/from_upload_main";case"legal":return"//yandex.ru/legal/fotki_termsofuse";case"feedback":return"//feedback.yandex.ru/?from=fotki";case"help":return"//help.yandex.ru/fotki";case"widgets":return"//widgets.yandex.ru/?text=fotki";case"blog":return"//clubs.ya.ru/fotki";case"mobile":return["//tune.yandex.ru/api/my/v1.0/my.xml?param=1","&block=44","&sk="+params.ticket,"&retpath="+encodeURIComponent("http://m.fotki.yandex.ru")].join("");case"podvote":return"/choice";case"hall-of-fame":return"/hall-of-fame";default:try{url=ns.router.generateUrl(page,params)}catch(er){ns.log.exception("[ph.utils.generateUrl] could not generate url",er),url="/"}return url}},utils.fullUrl=function(url){var loc=utils.getLocation();return loc.protocol+"//"+loc.host+url},utils.cssValue=function($node,prop){return parseInt($node.css(prop),10)},utils.once=function(obj,name,handler){var cleanup=function(){obj.off(name,handler),obj.off(cleanup)};obj.on(name,handler),obj.on(name,cleanup)},utils.sizes={xxxs:50,xxs:75,xs:100,s:150,m:300,l:500,xl:800,xxl:1024,xxxl:1280,x4l:1600,x5l:2560,orig:99999};var sizesForDisplaying={xxxs:50,xxs:75,xs:100,s:150,m:300,l:500,xl:800,xxl:1024,xxxl:1280,x4l:1600,x5l:99999};utils.getSizeName=function(size){return 50>=size?"xxxs":75>=size?"xxs":100>=size?"xs":150>=size?"s":300>=size?"m":500>=size?"l":800>=size?"xl":1024>=size?"xxl":1280>=size?"xxxl":1600>=size?"x4l":2560>=size?"x5l":0===(size||0)?"NOIMAGE":"orig"};var selectSize=function(imageData,dimensions,checkIsFinal){var sizesAvailable=[],getSizeInfo=function(size){return{name:sizesForDisplaying[size],value:imageData.sizes[size],sizeName:size}};if(-1==dimensions.width||-1==dimensions.height)return null;if(!imageData.sizes)return null;for(var size in sizesForDisplaying){var hasCurrentSize=!!imageData.sizes[size];if(hasCurrentSize&&sizesAvailable.push(size),hasCurrentSize&&checkIsFinal(imageData.sizes[size],dimensions))return getSizeInfo(size)}if(!sizesAvailable.length)return null;var sizeName=sizesAvailable[sizesAvailable.length-1];return getSizeInfo(sizeName)};utils.getClosestSize=function(imageData,dimensions){return selectSize(imageData,dimensions,function(sizeData,dimensions){return sizeData.width>=dimensions.width||sizeData.height>=dimensions.height})},utils.getCoverSize=function(imageData,dimensions){return selectSize(imageData,dimensions,function(sizeData,dimensions){return sizeData.width>=dimensions.width&&sizeData.height>=dimensions.height})},utils.pick=function(obj,props,strict){props=props||[],"string"==typeof props&&(props=[props]);for(var result={},i=0;i<props.length;i++){var pname=props[i];pname in obj?result[pname]=obj[pname]:strict&&ns.assert.fail("utils.pick",'Property "%s" is missing',pname)}return result},utils.transformParams=function(params,props){props=props||{};var result={};for(var p in props){var pname=props[p][0],pdefault=props[p][1];pname in params?result[p]=params[pname]:"undefined"!=typeof pdefault&&(result[p]=pdefault)}return result},utils.matchParams=function(a,b,list){a=a||{},b=b||{};for(var i=0;i<list.length;i++)if(a[list[i]]!=b[list[i]])return!1;return!0},utils.isUrlGoodForReturn=function(url){var path=utils.getRelativePath(url),route=ns.router(path);return!(!url||!url.match(re_host)&&0!==url.indexOf("/")||path.match(re_edit_url)||path.match(re_edit_url2)||path.match(re_view_url)||"photo"===route.page||"contest-vote"===route.page||"not-found"===route.page)},utils.getRelativePath=function(url){var from,offset;if(url=url||"",0===url.indexOf("https://"))offset=8;else if(0===url.indexOf("http://"))offset=7;else{if(0!==url.indexOf("//"))return 0===url.indexOf("/")?url:"";offset=2}return from=url.indexOf("/",offset),0>from?"":url.substring(from)};var re_all_dots=/\./g;utils.normalizeLogin=function(login){return login.toLowerCase().replace(re_all_dots,"-")},utils.getOldFotkiContextUrl=function(params){var context=params.context||"album";switch(context){case"calendar":case"top":case"contest":case"album":return ph.utils.generateUrl(context,params);case"tag":return utils.generateUrl("user-tag",{"author-login":params["author-login"],tag:params.tag,p:params.page});case"search":return ph.utils.generateUrl("search",params);case"recent":case"popular":return ph.utils.generateUrl("index",{context:context});default:ns.assert.fail("ph.utils",'Unknown context "%s"',context)}},utils.uniq=function(ar,key){for(var keys={},result=[],i=0;i<ar.length;i++){var item=ar[i],k=key(ar[i]);keys[k]||(keys[k]=!0,result.push(item))}return result},utils.getShareLink=function(photoData){ns.assert(photoData,"ph.utils","Photo not specified for generating share link");var _params=no.extend({},ns.page.current.params,{"author-login":photoData.author.login,"album-id":photoData.albumId,"image-id":photoData.imageId});return ph.utils.fullUrl(ph.utils.generateUrl("photo",_params))},utils.getShareLinkBlogCode=function(photoData){ns.assert(photoData,"ph.utils","Photo not specified for generating share link");var _params=no.extend({},ns.page.current.params,{"author-login":photoData.author.login,"album-id":photoData.albumId,"image-id":photoData.imageId}),context=ns.page.current.params.context;return context&&(_params=no.extend({},_params,{context:"search"===context?"album":context})),ph.utils.fullUrl(ph.utils.generateUrl("photo",_params))},utils.groupMedals=function(photoMoreData){var medals=[];if(!photoMoreData)return medals;photoMoreData.podDate&&medals.push({type:"photoofday",date:utils.parseDate(photoMoreData.podDate).getTime()}),photoMoreData.inTopFrom&&medals.push({type:"top",date:utils.parseDate(photoMoreData.inTopFrom).getTime()});for(var contests=no.jpath(".contestBindings.contestBinding",photoMoreData)||[],i=0;i<contests.length;i++){var contest=contests[i];if("rejected"!==contest.imageStatus){var medal={type:"contest",id:no.jpath(".contest.contestId",contest),state:no.jpath(".contest.state",contest),status:contest.imageStatus,name:no.jpath(".contest.name",contest),date:no.jpath(".contest.startDate",contest),votingStartDate:no.jpath(".contest.votingStartDate",contest),votingFinishDate:no.jpath(".contest.votingFinishDate",contest),place:no.jpath(".rating.place",contest)};"finished"!==medal.state?medals.unshift(medal):medals.push(medal)}}return medals},utils.destroyBlocks=function(view){view.$node.find("*[data-nb]").each(function(i,node){var block;nb.hasBlock(node)&&(block=nb.block(node),block&&block.destroy())})},utils.imgOnLoad=function($element,callback){$element.one("load",callback),($element[0].complete===!0||4==$element[0].readyState||"complete"==$element[0].readyState||"loaded"==$element[0].readyState)&&$element.trigger("load")},utils.appendParams=function(url,params){var hash="",query="",baseUrl=url||"",hashIndex=baseUrl.indexOf("#");hashIndex>=0&&(hash=baseUrl.substring(hashIndex),baseUrl=baseUrl.substring(0,hashIndex));var queryIndex=baseUrl.indexOf("?");queryIndex>=0&&(query=baseUrl.substring(queryIndex+1),baseUrl=baseUrl.substring(0,queryIndex));for(var pName in params)query+=query?"&"+pName+"="+params[pName]:pName+"="+params[pName];return baseUrl+(query?"?"+query:"")+(hash?hash:"")},utils.formatDateRelative=function(milliseconds){var date=moment(milliseconds),currentDate=moment();return currentDate.isSame(date,"day")?date.calendar():date.format(currentDate.isSame(date,"year")?"D MMMM":"D MMMM YYYY")},utils.formatDate=function(milliseconds,format){return moment(milliseconds).format(format)},utils.formatDateWithTZ=function(dateString,format){return moment(dateString).zone(dateString).format(format)},utils.plural=function(num,f0,f1,f3,f5){var placeholder="$0";if(num=isNaN(parseInt(num,10))?0:num,0===num)return f0.replace(placeholder,num);var lastNumber=num%10,lastNumbers=num%100,result="";return result=1===lastNumber&&11!==lastNumbers?f1:lastNumber>1&&5>lastNumber&&(10>lastNumbers||lastNumbers>20)?f3:f5,result.replace(placeholder,num)},utils.getAvatarUrl=function(uid){return"https://upics.yandex.net/"+(uid?uid:0)+"/normal"},utils.preloadImage=function(src){var img=new Image;img.src=src},utils.listenToPageChange=function(){var lastUrl;lastUrl=null,ph.prevUrl=null,ns.events.on("ns-page-before-load",function(evt,pages,newUrl){if(newUrl!==lastUrl){var newPageInfo=pages[1];if("photo"!==newPageInfo.page||newPageInfo.params["album-id"]){nb.popup.closeAll(),ns.events.trigger("ph-page-show",newPageInfo);var isPageChange=!!lastUrl;isPageChange&&ns.events.trigger("ph-page-change"),ph.prevUrl=lastUrl,lastUrl=newUrl}}})},utils.nsViewModels=function(decls){var decl={};ns.assert("object"==typeof decls,"ph.utils.nsViewModels","view models declaration must be an object");for(var modelId in decls){ns.assert("object"==typeof decls[modelId],"ph.utils.nsViewModels","for each model in view models declaration an object must be specified"),decl[modelId]={};for(var eventType in decls[modelId])ns.assert(["ns-model-insert","ns-model-remove","ns-model-changed","ns-model-destroyed","ns-model-touched"].indexOf(eventType)>=0,"ph.utils.nsViewModels",'unsupported model event type "%s"',eventType),decl[modelId][eventType]=utils._nsViewModelDecl(modelId,decls[modelId][eventType])}return decl},utils._nsViewModelDecl=function(modelId,decl){if("string"==typeof decl)return function(){var methodName=decl;ns.assert("function"==typeof this[methodName],"ph.utils._nsViewModelDecl",'was looking for method "%s" (%s)',methodName,this.id),this.keepValid(),this[methodName].call(this)};if("object"==typeof decl){var onModelChanged=function(){var methodName,model=this.getModel(modelId);ns.assert(model,"ph.utils._nsViewModelDecl","model %s was not found (view %s)",modelId,this.key),this.keepValid();for(var jpath in decl)model.hasDataChangedByJpath(jpath)&&(methodName=decl[jpath],ns.assert("function"==typeof this[methodName],"ph.utils._nsViewModelDecl",'was looking for method "%s" (%s)',methodName,this.id),this[methodName].call(this))};return onModelChanged}ns.assert.fail("utils._nsViewModelDecl","view model declaration of type %s is not supported",typeof decl)},ph.utils=utils}(),function(){var fullscreen;!function(){"use strict";var isCommonjs="undefined"!=typeof module&&module.exports,keyboardAllowed="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,fn=function(){for(var val,valLength,fnMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,l=fnMap.length,ret={};l>i;i++)if(val=fnMap[i],val&&val[1]in document){for(i=0,valLength=val.length;valLength>i;i++)ret[fnMap[0][i]]=val[i];return ret}return!1}(),screenfull={request:function(elem){var request=fn.requestFullscreen;elem=elem||document.documentElement,/5\.1[\.\d]* Safari/.test(navigator.userAgent)?elem[request]():elem[request](keyboardAllowed&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[fn.exitFullscreen]()},toggle:function(elem){this.isFullscreen?this.exit():this.request(elem)},onchange:function(){},onerror:function(){},raw:fn};return fn?(Object.defineProperties(screenfull,{isFullscreen:{get:function(){return!!document[fn.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[fn.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!document[fn.fullscreenEnabled]}}}),document.addEventListener(fn.fullscreenchange,function(e){screenfull.onchange.call(screenfull,e)}),document.addEventListener(fn.fullscreenerror,function(e){screenfull.onerror.call(screenfull,e)}),void(isCommonjs?module.exports=screenfull:window.screenfull=screenfull)):void(isCommonjs?module.exports=!1:window.screenfull=!1)}(),fullscreen={init:function(){screenfull&&$(document).on(screenfull.raw.fullscreenchange,function(){ns.events.trigger("ph-fullscreen-change",screenfull.isFullscreen)})},request:function(){screenfull.enabled&&screenfull.request()},exit:function(){screenfull.enabled&&screenfull.exit()},isFullscreen:function(){return screenfull.isFullscreen}},ph.fullscreen=fullscreen}(),function(){var getIcon=function(name){switch(name){case"gear":return'<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="22" height="22"><path fill="currentColor" d="M20.197,4.553l1.813,3.692l-2.62,1.985c0.066,0.626,0.077,1.264-0.012,1.909l2.535,2.057l-1.9,3.62l-3.203-0.84 c-0.426,0.384-0.898,0.711-1.394,1l-0.039,3.23l-4.093,0.798l-1.366-2.978c-0.298-0.048-0.6-0.099-0.898-0.177 c-0.263-0.069-0.518-0.151-0.769-0.242l-2.606,1.975l-3.226-2.62l1.521-2.897c-0.287-0.478-0.52-0.985-0.702-1.512l-3.249-0.762 l0.051-4.08l3.287-0.643c0.201-0.522,0.458-1.01,0.755-1.467L2.636,3.652l3.29-2.492l2.585,2.097 c0.532-0.169,1.088-0.267,1.652-0.328l1.442-2.933l4.07,0.957l-0.039,3.246c0.485,0.309,0.919,0.68,1.324,1.073L20.197,4.553z M12.176,7.067C9.949,6.483,7.674,7.769,7.093,9.938c-0.579,2.168,0.754,4.4,2.979,4.984c2.229,0.583,4.504-0.7,5.084-2.872 C15.735,9.882,14.403,7.651,12.176,7.067z"/></svg>';case"door":return'<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="16" height="16"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M5 0L    5 2 14 2 14 14 5 14 5 16 16 16 16 0zM0 6h6v-3l6 5-6 5v-3h-6v-4z"/></svg>';case"thumb-up":return'<svg viewBox="0 0 21 23" xmlns="http://www.w3.org/2000/svg" width="21" height="23"><path d="M 11.0012 -0.0015 L 3.9908 10.9985 L 3.9908 18.9985 C 3.9908 18.9985 3.9287 22.9985 7.9968 22.9985 L 14.882 22.9985 C 14.882 22.9985 14.9221 23.0015 14.9935 23.0015 C 15.5334 23.0015 17.8787 22.8315 18.7628 19.936 L 20.8909 12.9985 C 20.8909 12.9985 21.9551 8.9985 16.8849 8.9985 L 14.0057 8.9985 C 14.0057 8.9985 13.9637 9.001 13.8912 9.001 C 13.3915 9.001 11.4521 8.8818 11.9714 6.9985 L 12.879 3.7173 C 12.879 3.7173 13.8492 -0.0015 11.0012 -0.0015 M 7.9968 20.9985 C 6.0251 20.9985 5.9938 18.8735 5.9938 18.8735 L 5.9938 11.5615 L 10.6257 3.9365 C 11.1885 3.9365 10.3132 6.1865 10.3132 6.1865 C 8.4975 10.9985 13.0355 10.9985 13.0355 10.9985 L 16.8849 10.9985 C 19.5139 10.9985 18.888 12.9985 18.888 12.9985 C 18.888 12.9985 18.0743 15.5649 17.1295 18.9829 C 16.5163 20.9224 15.1255 20.9995 14.9104 20.9995 C 14.8918 20.9995 14.882 20.9985 14.882 20.9985 L 7.9968 20.9985 M 1.9878 9.9985 L -0.0151 9.9985 L -0.0151 21.9985 L 1.9878 21.9985 L 1.9878 9.9985" fill="currentColor"/></svg>';case"letter":return'<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="16" height="16"><path fill="currentColor" d="M0 2v12h16v-12h-16zm8 6l-7-5h14l-7 5z"/></svg>';case"ufo":return'<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="21" height="16"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M11.329 13.33c-1.646.435-3.189.65-4.356.646-.376-.001-.759-.023-1.1-.088l-.258-.062-.033.002c-.559.014-1.084 0-1.573-.037-1.895-.152-3.389-.713-3.692-1.843-.291-1.087.722-2.356 2.297-3.424.606-.409 1.045-.89 1.293-1.455 1.15-1.808 1.452-4.478 4.082-5.277l.506-.134c2.684-.603 4.269 1.569 6.164 2.572.433.321 1.065.522 1.863.623 1.896.15 3.393.71 3.692 1.841.301 1.133-.722 2.356-2.297 3.424-.405.275-.855.546-1.348.808l-.028.016-.197.186c-.265.223-.585.431-.908.615-1.013.579-2.461 1.152-4.107 1.587zm-.186-1.182c1.421-.36 2.476-.758 3.321-1.212.425-.229.646-.412.862-.573.194-.145.156-.275-.24-.382-.271-.073-.392-.045-.887-.04-.986.011-2.325.324-3.759.631-2.178.467-3.438 1.289-4.118 1.812-.336.261.09.514 1.117.468.985-.043 2.283-.342 3.704-.704zm-6.625.297c-.182-.688.642-1.42 1.504-1.913 1.013-.579 2.597-1.205 4.242-1.639 1.646-.435 3.184-.767 4.35-.764 1.004.004 2.265.254 2.446.939 0 0 .294-.117.542-.277 1.271-.818 1.356-1.229 1.195-1.836-.16-.606-.966-.962-2.955-1.12-1.888-.15-3.707-.241-6.378.464-2.67.706-4.552 1.908-6.121 2.967-1.635 1.102-1.854 1.836-1.776 2.313.072.433.495.94 2.485 1.099.859.067.466-.233.466-.233z"/></svg>';case"pin":return'<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="11" height="18"><path fill="currentColor" d="M11 5.361c0-2.961-2.462-5.361-5.5-5.361-3.037 0-5.5 2.4-5.5 5.361s2.463 5.362 5.5 5.362l-1.965 7.277c4.666-6.319 7.465-9.027 7.465-12.639zm-7.621 0c0-1.142.949-2.067 2.121-2.067s2.121.926 2.121 2.067c0 1.143-.949 2.068-2.121 2.068s-2.121-.925-2.121-2.068z"/></svg>';case"comment":return'<svg width="18" height="17" xmlns="http://www.w3.org/2000/svg" class="svg-icon"><path d="m9,13l-0.42,-0.01l-4.58,4.01l0,-4.61c-2.41,-0.77 -4,-2.46 -4,-5.89c0,-3.59 2.16,-6.5 9,-6.5c7,0 9.01,2.91 9,6.5c-0.02,4.49 -4.028999,6.5 -9,6.5z" fill="currentColor"/></svg>';case"like":case"heart":return'<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="16.998" height="14"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M12.398.04c-.257-.025-.498-.04-.723-.04-1.812 0-2.681 1.346-3.676 2.348-.993-1.002-1.863-2.348-3.674-2.348-.226 0-.468.015-.724.04-1.569.127-3.381 1.345-3.601 3.694v.773c.206 2.247 2.192 5.015 7.999 8.493 5.808-3.478 7.796-6.246 8.001-8.493v-.773c-.221-2.349-2.034-3.567-3.602-3.694z"/></svg>';case"upload":return'<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="16" height="16"><path d="M1,13v2h14v-2H1z M2,7h3v5h6V6.969L14,7L8,1L2,7z" fill="currentColor"/></svg>';default:return null}};ph.icon=getIcon}(),function(){var ActionContext=function(promise,options){this.promise=promise,this.options=options,this.init()};ActionContext.prototype.init=function(){this.page=no.extend({},ns.page.current),this.pageUrl=ns.page.currentUrl,this._listenToPageLeave(),this.promise.then(this.destroy,this)},ActionContext.prototype.destroy=function(){this._pageLeaveHandler&&(ns.events.off("ns-page-before-load",this._pageLeaveHandler),this._pageLeaveHandler=null)},ActionContext.prototype._listenToPageLeave=function(){var that=this;this._pageLeaveHandler=function(){that.pageLeft=!0},ph.utils.once(ns.events,"ns-page-before-load",this._pageLeaveHandler)},ActionContext.prototype.copyData=function(data){return data&&data.error&&(this.error=data.error),data&&data.model&&(this.model=data.model),this},ph.ActionContext=ActionContext}(),function(){var optionsDefaults={check:function(){return!0},done:function(){},fail:function(){}},actions={};actions.createContext=function(error,model){var promise=new Vow.Promise,context=new ph.ActionContext(promise);return model&&(context.model=model),error&&(context.error=error),context},actions["do"]=function(modelId,params,options){options=no.extend({},optionsDefaults,options||{});var promise=new Vow.Promise,context=new ph.ActionContext(promise,options);promise.then(function(model){context.model=model,options.done(context)}),promise.fail(function(details){context.model=details.model,context.error=details.error,details.model&&!details.error&&(context.error=details.model.getError()),options.fail(context)
});var requestPromise=ns.request(modelId,params);requestPromise.then(function(models){if(!models||!models.length||!options.check(models[0]))return void promise.reject({model:models[0]});var model=models[0],error=model.getError();return error?void promise.reject({model:model,error:error}):void promise.fulfill(models[0])}),requestPromise.fail(function(error){var doModel=no.jpath(".invalid[0]",error),doModelError=doModel&&doModel.length?doModel[0].getError():{};promise.reject({error:doModelError})})},actions.get=actions["do"],actions.restorePage=function(context){return context&&context.pageLeft?ns.page.go(context.pageUrl):Vow.fulfill()},ph.actions=actions}(),function(){var errorReasonAborted="Server returned no data",isOk=function(model){return"ok"===no.jpath(".result",model.getData())},wrapError=function(error,errorName){return error=error||{},errorName||(errorName=error.reason===errorReasonAborted||"cancelled"===error.name?"aborted":"cannot edit"),{name:errorName,details:error.name||"operation failed"}},ImageEditTask=function(photo,actions,ticket,beforeEditCallback,metrikaCountCallback){ns.assert(beforeEditCallback,"image-edit-task","beforeEditCallback not specified"),ns.assert(metrikaCountCallback,"image-edit-task","metrikaCountCallback not specified"),this.photo=photo,this.actions=actions,this.ticket=ticket,this.beforeEditCallback=beforeEditCallback,this.metrikaCountCallback=metrikaCountCallback,this.params=photo.params,this.statusRetries=3,this.tooLongTimeout=12e4,this.statusPingTimeout=700,this.promise=null,this.done=!1,this.failed=!1};ImageEditTask.prototype.run=function(){var that=this;if(this.promise)return this.promise;var promise=this.promise=new Vow.Promise,beforeEditPromise=new Vow.Promise,editPromise=new Vow.Promise;return beforeEditPromise.sync(this.beforeEdit()),beforeEditPromise.fail(function(error){promise.reject(wrapError(error))}),beforeEditPromise.then(function(){editPromise.sync(that.startEdit()),that.initTooLongTimeout(promise)}),editPromise.fail(function(error){promise.reject(wrapError(error))}),editPromise.then(function(){that.pingStatus()}),this.promise},ImageEditTask.prototype.beforeEdit=function(){var that=this,promise=new Vow.Promise,metrikaCountCallback=this.metrikaCountCallback;return ph.actions["do"]("do-image-before-edit",{ticket:this.ticket,"image-id":this.params["image-id"],actions:this.actions},{check:isOk,done:function(context){var askUser=context.model.get(".willDropAreas");askUser?(that.beforeEditCallback(promise),promise.then(function(){metrikaCountCallback(!0)},function(){metrikaCountCallback(!1)})):(promise.fulfill(context),metrikaCountCallback(null))},fail:function(context){promise.reject(context.error)}}),promise},ImageEditTask.prototype.startEdit=function(){var promise=new Vow.Promise;return ph.actions["do"]("do-image-edit",{ticket:this.ticket,"image-id":this.params["image-id"],actions:this.actions},{check:isOk,done:function(context){promise.fulfill(context)},fail:function(context){promise.reject(context.error)}}),promise},ImageEditTask.prototype.pingStatus=function(){var that=this,promise=this.promise;this.failed||this.done||setTimeout(function(){ph.actions["do"]("do-image-edit-status",{ticket:that.ticket,"image-id":that.params["image-id"]},{check:function(model){return!!model.get(".name")},done:function(context){var status=context.model.get(".name");return"ERROR"===status?void promise.reject(wrapError(null,"error")):"IN_PROGRESS"===status?void that.pingStatus():("FINISHED"===status&&promise.fulfill(),void promise.reject(wrapError(null,"uknown status")))},fail:function(context){that.statusRetries--<=0?promise.reject(wrapError(context.error,"status check failed")):that.pingStatus()}})},this.statusPingTimeout)},ImageEditTask.prototype.initTooLongTimeout=function(promise){var timer=setTimeout(function(){promise.reject(wrapError(null,"timeout"))},this.tooLongTimeout);promise.always(function(){timer&&(clearTimeout(timer),timer=null)}),promise.then(function(){this.done=!0},function(){this.failed=!0},this)},ph.ImageEditTask=ImageEditTask}(),function(){var errorReasonAborted="Server returned no data",isOk=function(model){return!!no.jpath(".jobId",model.getData())},wrapError=function(error,errorName){return error=error||{},errorName||(errorName=error.reason===errorReasonAborted||"cancelled"===error.name?"aborted":"cannot edit"),{name:errorName,details:error.name||"operation failed"}},SaveToDiskTask=function(photo,ticket){this.photo=photo,this.ticket=ticket,this.params=photo.params,this.statusRetries=3,this.tooLongTimeout=12e4,this.statusPingTimeout=700,this.promise=null,this.done=!1,this.failed=!1};SaveToDiskTask.prototype.run=function(){var that=this;if(this.promise)return this.promise;var promise=this.promise=new Vow.Promise,savePromise=new Vow.Promise;return savePromise.sync(that.startSave()),that.initTooLongTimeout(promise),savePromise.fail(function(error){promise.reject(wrapError(error,error.name))}),savePromise.then(function(context){that.pingStatus(no.jpath(".jobId",context.model.getData()))}),this.promise},SaveToDiskTask.prototype.startSave=function(){var promise=new Vow.Promise,photoData=this.photo.getData();return ph.actions["do"]("do-photo-to-disk-start",{"author-id":no.jpath(".author.uid",photoData),"image-id":no.jpath(".imageId",photoData),ticket:this.ticket},{check:isOk,done:function(context){promise.fulfill(context)},fail:function(context){promise.reject(context.error)}}),promise},SaveToDiskTask.prototype.pingStatus=function(jobId){var that=this,promise=this.promise;this.failed||this.done||setTimeout(function(){ph.actions["do"]("do-photo-to-disk-status",{"job-id":jobId,ticket:that.ticket},{check:function(model){return!!model.get(".state")},done:function(context){var status=context.model.get(".state");return"error"===status?void promise.reject(wrapError(null,"error")):"running"===status?void that.pingStatus(jobId):("completed"===status&&promise.fulfill(context),void promise.reject(wrapError(null,"uknown status")))},fail:function(context){that.statusRetries--<=0?promise.reject(wrapError(context.error,"status check failed")):that.pingStatus(jobId)}})},this.statusPingTimeout)},SaveToDiskTask.prototype.initTooLongTimeout=function(promise){var timer=setTimeout(function(){promise.reject(wrapError(null,"timeout"))},this.tooLongTimeout);promise.always(function(){timer&&(clearTimeout(timer),timer=null)}),promise.then(function(){this.done=!0},function(){this.failed=!0},this)},ph.saveToDiskTask=SaveToDiskTask}(),function(){function stackBlurImage(imageIDOrElement,canvasIDOrElement,radius,blurAlphaChannel){var img=stackBlurGetElement(imageIDOrElement),w=img.naturalWidth,h=img.naturalHeight,canvas=stackBlurGetElement(canvasIDOrElement);canvas.style.width=w+"px",canvas.style.height=h+"px",canvas.width=w,canvas.height=h;var context=canvas.getContext("2d");context.clearRect(0,0,w,h),context.drawImage(img,0,0),isNaN(radius)||1>radius||(blurAlphaChannel?stackBlurCanvasRGBA(canvasIDOrElement,0,0,w,h,radius):stackBlurCanvasRGB(canvasIDOrElement,0,0,w,h,radius))}function stackBlurCanvasRGBA(canvasIDOrElement,top_x,top_y,width,height,radius){if(!(isNaN(radius)||1>radius)){radius|=0;var imageData,canvas=stackBlurGetElement(canvasIDOrElement),context=canvas.getContext("2d");try{try{imageData=context.getImageData(top_x,top_y,width,height)}catch(e){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),imageData=context.getImageData(top_x,top_y,width,height)}catch(e){throw alert("Cannot access local image"),new Error("unable to access local image data: "+e)}}}catch(e){throw alert("Cannot access image"),new Error("unable to access image data: "+e)}var x,y,i,p,yp,yi,yw,r_sum,g_sum,b_sum,a_sum,r_out_sum,g_out_sum,b_out_sum,a_out_sum,r_in_sum,g_in_sum,b_in_sum,a_in_sum,pr,pg,pb,pa,rbs,pixels=imageData.data,div=radius+radius+1,widthMinus1=width-1,heightMinus1=height-1,radiusPlus1=radius+1,sumFactor=radiusPlus1*(radiusPlus1+1)/2,stackStart=new BlurStack,stack=stackStart;for(i=1;div>i;i++)if(stack=stack.next=new BlurStack,i==radiusPlus1)var stackEnd=stack;stack.next=stackStart;var stackIn=null,stackOut=null;yw=yi=0;var mul_sum=mul_table[radius],shg_sum=shg_table[radius];for(y=0;height>y;y++){for(r_in_sum=g_in_sum=b_in_sum=a_in_sum=r_sum=g_sum=b_sum=a_sum=0,r_out_sum=radiusPlus1*(pr=pixels[yi]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),a_out_sum=radiusPlus1*(pa=pixels[yi+3]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,a_sum+=sumFactor*pa,stack=stackStart,i=0;radiusPlus1>i;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack.a=pa,stack=stack.next;for(i=1;radiusPlus1>i;i++)p=yi+((i>widthMinus1?widthMinus1:i)<<2),r_sum+=(stack.r=pr=pixels[p])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[p+1])*rbs,b_sum+=(stack.b=pb=pixels[p+2])*rbs,a_sum+=(stack.a=pa=pixels[p+3])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,a_in_sum+=pa,stack=stack.next;for(stackIn=stackStart,stackOut=stackEnd,x=0;width>x;x++)pixels[yi]=r_sum*mul_sum>>shg_sum,pixels[yi+1]=g_sum*mul_sum>>shg_sum,pixels[yi+2]=b_sum*mul_sum>>shg_sum,pixels[yi+3]=a_sum*mul_sum>>shg_sum,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,a_sum-=a_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,a_out_sum-=stackIn.a,p=yw+((p=x+radius+1)<widthMinus1?p:widthMinus1)<<2,r_in_sum+=stackIn.r=pixels[p],g_in_sum+=stackIn.g=pixels[p+1],b_in_sum+=stackIn.b=pixels[p+2],a_in_sum+=stackIn.a=pixels[p+3],r_sum+=r_in_sum,g_sum+=g_in_sum,b_sum+=b_in_sum,a_sum+=a_in_sum,stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,a_out_sum+=pa=stackOut.a,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,a_in_sum-=pa,stackOut=stackOut.next,yi+=4;yw+=width}for(x=0;width>x;x++){for(g_in_sum=b_in_sum=a_in_sum=r_in_sum=g_sum=b_sum=a_sum=r_sum=0,yi=x<<2,r_out_sum=radiusPlus1*(pr=pixels[yi]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),a_out_sum=radiusPlus1*(pa=pixels[yi+3]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,a_sum+=sumFactor*pa,stack=stackStart,i=0;radiusPlus1>i;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack.a=pa,stack=stack.next;for(yp=width,i=1;radius>=i;i++)yi=yp+x<<2,r_sum+=(stack.r=pr=pixels[yi])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[yi+1])*rbs,b_sum+=(stack.b=pb=pixels[yi+2])*rbs,a_sum+=(stack.a=pa=pixels[yi+3])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,a_in_sum+=pa,stack=stack.next,heightMinus1>i&&(yp+=width);for(yi=x,stackIn=stackStart,stackOut=stackEnd,y=0;height>y;y++)p=yi<<2,pixels[p+3]=pa=a_sum*mul_sum>>shg_sum,pa>0?(pa=255/pa,pixels[p]=(r_sum*mul_sum>>shg_sum)*pa,pixels[p+1]=(g_sum*mul_sum>>shg_sum)*pa,pixels[p+2]=(b_sum*mul_sum>>shg_sum)*pa):pixels[p]=pixels[p+1]=pixels[p+2]=0,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,a_sum-=a_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,a_out_sum-=stackIn.a,p=x+((p=y+radiusPlus1)<heightMinus1?p:heightMinus1)*width<<2,r_sum+=r_in_sum+=stackIn.r=pixels[p],g_sum+=g_in_sum+=stackIn.g=pixels[p+1],b_sum+=b_in_sum+=stackIn.b=pixels[p+2],a_sum+=a_in_sum+=stackIn.a=pixels[p+3],stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,a_out_sum+=pa=stackOut.a,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,a_in_sum-=pa,stackOut=stackOut.next,yi+=width}context.putImageData(imageData,top_x,top_y)}}function stackBlurCanvasRGB(canvasIDOrElement,top_x,top_y,width,height,radius){if(!(isNaN(radius)||1>radius)){radius|=0;var imageData,canvas=stackBlurGetElement(canvasIDOrElement),context=canvas.getContext("2d");try{try{imageData=context.getImageData(top_x,top_y,width,height)}catch(e){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead"),imageData=context.getImageData(top_x,top_y,width,height)}catch(e){throw alert("Cannot access local image"),new Error("unable to access local image data: "+e)}}}catch(e){throw alert("Cannot access image"),new Error("unable to access image data: "+e)}var x,y,i,p,yp,yi,yw,r_sum,g_sum,b_sum,r_out_sum,g_out_sum,b_out_sum,r_in_sum,g_in_sum,b_in_sum,pr,pg,pb,rbs,pixels=imageData.data,div=radius+radius+1,widthMinus1=width-1,heightMinus1=height-1,radiusPlus1=radius+1,sumFactor=radiusPlus1*(radiusPlus1+1)/2,stackStart=new BlurStack,stack=stackStart;for(i=1;div>i;i++)if(stack=stack.next=new BlurStack,i==radiusPlus1)var stackEnd=stack;stack.next=stackStart;var stackIn=null,stackOut=null;yw=yi=0;var mul_sum=mul_table[radius],shg_sum=shg_table[radius];for(y=0;height>y;y++){for(r_in_sum=g_in_sum=b_in_sum=r_sum=g_sum=b_sum=0,r_out_sum=radiusPlus1*(pr=pixels[yi]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,stack=stackStart,i=0;radiusPlus1>i;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack=stack.next;for(i=1;radiusPlus1>i;i++)p=yi+((i>widthMinus1?widthMinus1:i)<<2),r_sum+=(stack.r=pr=pixels[p])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[p+1])*rbs,b_sum+=(stack.b=pb=pixels[p+2])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,stack=stack.next;for(stackIn=stackStart,stackOut=stackEnd,x=0;width>x;x++)pixels[yi]=r_sum*mul_sum>>shg_sum,pixels[yi+1]=g_sum*mul_sum>>shg_sum,pixels[yi+2]=b_sum*mul_sum>>shg_sum,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,p=yw+((p=x+radius+1)<widthMinus1?p:widthMinus1)<<2,r_in_sum+=stackIn.r=pixels[p],g_in_sum+=stackIn.g=pixels[p+1],b_in_sum+=stackIn.b=pixels[p+2],r_sum+=r_in_sum,g_sum+=g_in_sum,b_sum+=b_in_sum,stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,stackOut=stackOut.next,yi+=4;yw+=width}for(x=0;width>x;x++){for(g_in_sum=b_in_sum=r_in_sum=g_sum=b_sum=r_sum=0,yi=x<<2,r_out_sum=radiusPlus1*(pr=pixels[yi]),g_out_sum=radiusPlus1*(pg=pixels[yi+1]),b_out_sum=radiusPlus1*(pb=pixels[yi+2]),r_sum+=sumFactor*pr,g_sum+=sumFactor*pg,b_sum+=sumFactor*pb,stack=stackStart,i=0;radiusPlus1>i;i++)stack.r=pr,stack.g=pg,stack.b=pb,stack=stack.next;for(yp=width,i=1;radius>=i;i++)yi=yp+x<<2,r_sum+=(stack.r=pr=pixels[yi])*(rbs=radiusPlus1-i),g_sum+=(stack.g=pg=pixels[yi+1])*rbs,b_sum+=(stack.b=pb=pixels[yi+2])*rbs,r_in_sum+=pr,g_in_sum+=pg,b_in_sum+=pb,stack=stack.next,heightMinus1>i&&(yp+=width);for(yi=x,stackIn=stackStart,stackOut=stackEnd,y=0;height>y;y++)p=yi<<2,pixels[p]=r_sum*mul_sum>>shg_sum,pixels[p+1]=g_sum*mul_sum>>shg_sum,pixels[p+2]=b_sum*mul_sum>>shg_sum,r_sum-=r_out_sum,g_sum-=g_out_sum,b_sum-=b_out_sum,r_out_sum-=stackIn.r,g_out_sum-=stackIn.g,b_out_sum-=stackIn.b,p=x+((p=y+radiusPlus1)<heightMinus1?p:heightMinus1)*width<<2,r_sum+=r_in_sum+=stackIn.r=pixels[p],g_sum+=g_in_sum+=stackIn.g=pixels[p+1],b_sum+=b_in_sum+=stackIn.b=pixels[p+2],stackIn=stackIn.next,r_out_sum+=pr=stackOut.r,g_out_sum+=pg=stackOut.g,b_out_sum+=pb=stackOut.b,r_in_sum-=pr,g_in_sum-=pg,b_in_sum-=pb,stackOut=stackOut.next,yi+=width}context.putImageData(imageData,top_x,top_y)}}function BlurStack(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}function stackBlurGetElement(elementOrID){return 1==elementOrID.nodeType?elementOrID:document.getElementById(elementOrID)}var stackBlur,mul_table=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],shg_table=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];stackBlur={Image:stackBlurImage,CanvasRGBA:stackBlurCanvasRGBA,CanvasRGB:stackBlurCanvasRGB},ph.stackBlur=stackBlur}();var ns={};ns.todo=function(){throw new Error("Unimplemented")},ns.parseQuery=function(s){var o={};return s.split("&").forEach(function(chunk){var p=chunk.split("="),name=p.shift();if(name){var value=p.join("=");if("undefined"==typeof value)value="";else try{value=decodeURIComponent(value)}catch(e){value="",ns.log.info("ns.parseQuery.invalid-param",{query:s,chunk:chunk})}name in o?(Array.isArray(o[name])||(o[name]=[o[name]]),o[name].push(value)):o[name]=value}}),o},ns.renderString=function(json,mode,module){return yr.run(module||"main",json,mode)},ns.renderNode=function(json,mode,module){return ns.html2node(ns.renderString(json,mode,module))},ns.init=function(){ns.action.init(),ns.router.init(),ns.history.init(),ns.initMainView()},ns.initMainView=function(){var mainView=ns.View.create("app");mainView._setNode(document.getElementById("app")),mainView.invalidate(),ns.MAIN_VIEW=mainView},ns.assert=function(truthy){truthy||ns.assert.fail.apply(this,Array.prototype.slice.call(arguments,1))},ns.assert.fail=function(contextName,message){for(var messageArgs=Array.prototype.slice.call(arguments,2),i=0;i<messageArgs.length;i++)message=message.replace("%s",messageArgs[i]);throw new Error("["+contextName+"] "+message)},ns.key=function(prefix,params){var key=prefix;params=params||{};for(var pName in params)key+="&"+pName+"="+params[pName];return key},ns.params2query=function(params){var pName,pValue,query=[];for(pName in params)if(pValue=params[pName],Array.isArray(pValue))for(var i=0;i<pValue.length;i++)query.push(encodeURIComponent(pName)+"="+encodeURIComponent(pValue[i]));else query.push(encodeURIComponent(pName)+"="+encodeURIComponent(pValue));return query.join("&")},ns.reset=function(){ns.action&&ns.action._reset(),ns.router._reset(),ns.layout._reset(),ns.Model._reset(),ns.View._reset(),ns.request._reset(),ns.page._reset(),ns.MAIN_VIEW=null},window.ns=ns,ns.L={},ns.L.VIEW="view",ns.L.ASYNC="async",ns.L.BOX="box",ns.V={},ns.V.STATUS={NONE:"none",LOADING:"loading",OK:"ok",INVALID:"invalid"},ns.M={},ns.M.STATUS={ERROR:"error",INITED:"inited",NONE:"none",OK:"ok",INVALID:"invalid"},ns.R={NOT_APP_URL:"ns-router-not-app",NOT_FOUND:"not-found",REDIRECT:"ns-router-redirect"},ns.U={},ns.U.STATUS={MODELS:"models",EXPIRED:"expired"},ns.U.EXEC={GLOBAL:"global",ASYNC:"async",PARALLEL:"parallel"},ns.DEBUG=!1,ns.H={DEFAULTS:{dataType:"json",type:"POST"}},ns.V.EVENTS={click:"click",dblclick:"dblclick",mousedown:"mousedown",mousemove:"mousemove",mouseup:"mouseup"},ns.V.DOM_EVENTS=["blur","change","input","click","dblclick","dragstart","dragenter","dragover","dragleave","drag","drop","dragend","focus","focusin","focusout","keydown","keypress","keyup","mousedown","mouseenter","mouseleave","mousemove","mouseout","mouseover","mouseup","resize","scroll","submit"],ns.V.NS_EVENTS=["ns-view-async","ns-view-init","ns-view-htmlinit","ns-view-show","ns-view-touch","ns-view-hide","ns-view-htmldestroy"],ns.IS_TOUCH=Boolean("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch),ns.IS_TOUCH&&(ns.V.DOM_EVENTS.push("swipe","swipeleft","swiperight","tap","touchstart","touchmove","touchend"),ns.V.EVENTS={click:"tap",dblclick:"doubletap",mousedown:"touchstart",mousemove:"touchmove",mouseup:"touchend"}),function(ns){ns.replaceNode=function(oldNode,newNode){return oldNode===newNode?!0:oldNode.parentNode?(oldNode.parentNode.replaceChild(newNode,oldNode),!0):!1},ns.removeNode=function(node){var parent=node.parentNode;parent&&parent.removeChild(node)},ns.html2node=function(html){var div=document.createElement("div");return div.innerHTML=html,div.firstChild};var whiteSpacesInClassNameRE=/[\t\r\n]/g;ns.hasClass="undefined"!=typeof document&&document.createElement("div").classList?function(node,className){return node.classList.contains(className)}:function(node,className){return className=" "+className+" ",1===node.nodeType&&(" "+node.className+" ").replace(whiteSpacesInClassNameRE," ").indexOf(className)>=0},ns.byClass="undefined"!=typeof document&&document.getElementsByClassName?function(className,context){return context=context||document,context.getElementsByClassName(className)}:function(className,context){return context=context||document,$(context).find("."+className)}}(ns),function(ns){var ENTITYIFY_REGEXP=/[&<>"'\/]/g,ENTITYIFY_REPLACER=function(){var chars={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"};return function(c){return chars[c]}}();ns.entityify=function(s){return String(s).replace(ENTITYIFY_REGEXP,ENTITYIFY_REPLACER)};var DEENTITYIFY_REGEXP=/&([^&;]+);/g,DEENTITYIFY_REPLACER=function(){var chars={amp:"&",lt:"<",gt:">",quot:'"',"#x27":"'","#x2F":"/"};return function(a,b){return chars[b]||a}}();ns.deentityify=function(s){return String(s).replace(DEENTITYIFY_REGEXP,DEENTITYIFY_REPLACER)}}(ns),ns.Events={},ns.Events.on=function(name,handler){var handlers=this._nsevents_handlers||(this._nsevents_handlers={});return ns.assert("function"==typeof handler,"ns.Events",'Handler for event "%s" in not a function.',name),(handlers[name]||(handlers[name]=[])).push(handler),this},ns.Events.once=function(name,handler){var that=this,once=function(){that.off(name,once),handler.apply(this,arguments)};return this.on(name,once),this},ns.Events.off=function(name,handler){var handlers;if(handler){if(handlers=this._nsevents_handlers&&this._nsevents_handlers[name]){var i=handlers.indexOf(handler);-1!==i&&handlers.splice(i,1)}}else handlers=this._nsevents_handlers,handlers&&(handlers[name]=null);return this},ns.Events.trigger=function(name){var handlers=this._nsevents_handlers&&this._nsevents_handlers[name];if(handlers){handlers=handlers.slice();for(var i=0,l=handlers.length;l>i;i++)try{handlers[i].apply(this,arguments)}catch(e){ns.log.exception("ns.events",e)}}return this},ns.Events.atrigger=function(){var that=this,args=arguments;no.next(function(){that.trigger.apply(that,args)})},ns.Events.forward=function(name,object){return this.on(name,function(e,params){object.trigger(e,params)})},ns.events=no.extend({},ns.Events),!function(){function isFunction(fn){return"function"==typeof fn}ns.history={},ns.history.init=function(){$(window).on("popstate",function(e){e.preventDefault(),e.stopPropagation(),ns.history.onpopstate(e)}),$(document).on(ns.V.EVENTS.click,"a",ns.history._onAnchorClick)},ns.history.pushState=function(url,title){isFunction(window.history.pushState)&&window.history.pushState(null,title||ns.page.title(url),url)},ns.history.replaceState=function(url,title){isFunction(window.history.replaceState)&&window.history.replaceState(null,title||ns.page.title(url),url)},ns.history.onpopstate=function(){ns.page.go("",!0)},ns.history.followAnchorHref=function(href){return ns.page.go(href)},ns.history._onAnchorClick=function(e){var target=e.currentTarget;if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return!0;if(target.hostname!==window.location.hostname)return!0;if(ns.router.baseDir){var linkPath=target.pathname,baseDir=ns.router.baseDir;if(linkPath.substr(0,baseDir.length)!==baseDir)return!0}var href=target.getAttribute("href");if(!href)return!0;if("_blank"!==target.getAttribute("target")){var returnValue=ns.history.followAnchorHref(href,target);if(Vow.isPromise(returnValue))return e.preventDefault(),!0}}}(),ns.http=function(url,params,options){options=no.extend({},ns.H.DEFAULTS,options),options.url=url,options.data=params;var promise=new Vow.Promise;return $.ajax(options).done(function(data){promise.fulfill(data)}).fail(function(jqXHR,textStatus,errorThrown){var error=errorThrown||textStatus||"unknown error";promise.reject({error:error,xhr:jqXHR})}),promise},ns.object={},ns.object.clone=function(obj){if(obj&&"object"==typeof obj){var r;if(Array.isArray(obj)){r=[];for(var i=0;i<obj.length;i++)r.push(ns.object.clone(obj[i]))}else{r={};for(var key in obj)r[key]=ns.object.clone(obj[key])}return r}return obj},ns.object.isEmpty=function(obj){for(var key in obj)return!1;return!0},function(){ns.profile={},ns.profile.startTimer=function(label){this._profileTimes||(this._profileTimes={}),ns.assert(!this._profileTimes[label],"ns.profile","Timer '%s' is in use",label),this._profileTimes[label]=Date.now()},ns.profile.stopTimer=function(label){return this._profileTimes||(this._profileTimes={}),ns.assert(this._profileTimes[label],"ns.profile","Timer '%s' haven't been started",label),this._profileTimes[label]=Date.now()-this._profileTimes[label],this._profileTimes[label]},ns.profile.switchTimer=function(from,to){this.stopTimer(from),this.startTimer(to)},ns.profile.getTimer=function(label){this._profileTimes||(this._profileTimes={});var value=this._profileTimes[label];return"number"==typeof value?value:0/0},ns.profile.getTimers=function(){return no.extend({},this._profileTimes)}}(),!function(ns,undefined){ns.action={};var _actions={},_inited=!1;ns.action.define=function(id,action){if(id in _actions)throw new Error("[ns.action] Can't redefine '"+id+"'");_actions[id]=action},ns.action.copy=function(existentAction,newAction){if(newAction in _actions)throw new Error("[ns.action] Can't redefine '"+newAction+"'");if(!(existentAction in _actions))throw new Error("[ns.action] '"+existentAction+"' is not defined");_actions[newAction]=_actions[existentAction]},ns.action.run=function(id,params,node,event){var action=_actions[id];ns.assert(action,"ns.action","%s is not defined",id);try{return action(id,params,node,event)}catch(e){ns.log.exception("ns.action",e)}},ns.action.getParams=function(node){var paramString=node.getAttribute("data-params");if(paramString&&"{"===paramString.charAt(0))try{return JSON.parse(paramString)}catch(e){}return{}},ns.action.init=function(){if(!_inited){_inited=!0;var $body=$("body"),selector=".ns-action",events=[ns.V.EVENTS.click,ns.V.EVENTS.dblclick].join(" ");$body.on(events,selector,this._process)}},ns.action._process=function(e){var target=e.currentTarget,action=target.getAttribute("dblclick"===e.type?"data-dblclick-action":"data-click-action"),returnValue=!0;return action&&(returnValue=ns.action.run(action,ns.action.getParams(target),target,e)),returnValue===undefined||Vow.isPromise(returnValue)?!1:returnValue},ns.action._reset=function(){_actions={}}}(ns),function(){ns.Model=function(){},no.extend(ns.Model.prototype,ns.Events);var _ctors={},_infos={},_cache={},_keySuffix=0;ns.Model.prototype.STATUS=ns.M.STATUS,ns.Model.prototype.RETRY_LIMIT=3,ns.Model.prototype.status=ns.M.STATUS.NONE,ns.Model.prototype.key=null,ns.Model.prototype.params=null,ns.Model.prototype._init=function(id,params){this.id=id,this._reset(),this.info=ns.Model.info(id),no.extend(this,ns.Model.getKeyAndParams(id,params,this.info)),this._reinit()},ns.Model.prototype._reinit=function(){this.status===this.STATUS.NONE&&(this._bindEvents(),this.status=this.STATUS.INITED,this.trigger("ns-model-init"))},ns.Model.prototype._reset=function(status){this.data=null,this.error=null,this._softReset(status),this._version=0},ns.Model.prototype._softReset=function(status){this.status=status||this.STATUS.NONE,this.retries=0},ns.Model.prototype._bindEvents=function(){for(var event in this.info.events){var callbacks=this.info.events[event];Array.isArray(callbacks)||(callbacks=[callbacks]);for(var i=0,j=callbacks.length;j>i;i++)this.on(event,this._prepareCallback(callbacks[i]))}},ns.Model.prototype._unbindEvents=function(){for(var event in this.info.events){var callbacks=this.info.events[event];Array.isArray(callbacks)||(callbacks=[callbacks]);for(var i=0,j=callbacks.length;j>i;i++)this.off(event,this._prepareCallback(callbacks[i]))}},ns.Model.prototype._prepareCallback=function(method){return"string"==typeof method&&(method=this[method]),ns.assert("function"==typeof method,"ns.Model","Can't find method '%s' in '%s' to bind event",method,this.id),method},ns.Model.prototype.invalidate=function(){this._softReset(this.STATUS.INVALID)},ns.Model.prototype.destroy=function(){this.trigger("ns-model-before-destroyed"),this._reset(this.STATUS.NONE),this.trigger("ns-model-destroyed"),this._unbindEvents()},ns.Model.prototype.isValid=function(){return this.status===this.STATUS.OK},ns.Model.prototype.getData=function(){return this.data},ns.Model.prototype.get=function(jpath){var data=this.data;return data?no.jpath(jpath,data):void 0},ns.Model.prototype.select=function(jpath){var data=this.data;return data?no.jpath.raw(jpath,data).toArray():[]},ns.Model.prototype.set=function(jpath,value,options){var data=this.data;if(this.isValid()&&data&&(no.jpath.set(jpath,data,value),options=options||{},options.jpath=jpath,this.touch(options),!options.silent))for(var parts=jpath.split("."),l=parts.length;l>1;){var _jpath=parts.slice(0,l).join(".");this.trigger("ns-model-changed"+_jpath,_jpath,jpath),l--}},ns.Model.prototype.setData=function(data,options){return this._reinit(),!data||this.isValid()&&!this.hasDataChanged(data)||(this.data=this._beforeSetData(this.preprocessData(data),options),this.status=this.STATUS.OK,this.error=null,this.touch(options)),this},ns.Model.prototype.hasDataChanged=function(data){return!!data},ns.Model.prototype.getError=function(){return this.error},ns.Model.prototype.setError=function(error){this.data=null,this.error=error,this.status=this.STATUS.ERROR},ns.Model.prototype._beforeSetData=function(data){return data},ns.Model.prototype.preprocessData=function(data){return data},ns.Model.prototype.getRequestParams=function(){return ns.Model._getKeyParams(this.id,this.params,this.info)},ns.Model.prototype.canRequest=function(){return!this.retries||!this.isDo()&&this.retries<this.RETRY_LIMIT},ns.Model.prototype.extractData=function(result){return result?result.data:void 0},ns.Model.prototype.extractError=function(result){return result?result.error:void 0},ns.Model.prototype.isDo=function(){return this.info.isDo},ns.Model.prototype.getVersion=function(){return this._version},ns.Model.prototype._incVersion=function(){this._version++},ns.Model.prototype.touch=function(options){if(options=options||{},!options.silent){this._incVersion(),this.trigger("ns-model-touched");var jpath=options.jpath||"";this.trigger("ns-model-changed",jpath)}},ns.Model.prototype.prepareRequest=function(requestID){return this.requestID=requestID,this.retries++,this.promise=new Vow.Promise,this},ns.Model.prototype.destroyWith=function(models){ns.Model.destroyWith(this,models)},ns.Model.get=function(id,params){var model=this._find(id,params);if(!model){var Ctor=_ctors[id];model=new Ctor,model._init(id,params),model.isDo()||(_cache[id][model.key]=model)}return model._reinit(),model},ns.Model.getValid=function(id,params){var model=this._find(id,params);return model&&model.isValid()?model:null},ns.Model._find=function(id,params){ns.assert(id in _infos,"ns.Model","'%s' is not defined",id);var key=ns.Model.key(id,params);return _cache[id][key]||null},ns.Model.destroy=function(model){if(!model.isDo()){var id=model.id,key=model.key,cached=_cache[id][key];cached&&model.destroy()}},ns.Model.isValid=function(id,params){return!!ns.Model.getValid(id,params)
},ns.Model.define=function(id,info,base){ns.assert(!(id in _infos),"ns.Model","Can't redefine '%s'",id),info=info||{},"undefined"==typeof info.isCollection&&(info.isCollection=!!info.split);var baseClass=base;"string"==typeof base?(baseClass=_ctors[base],ns.assert(baseClass,"ns.Model","Can't find '%s' to extend '%s'",base,id)):base||(baseClass=info.uniq?ns.ModelUniq:info.isCollection?ns.ModelCollection:ns.Model);var ctor=info.ctor||function(){};return ctor=no.inherit(ctor,baseClass,info.methods),_infos[id]=info,_ctors[id]=ctor,_cache[id]={},ctor},ns.Model._reset=function(){_cache={},_ctors={},_infos={}},ns.Model._clear=function(){for(var id in _infos)_cache[id]={}},ns.Model.info=function(id){var info=ns.Model.infoLite(id);return info&&!info.ready&&(info.params=info.params||{},info.events=info.events||{},info.isDo=/^do-/.test(id),info.ready=!0),info},ns.Model.infoLite=function(id){var info=_infos[id];return ns.assert(info,"ns.Model","'%s' is not defined",id),info},ns.Model.key=function(id,params,info){return ns.Model.getKeyAndParams(id,params,info).key},ns.Model.getKeyAndParams=function(id,params,info){if(info=info||ns.Model.info(id),ns.assert(info,"ns.Model",'Unknown model type "%s"',id),info.isDo)return{key:"do-"+id+"-"+_keySuffix++,params:params};var keyPrefix="model="+id,keyParams=ns.Model._getKeyParams(id,params,info);return{key:ns.key(keyPrefix,keyParams),params:keyParams}},ns.Model._getKeyParams=function(id,params,info){if(params=params||{},info=info||ns.Model.info(id),ns.assert(info,"ns.Model",'Unknown model type "%s"',id),"function"==typeof info.params)return info.params(params);for(var defaults=info.params,pNames=info.pNames||(info.pNames=Object.keys(info.params)),result={},i=0,l=pNames.length;l>i;i++){var pName=pNames[i],pValue=params[pName];pValue=void 0===pValue?defaults[pName]:pValue,null!=pValue&&(result[pName]=pValue)}return result},ns.Model.invalidate=function(id,filter){filter=filter||function(){return!0};var models=_cache[id];for(var key in models){var model=models[key];filter(model)&&model.invalidate()}},ns.Model.destroyWith=function(targetModel,withModels){Array.isArray(withModels)||(withModels=[withModels]);for(var i=0,len=withModels.length;len>i;i++){var model=withModels[i];ns.assert(model instanceof ns.Model,"ns.Model","destroyWith called for '%s' while one of the withModels is not instance of ns.Model",targetModel.id),model.on("ns-model-destroyed",function(){ns.Model.destroy(targetModel)})}},ns.Model.isCollection=function(model){return(model.info||ns.Model.infoLite(model.id)).isCollection},ns.Model.traverse=function(id,callback){ns.Model.infoLite(id),ns.assert("function"==typeof callback,"ns.Model.traverse","callback must be a function");var models=_cache[id];for(var key in models)callback(models[key])},ns.ModelUniq=function(){},no.inherit(ns.ModelUniq,ns.Model),ns.ModelUniq.prototype.__superInit=ns.ModelUniq.prototype._init,ns.ModelUniq.prototype._init=function(id){var info=ns.Model.info(id);info.events.changed=info.events.changed||[];var onchangedCallbacks=info.events.changed,cb=function(){var that=this,uniq=this.params[this.uniqName];this.uniqCached||(this.uniqCached={}),uniq.forEach(function(i,v){that.uniqCached[v]=!0})};Array.isArray(onchangedCallbacks)?onchangedCallbacks.unshift(cb):info.events.changed=[cb,info.events.changed],this.__superInit.apply(this,arguments)},ns.ModelUniq.prototype._superIsValid=ns.Model.prototype.isValid,ns.ModelUniq.prototype.isValid=function(){return-1===this.key.indexOf("&"+this.uniqName+"=")?!0:this._superIsValid()},ns.ModelUniq.prototype.uniqName="",ns.ModelUniq.prototype.uniqPath="",ns.ModelUniq.prototype.uniqCached=null,ns.ModelUniq.prototype.uniq=function(params,cached){var that=this,name=this.uniqName,copy=no.extend({},params);if(this.uniqCached||(this.uniqCached={}),cached)for(var k in params)cached[k]=k===name?[]:params[k];return copy[name]=[].concat(copy[name]).map(function(v){return that.uniqCached[v]?(cached&&cached[name].push(v),null):v}),copy[name].length||delete copy[name],cached&&!cached[name].length&&delete cached[name],copy},ns.ModelUniq.prototype.uniqFromKey=function(key){return((key.split(this.uniqName+"=")[1]||"").split("&")[0]||"").split(",")},ns.ModelUniq.prototype.uniqFromJSON=ns.todo,ns.ModelUniq.prototype.getData=function(params){var that=this,path=this.uniqPath,uniqs=[].concat(params[this.uniqName]),data={};data[path]=[];var modelsCache=_cache[this.id];for(var key in modelsCache)for(var model=modelsCache[key],arrKey=that.uniqFromKey(key),i=0,j=uniqs.length;j>i;i++)if(arrKey.indexOf(uniqs[i])>-1){var value=that.uniqFromJSON(model.data,uniqs[i]);value&&data[path].push(value),uniqs.splice(i,1),i--}return data}}(),function(){ns.ModelCollection=function(){},no.inherit(ns.ModelCollection,ns.Model),ns.ModelCollection.prototype._init=function(){this._modelsEvents={},ns.Model.prototype._init.apply(this,arguments)},ns.ModelCollection.prototype.getData=function(){if(this.isValid()){var jpathItems;jpathItems=this.info.split?this.info.split.items:this.info.jpathItems?this.info.jpathItems:".items",this.data||(this.data={}),"/"===jpathItems?this.data=[]:no.jpath.set(jpathItems,this.data,[]);var items=no.jpath(jpathItems,this.data);this.models.forEach(function(model){items.push(model.getData())})}return this.data},ns.ModelCollection.prototype._reset=function(){ns.Model.prototype._reset.apply(this,arguments),this.clear()},ns.ModelCollection.prototype._beforeSetData=function(data,options){var splitInfo=this.info.split;if(splitInfo){var items=no.jpath(splitInfo.items,data),models=this._splitModels(items,options);if(models&&this.models&&this.models.length){var remove=[],insert=[],i=0,length=0;for(i=0,length=models.length;length>i;i++)-1===this.models.indexOf(models[i])&&insert.push(models[i]);for(i=0,length=this.models.length;length>i;i++)-1===models.indexOf(this.models[i])&&remove.push(this.models[i]);this.__removeModels(remove),this.__insertModels(insert),this.models=models}else this.insert(models)}else this.clear();return data},ns.ModelCollection.prototype._splitModels=function(items,options){var splitInfo=this.info.split;return items.map(function(item){var params={};for(var key in splitInfo.params)params[key]=no.jpath(splitInfo.params[key],item);var modelId;return modelId="function"==typeof splitInfo.model_id?splitInfo.model_id(item,params):splitInfo.model_id,modelId?ns.Model.get(modelId,params).setData(item,options):void 0})},ns.ModelCollection.prototype._subscribeSplit=function(model){var that=this;this.bindModel(model,"ns-model-changed",function(evt,jpath){that.onItemChanged(evt,model,jpath)}),this.bindModel(model,"ns-model-touched",function(evt){that.onItemTouched(evt,model)}),this.bindModel(model,"ns-model-destroyed",function(evt){that.onItemDestroyed(evt,model)})},ns.ModelCollection.prototype.bindModel=function(model,eventName,callback){var events=this._modelsEvents[model.key]||(this._modelsEvents[model.key]={});model.on(eventName,callback),events[eventName]=callback},ns.ModelCollection.prototype.unbindModel=function(model,eventName){var events=this._modelsEvents[model.key];events&&events[eventName]&&(model.off(eventName,events[eventName]),delete events[eventName])},ns.ModelCollection.prototype.onItemChanged=function(evt,model,jpath){this.trigger("ns-model-changed",{model:model,jpath:jpath})},ns.ModelCollection.prototype.onItemTouched=function(){this._version++},ns.ModelCollection.prototype.onItemDestroyed=function(evt,model){this.remove(model)},ns.ModelCollection.prototype.getSelfVersion=function(){return this._versionSelf},ns.ModelCollection.prototype._incVersion=function(){ns.Model.prototype._incVersion.apply(this,arguments),this._versionSelf=this._version},ns.ModelCollection.prototype._unsubscribeSplit=function(model){if(model.key in this._modelsEvents){var events=this._modelsEvents[model.key];for(var eventName in events)model.off(eventName,events[eventName]);delete this._modelsEvents[model.key]}},ns.ModelCollection.prototype.clear=function(){var models=this.models;if(this.models=[],models&&models.length){var that=this;models.forEach(function(model){that._unsubscribeSplit(model)}),this.trigger("ns-model-remove",models)}},ns.ModelCollection.prototype.insert=function(models,index){this._reinit(),isNaN(index)&&(index=this.models.length),Array.isArray(models)||(models=[models]);for(var model,insertion=[],i=0;i<models.length;i++)model=models[i],model&&this.models.indexOf(model)<0&&insertion.indexOf(model)<0&&insertion.push(model);return this.__insertModels(insertion,index)},ns.ModelCollection.prototype.__insertModels=function(models,index){for(var i=0,length=models.length;length>i;i++)this.models.splice(index+i,0,models[i]),this._subscribeSplit(models[i]);return models.length>0?(this.status=this.STATUS.OK,this.trigger("ns-model-insert",models),!0):!1},ns.ModelCollection.prototype.remove=function(models){Array.isArray(models)||(models=[models]);for(var itemsToRemove=this._modelsIndexToInstance(models),removedItems=[],i=0,j=itemsToRemove.length;j>i;i++){var itemToRemove=itemsToRemove[i],itemToRemoveIndex=this.models.indexOf(itemToRemove);itemToRemoveIndex>-1&&(itemToRemove._itemToRemoveIndex=itemToRemoveIndex,removedItems.push(itemToRemove))}return this.__removeModels(removedItems)},ns.ModelCollection.prototype.__removeModels=function(models){models=models.sort(function(a,b){return b._itemToRemoveIndex-a._itemToRemoveIndex});for(var i=0,length=models.length;length>i;i++)this._unsubscribeSplit(models[i]),this.models.splice(models[i]._itemToRemoveIndex,1);return models.length?(this.trigger("ns-model-remove",models),!0):!1},ns.ModelCollection.prototype._modelsIndexToInstance=function(models){for(var items=[],i=0,j=models.length;j>i;i++){var index=models[i];if("number"==typeof index){var item=this.models[index];this.models[index]&&items.push(item)}else items.push(index)}return items}}(),function(){function compile(layout,params){var t={};if("string"==typeof layout)t[layout]=!0,layout=t;else if(Array.isArray(layout)){for(var i=0,l=layout.length;l>i;i++)t[layout[i]]=!0;layout=t}var result={};for(var raw_key in layout){var value,key=no.jpath.string(raw_key)(params),raw_value=layout[raw_key];switch(typeof raw_value){case"function":value=compile(raw_value(params),params);break;case"object":case"string":value=compile(raw_value,params);break;default:value={}}result[cleanKey(key)]={type:getViewType(key),views:value}}return result}function inherit(layout,parent){var result=ns.object.clone(parent);for(var key in layout){var parts=key.split(hasSpacesRE),l=parts.length;if(getViewType(parts[l-1])!==ns.L.BOX)throw new Error("[ns.layout] Can't overwrite view layout '"+parts[l-1]+"'");for(var lvalue=result,i=0;l-1>i;i++)if(lvalue=lvalue[cleanKey(parts[i])].views,!lvalue)throw new Error('[no.layout] Path "'+parts.slice(0,i).join(" ")+'" is undefined in this layout and cannot be extended');lvalue[cleanKey(parts[l-1])]=layout[key]}return result}function getViewType(s){var lastChar=s.substr(-1);return"@"===lastChar?ns.L.BOX:"&"===lastChar?ns.L.ASYNC:ns.L.VIEW}function cleanKey(key){if(hasSpacesRE.test(key))return key;var ch=key.slice(-1);return("@"===ch||"&"===ch)&&(key=key.slice(0,-1)),key}ns.layout={};var _pages={},hasSpacesRE=/\s+/;ns.layout.define=function(id,layout,parent_id){if(_pages[id])throw new Error("[ns.layout] Can't redefine '"+id+"'");_pages[id]={layout:layout,parent_id:parent_id}},ns.layout.undefine=function(id){delete _pages[id]},ns.layout._reset=function(){_pages={}},ns.layout.page=function(id,params){var raw=_pages[id];if(!raw)throw new Error("[ns.layout] '"+id+"' is not defined");var layout=compile(raw.layout,params);if(raw.parent_id){var parent=ns.layout.page(raw.parent_id,params);layout=inherit(layout,parent)}return layout}}(),function(ns){ns.log={},ns.log.debug=function(){console.log.apply(console,arguments)},ns.log.info=function(){},ns.log.error=function(){},ns.log.exception=function(){}}(ns),function(){function triggerPageAfterLoad(val){return ns.events.trigger("ns-page-after-load",val),val}function triggerPageErrorLoad(err){return ns.events.trigger("ns-page-error-load",err),Vow.reject(err)}ns.page={},ns.page.current={},ns.page.currentUrl=null,ns.page.DEFAULT_HISTORY_ACTION="push",ns.page.go=function(url,historyAction){if(historyAction?historyAction===!0&&(historyAction="replace"):historyAction=ns.page.DEFAULT_HISTORY_ACTION,url=url||ns.page.getCurrentUrl(),!ns.page.block.check(url))return url!==ns.page.currentUrl&&ns.history.replaceState(ns.page.currentUrl),Vow.reject("block");var route=ns.router(url);return route.page===ns.R.REDIRECT?ns.page.redirect(route.redirect):route.page===ns.R.NOT_APP_URL?("replace"===historyAction?window.location.replace(route.redirect):window.location=route.redirect,new Vow.Promise):(ns.events.trigger("ns-page-before-load",[ns.page.current,route],url),"push"===historyAction&&url===ns.page.currentUrl&&(historyAction="preserve"),ns.page.followRoute(route).then(function(){return ns.page._setCurrent(route,url),ns.page._fillHistory(url,historyAction),ns.page.title(),ns.page.startUpdate(route)},triggerPageErrorLoad))},ns.page.followRoute=function(){return Vow.fulfill()},ns.page.startUpdate=function(route){var layout=ns.layout.page(route.page,route.params),update=new ns.Update(ns.MAIN_VIEW,layout,route.params);return update.start().then(triggerPageAfterLoad,triggerPageErrorLoad)},ns.page._setCurrent=function(route,url){ns.page.current=route,ns.page.currentUrl=url},ns.page._fillHistory=function(url,action){"push"===action?ns.history.pushState(url):"replace"===action&&ns.history.replaceState(url),ns.page.history.push(url)},ns.page.redirect=function(url){return ns.history.replaceState(url),ns.page.go(url,!0)},ns.page.title=function(){document.title="NoScript app "+ns.page.currentUrl.url},ns.page._reset=function(){this.current={},this.currentUrl=""},ns.page.getDefaultUrl=function(){return ns.router.url("/")},ns.page.getCurrentUrl=function(){return window.location.pathname+window.location.search}}(),!function(){ns.page.block={},ns.page.block._checkers=[],ns.page.block.add=function(fn){return ns.page.block._checkers.push(fn),this},ns.page.block.remove=function(fn){var checkers=ns.page.block._checkers,index=checkers.indexOf(fn);return index>-1&&checkers.splice(index,1),this},ns.page.block.clear=function(){return ns.page.block._checkers=[],this},ns.page.block.check=function(url){for(var checkers=ns.page.block._checkers,i=0,j=checkers.length;j>i;i++)if(checkers[i](url)===!1)return!1;return!0}}(),function(){ns.page.history={},ns.page.history._current=null,ns.page.history._history=[],ns.page.history.push=function(url){var nsHistory=ns.page.history;if(nsHistory._current&&nsHistory._current!==url){var prevPage=ns.page.history.getPrevious();prevPage===url?nsHistory._history.pop():nsHistory._history.push(nsHistory._current)}nsHistory._current=url},ns.page.history.back=function(){var nsHistory=ns.page.history,previousPage=nsHistory.getPrevious();return previousPage?nsHistory._history.pop():previousPage=ns.page.getDefaultUrl(),nsHistory._current=previousPage,ns.page.go(previousPage)},ns.page.history.getPrevious=function(n){n=n||0;var history=ns.page.history._history,l=history.length;return history[l-n-1]}}(),function(){function models2params(models){for(var params={},i=0,l=models.length;l>i;i++){var suffix="."+i,model=models[i];params["_model"+suffix]=model.id;var mParams=model.getRequestParams();for(var name in mParams)params[name+suffix]=mParams[name]}return params}function normalizeItems(items,params){for(var _items=[],i=0,l=items.length;l>i;i++)_items.push({id:items[i],params:params});return _items}function model2Promise(model){return model.promise}function items2models(items,params){"string"==typeof items&&(items=[items]),"string"==typeof items[0]&&(params=params||{},items=normalizeItems(items,params));for(var models=[],i=0,l=items.length;l>i;i++){var item=items[i];models.push(item.model&&item.model instanceof ns.Model?item.model:ns.Model.get(item.id,item.params))}return models}function models2name(model){return model.id}ns.request=function(items,params,options){return ns.request.models(items2models(items,params),options)},ns.forcedRequest=function(items,params,options){return options=options||{},options.forced=!0,ns.request.models(items2models(items,params),options)},ns.request.models=function(models,options){models=models.map(function(model){return model.getRequest?model.getRequest():model});var request=new Request(models,options);return request.start()},ns.request.requestParams={},ns.request.addRequestParams=function(params){no.extend(params,ns.request.requestParams)},ns.request.URL="/models/",ns.request.canProcessResponse=function(){return!0},ns.request._reset=function(){ns.request.manager._keys={}};var REQUEST_ID=0,Request=function(models,options){this.id=REQUEST_ID++,this.models=models,this.options=options||{},this.promise=new Vow.Promise};Request.prototype.start=function(){for(var loading=[],requesting=[],models=this.models,i=0,l=models.length;l>i;i++){var model=models[i],addRequest=ns.request.manager.add(model,this.id,this.options.forced);addRequest===!0?requesting.push(model):addRequest instanceof ns.Model&&loading.push(model)}return this.request(loading,requesting),this.promise},Request.prototype.request=function(loading,requesting){var httpRequest,all=[];if(requesting.length){var regularRequests=[],customRequests=[];if(requesting.forEach(function(model){if("function"==typeof model.request){var modelRequestPromise=model.request().then(function(){ns.request.manager.done(model)},function(){ns.request.manager.done(model)});model.promise=modelRequestPromise,customRequests.push(modelRequestPromise)}else regularRequests.push(model)}),all=all.concat(customRequests),regularRequests.length){var params=models2params(regularRequests),modelsNames=regularRequests.map(models2name);ns.request.addRequestParams(params),httpRequest=ns.http(ns.request.URL+"?_m="+modelsNames.join(","),params),all=all.concat(regularRequests.map(model2Promise))}}if(loading.length&&(all=all.concat(loading.map(model2Promise))),all.length){var that=this;httpRequest&&httpRequest.then(function(r){ns.request.canProcessResponse(r)===!1?(ns.request.manager.clean(that.models),that.promise.reject({error:"CANT_PROCESS",invalid:that.models,valid:[]})):that.extract(regularRequests,r)},function(e,xhr){ns.log.error("ns.request.http",{error:e,xhr:xhr}),that.extract(regularRequests,{})}),Vow.all(all).then(this.start.bind(this))}else{ns.request.manager.clean(this.models);for(var validModels=[],invalidModels=[],i=0,j=this.models.length;j>i;i++){var model=this.models[i];model.isValid()?validModels.push(model):invalidModels.push(model)}invalidModels.length?this.promise.reject({invalid:invalidModels,valid:validModels}):this.promise.fulfill(this.models)}},Request.prototype.extract=function(models,response){for(var results=response&&response.models||[],i=0,l=models.length;l>i;i++){var model=models[i],result=results[i];if(!(model.requestID>this.id)){var data,error;result?(data=model.extractData(result),data||(error=model.extractError(result),error||(error={id:"INVALID_FORMAT",reason:"response should contain result or error"}))):error={id:"NO_DATA",reason:"Server returned no data"},data?model.setData(data):model.setError(error),ns.request.manager.done(model),model.promise.fulfill()}}}}(),ns.request.manager={STATUS:{LOADING:0,FAILED:1,DONE:2},_keys:{},add:function(model,requestId,forced){var REQUEST_STATUS=this.STATUS,modelKey=model.key,request=this._keys[modelKey];return request?request.status===REQUEST_STATUS.LOADING?model.isDo()?request.model:forced?(request.model.requestID=requestId,!0):request.model:request.status===REQUEST_STATUS.FAILED?request.model.canRequest()?(this._createRequest(model,requestId),!0):(model.status=model.STATUS.ERROR,this.done(model,!0),!1):model.isValid()?!1:model.canRequest()?(this._createRequest(model,requestId),!0):!1:model.isValid()?forced&&model.requestID!==requestId?(this._createRequest(model,requestId),!0):!1:model.canRequest()?(this._createRequest(model,requestId),!0):!1},done:function(model,force){var request=this._keys[model.key];request&&(request.status=model.isValid()||force?this.STATUS.DONE:this.STATUS.FAILED)},clean:function(models){for(var i=0,j=models.length;j>i;i++){var model=models[i];model.retries=0,delete this._keys[model.key]}},_createRequest:function(model,requestId){this._keys[model.key]={status:this.STATUS.LOADING,model:model},model.prepareRequest(requestId)}},ns.router=function(url){var baseDir=ns.router.baseDir,routesDef=ns.router._routes;if(0!==url.indexOf(baseDir))return{page:ns.R.NOT_APP_URL,params:{},redirect:url};url=url.substring(baseDir.length),url||(url="/");var pathRedirect=ns.router._processRedirect(routesDef.redirect,url);if(pathRedirect)return{page:ns.R.REDIRECT,params:{},redirect:baseDir+pathRedirect};var urlChunks=url.split("?"),urlWithoutQuery=urlChunks.shift();if(urlWithoutQuery in routesDef.rewriteUrl){var urlQuery=urlChunks.join("?");url=routesDef.rewriteUrl[urlWithoutQuery]+(urlQuery?"?"+urlQuery:"")}for(var routes=routesDef.route,i=0,j=routes.length;j>i;i++){var route=routes[i],params=ns.router._parseUrl(route,url);if(params)return route.page in routesDef.rewriteParams&&(params=routesDef.rewriteParams[route.page](params)),{page:route.page,params:params}}return{page:ns.R.NOT_FOUND,params:{}}},ns.router.URL_FIRST_SYMBOL="/",ns.router._getParamsRouteFromUrl=function(route,parsedChunks){for(var rparam,rparams=route.params,params={},l=rparams.length,k=0;l>k;k++){rparam=rparams[k];var paramValueFromURL=parsedChunks[k+1];if(paramValueFromURL)try{paramValueFromURL=decodeURIComponent(paramValueFromURL)}catch(e){paramValueFromURL=""}paramValueFromURL||(paramValueFromURL=rparam.default_value),params[rparam.name]=paramValueFromURL}return params},ns.router._parseUrl=function(route,url){var parsedChunks=route.regexp.exec(url);if(parsedChunks){var params=ns.router._getParamsRouteFromUrl(route,parsedChunks),query=parsedChunks[route.params.length+1];return query&&no.extend(params,ns.parseQuery(query)),params}return null},ns.router._processRedirect=function(redirectDefs,url){for(var pathRedirect,i=0,j=redirectDefs.length;j>i;i++){var redirect=redirectDefs[i];if("function"==typeof redirect.path){var parsedParams=ns.router._parseUrl(redirect,url);parsedParams&&(pathRedirect=redirect.path(parsedParams,url))}else redirect.regexp.test(url)&&(pathRedirect=redirect.path);if(pathRedirect)return pathRedirect}return null},ns.router.init=function(){var routes=ns.router.routes;ns.router._regexps={};for(var id in ns.router.regexps)ns.router._regexps[id]=new RegExp("^"+ns.router.regexps[id]+"$");var _routes={};_routes.redirect=routes.redirect||{},_routes.rewriteUrl=routes.rewriteUrl||{},_routes.rewriteParams=routes.rewriteParams||{};var rawRoutes=routes.route||{},compiledRoutes=[],compiledRoutesHash={};for(var route in rawRoutes){var page=rawRoutes[route],compiled=ns.router.compile(route);compiled.page=page,compiledRoutes.push(compiled),compiledRoutesHash[page]=compiledRoutesHash[page]||[],compiledRoutesHash[page].push(compiled)}_routes.route=compiledRoutes,_routes.routeHash=compiledRoutesHash;var rawRedirects=routes.redirect||{},compiledRedirects=[];for(var redirect in rawRedirects){var compiled=ns.router.compile(redirect);compiledRedirects.push({regexp:compiled.regexp,path:rawRedirects[redirect],params:compiled.params})}_routes.redirect=compiledRedirects,ns.router._routes=_routes},ns.router.url=function(url){return ns.router.baseDir+url||"/"},ns.router.generateUrl=function(id,params){var url,routes=ns.router._routes.routeHash[id];params=params||{},ns.assert(routes&&routes.length,"ns.router","Could not find route with id '%s'!",id);for(var i=0;i<routes.length&&(url=ns.router._generateUrl(routes[i],params),null===url);i++);return ns.assert(null!==url,"ns.router","Could not generate url for layout id '%s'!",id),ns.router.url(url)},ns.router._generateUrl=function(def,params){for(var url,section,svalue,pvalue,param,result=[],query=no.extend({},params),rewrites=ns.router._routes.rewriteUrl,i=0;i<def.sections.length;i++){section=def.sections[i],svalue="";for(var j=0;j<section.items.length;j++)if(param=section.items[j],param.name){pvalue=params[param.name];var is_param_present=param.name in params;if(param.is_optional&&!is_param_present&&(pvalue=param.default_value),param.is_filter&&pvalue!==param.filter_value)return null;if(!param.is_optional&&!is_param_present)return null;if(param.is_optional&&!is_param_present)continue;if(!ns.router._isParamValid(pvalue,param.type))return null;svalue+=encodeURIComponent(pvalue),delete query[param.name]}else svalue+=param.default_value;(svalue||!section.is_optional)&&result.push(svalue)}url=result.join("/"),url=url?ns.router.URL_FIRST_SYMBOL+url:"";for(var rewrote=!0;rewrote;){rewrote=!1;for(var srcUrl in rewrites)url===rewrites[srcUrl]&&(url=srcUrl,rewrote=!0)}var queryString=ns.params2query(query);return queryString?url+"?"+queryString:url},ns.router.compile=function(route){route=route.replace(/\/$/,""),route[0]===ns.router.URL_FIRST_SYMBOL&&(route=route.substr(1));var parts=route.split("/"),sections=parts.map(ns.router._parseSection),sregexps=sections.map(ns.router._generateSectionRegexp);"/"===sregexps[0][0]&&(sregexps[0]=ns.router.URL_FIRST_SYMBOL+sregexps[0].substr(1));var regexp=sregexps.join(""),params=[];return sections.forEach(function(s){params=params.concat(s.items.filter(function(p){return!!p.name}))}),regexp="^"+regexp+"/?(?:\\?(.*))?$",{regexp:new RegExp(regexp),params:params,sections:sections}},ns.router._parseSection=function(rawSection){for(var curIndex=0,openBraketIndex=-1,closeBraketIndex=-1,items=[];;){if(openBraketIndex=rawSection.indexOf("{",curIndex),0>openBraketIndex)break;closeBraketIndex=rawSection.indexOf("}",openBraketIndex),ns.assert(closeBraketIndex>0,"ns.router","could not parse parameter in url section: %s",rawSection),openBraketIndex>curIndex&&items.push({default_value:rawSection.substr(curIndex,openBraketIndex-curIndex)}),items.push(ns.router._parseParam(rawSection.substr(openBraketIndex+1,closeBraketIndex-openBraketIndex-1))),curIndex=closeBraketIndex+1}return curIndex<rawSection.length&&items.push({default_value:rawSection.substr(curIndex)}),{is_optional:items.length&&items.filter(function(p){return p.is_optional}).length===items.length,items:items}},ns.router._parseParam=function(param){var chunks,param_type,param_default,param_is_optional,param_filter_value,paramName,param_is_filter=!1;chunks=param.split("=");var paramNameAndType=chunks[0].split(":");return paramName=paramNameAndType[0],param_type=paramNameAndType[1]||"id",3===chunks.length?(param_is_optional=!1,param_is_filter=!0,param_filter_value=chunks[2],ns.assert(param_filter_value,"ns.router","Parameter '%s' value must be specified",paramName),ns.assert(ns.router._isParamValid(param_filter_value,param_type),"ns.router","Wrong value for '%s' parameter",paramName)):(param_is_optional=2===chunks.length,param_default=chunks[1]),{name:paramName,type:param_type,default_value:param_default,is_optional:param_is_optional,is_filter:param_is_filter,filter_value:param_filter_value}},ns.router._generateSectionRegexp=function(section){var re="";return section.items.forEach(function(p){re+=ns.router._generateParamRegexp(p)}),re=section.is_optional?"(?:/(?!/)"+re+")?":"/"+re},ns.router._generateParamRegexp=function(p){var re,regexps=ns.router.regexps;return p.default_value&&!p.name?p.default_value:(p.type&&ns.assert(p.type in regexps,"ns.router","Could not find regexp for type '%s'!",p.type),p.is_filter&&p.filter_value?re="("+p.filter_value+")":(re=regexps[p.type],re="("+re+")",p.is_optional&&(re="(?:"+re+")?")),re)},ns.router._isParamValid=function(pvalue,ptype){var _regexp=ns.router._regexps[ptype];return ns.assert(_regexp,"ns.router","Could not find regexp for type '%s'!",ptype),_regexp.test(pvalue)},ns.router._reset=function(){this.baseDir="",this._routes=null,this.routes={},this.regexps={id:"[A-Za-z_][A-Za-z0-9_-]*","int":"[0-9]+"}},ns.router._reset(),function(){function views2models(views){for(var added={},models=[],i=0,l=views.length;l>i;i++){var viewModels=views[i].models;for(var model_id in viewModels){var model=viewModels[model_id],key=model.key;added[key]||(models.push(model),added[key]=!0)}}return models}ns.Update=function(view,layout,params,options){if(this.view=view,!(this.view.id in layout))throw new Error("[ns.Update] Can't find view layout");this.layout=layout[this.view.id],this.params=params,this.id=++update_id,this.promise=new Vow.Promise,options=options||{},this.EXEC_FLAG=options.execFlag||ns.U.EXEC.GLOBAL,this.log("created instance",this,"with layout",this.layout,"and params",this.params),ns.Update._addToQueue(this)||this.abort()},no.extend(ns.Update.prototype,ns.profile);var currentUpdates=[],update_id=-1;ns.Update.prototype.STATUS=ns.U.STATUS,ns.Update.prototype._EVENTS_ORDER=["ns-view-hide","ns-view-htmldestroy","ns-view-htmlinit","ns-view-async","ns-view-show","ns-view-touch"],ns.Update.prototype.log=function(){if(ns.DEBUG){var args=Array.prototype.slice.apply(arguments);"generated html"===args[0]&&(args[1]=ns.html2node(args[1])),ns.log.debug.apply(ns.log,["[ns.Update]",this.id].concat(args))}},ns.Update.prototype._requestModels=function(models){this.startTimer("requestModels"),this.log("started models request",models);for(var allModelsValid=!0,i=0,j=models.length;j>i;i++)if(!models[i].isValid()){allModelsValid=!1;break}if(allModelsValid)return this.log("received models",models),Vow.fulfill(models);var promise=ns.request.models(models);return promise.always(function(){this.stopTimer("requestModels")},this),promise.then(this._onRequestModelsOK,this._onRequestModelsError,this)},ns.Update.prototype._onRequestModelsOK=function(models){return this.log("received models",models),models},ns.Update.prototype._onRequestModelsError=function(err){this.log("failed to receive models",err);var error={error:this.STATUS.MODELS,invalidModels:err.invalid,validModels:err.valid};return ns.Update.handleError(error,this)?[].concat(err.invalid,err.valid):Vow.reject(error)},ns.Update.prototype._requestSyncModels=function(){this.startTimer("collectModels");var views=this.view._getRequestViews({sync:[],async:[]},this.layout.views,this.params).sync;this.log("collected incomplete views",views);var models=views2models(views);return this.log("collected needed models",models),this.stopTimer("collectModels"),this._requestModels(models)},ns.Update.prototype._requestAllModels=function(){if(this._expired())return this._rejectWithStatus(this.STATUS.EXPIRED);this.startTimer("collectModels");var requestPromise=new Vow.Promise,views=this.view._getRequestViews({sync:[],async:[]},this.layout.views,this.params);this.log("collected incomplete views",views);var models=views2models(views.sync);this.log("collected needed models",models),this.stopTimer("collectModels");var syncPromise=this._requestModels(models),asyncPromises=views.async.map(function(view){return view.updateAfter(this.promise)},this);return syncPromise.then(function(){requestPromise.fulfill({async:asyncPromises})},function(e){requestPromise.reject(e)}),requestPromise},ns.Update.prototype._applyLayout=function(){this.view._getRequestViews({sync:[],async:[]},this.layout.views,this.params)},ns.Update.prototype._generateHTML=function(){return this._expired()?this._rejectWithStatus(this.STATUS.EXPIRED):Vow.fulfill(this._renderUpdateTree())},ns.Update.prototype._renderUpdateTree=function(){this.startTimer("collectViews");var tree={views:{}};this.view._getUpdateTree(tree,this.layout.views,this.params),this.log("created render tree",tree),this.stopTimer("collectViews");var html;return ns.object.isEmpty(tree.views)||(this.startTimer("generateHTML"),html=this.applyTemplate(tree,this.params,this.layout),this.log("generated html",html),this.stopTimer("generateHTML")),html},ns.Update.prototype._insertNodes=function(node,async){if(this._expired())return this._rejectWithStatus(this.STATUS.EXPIRED);this.startTimer("insertNodes");var hideViewEvents={"ns-view-hide":[],"ns-view-htmldestroy":[]};
this.view.beforeUpdateHTML(this.layout.views,this.params,hideViewEvents),this._triggerViewEvents(hideViewEvents);var viewEvents={"ns-view-async":[],"ns-view-hide":[],"ns-view-htmldestroy":[],"ns-view-htmlinit":[],"ns-view-show":[],"ns-view-touch":[]};return this.view._updateHTML(node,this.layout.views,this.params,{toplevel:!0,async:async},viewEvents),this.switchTimer("insertNodes","triggerEvents"),viewEvents["ns-view-hide"]=[],viewEvents["ns-view-htmldestroy"]=[],this._triggerViewEvents(viewEvents),this.stopTimer("triggerEvents"),Vow.fulfill()},ns.Update.prototype._triggerViewEvents=function(viewEvents){for(var i=0,j=this._EVENTS_ORDER.length;j>i;i++)for(var event=this._EVENTS_ORDER[i],views=viewEvents[event]||[],k=views.length-1;k>=0;k--)views[k].trigger(event,this.params)},ns.Update.prototype._updateDOM=function(){if(this._expired())return this._rejectWithStatus(this.STATUS.EXPIRED);var html=this._renderUpdateTree(),node=ns.html2node(html||"");return this._insertNodes(node)},ns.Update.prototype.prefetch=function(){return this.log("started `prefetch` scenario"),this.promise=this._requestSyncModels(),this.promise.then(this._fulfill,this._reject,this),this.promise},ns.Update.prototype.generateHTML=function(){return this.log("started `generateHTML` scenario"),Vow.invoke(this._requestSyncModels.bind(this)).then(this._generateHTML,null,this).then(this._fulfill,this._reject,this),this.promise},ns.Update.prototype.prerender=function(){return this.log("started `prerender` scenario"),ns.todo(),this.promise},ns.Update.prototype.render=function(){if(this._expired())return this._reject({error:this.STATUS.EXPIRED}),this.promise;this.log("started `render` scenario");var asyncViewPromises,saveAsyncPromises=function(result){asyncViewPromises=result},fulfillWithAsyncPromises=function(){this._fulfill(asyncViewPromises)};return Vow.invoke(this._requestAllModels.bind(this)).then(saveAsyncPromises,null,this).then(this._updateDOM,null,this).then(fulfillWithAsyncPromises,this._reject,this),this.promise},ns.Update.prototype.start=ns.Update.prototype.render,ns.Update.prototype.reconstruct=function(node){return this.log("started `reconstruct` scenario"),this._applyLayout(),Vow.invoke(this._insertNodes.bind(this),node).then(function(){this._fulfill({async:[]})},this._reject,this),this.promise},ns.Update.prototype.applyTemplate=function(tree){return ns.renderString(tree,null,"")},ns.Update.prototype._expired=function(){return this.promise.isResolved()||-1===currentUpdates.indexOf(this)},ns.Update.prototype.abort=function(){this._reject({error:ns.U.STATUS.EXPIRED})},ns.Update.prototype._fulfill=function(result){ns.Update._removeFromQueue(this),this.promise.fulfill(result),this.perf(this.getTimers()),this.log("successfully finished scenario")},ns.Update.prototype._reject=function(reason){ns.Update._removeFromQueue(this),this.promise.reject(reason),this.log("scenario was rejected with reason",reason)},ns.Update.prototype._rejectWithStatus=function(status){return Vow.reject({error:status})},ns.Update.prototype.isGlobal=function(){return this.EXEC_FLAG===ns.U.EXEC.GLOBAL},ns.Update.prototype.perf=function(){},ns.Update.handleError=function(){return!1},ns.Update._removeFromQueue=function(updateInstance){var index=currentUpdates.indexOf(updateInstance);index>-1&&currentUpdates.splice(index,1)},ns.Update._addToQueue=function(newUpdate){var i,j,currentRuns=currentUpdates,FLAGS=ns.U.EXEC,FLAG_GLOBAL=FLAGS.GLOBAL,FLAG_PARALLEL=FLAGS.PARALLEL,FLAG_ASYNC=FLAGS.ASYNC,newRunExecutionFlag=newUpdate.EXEC_FLAG;if(newRunExecutionFlag===FLAG_GLOBAL){var survivedRuns=[];for(i=currentRuns.length-1;i>=0;i--){var run=currentRuns[i];run.EXEC_FLAG===FLAG_PARALLEL?survivedRuns.push(run):run.abort()}currentUpdates=survivedRuns}else if(newRunExecutionFlag===FLAG_ASYNC)for(i=0,j=currentRuns.length;j>i;i++)if(currentRuns[i].EXEC_FLAG===FLAG_GLOBAL)return!1;return currentUpdates.push(newUpdate),!0}}(),function(){ns.View=function(){},no.extend(ns.View.prototype,ns.Events),ns.View.prototype.STATUS=ns.V.STATUS,ns.View.prototype._$document="undefined"==typeof document?null:$(document),ns.View.prototype._$window="undefined"==typeof window?null:$(window),ns.View.prototype.key=null,ns.View.prototype.params=null,ns.View.prototype.node=null,ns.View.prototype.$node=null,ns.View.prototype.views=null,ns.View.prototype.id=null,ns.View.prototype.__modelsEventsBinded=!1,ns.View.prototype._init=function(id,params,async){this.id=id,this.async=async,this.info=ns.View.info(id),no.extend(this,ns.View.getKeyAndParams(this.id,params||{},this.info)),this._initModels(),this._modelsVersions={},this.views={},this.status=this.STATUS.NONE,this._bindCreateEvents(),this.trigger("ns-view-init")},ns.View.prototype._initModels=function(){this.models={},this._modelsHandlers={};for(var id in this.info.models)if(!this.models[id]){var model=ns.Model.get(id,this.params);this.models[id]=model,this._modelsHandlers[model.key]={}}},ns.View.prototype._getView=function(id){return this.views[id]},ns.View.prototype._addView=function(id,params,type){var view=this._getView(id);return view||(view=type===ns.L.BOX?new ns.Box(id,params):ns.View.create(id,params,type===ns.L.ASYNC),this.views[view.id]=view),view},ns.View.prototype._htmldestroy=function(events){this._unbindEvents("init"),events.push(this)},ns.View.prototype._htmlinit=function(events){this._bindEvents("init"),events.push(this)},ns.View.prototype._hide=function(events){return this.isLoading()||this._visible!==!0?this.isLoading()&&this._visible!==!1?(this._hideNode(),this._visible=!1,!1):!1:(this._unbindEvents("show"),this._hideNode(),this._visible=!1,events&&events.push(this),!0)},ns.View.prototype._hideNode=function(){this.node.className=this.node.className.replace(" ns-view-visible","")+" ns-view-hidden"},ns.View.prototype._show=function(events){return this.isLoading()||this._visible===!0?!1:(this.__modelsEventsBinded||this.__bindModelsEvents(),this._bindEvents("show"),this._showNode(),this._visible=!0,events&&events.push(this),!0)},ns.View.prototype._showNode=function(){this.node.className=this.node.className.replace(" ns-view-hidden","")+" ns-view-visible"},ns.View.prototype.__bindModelsEvents=function(){this.__modelsEventsBinded=!0;var models=this.models;for(var idModel in models){var model=models[idModel];this.__bindModelEvents(model)}},ns.View.prototype.__bindModelEvents=function(model){var decl=this.info.models[model.id];for(var eventName in decl){var handlerName=decl[eventName],handler=this[handlerName]||decl[eventName];"function"==typeof handler&&(handler===this.keepValid&&(handler=no.nop),this.__bindModelEvent(model,eventName,this._invokeModelHandler.bind(this,handler,model)))}},ns.View.prototype._invokeModelHandler=function(handler,model){return this._saveModelVersion(model.id),handler.apply(this,Array.prototype.slice.call(arguments,2))},ns.View.prototype.__bindModelEvent=function(model,eventName,handler){model.on(eventName,handler),this._modelsHandlers[model.key][eventName]=handler},ns.View.prototype.__unbindModelsEvents=function(){var models=this.models;for(var model_id in models){var model=models[model_id];this.__unbindModelEvent(model)}},ns.View.prototype.__unbindModelEvent=function(model){var events=this._modelsHandlers[model.key];for(var eventName in events)model.off(eventName,events[eventName]),delete events[eventName]},ns.View.prototype._prepareCallback=function(fn){if("string"==typeof fn){var method=this[fn];return ns.assert(method,"ns.View","Can't find method '%s' in '%s'",fn,this.id),method}return fn},ns.View.prototype._bindEventHandlers=function(events,handlerPos){for(var bindedEvents=[],i=0,j=events.length;j>i;i++){var event=events[i],eventCopy=[].concat(event);eventCopy[handlerPos]=this._prepareCallback(event[handlerPos]).bind(this),bindedEvents.push(eventCopy)}return bindedEvents},ns.View.prototype._getEvents=function(type){var eventProp="_"+type+"Events";if(!this[eventProp]){var eventsInfo=this.info[type+"Events"],nseventsInfo=this.info[type+"Nsevents"];this[eventProp]={bind:this._bindEventHandlers(eventsInfo.bind,2),delegate:this._bindEventHandlers(eventsInfo.delegate,2),nsevents:this._bindEventHandlers(nseventsInfo,1)}}return this[eventProp]},ns.View.prototype._bindEvents=function(type){var i,j,event,$node=this.$node,events=this._getEvents(type),delegateEvents=events.delegate;for(i=0,j=delegateEvents.length;j>i;i++)event=delegateEvents[i],"window"===event[1]||"document"===event[1]?this["_$"+event[1]].on(event[0],event[2]):event[1]?$node.on(event[0],event[1],event[2]):$node.on(event[0],event[2]);var bindEvents=events.bind;for(i=0,j=bindEvents.length;j>i;i++)event=bindEvents[i],$node.find(event[1]).on(event[0],event[2]);var nsEvents=events.nsevents;for(i=0,j=nsEvents.length;j>i;i++)event=nsEvents[i],ns.events.on(event[0],event[1])},ns.View.prototype._bindCreateEvents=function(){for(var i=0,j=this.info.createEvents.length;j>i;i++){var event=this.info.createEvents[i];this.on(event[0],this._prepareCallback(event[1]))}},ns.View.prototype._unbindEvents=function(type){var i,j,event,$node=this.$node,events=this._getEvents(type),delegateEvents=events.delegate;for(i=0,j=delegateEvents.length;j>i;i++)event=delegateEvents[i],"window"===event[1]||"document"===event[1]?this["_$"+event[1]].off(event[0],event[2]):event[1]?$node.off(event[0],event[1],event[2]):$node.off(event[0],event[2]);var bindEvents=events.bind;for(i=0,j=bindEvents.length;j>i;i++)event=bindEvents[i],$node.find(event[1]).off(event[0],event[2]);var nsEvents=events.nsevents;for(i=0,j=nsEvents.length;j>i;i++)event=nsEvents[i],ns.events.off(event[0],event[1])},ns.View.prototype.invalidate=function(){for(var views=this._getDescendantsAndSelf(),i=0,j=views.length;j>i;i++){var view=views[i];view.status===this.STATUS.OK&&(view.status=this.STATUS.INVALID)}},ns.View.prototype.isOk=function(){return this.status===this.STATUS.OK},ns.View.prototype.isLoading=function(){return this.status===this.STATUS.LOADING},ns.View.prototype.isNone=function(){return this.status===this.STATUS.NONE},ns.View.prototype.isValid=function(){return this.isOk()&&this.isModelsValidWithVersions()},ns.View.prototype.isValidSelf=ns.View.prototype.isValid,ns.View.prototype.isModelsValidWithVersions=function(){return this.isModelsValid(this._modelsVersions)},ns.View.prototype.isModelsValid=function(modelsVersions){var models=this.models;for(var id in models){var model=models[id];if(!model.isValid()||modelsVersions&&this._getModelVersion(id)>modelsVersions[id])return!1}return!0},ns.View.prototype.isVisible=function(){return this._visible},ns.View.prototype._apply=function(callback){var views=this.views;for(var id in views)callback(views[id],id)},ns.View.prototype._saveLayout=function(pageLayout){this.layout={},this.layout[this.id]={views:pageLayout}},ns.View.prototype._getRequestViews=function(updated,pageLayout,params){this._addSelfToUpdate(updated),this._saveLayout(pageLayout);for(var view_id in pageLayout)this._addView(view_id,params,pageLayout[view_id].type);return this._apply(function(view,id){view._getRequestViews(updated,pageLayout[id].views,params)}),updated},ns.View.prototype._addSelfToUpdate=function(updated){return this.asyncState=!1,this.async?this.shouldBeSync||this.isModelsValid()?updated.sync.push(this):(this.asyncState=!0,updated.async.push(this)):(this.isValidSelf()||this.invalidate(),updated.sync.push(this)),this.shouldBeSync=!1,updated},ns.View.prototype._getUpdateTree=function(tree,layout,params){return this.isValid()?this._apply(function(view,id){view._getUpdateTree(tree,layout[id].views,params)}):tree.views[this.id]=this._getViewTree(layout,params),tree},ns.View.prototype._getCommonTree=function(){var tree={collection:!1,box:!1,key:this.key,models:{},params:this.params,state:this.asyncState?"loading":"ok",tree:{},views:{}};return tree.tree[this.id]=!0,tree},ns.View.prototype._getTree=function(){var tree=this._getCommonTree(),treeToAppend=this.patchTree(tree);return treeToAppend&&"object"==typeof treeToAppend&&!Array.isArray(treeToAppend)&&(tree=no.extend(treeToAppend,tree)),tree},ns.View.prototype._getViewTree=function(layout,params){var tree=this._getTree();return tree.models=this._getModelsForTree(),"loading"===tree.state?tree:(this.isModelsValid()||(tree.state="error"),"object"!=typeof layout?!0:(tree.views=this._getDescViewTree(layout,params),tree))},ns.View.prototype.patchTree=no.nop,ns.View.prototype._getDescViewTree=function(layout,params){var views={};return this._apply(function(view,id){views[id]=view._getViewTree(layout[id].views,params)}),views},ns.View.prototype._getPlaceholderTree=function(layout,params){var tree=this._getTree();return tree.collection=!0,tree.state="placeholder",tree.views=this._getDescViewTree(layout,params),tree},ns.View.prototype._getModelsForTree=function(){var modelsData={},models=this.models;for(var id in models){var model=models[id];modelsData[id]={},model.isValid()?(modelsData[id].status="ok",modelsData[id][id]=model.getData()):(modelsData[id].status="error",modelsData[id][id]=model.getError())}return modelsData},ns.View.prototype.getModel=function(id){return this.models[id]},ns.View.prototype.getModelData=function(id){return this.getModel(id).getData()},ns.View.prototype._getDescendantsAndSelf=function(views){return views=views||[],views.push(this),this._apply(function(view){view._getDescendantsAndSelf(views)}),views},ns.View.prototype._setNode=function(node){var STATUS=this.STATUS;node?(this.node=node,this.$node=$(node),this.status=this.asyncState?STATUS.LOADING:STATUS.OK):this.status=STATUS.NONE},ns.View.prototype._extractNode=function(node){var viewNode,viewNodes=ns.byClass("ns-view-"+this.id,node);if(1===viewNodes.length)viewNode=viewNodes[0];else for(var i=0;i<viewNodes.length;i++)viewNodes[i].getAttribute("data-key")===this.key&&(viewNode=viewNodes[i]);return viewNode},ns.View.prototype._selfBeforeUpdateHTML=function(events){var viewWasInvalid=!this.isValidSelf();viewWasInvalid&&this.node&&!this.isLoading()&&(this._visible===!0&&events["ns-view-hide"].push(this),events["ns-view-htmldestroy"].push(this))},ns.View.prototype.beforeUpdateHTML=function(layout,params,events){this._selfBeforeUpdateHTML(events),this.asyncState||this._apply(function(view,id){view.beforeUpdateHTML(layout[id].views,params,events)})},ns.View.prototype._updateHTML=function(node,layout,params,updateOptions,events){var options_next;options_next=updateOptions.toplevel?no.extend({},updateOptions):updateOptions;var viewNode,syncUpdate=!updateOptions.async,viewWasInvalid=!this.isValid();viewWasInvalid&&(viewNode=this._extractNode(node),ns.assert(viewNode,"ns.View","Can't find node for '%s'",this.id),updateOptions.toplevel&&(this.node&&(ns.replaceNode(this.node,viewNode),options_next.parent_added=!0),options_next.toplevel=!1),this.node&&!this.isLoading()&&(this._hide(events["ns-view-hide"]),this._htmldestroy(events["ns-view-htmldestroy"])),!this.node||updateOptions.parent_added||options_next.parent_added||ns.replaceNode(this.node,viewNode),this._setNode(viewNode),this.isOk()?this._htmlinit(events["ns-view-htmlinit"]):this.isLoading()&&events["ns-view-async"].push(this),this._saveModelsVersions()),(syncUpdate||viewWasInvalid)&&this.isOk()&&(this._show(events["ns-view-show"]),events["ns-view-touch"].push(this)),viewNode=viewNode||node,this.asyncState||this._apply(function(view,id){view._updateHTML(viewNode,layout[id].views,params,options_next,events)})},ns.View.prototype._saveModelsVersions=function(){for(var modelId in this.models)this._saveModelVersion(modelId)},ns.View.prototype._getModelVersion=function(modelId){return this.models[modelId].getVersion()},ns.View.prototype._saveModelVersion=function(modelId){this._modelsVersions[modelId]=this._getModelVersion(modelId)},ns.View.prototype.keepValid=ns.View.prototype._saveModelsVersions,ns.View.prototype.updateAfter=function(promise){this._asyncPromise=new Vow.Promise;var that=this;return promise.then(function(){that.update()}),this._asyncPromise},ns.View.prototype.update=function(params,options){this.shouldBeSync=!0;var updateParams=this.params;if(params&&(updateParams=no.extend({},this.params,params)),!this.layout){var fakeLayoutName="ns-temp-layout-for-"+this.id,fakeLayout={};fakeLayout[this.id]={},ns.layout.define(fakeLayoutName,fakeLayout),this.layout=ns.layout.page(fakeLayoutName,updateParams),ns.layout.undefine(fakeLayoutName)}options=options||{},options.execFlag=options.execFlag||ns.U.EXEC.ASYNC;var updatePromise=new ns.Update(this,this.layout,updateParams,options).render();return this._asyncPromise&&this._asyncPromise.sync(updatePromise),updatePromise};var _infos={},_ctors={};ns.View.define=function(id,info,base){ns.assert(!(id in _infos),"ns.View","Can't redefine '%s'",id),info=info||{};var baseClass=this;"string"==typeof base?(baseClass=_ctors[base],ns.assert(baseClass,"ns.View","Can't find '%s' to extend '%s'",base,id)):"function"==typeof base&&(baseClass=base);var ctor=info.ctor||function(){};return ctor=no.inherit(ctor,baseClass,info.methods),info.models=this._formatModelsDecl(info.models||{}),info.events=info.events||{},_infos[id]=info,_ctors[id]=ctor,ctor},ns.View._reset=function(){_ctors={},_infos={}},ns.View.infoLite=function(id){var info=_infos[id];return ns.assert(info,"ns.View","'%s' is not defined",id),info},ns.View.info=function(id){var info=ns.View.infoLite(id);return info&&!info.pGroups&&(ns.View._initInfoParams(info),ns.View._initInfoEvents(info)),info},ns.View._initInfoParams=function(info){if(info.params){ns.assert(!info["params+"],"ns.View","you cannot specify params and params+ at the same time"),ns.assert(!info["params-"],"ns.View","you cannot specify params and params- at the same time");var groups,pGroups=[];groups=Array.isArray(info.params)?info.params:[info.params];for(var i=0;i<groups.length;i++){var group=groups[i];pGroups.push({pNames:Object.keys(group),pFilters:group,pDefaults:{}})}info.pGroups=pGroups}else{var params={};for(var model_id in info.models){var modelInfo=ns.Model.info(model_id);ns.assert(modelInfo,ns.View,"Model %s is not defined!",model_id),"object"==typeof modelInfo.params&&no.extend(params,modelInfo.params)}var exclude=info["params-"];if(exclude){for(var i=0;i<exclude.length;i++)delete params[exclude[i]];delete info["params-"]}info["params+"]&&(no.extend(params,info["params+"]),delete info["params+"]);var pNames=Object.keys(params);info.pGroups=pNames.length?[{pNames:pNames,pFilters:{},pDefaults:params}]:[]}},ns.View._initInfoEvents=function(info){info.createEvents=[],info.initEvents={bind:[],delegate:[]},info.showEvents={bind:[],delegate:[]},info.initNsevents=[],info.showNsevents=[];for(var eventDecl in info.events){var declParts=eventDecl.split(" "),eventParts=declParts.shift().split("@"),when=eventParts.length>1?eventParts.pop():"";when=!when||"init"!==when&&"show"!==when?"":when;var eventName=eventParts.join("@"),eventSelector=declParts.join(" ");if(eventName){var handler=info.events[eventDecl],nativeEvent=ns.V.DOM_EVENTS.indexOf(eventName)>-1;if(nativeEvent){var arr=[eventName,eventSelector,info.events[eventDecl]],globalSelector="window"===eventSelector||"document"===eventSelector,delegatedEvent=globalSelector||!("scroll"===eventName&&eventSelector);when||(when=globalSelector?"show":"init"),info[when+"Events"][delegatedEvent?"delegate":"bind"].push(arr)}else ns.V.NS_EVENTS.indexOf(eventName)>-1?info.createEvents.push([eventName,handler]):(when=when||"show",info[when+"Nsevents"].push([eventName,handler]))}}},ns.View.getKey=function(id,params,info){return this.getKeyAndParams(id,params,info).key},ns.View.getKeyAndParams=function(id,params,info){info=info||ns.View.info(id)||{};var keyParams;return keyParams="function"==typeof info.params?info.params(no.extend({},params)):ns.View._getKeyParams(id,params,info),ns.assert(keyParams,"ns.View","Could not generate key for view %s",id),{params:keyParams,key:ns.key("view="+id,keyParams)}},ns.View._getKeyParams=function(id,params,info){var extendedModels={},paramsExtendedByModels=!1;for(var model in info.models){var modelInfo=ns.Model.info(model);"function"==typeof modelInfo.params&&(paramsExtendedByModels=!0,no.extend(extendedModels,modelInfo.params(params)))}paramsExtendedByModels&&(no.extend(extendedModels,params),params=extendedModels);var pGroups=info.pGroups||[];if(!pGroups.length)return paramsExtendedByModels?params:{};for(var g=0;g<pGroups.length;g++){for(var group=pGroups[g],pNames=group.pNames||[],pFilters=group.pFilters||{},pDefaults=group.pDefaults||{},result={},i=0,l=pNames.length;l>i;i++){var pName=pNames[i],pValue=params[pName],pFilter=pFilters[pName],isOptional=pName in pDefaults;if(pValue=void 0===pValue?pDefaults[pName]:pValue,null!=pValue||!isOptional){if(null==pValue||pFilter&&pValue!==pFilter){result=null;break}result[pName]=pValue}}if(result)return result}return null},ns.View.create=function(id,params,async){var Ctor=_ctors[id];ns.assert(Ctor,"ns.View","'%s' is not defined",id);var view=new Ctor;return view._init(id,params,async),view},ns.View.defaultModelEvents={"ns-model-insert":"invalidate","ns-model-remove":"invalidate","ns-model-changed":"invalidate","ns-model-destroyed":"invalidate"},ns.View._expandModelsDecl=function(decl){if(!Array.isArray(decl))return decl;for(var declExpanded={},i=0,l=decl.length;l>i;i++)declExpanded[decl[i]]=no.extend({},this.defaultModelEvents);return declExpanded},ns.View._formatModelsDecl=function(decls){var declsFormated=this._expandModelsDecl(decls);for(var idModel in declsFormated){var declFull=getFullMethodDecl(declsFormated[idModel]),methodCommon=null;"string"==typeof declFull&&(methodCommon=declFull,declFull={});for(var eventName in this.defaultModelEvents){var methodDefault=this.defaultModelEvents[eventName];declFull[eventName]=void 0===declFull[eventName]?methodCommon||methodDefault:getFullMethodDecl(declFull[eventName])}declsFormated[idModel]=declFull}return declsFormated};var getFullMethodDecl=function(decl){return!0===decl?"invalidate":!1===decl?"keepValid":decl}}(),ns.ViewCollection=function(){},no.extend(ns.ViewCollection,ns.View),no.inherit(ns.ViewCollection,ns.View),ns.ViewCollection.define=function(id,info,baseClass){info=info||{},baseClass=baseClass||this;var ctor=ns.View.define.call(this,id,info,baseClass);ns.assert(info.split,"ns.ViewCollection","'%s'  must define 'split' section",id),ns.assert(info.split.intoViews,"ns.ViewCollection","'%s'  must define 'split.intoViews' section",id),ns.assert(info.split.byModel,"ns.ViewCollection","'%s'  must define 'split.byModel' section",id);var isValidModelCollection=info.split.byModel in info.models&&ns.Model.infoLite(info.split.byModel).isCollection;return ns.assert(isValidModelCollection,"ns.ViewCollection","'%s'  must depend on ns.ModelCollection",id),info.isCollection=!0,info.modelCollectionId=info.split.byModel,ctor},ns.ViewCollection.eventsModelCollectionDefault={"ns-model-insert":"keepValid","ns-model-remove":"keepValid","ns-model-changed":"invalidate","ns-model-destroyed":"invalidate"},ns.ViewCollection._expandModelsDecl=function(decls){if(!Array.isArray(decls))return decls;for(var declsExpanded={},i=0,l=decls.length;l>i;i++){var idModel=decls[i];declsExpanded[idModel]=ns.Model.infoLite(idModel).isCollection?no.extend({},this.eventsModelCollectionDefault):no.extend({},this.defaultModelEvents)}return declsExpanded},ns.ViewCollection.prototype._init=function(){ns.View.prototype._init.apply(this,arguments)},ns.ViewCollection.prototype._invokeModelHandler=function(handler,model,e,o){return o&&o.model?void 0:(this._saveModelVersion(model.id),handler.apply(this,Array.prototype.slice.call(arguments,2)))},ns.ViewCollection.prototype._getModelVersion=function(modelId){var modelVersion,model=this.models[modelId];return modelVersion=modelId===this.info.modelCollectionId?model.getSelfVersion():model.getVersion()},ns.ViewCollection.prototype.isValid=function(){return this.isValidSelf()&&this.isValidDesc()},ns.ViewCollection.prototype.isValidDesc=function(){for(var key in this.views)if(!this.views[key].isValid())return!1;return!0},ns.ViewCollection.prototype.invalidate=function(){this.status===this.STATUS.OK&&(this.status=this.STATUS.INVALID)},ns.ViewCollection.prototype.invalidateAll=ns.View.prototype.invalidate,ns.ViewCollection.prototype._getView=function(id,params){var key=ns.View.getKey(id,params);return this._getViewByKey(key)},ns.ViewCollection.prototype._getViewByKey=function(key){return this.views&&this.views[key]||null},ns.ViewCollection.prototype._addView=function(id,params){var view=this._getView(id,params);return view||(view=ns.View.create(id,params),view._showNode=no.nop,view._hideNode=no.nop,this.views[view.key]=view),view},ns.ViewCollection.prototype._deleteView=function(view){delete this.views[view.key]},ns.ViewCollection.prototype._apply=function(callback){var views=this.views;for(var key in views)callback(views[key],views[key].id)},ns.ViewCollection.prototype._getRequestViews=function(updated,pageLayout){return this._saveLayout(pageLayout),this._addSelfToUpdate(updated)},ns.ViewCollection.prototype._getUpdateTree=function(tree,layout,params){var decl;return decl=this.isValidSelf()?this._getPlaceholderTree(layout,params):this._getViewTree(layout,params),tree.views[this.id]=decl,tree},ns.ViewCollection.prototype._forEachCollectionItem=function(cb,params){var MC=this.models[this.info.modelCollectionId];if(MC.isValid())for(var modelItems=MC.models,i=0,j=modelItems.length;j>i;i++){var viewItem=this._getViewItem(modelItems[i],params);if(viewItem.id){var view=this._addView(viewItem.id,viewItem.params);cb(view)}}},ns.ViewCollection.prototype._getDescViewTree=function(layout,params){var that=this,result={};return result["ns-view-collection-container"]=[],this._forEachCollectionItem(function(view){var decl=null;if(that.isValidSelf()?view.info.isCollection&&view.isValidSelf()?decl=view._getPlaceholderTree(layout,params):view.isValid()||(decl=view._getViewTree(layout,params)):decl=view.isValidSelf()?view._getPlaceholderTree(layout,params):view._getViewTree(layout,params),decl){var viewItemTree={};viewItemTree[view.id]=decl,result["ns-view-collection-container"].push(viewItemTree)}},params),result},ns.ViewCollection.prototype._getViewTree=function(layout,params){var tree=this._getTree();return tree.collection=!0,tree.models=this._getModelsForTree(),tree.views=this._getDescViewTree(layout,params),tree},ns.ViewCollection.prototype.beforeUpdateHTML=function(layout,params,events){this._selfBeforeUpdateHTML(events),this.isLoading()||this._forEachCollectionItem(function(view){view.beforeUpdateHTML(null,params,events)},params)},ns.ViewCollection.prototype._updateHTML=function(node,layout,params,updateOptions,events){var options_next,newNode=this._extractNode(node),isOuterPlaceholder=$(newNode).hasClass("ns-view-placeholder"),viewWasInvalid=!this.isValid(),syncUpdate=!updateOptions.async;if(options_next=updateOptions.toplevel?no.extend({},updateOptions):updateOptions,this.isValidSelf())!updateOptions.toplevel&&isOuterPlaceholder&&(ns.replaceNode(newNode,this.node),options_next=no.extend({},updateOptions),options_next.toplevel=!0,options_next.parent_added=!0);else{var hadOldNode=!!this.node;if(!newNode)throw new Error("[ns.ViewCollection] Can't find node for '"+this.id+"'");updateOptions.toplevel?isOuterPlaceholder?options_next.toplevel=!0:(this.node&&ns.replaceNode(this.node,newNode),options_next.toplevel=!1,options_next.parent_added=!0,this._setNode(newNode)):isOuterPlaceholder?(ns.replaceNode(newNode,this.node),options_next.toplevel=!1,options_next.parent_added=!0):this._setNode(newNode),hadOldNode&&!this.isLoading()&&(this._hide(events["ns-view-hide"]),this._htmldestroy(events["ns-view-htmldestroy"])),this.isOk()?this._htmlinit(events["ns-view-htmlinit"]):this.isLoading()&&events["ns-view-async"].push(this)}if((syncUpdate||viewWasInvalid)&&this.isOk()&&(this._show(events["ns-view-show"]),events["ns-view-touch"].push(this),this._saveModelsVersions()),!this.isLoading()){var containerDesc,itemsExist={};if(containerDesc=this.$node.is(".ns-view-container-desc")?this.node:ns.byClass("ns-view-container-desc",this.node)[0],!containerDesc)throw new Error("[ns.ViewCollection] Can't find descendants container (.ns-view-container-desc element) for '"+this.id+"'");newNode=newNode||this.node;var prev;this._forEachCollectionItem(function(view){if(isOuterPlaceholder){var viewItemWasInValid=!view.isValid();view._updateHTML(newNode,null,params,options_next,events),viewItemWasInValid&&(prev?$(prev.node).after(view.node):$(containerDesc).prepend(view.node))}else{var viewItemWasValid=view.isValid();view._updateHTML(newNode,null,params,options_next,events),viewItemWasValid&&ns.replaceNode(view._extractNode(newNode),view.node)}itemsExist[view.key]=view,prev=view},params),this._apply(function(view){itemsExist[view.key]||(view.invalidate(),view._hide(events["ns-view-hide"]),view._htmldestroy(events["ns-view-htmldestroy"]),this._deleteView(view),ns.removeNode(view.node))}.bind(this))}},ns.ViewCollection.prototype._getViewItem=function(modelItem,updateParams){var viewId,viewItemParams=no.extend({},updateParams,modelItem.params),infoViewId=this.info.split.intoViews;return viewId="function"==typeof infoViewId?infoViewId.call(this,modelItem,viewItemParams):infoViewId,{id:viewId,params:viewItemParams}},ns.Box=function(id,params){this.id=id,this.params=params,this.views={},this.key=ns.Box.getKey(id),this.node=null,this.active={},this._visible=!1},ns.Box.prototype._getViewKey=function(id,params,type){var key;return key=type===ns.L.BOX?ns.Box.getKey(id):ns.View.getKey(id,params)},ns.Box.prototype._getView=function(id,params,type){var key=this._getViewKey(id,params,type);return this.views[key]},ns.Box.prototype._addView=function(id,params,type){var view=this._getView(id,params,type);return view||(view=type===ns.L.BOX?new ns.Box(id,params):ns.View.create(id,params,type===ns.L.ASYNC),this.views[view.key]=view),view},ns.Box.prototype._getDescendantsAndSelf=function(descs){var views=this.views,active=this.active;descs.push(this);for(var id in active){var view=views[active[id]];view._getDescendantsAndSelf(descs)}return descs},ns.Box.prototype._getRequestViews=function(updated,layout,params){for(var id in layout){var view=this._addView(id,params,layout[id].type);view._getRequestViews(updated,layout[id].views,params)}},ns.Box.prototype._getUpdateTree=function(tree,layout,params){if(this.isNone())tree.views[this.id]=this._getViewTree(layout,params);else{var views=this.views;for(var id in layout){var selfLayout=layout[id],key=this._getViewKey(id,params,selfLayout.type);views[key]._getUpdateTree(tree,selfLayout.views,params)}}},ns.Box.prototype._getViewTree=function(layout,params){var tree=this._getCommonTree();tree.box=!0;var views=this.views;for(var id in layout){var selfLayout=layout[id],key=this._getViewKey(id,params,selfLayout.type);tree.views[id]=views[key]._getViewTree(selfLayout.views,params)}return tree},ns.Box.prototype.beforeUpdateHTML=function(layout,params,events){var newLayout={};for(var id in layout){var selfLayout=layout[id],key=this._getViewKey(id,params,selfLayout.type);newLayout[id]=key;var view=this.views[key];view.beforeUpdateHTML(layout[view.id].views,params,events)}for(var key in this.views){var view=this.views[key];if(newLayout[view.id]!==view.key)for(var descs=view._getDescendantsAndSelf([]),i=0,l=descs.length;l>i;i++){var desc=descs[i];desc.node&&desc._visible===!0&&!desc.isLoading()&&desc.trigger&&events["ns-view-hide"].push(desc)}}},ns.Box.prototype._updateHTML=function(node,layout,params,options,events){var oldNode;if(!this.node||!options.toplevel){var newNode=ns.byClass("ns-view-"+this.id,node)[0];newNode&&(oldNode=this.node,this.node=newNode)}if(!this.node)throw new Error("[ns.Box] Can't find node for '"+this.id+"'");var views=this.views,layoutActive={};for(var id in layout){var selfLayout=layout[id],key=this._getViewKey(id,params,selfLayout.type);layoutActive[id]=key;var view=views[key];view._updateHTML(node,selfLayout.views,params,options,events)}for(var key in views){var view=views[key];if(layoutActive[view.id]!==view.key){for(var descs=view._getDescendantsAndSelf([]),i=0,l=descs.length;l>i;i++)descs[i]._hide()&&events["ns-view-hide"].push(descs[i]);
oldNode&&oldNode.contains(view.node)&&this.node.appendChild(view.node)}}this.active=layoutActive,this._sortViewNodes(),this._show()},ns.Box.prototype._sortViewNodes=function(){var active=this.active,views=this.views,viewNodesIterator=function(children){var position=-1,childrenCount=children.length;return{getNext:function(){for(position+=1;childrenCount>position;position++)if(ns.hasClass(children[position],"ns-view-visible"))return children[position];return null}}}(this.node.children);for(var viewId in active){var viewKey=active[viewId],view=views[viewKey],cursorViewNode=viewNodesIterator.getNext();cursorViewNode!==view.node&&(cursorViewNode?this.node.insertBefore(view.node,cursorViewNode):this.node.appendChild(view.node))}},ns.Box.prototype._show=function(){return this._visible===!1&&(this._showNode(),this._visible=!0),!1},ns.Box.prototype._hide=function(){return this._visible===!0&&(this._hideNode(),this._visible=!1),!1},ns.Box.prototype.isNone=function(){return!this.node},ns.Box.prototype._getCommonTree=ns.View.prototype._getCommonTree,ns.Box.prototype._hideNode=ns.View.prototype._hideNode,ns.Box.prototype._showNode=ns.View.prototype._showNode,ns.Box.prototype.isOk=no["true"],ns.Box.prototype.isLoading=no["false"],ns.Box.getKey=function(id){return"box="+id},function(){function nsViewCallHelper(view,methodName,p1,p2,p3,p4,p5){var tree=yr.nodeset2data(view);view=tree.bosphorus;try{var result=view[methodName](p1,p2,p3,p4,p5)}catch(e){return ns.log.exception("ns-view-call",e,{id:view.id,key:view.key,method:methodName}),yr.object2nodeset({})}return Array.isArray(result)?yr.array2nodeset(result):yr.object2nodeset(result)}function nsModelCallHelper(tree,modelName,methodName,p1,p2,p3,p4,p5){tree=yr.nodeset2data(tree);var view=tree.bosphorus,model=view.getModel(modelName);if(model){try{var result=model[methodName](p1,p2,p3,p4,p5)}catch(e){return ns.log.exception("ns-model-call",e,{id:view.id,key:view.key,method:methodName,model:modelName}),yr.object2nodeset({})}return Array.isArray(result)?yr.array2nodeset(result):yr.object2nodeset(result)}return yr.object2nodeset({})}ns.View.prototype.patchTree=function(){return{bosphorus:this}},yr.externals["_ns-view-call"]=function(){return nsViewCallHelper.apply(null,arguments)},yr.externals["_ns-view-call-scalar"]=function(){return nsViewCallHelper.apply(null,arguments)},yr.externals["_ns-model-call"]=function(tree,modelName,modelMethod,p1,p2,p3,p4,p5){return nsModelCallHelper(tree,modelName,modelMethod,p1,p2,p3,p4,p5)},yr.externals["_ns-model-call-scalar"]=function(){return nsModelCallHelper.apply(null,arguments)}}(),function(){var goodErrors=ph.common.goodErrors;ns.log.exception=ph._logException,ns.page.title=function(){return"Яндекс.Фотки"},ns.Model.prototype.extractData=function(result){return result?result.result:void 0};var _canRequest=ns.Model.prototype.canRequest;ns.Model.prototype.canRequest=function(){var defaultValue=_canRequest.apply(this,arguments);if(defaultValue){var error=this.getError();if(error&&goodErrors.indexOf(error.name)>=0)return ph.modelsManager.handleError(this),!1}return defaultValue},ns.assert(typeof ns.Model.prototype.setSilent,"ns.Model","we have created setSilent custom method"),ns.Model.prototype.setSilent=function(jpath,data){return this.set(jpath,data,{silent:!0})},ns.assert(typeof ns.Model.prototype.getRestoreData,"ns.Model","we have custom getRestoreData method"),ns.assert(typeof ns.Model.prototype.restoreModel,"ns.Model","we have custom restoreModel method"),ns.Model.prototype.getRestoreData=function(){return this.getData()},ns.Model.prototype.restoreModel=function(obj){return this.setData(obj),this},ns.Update.handleError=function(error){return error.error===ns.U.STATUS.MODELS?ph.redirect["do"](ns.page.current,error.invalidModels)?!1:!0:!1};var _getCommonTree=ns.View.prototype._getCommonTree;ns.View.prototype._getCommonTree=function(){var tree=_getCommonTree.apply(this,arguments);return tree.state=!this.asyncState||this.isModelsValid()?"ok":"loading",tree},ph.LocalModel=function(){},no.inherit(ph.LocalModel,ns.Model);var ns_model_init=ns.Model.prototype._init;ph.LocalModel.prototype._init=function(){var result=ns_model_init.apply(this,arguments);return this.phLocalModelInit(),result},ph.LocalModel.prototype.canRequest=function(){return!1},ph.LocalModel.prototype.phLocalModelInit=function(){ns.assert(this.info.getInitialData,"ph.LocalModel","getInitialData not specified"),ns.assert("function"==typeof this.info.getInitialData,"getInitialData must be a function");var data=this.info.getInitialData.call(this);this.setData(data,{silent:!0})},ph.View=function(){},no.inherit(ph.View,ns.View);var ns_view_init=ns.View.prototype._init;ph.View.prototype._init=function(){var result=ns_view_init.apply(this,arguments);return this.phViewInit(),result},ph.View.prototype.phViewInit=function(){var that=this;this.info.shortcuts&&(this.on("ns-view-show",function(){ph.keyboard.register(that,that.info.shortcuts)}),this.on("ns-view-hide",function(){ph.keyboard.forget(that)}))},ph.View.prototype.isVisible=function(){return this._visible}}(),function(){var diff=function(obja,objb){return!_.isEqual(obja,objb)},_assertModelMethod=function(methodName){ns.assert(!(methodName in ns.Model.prototype),"model-set-data",'method "%s" already exist in ns.Model',methodName)},_set=ns.Model.prototype.set;ns.Model.prototype.set=function(jpath,newValue){if(!this.info.disableJpathDataChecks){var oldValue=this.get(jpath);if(!diff(oldValue,newValue))return;this._prevData=_.cloneDeep(this.getData()),this._jpathCache={}}return _set.apply(this,arguments)},ns.Model.prototype._beforeSetData=function(data){return this.info.disableJpathDataChecks||(this._prevData=_.cloneDeep(data),this._jpathCache={}),data};var _hasDataChanged=ns.Model.prototype.hasDataChanged;ns.Model.prototype.hasDataChanged=function(data){if(!this.info.disableJpathDataChecks){var oldData=this.getData(),newData=this.preprocessData(data);return diff(oldData,newData)}return _hasDataChanged.apply(this,arguments)},_assertModelMethod("hasDataChangedByJpath"),ns.Model.prototype.hasDataChangedByJpath=function(jpath){if(ns.assert(!this.info.disableJpathDataChecks,"ns.model","hasDataChangedByJpath can be called only if disableJpathDataChecks flag is not set"),!(jpath in this._jpathCache)){var changed=diff(no.jpath(jpath,this._prevData),no.jpath(jpath,this.getData()));this._jpathCache[jpath]=changed}return this._jpathCache[jpath]},_assertModelMethod("deleteData"),ns.Model.prototype.deleteData=function(jpath){var updatedData=_.cloneDeep(this.getData());no.jpath.set(jpath,updatedData),this.setData(updatedData)}}(),function(){ph.redirectToPassport=function(){ns.page.go(ph.utils.generateUrl("passport",{action:"signIn"}))},ph.redirectToPassportAndSave=function(ticket){var params=no.extend({sd:1,sk:ticket},ns.page.current.params),signInUrl=ph.utils.generateUrl("passport",{action:"signIn",retpath:ph.utils.fullUrl(ph.utils.generateUrl("photo",params))});ns.page.go(signInUrl)},ph.redirectToOferta=function(){var ofertaUrl=ph.utils.generateUrl("oferta",{retpath:ph.utils.fullUrl(ns.page.currentUrl)});ns.page.go(ofertaUrl)},ph.noAuthRedirect=function(auth){return auth&&auth.isAuthValid()?!1:(ph.redirectToPassport(),!0)},ph.redirect={"do":function(pageInfo,models){return this.commonRedirects(models)?void 0:this[pageInfo.page](models,pageInfo.params)},commonRedirects:function(models){return this._isModelError(models,"auth","pdd")?this._redirect(ph.utils.generateUrl("pdd")):this._isModelError(models,"auth","auth:need_reset")?this._redirect("https://pass.yandex.ru/resign?retpath="+encodeURIComponent(ph.utils.fullUrl(ns.page.currentUrl))):this._isAnyModelError(models,"Forbidden")?this._redirect(ph.utils.generateUrl("root")):null},index:function(){},"contest-vote":function(models){return this._isModelError(models,"contest","contest is not active")?this._redirect(ph.utils.generateUrl("contest",ns.page.current.params)):void 0},photo:function(models,params){var auth=this._model("auth",models),profile=this._model("profile",models),photo=this._model("photo",models),albumInfo=this._model("album-info",models),photoInitialRedirect=this._model("photo-initial-redirect",models),isAuthor=this._isAuthor(profile,auth),promise=null;if(photoInitialRedirect&&photoInitialRedirect.getAlbumId()){var albumId=photoInitialRedirect.getAlbumId(),urlParams=no.extend({},params);return photoInitialRedirect.setAsValid(),this._redirectToPhoto(params,urlParams,albumId)}if(profile){if(profile.get(".isBlocked")&&!isAuthor)return this.redirectToProfile(profile);if(profile.getError())return this.redirectToProfile(profile)}if(photo&&(promise=this.redirectToPhoto(photo,params)))return promise;if(albumInfo){var albumInfoError=albumInfo.getError();if(albumInfoError&&"ask password"!==albumInfoError.name)return this.redirectToAlbum(albumInfo)}return null},redirectToAlbum:function(albumInfo){var albumUrl,params;if(albumInfo){var albumId=albumInfo.params["album-id"]||albumInfo.get(".albumId");typeof albumId>0&&(params=no.extend({},ns.page.current.params,{"album-id":albumId}),albumUrl=ph.utils.generateUrl("album",params))}return albumUrl?this._redirect(albumUrl):this.redirectToProfile()},redirectToProfile:function(profile){var params=profile&&profile.params||ns.page.current.params;return this._redirect(ph.utils.generateUrl("user-profile",params))},redirectToPhoto:function(photo,params){params=params||ns.page.current.params;var urlParams=no.extend({},params,photo.params);return this._redirectToPhoto(params,urlParams,photo.get(".albumId"))},_redirectToPhoto:function(params,urlParams,albumId){return ph.params.hiddenParams["comment-id"]&&(urlParams["comment-id"]=ph.params.hiddenParams["comment-id"]),ph.params.hiddenParams["comment-reply"]&&(urlParams["comment-reply"]=ph.params.hiddenParams["comment-reply"]),albumId&&(urlParams["album-id"]=albumId),this._differ(params,urlParams,["author-login","image-id","album-id"])?this._redirect(ph.utils.generateUrl("photo",urlParams)):null},redirectTo404:function(){return this._redirect(ph.utils.generateUrl("not-found",{}))},_isModelError:function(models,modelId,errorName){var model=this._model(modelId,models),modelError=model&&model.getError();return modelError&&modelError.name===errorName},_isAnyModelError:function(models,errorName){return models.some(function(model){var modelError=model.getError();return modelError&&modelError.name===errorName})},_isAuthor:function(profile,auth){return profile&&auth&&profile.get(".userId")==auth.get(".photo-profile.userId")},_redirect:function(url){return url?ns.page.go(url,"replace"):null},_model:function(id,models){for(var i=0;i<models.length;i++)if(models[i].id===id)return models[i];return null},_differ:function(params1,params2,keys){return keys.some(function(key){return params1[key]!=params2[key]})}}}(),function(){var timeout,slideshow={},delay=4500,isRunning=!1,go=function(){timeout=setTimeout(function(){timeout=null,ns.events.trigger("ph-next-photo")},delay)};slideshow.run=function(){timeout||(isRunning=!0,go())},slideshow.stop=function(){timeout&&(clearTimeout(timeout),timeout=null),isRunning=!1,ns.events.trigger("ph-slideshow-stop")},slideshow.isRunning=function(){return isRunning},ph.slideshow=slideshow}(),function(){var keyboard={},keys={13:"enter",27:"esc",32:"space",37:"left",39:"right",69:"e",70:"f",74:"j",75:"k",76:"l",191:"/"},keyMap={"?":{key:"/",shift:!0}},rInput=/^(input|textarea|select)$/i,_blocks={},_views={},_defs={},_keysDown={};keyboard.init=function(){this._onKeyDown=function(evt){keyboard._handle(evt)},this._onKeyUp=function(evt){keyboard._handleKeyUp(evt)},this._onWindowBlur=function(evt){keyboard.handleWindowBlur(evt)},this.enable()},keyboard.disable=function(){$(document).off("keydown",this._onKeyDown),$(document).off("keyup",this._onKeyUp),$(window).off("blur",this._onWindowBlur)},keyboard.enable=function(){$(document).on("keydown",this._onKeyDown),$(document).on("keyup",this._onKeyUp),$(window).on("blur",this._onWindowBlur)},keyboard.register=function(view,def){_views[view.id]=view,_defs[view.id]=keyboard._prepareEvents(def)},keyboard.registerBlock=function(blockName,def){_blocks[blockName]=keyboard._prepareEvents(def)},keyboard.forget=function(view){_views[view.id]=null,_defs[view.id]=null},keyboard.handleWindowBlur=function(){_keysDown={}},keyboard.getDefs=function(){var hash={},data=[];for(var viewId in _defs)for(var key in _defs[viewId]){var action=_defs[viewId][key],actionName=action.name;if(actionName){var shortcuts=hash[actionName];shortcuts||(shortcuts=hash[actionName]=[],data.push({actionName:actionName,keys:shortcuts})),shortcuts.push(action.printVersion)}}return data},keyboard.getKeyName=function(evt){return keys[evt.which]},keyboard._handle=function(evt){var action,$target=$(evt.target),key=keys[evt.which];if(key&&!_keysDown[key]){_keysDown[key]=!0;for(var blockName in _blocks)if(action=_blocks[blockName][key],action&&keyboard._isActionValid(evt,action)){var blockNode=$target.closest('*[data-nb~="'+blockName+'"]')[0],block=blockNode&&nb.block(blockNode,null,blockName);if(block&&(block[action.method](evt),action.last))return void evt.preventDefault()}for(var viewId in _views)if(_views[viewId]){action=_defs[viewId][key];var view=_views[viewId];if(action&&keyboard._isActionValid(evt,action)&&(view[action.method](evt),action.last))return void evt.preventDefault()}}},keyboard._handleKeyUp=function(evt){var key=keys[evt.which];key&&(_keysDown[key]=null)},keyboard._prepareEvents=function(def){var events={};for(var key in def){var action=def[key];action="string"==typeof action?{method:action}:no.extend({},action);var printVersion=no.extend({},action,{keyName:key}),mapped=keyMap[key];mapped&&(action=no.extend(action,mapped,{keyName:key}),key=mapped.key),action.printVersion=printVersion,events[key]=action}return events},keyboard._isActionValid=function(evt,action){var $target=$(evt.target),nodeName=evt.target.nodeName;if(action.selector){if(!$target.is(action.selector))return!1}else if(rInput.test(nodeName))return!1;var isValid=(!action.meta&&!evt.metaKey||action.meta&&evt.metaKey)&&(!action.shift&&!evt.shiftKey||action.shift&&evt.shiftKey)&&(!action.alt&&!evt.altKey||action.alt&&evt.altKey)&&(!action.ctrl&&!evt.ctrlKey||action.ctrl&&evt.ctrlKey);return isValid},ph.keyboard=keyboard}(),function(){var Queue=function(options){this.queue=[],this.queueKeys=[],ns.assert(options,"ph.Queue","options not specified"),ns.assert(options.keyFunc,"ph.Queue","`keyFunc` function was not specified"),this.keyFunc=options.keyFunc,this.skipCycles=options.skipCycles,this.skipErrors=options.skipErrors,this.max=options.max||1,this._resetRunning()};Queue.prototype.add=function(keyObj,callback,dropQueue){ns.assert(keyObj,"ph.Queue","called `add` method without `keyObj` specified"),ns.assert(callback,"ph.Queue","called `add` method without `callback` specified");var key=this.keyFunc(keyObj);ns.assert(key,"ph.Queue","could not calculate key"),dropQueue&&this.abortAll(dropQueue),this.queueKeys.push(key),this.queue.push(callback),this._run()},Queue.prototype.abortAll=function(abortCurrent){if(this.queue=[],this.queueKeys=[],abortCurrent&&this._runningCount){for(var key in this._running)this._running[key].reject(),this._runningCount--;this._resetRunning()}},Queue.prototype._run=function(){this._runningCount>=this.max||this._next()},Queue.prototype._next=function(){var that=this,queue=this.queue,queueKeys=this.queueKeys;if(0!==queue.length){var next=queue[0],nextKey=queueKeys[0],foundIndex=0;if(this.skipCycles)for(var i=queueKeys.length-1;i>0;i--)if(this.keyFunc(queueKeys[i])===nextKey){foundIndex=i;break}next=queue[foundIndex],this.queue=queue.slice(foundIndex+1),this.queueKeys=queueKeys.slice(foundIndex+1);var promise=next();if(!promise)return void this._next();this._running[nextKey]=promise,this._runningCount++,this.skipErrors?promise.always(function(){that._taskDone(nextKey)}):promise.then(function(){that._taskDone(nextKey)}),this._run()}},Queue.prototype._resetRunning=function(){this._running={},this._runningCount=0},Queue.prototype._taskDone=function(key){delete this._running[key],this._runningCount--,this._next()},ph.Queue=Queue}(),function(){var ready=new Vow.Promise,goToUrl=function(url){window.location.href=url},metrika={};metrika.init=function(){ph.loadModule("metrika").then(function(){var counter=new Ya.Metrika({id:149814,defer:!0,clickmap:!0,accurateTrackBounce:!0,trackLinks:!0,trackHash:!1,webvisor:!0});ready.fulfill(counter)}),ns.events.on("ph-page-show",this.countHit)},metrika.count=function(params){ready.then(function(counter){counter.params.apply(counter,params)})},metrika.countLink=function(countCallback){return function(evt,node){var that=this,delay=50,target=node&&1===node.nodeType?node:evt.currentTarget,href=$(target).attr("href");return ns.assert(href,"ph.metrika.countLink","event target must be an anchor"),countCallback.call(that,evt),evt.altKey||evt.ctrlKey||evt.metaKey||evt.shiftKey?!0:(setTimeout(function(){goToUrl(href)},delay),evt.preventDefault(),!1)}},metrika.countHit=function(){var params=[document.location.href,document.title];no.next(function(){ready.then(function(counter){counter.hit.apply(counter,params)})})},metrika.mode=function(){return ph.slideshow.isRunning()?"in slideshow":"view"===ns.page.current.params.mode?"in white mode":"in black mode"},metrika.group=function(value,groups){for(var separator="—",less="< ",more="≥ ",i=0;i<groups.length;i++){var from=groups[i],to=groups[i+1]||from;if(from>value)return less+from;if(value>=from&&to>value)return from+separator+(to-1);if(value>=to&&i===groups.length-1)return more+to}},metrika.generateMetrikaCounter=function(metrikaParams){return ns.assert(metrikaParams,"ph.generateMetrikaCounter","metrikaParams not specified"),function(params){ns.assert(Array.isArray(params),"metrikaCounter","params must be an array"),ph.metrika.count(metrikaParams.concat(params))}},metrika.getEventSummary=function(evt){return evt&&"click"===evt.type?"click":"hotkey "+ph.metrika.getKeyName(evt)},metrika.getKeyName=function(evt){return ph.keyboard.getKeyName(evt)},metrika.getImageFormat=function(photo){return photo&&photo.get(".imageFormat")||"unknown"},metrika.getContextInfo=function(){var params=ns.page.current.params,result={name:params.context||"album"};return"search"===result.name&&(result.more="generic",params.modelid||"model"===params.type?result.more="camera":params.tags&&(result.more="tag")),result},ph.metrika=metrika}(),function(){var warn=function(message){"function"==typeof no.jpath(".console.warn",window)&&window.console.warn(message)},onPageShow=function(evt,pageInfo){var statParams=null;switch(pageInfo.page){case"photo":statParams=["desktop_web","image_viewer",pageInfo.params.context||"album"];break;case"contest-vote":statParams=["desktop_web","contest_vote"];break;case"index":statParams=["desktop_web","index",pageInfo.params.context||"recent"]}return statParams?void $.ajax({url:ph.utils.generateUrl("stat",statParams),type:"GET",dataType:"text"}):void warn("No stat params for page "+pageInfo.page)};ph.statface={init:function(){ns.events.on("ph-page-show",onPageShow)}}}();var nb={};nb.inherit=function(child,parent){var F=function(){};F.prototype=parent.prototype,child.prototype=new F,child.prototype.constructor=child},nb.extend=function(dest){for(var srcs=[].slice.call(arguments,1),i=0,l=srcs.length;l>i;i++){var src=srcs[i];for(var key in src)dest[key]=src[key]}return dest};var nb=nb||{};!function(){nb.node={},nb.node.data=function(node,key,value){function parseValue(value){try{var ch=value.charAt(0);return"["===ch||"{"===ch?eval("("+value+")"):value}catch(er){return value}}if(!key){for(var data={},attrs=node.attributes,r,i=0,l=attrs.length;l>i;i++){var attr=attrs[i];(r=/^data-nb-(.+)/.exec(attr.name))&&(data[r[1]]=parseValue(attr.value))}return data}return void 0===value?parseValue(node.getAttribute("data-nb-"+key)||""):void node.setAttribute("data-nb-"+key,value)},nb.node.getMod=function(node,name){return nb.node.setMod(node,name)};var modCache={};nb.node.setMod=function(node,name,value){var rx=modCache[name]||(modCache[name]=RegExp("(?:^|\\s+)"+name+"(?:_([\\w-]+))?(?:$|\\s+)")),className=node.className;if(void 0===value){var r=rx.exec(className);return r?void 0===r[1]?!0:r[1]:""}className=className.replace(rx," ").trim(),value!==!1&&""!==value&&(className+=" "+name+(value===!0?"":"_"+value)),node.className=className},nb.node.delMod=function(node,name){nb.node.setMod(node,name,!1)}}(),function(){var _factories={},_docEvents={},_domEvents=["click","dblclick","mouseup","mousedown","keydown","keypress","keyup","input","change","blur","mouseover","mouseout","focusin","focusout"],_rx_domEvents=new RegExp("^("+_domEvents.join("|")+")\\b\\s*(.*)?$"),_id=0,_cache={},_getName=function(node){var _data_nb=node.getAttribute("data-nb");return _data_nb?_data_nb.trim().replace(/\s+/g," "):_data_nb},_getNames=function(name){return name.split(/\s+/)},Block=function(){};Block.prototype.__init=function(node){this.node=node,this.$node=$(node),this.__handlers={},this.__bindEvents(),this.trigger("init"),space&&nb.trigger("inited:"+this.id,this)},Block.prototype.__bindEvents=function(){for(var that=this,mixinEvents=Factory.get(this.name).events,i=0,l=mixinEvents.length;l>i;i++){var events=mixinEvents[i].custom,local=mixinEvents[i].local;for(var event in events)!function(handlers){that.__bindCustomEvent(event,function(e,params){for(var i=handlers.length;i--;){var r=handlers[i].call(that,e,params);if(r===!1||null===r)return r}})}(events[event]);for(var event in local)for(var selector in local[event])for(var suffix=(selector||"").length?" "+selector:"",eventDefinition=event+suffix,handlers=local[event][selector],i=0;i<handlers.length;i++)!function(handler){that.on(eventDefinition,function(){handler.apply(that,arguments)})}(handlers[i])}},Block.prototype.destroy=function(){for(var mixinEvents=Factory.get(this.name).events,i=0,l=mixinEvents.length;l>i;i++){for(var event in mixinEvents[i].custom)this.off(event);for(var event in mixinEvents[i].local)this.off(event)}_cache[this.id]=null},Block.prototype.__getHandlers=function(name){var handlers=this.__handlers;return handlers[name]||(handlers[name]=[])},Block.prototype.on=function(name,handler){var r=_rx_domEvents.exec(name);return r?this.$node.on(r[1],r[2]||"",handler):this.__bindCustomEvent(name,handler),handler},Block.prototype.__bindCustomEvent=function(name,handler){this.__getHandlers(name).push(handler)},Block.prototype.off=function(name,handler){var r=_rx_domEvents.exec(name);if(r)this.$node.off(r[1],r[2]||"",handler);else if(handler){var handlers=this.__getHandlers(name),i=handlers.indexOf(handler);-1!==i&&handlers.splice(i,1)}else this.__handlers[name]=null},Block.prototype.trigger=function(name,params){for(var handlers=this.__getHandlers(name).slice(),i=0,l=handlers.length;l>i;i++)handlers[i].call(this,name,params)},Block.prototype.nbdata=function(key,value){return nb.node.data(this.node,key,value)},Block.prototype.show=function(){this.$node.removeClass("_hidden"),this.trigger("show")},Block.prototype.hide=function(){this.$node.addClass("_hidden"),this.trigger("hide")},Block.prototype.getMod=function(name){return nb.node.setMod(this.node,name)},Block.prototype.setMod=function(name,value){nb.node.setMod(this.node,name,value)},Block.prototype.delMod=function(name){nb.node.setMod(this.node,name,!1)},Block.prototype.children=function(){for(var children=[],$nodes=this.$node.find("[data-nb]"),i=0,l=$nodes.length;l>i;i++)children=children.concat(nb.blocks($nodes[i]));return children},nb.Block=Block;var Factory=function(name,ctor,events){this.name=name,ctor.prototype.name=name,this.ctor=ctor,this.events=this._prepareEvents(events)};Factory.prototype._prepareEvents=function(events){events=events||{};var proto=this.ctor.prototype,dom={},custom={},local={};for(var event in events){var handlers,key,r=_rx_domEvents.exec(event);if(r){var type=r[1];handlers="blur"===type?local[type]||(local[type]={}):dom[type]||(dom[type]={}),key=r[2]||""}else handlers=custom,key=event;var handler=events[event];"string"==typeof handler&&(handler=proto[handler]),null===handler?handlers[key]=null:(handlers=handlers[key]||(handlers[key]=[]),handlers.push(handler))}for(var type in dom)_docEvents[type]||($(document).on(type,function(e){return e.button&&"click"===e.type?void 0:Factory._onevent(e)}),_docEvents[type]=!0);return[{dom:dom,custom:custom,local:local}]},Factory.prototype.create=function(node,events){var id=node.getAttribute("id");if(id||(id="nb-"+_id++,node.setAttribute("id",id)),_cache[id]||(_cache[id]={},null===_getName(node)&&node.setAttribute("data-nb",this.name)),!_cache[id][this.name]){var block=new this.ctor;if(block.id=id,block.__init(node),events)for(var event in events)block.on(event,events[event]);_cache[id][this.name]=block}return _cache[id][this.name]},Factory.prototype._extendEvents=function(base){function extend(dest,src){for(var key in src){var s_handlers=src[key],d_handlers=dest[key];dest[key]=null===d_handlers?[]:s_handlers.concat(d_handlers||[])}}var t_dom=this.events[0].dom,b_dom=base.events[0].dom;for(var event in b_dom)extend(t_dom[event]||(t_dom[event]={}),b_dom[event]);extend(this.events[0].custom,base.events[0].custom)},Factory._onevent=function(e){function findBlockNodes(){blockNode=null;for(var parent;parent=node.parentNode;){if(name=_getName(node)){blockNode=node;break}nodes.push(node),node=parent}return blockNode?(isHover&&fromNode&&(nodes=origNode===blockNode?[]:[origNode]),n=nodes.length,!0):void 0}function checkEvents(blockName,events){if(events){for(var R,node,$node,i=0;n>i;i++){node=nodes[i],$node=$nodes[i]||($nodes[i]=$(node));for(var selector in events)if(selector&&$node.is(selector)&&!(isHover&&fromNode&&$.contains(node,fromNode))){var r=doHandlers(node,blockName,events[selector]);r===!1&&(R=r)}if(R===!1)return R}var handlers=events[""];return!handlers||isHover&&fromNode&&$.contains(blockNode,fromNode)?void 0:doHandlers(blockNode,blockName,handlers)}}function doHandlers(node,blockName,handlers){for(var block=factory.create(blockNode),i=handlers.length;i--;){var r=handlers[i].call(block,e,node);if(r===!1)return!1;if(null===r)break}}var nodes,n,$nodes,blockNode,name,factory,type=e.type,origNode=e.target,isHover="mouseover"===type||"mouseout"===type,fromNode=e.relatedTarget,node=origNode;for(nodes=[],$nodes=[],n=nodes.length;;){if(!findBlockNodes())break;for(var names=_getNames(name),r=!0,j=0;j<names.length;j++){var blockName=names[j];factory=Factory.get(blockName);for(var mixinEvents=factory.events,i=0,l=mixinEvents.length;l>i;i++)checkEvents(blockName,mixinEvents[i].dom[type])===!1&&(r=!1)}if(!r)return!1;if(fromNode)return;nodes.push(node),$nodes.push($(node)),n=nodes.length,node=node.parentNode}},Factory.get=function(name){return _factories[name]},nb.hasBlock=function(node,blockName){var id=node.getAttribute("id");return!(!id||!_cache[id]||blockName&&!_cache[id][blockName])},nb.block=function(node,events,blockName){var name=_getName(node);return name?blockName?Factory.get(blockName).create(node,events):nb.blocks(node,events)[0]:null},nb.blocks=function(node,events){var name=_getName(node);if(!name)return[];for(var names=_getNames(name),blocks=[],i=0;i<names.length;i++)blocks.push(Factory.get(names[i]).create(node,events));return blocks},nb.find=function(id){var node=document.getElementById(id);return node?nb.block(node):void 0},nb.define=function(name,methods,base){"string"!=typeof name&&(base=methods,methods=name,name="nb-"+_id++),base&&(base=Factory.get(base));var events=methods.events;delete methods.events;var ctor=function(){};nb.inherit(ctor,base?base.ctor:Block),nb.extend(ctor.prototype,methods);var factory=new Factory(name,ctor,events);return base&&factory._extendEvents(base),_factories[name]=factory,factory},nb.init=function(where){where=where||document;for(var nodes=$(where).find("._init").addBack().filter("._init"),i=0,l=nodes.length;l>i;i++)nb.block(nodes[i])},nb.destroy=function(where){where=where||document;for(var nodes=$(where).find("._init").addBack().filter("._init"),i=0,l=nodes.length;l>i;i++){var node=nodes[i],id=node.getAttribute("id"),blocks=_cache[id];if(blocks)for(var name in blocks)blocks[name].destroy()}};var space=nb.define({events:{click:function(e){nb.trigger("space:click",e.target)}}}).create(document.getElementsByTagName("html")[0]);nb.on=function(name,handler){return space.on(name,handler)},nb.off=function(name,handler){space.off(name,handler)},nb.trigger=function(name,params){space.trigger(name,params)},$(function(){nb.init()})}(),nb.vec={},nb.vec.add=function(a,b,s){return s=s||1,[a[0]+s*b[0],a[1]+s*b[1]]},nb.vec.mulS=function(a,b){return a[0]*b[0]+a[1]*b[1]},nb.vec.mulM=function(m,a){return[nb.vec.mulS(m[0],a),nb.vec.mulS(m[1],a)]},nb.vec.scale=function(a,b){return b="number"==typeof b?[b,b]:b,[a[0]*b[0],a[1]*b[1]]},nb.vec.dir2vec=function(dir){return[nb.vec.dirs[dir[0]],nb.vec.dirs[dir[1]]]},nb.vec.dirs={left:-1,center:0,right:1,top:-1,bottom:1},nb.vec.flipDir={left:"right",right:"left",top:"bottom",bottom:"top"},nb.rect=function(node){if(node instanceof Array)return[node,[0,0]];var size,$node=$(node),offset=$node.offset()||{};return $node.hasClass("_hidden")?($node.toggleClass("_invisible",!0),$node.toggleClass("_hidden",!1),size={width:$node.outerWidth(),height:$node.outerHeight()},$node.toggleClass("_hidden",!0),$node.toggleClass("_invisible",!1)):size={width:$node.outerWidth(),height:$node.outerHeight()},[[offset.left,offset.top],[size.width,size.height]]},nb.rect.move=function(r,a){return[nb.vec.add(r[0],a),r[1]]},nb.rect.norm=function(r){var x=r[0],y=nb.vec.add(x,r[1]),a=[Math.min(x[0],y[0]),Math.min(x[1],y[1])],b=[Math.max(x[0],y[0]),Math.max(x[1],y[1])];return[a,nb.vec.add(b,a,-1)]},nb.rect.trans=function(r,m){return r=[nb.vec.mulM(m,r[0]),nb.vec.mulM(m,r[1])],nb.rect.norm(r)},nb.rect.dir2vec=function(r,dir){var h=nb.vec.scale(r[1],.5),c=nb.vec.add(r[0],h),d=nb.vec.scale(nb.vec.dir2vec(dir),h);return nb.vec.add(c,d)},nb.rect.adjust=function(what,where,how){var a=nb.rect.dir2vec(what,how.what),b=nb.rect.dir2vec(where,how.where);return{rect:nb.rect.move(what,nb.vec.add(b,a,-1)),point:b}},window.nb=nb,function($,nb){function getOptions(){return{}}function oninit(){this.options=this.getOptions(),this.$tail=this.$node.find(this.options.tail_selector||".popup__tail"),this.hasTail=!!this.$tail.length}function ontoggle(e,params){var where=params.where;return this.where&&(where===this.where||where instanceof Array&&where[0]===this.where[0]&&where[1]===this.where[1])?void this.trigger("close"):void this.trigger("open",params)}function onopen(e,params){if(this.where=params.where,this.how=params.how,this.toggler=params.toggler,this.parent=params.parent,this.size=params.size,this._placeholder||(this._placeholder=$('<s class="_hidden"/>').insertBefore(this.node)),!("popup"!==this._type||this.parent||this.where instanceof Array)){var parent=$(this.where).parentsUntil($holder(),"[data-nb]").last()[0];parent&&(parent=nb.block(parent),"popup"===parent._type&&(this.parent=parent))}this.$node.detach(),nb.trigger("popup-before-open",this),"modal"===this._type?$paranja().append(this.node).show():($holder(!0).append(this.node),this._move()),this.show(),nb.trigger("popup-opened",this)}function onclose(){return this.where=null,this.toggler=null,this.parent=null,this.trigger("popup-before-close"),nb.trigger("popup-before-close",this),"modal"===this._type&&$paranja().hide(),this.hide(),this._placeholder&&this._placeholder.after(this.node),nb.trigger("popup-closed",this),!1}function onmove(){this._move()}function move(){if(!this.modal){var tailDir,how=normalizeHow(this.how),MIN_LEFT=this.options.tail_offset||27,TAIL_WIDTH=this.options.tail_width||10,orig_what=nb.rect(this.node),where=nb.rect(this.where),adj_what=nb.rect.adjust(orig_what,where,how),what=adj_what.rect,needTail=this.hasTail&&(tailDir=tailDirs(how.what,how.where));if(needTail){this.setMod("popup_to",tailDir[1]);var css={left:"",right:"",top:"",bottom:""};if("center"!==tailDir[0]){var x,y,offset2origin=nb.vec.scale(adj_what.point,-1),transform=transforms[tailDir.join(" ")],t_what=nb.rect.trans(nb.rect.move(what,offset2origin),transform),t_where=nb.rect.trans(nb.rect.move(where,offset2origin),transform),r=Math.min(t_what[1][0]/2,t_where[1][0]/2);
r>=MIN_LEFT?x=r:(x=MIN_LEFT,t_what=nb.rect.move(t_what,[r-MIN_LEFT,0])),t_what=nb.rect.move(t_what,[0,TAIL_WIDTH]),what=nb.rect.move(nb.rect.trans(nb.rect.trans(nb.rect.trans(t_what,transform),transform),transform),adj_what.point);var tailOffset=nb.vec.mulM(transform,nb.vec.mulM(transform,nb.vec.mulM(transform,[x,0])));x=tailOffset[0],y=tailOffset[1];var AUTO="auto";x>0?(css.left=x,css.right=AUTO):0>x?(css.left=AUTO,css.right=-x):y>0?(css.top=y,css.bottom=AUTO):(css.top=AUTO,css.bottom=-y)}else what=nb.rect.move(what,nb.vec.scale(nb.vec.dir2vec(how.where),TAIL_WIDTH));this.$tail.css(css).show()}else this.$tail.hide();if(this.$node.css({left:what[0][0],top:what[0][1]}),this.size){var sizeCss={};this.size.width&&(sizeCss.width=$(this.size.width).outerWidth()),this.size.height&&(sizeCss.height=$(this.size.height).outerHeight()),this.$node.css(sizeCss)}}}function normalizeHow(how){how=how||{dir:"bottom"};var what,where;return how.dir?(what=nb.vec.flipDir[how.dir],where=how.dir):(what=how.what,where=how.where),{what:normalizeDir(what),where:normalizeDir(where)}}function normalizeDir(dir){dir=dir||"";var parts;switch(dir){case"":parts=["center","center"];break;case"left":case"right":case"center":parts=[dir,"center"];break;case"top":case"bottom":parts=["center",dir];break;default:parts=dir.split(/\s+/),(/^(?:left|right)/.test(parts[1])||/^(?:top|bottom)/.test(parts[0]))&&(parts=[parts[1],parts[0]])}return parts}function tailDirs(what,where){return what[0]===where[0]&&nb.vec.flipDir[what[1]]===where[1]?where:what[1]===where[1]&&nb.vec.flipDir[what[0]]===where[0]?[where[1],where[0]]:void 0}function show(){this.$node.removeClass("_hidden"),this.trigger("show")}function hide(){this.$node.addClass("_hidden"),this.trigger("hide")}function destroy(){this.trigger("close"),this._placeholder&&this._placeholder.remove(),nb.Block.prototype.destroy.call(this)}function isPopup(){return!0}var transforms={"left bottom":[[1,0],[0,1]],"right bottom":[[-1,0],[0,1]],"top left":[[0,1],[-1,0]],"bottom left":[[0,-1],[-1,0]],"right top":[[-1,0],[0,-1]],"left top":[[1,0],[0,-1]],"bottom right":[[0,-1],[1,0]],"top right":[[0,1],[1,0]]},base={events:{init:oninit,toggle:ontoggle,open:onopen,close:onclose,move:onmove,"click .popup__close":onclose},getOptions:getOptions,_move:move,show:show,hide:hide,isPopup:isPopup,destroy:destroy};base=nb.define(base);var $paranja=function(){var div=$('<div class="paranja paranja_theme_dark"/>').appendTo("body").hide();return $paranja=function(){return div},div},$holder=function(){var div=$('<div class="popup-holder"/>').appendTo("body");return $holder=function(append){return append&&!div.is(":last-child")&&div.appendTo("body"),div},div};nb.define("tooltip",{_type:"tooltip"},base.name),nb.define("popup",{_type:"popup"},base.name),nb.define("modal",{_type:"modal"},base.name),nb.define("ballon",{_type:"ballon"},base.name),nb.on("popup-before-open",function(e,popup){var opened=$holder().children();switch(popup._type){case"tooltip":for(var i=opened.length;i>0;i--){var p=nb.block(opened[i-1]);"tooltip"===p._type&&p.trigger("close")}break;case"modal":for(var i=opened.length;i>0;i--)nb.block(opened[i-1]).trigger("close");break;case"ballon":break;default:for(var i=opened.length;i>0;i--){var p=nb.block(opened[i-1]);if(popup.parent===p)break;"tooltip"!==p._type&&p.trigger("close")}}}),nb.on("popup-before-close",function(e,popup){switch(popup._type){case"tooltip":break;case"modal":for(var opened=$holder().children(),i=opened.length;i>0;i--)nb.block(opened[i-1]).trigger("close");break;default:for(var nextAll=$(popup.node).nextAll(),i=0;i<nextAll.length;i++){var p=nb.block(nextAll[i]);if(p&&"popup"===p._type){p.trigger("close");break}}}}),nb.on("keydown",function(e){if(27===e.keyCode){var popup,popupNode=$holder().children().last()[0];if(!popupNode)return popupNode=$paranja().children().last()[0],popupNode&&(popup=nb.block(popupNode),!popup.ignoreEsc)?(popup.trigger("close"),e.stopImmediatePropagation(),!1):void 0;if(popup=nb.block(popupNode),!popup.ignoreEsc)return nb.block(popupNode).trigger("close"),e.stopImmediatePropagation(),!1}}),nb.on("space:click",function(e,node){var popup;return popup=$holder().children().has(node).add($holder().children().filter(node)),popup.length?(popup=popup.next(),void(popup.length&&nb.block(popup[0]).trigger("close"))):$holder().children().length?(popup=nb.block($holder().children().first()[0]),void(popup.ignoreEsc||popup.trigger("close"))):void($paranja().has(node).length||(popup=$paranja().children().last()[0],popup&&(popup=nb.block(popup),popup.ignoreEsc||popup.trigger("close"))))}),nb.on("popup-close",function(){$holder().children().length&&nb.block($holder().children().first()[0]).trigger("close"),$paranja().children().length&&nb.block($paranja().children().first()[0]).trigger("close")}),nb.popup={someOpen:function(){return!!$holder().children().length||!!$paranja().children().length},closeAll:function(){for(var opened=$holder().children(),i=opened.length;i>0;i--){var p=nb.block(opened[i-1]);p&&p.isPopup()&&p.trigger("close")}}}}(jQuery,nb),nb.define("popup-toggler",{events:{click:"onclick"},onclick:function(){if(!this.getMod("_disabled")){var popup=this.getPopup();if(popup){var data=this.nbdata("popup-toggler");return popup.trigger("toggle",{where:data.where||this.node,how:data.how,toggler:this.node,size:data.size}),!1}}},getPopup:function(){if(!this._popup){var data=this.nbdata("popup-toggler");this._popup=nb.find(data.id)}return this._popup}}),nb.define("tooltip-toggler",{events:{mouseover:"showTooltip",mouseout:"hideTooltip"},showTooltip:function(){if(!this.getMod("_disabled")){var tooltip=this.getTooltip();if(tooltip){var data=this.nbdata("tooltip-toggler");return tooltip.trigger("open",{where:data.where||this.node,how:data.how}),!1}}},hideTooltip:function(){var tooltip=this.getTooltip();return tooltip?(tooltip.trigger("close"),!1):void 0},getTooltip:function(){if(!this._tooltip){var data=this.nbdata("tooltip-toggler");this._tooltip=nb.find(data.id)}return this._tooltip}}),function($,doc){var suggest={};suggest.events={init:"onInit",keydown:"onKeyDown",keyup:"onKeyUp",click:"onFocusIn",focusin:"onFocusIn",input:"onInput"},suggest.onInit=function(){this.delay=this.getDataNumber("delay",300),this.min_length=this.getDataNumber("min_length",1),this.max_items=this.getDataNumber("max_items",-1),this.ignore_case=this.getDataBool("ignore_case"),this.label_key=this.getDataString("label-key","label"),this.source_url=this.getDataString("source-url"),this.response_timeout=this.getDataNumber("timeout",1e4),this.scroll_min=this.getDataNumber("scroll-min",-1),this.expand_to_input=this.getDataBool("expand-popup-to-input"),this.show_loader=this.getDataBool("show-loader"),this.show_fade=this.getDataBool("show-fade"),this.highlight_match=this.getDataBool("highlight-matches"),this.focusin_show=this.getDataBool("focusin-show"),this.theme_class=this.getDataString("theme-class",""),this.search_param_name=this.getDataString("search-param-name","text"),this.max_param_name=this.getDataString("max-param-name","max"),this.default_params=this.getDataObject("default_params",{}),this.popup_selector=this.getDataString("popup-selector"),this.$input=this.$node,this._text=null,this._suggest_text=null,this._selected=null,this._html={},this._createPopup(),this._popup_opened=!1,this.createDataSource(),this._getDataTimeout=null,nb.trigger("inited:"+this.node.id,this)},suggest.getDataNumber=function(key,default_value){var value=+this.nbdata(key);return isNaN(value)?default_value:value},suggest.getDataBool=function(key){return"true"===(this.nbdata(key)||"").toLowerCase()},suggest.getDataString=function(key,default_value){return this.nbdata(key)||default_value},suggest.getDataObject=function(key,default_value){return this.nbdata(key)||default_value},suggest.onFocusIn=function(){!this.focusin_show||this._popup_opened||!this._text&&0!==this.min_length||this.suggest(this._text)},suggest._createPopup=function(){var that=this;if(this.$popup=this.popup_selector?this.$node.next(this.popup_selector):$('<div class="popup popup_theme_blocky popup_to_top" data-nb="popup"><div class="suggest-scrollbox"></div></div>').addClass(this.theme_class).appendTo(doc.body),this.show_loader){var $input=this.$input,offset=$input.offset(),width=$input.outerWidth();this.$loader=$('<div class="loader_new"></div>').insertBefore(this.$popup);var loader_width=this.$loader.outerWidth();this.$loader.css({left:offset.left+width-loader_width,top:offset.top})}this.$popup_wrapper=this.$popup.find(".suggest-scrollbox"),this.popup=nb.block(this.$popup[0],{"mouseover .suggest-scrollbox li":function(evt){that.setCurrent(evt.target)},"click .suggest-scrollbox li":function(evt){var $item=$(evt.target).closest("li");that.selectItem($item)},close:function(){that._popup_opened=!1}})},suggest.onKeyDown=function(evt){return 38==evt.keyCode?void evt.preventDefault():void 0},suggest.onKeyUp=function(evt){if(13==evt.keyCode)return evt.preventDefault(),void this.selectItem();if(this._isReady()){if(27==evt.keyCode)return void this._reset();if(38==evt.keyCode)return evt.preventDefault(),void this.changeCurrent(-1);if(40==evt.keyCode)return evt.preventDefault(),void this.changeCurrent(1);var text=this.$input.val().trim();text!==this._text&&(this._text=text,this.suggest(text))}},suggest.onInput=function(){var text=this.$input.val().trim();text!==this._text&&(this._text=text,this.suggest(text))},suggest.suggest=function(text){var that=this;return text=text||"",this._getDataTimeout&&clearTimeout(this._getDataTimeout),text.length<this.min_length?void this.popup.trigger("close"):void(this._data.has(text)?this._showFor(text):this._getDataTimeout=setTimeout(function(){that._requestData(text)},this.delay))},suggest.clear=function(){this.$input.val(""),this._text="",this._selected=null},suggest._reset=function(){this.$input.val(this._text)},suggest.createDataSource=function(){if(this.source_url){var params={url:this.source_url,retry_count:3,max_items:this.max_items,timeout:this.response_timeout,query_param_name:this.search_param_name,max_param_name:this.max_param_name,default_params:this.default_params};this._data=(new nb.suggest.ajaxDS).init(params)}},suggest.setArrayData=function(options){this._data=(new nb.suggest.arrayDS).init(options)},suggest.setDataSource=function(ds){this._data=ds},suggest._requestData=function(text){var that=this;this._data.get({key:text,onstart:function(){that.showLoader()},onsuccess:function(){that._showFor(text),that.hideLoader()},onfail:function(){that.hideLoader()}})},suggest._showFor=function(text){if(this.$input.val().trim()===text){var data=this._data.getSync(text);if(data.length<=0)return void this.popup.trigger("close");this._suggest_text=text,this.showSuggest();var suggest=this.renderSuggest(text,data);this.$suggest_container=suggest.container,this.$suggest_container.find("li.current").toggleClass("current",!1),this.$popup_wrapper.css(suggest.scroll_height?{"max-height":suggest.scroll_height,"overflow-y":"scroll"}:{"max-height":"",overflow:""})}},suggest.renderSuggest=function(text,data){var that=this,suggest=this._html[text];if($("ul",this.$popup_wrapper).remove(),suggest)return this.$popup_wrapper.append(suggest.container),suggest;var $container=$("<ul/>");this.$popup_wrapper.append($container),data.forEach(function(item){var $item=that.renderItem(item);$container.append($item)});var scroll_height;if(this.scroll_min>0&&data.length>this.scroll_min){var $items=$container.find("li");scroll_height=0;for(var i=0;i<this.scroll_min;i++)scroll_height+=$($items[i]).outerHeight()}return suggest={container:$container,scroll_height:scroll_height},this._html[text]=suggest,suggest},suggest.showSuggest=function(){return this._popup_opened?!1:(this.expand_to_input&&this.$popup.css("width",this.$input.outerWidth()),this.popup.trigger("open",{where:this.node,how:{where:"left bottom",what:"left top"}}),this._popup_opened=!0,!0)},suggest.renderItem=function(item){var label_html,label=item[this.label_key]||"";label_html=this.highlight_match?this.hightlightMatches(label,this._suggest_text):"<span>"+label+"</span>";var $item=$("<li></li>").attr("title",label).html(label_html);return this.show_fade&&$item.append('<div class="fader"></div>'),$item},suggest.hightlightMatches=function(text,match){var index;if(!text||!match)return"";for(var text_low=text.toLowerCase(),text_length=text.length,match_low=match.toLowerCase(),match_length=match.length,cur_index=0,parts=[];(index=text_low.indexOf(match_low,cur_index))>=0;)index>cur_index&&parts.push("<span>"+text.substring(cur_index,index)+"</span>"),parts.push('<span class="match">'+text.substring(index,index+match_length)+"</span>"),cur_index=index+match_length;return text_length>cur_index&&parts.push("<span>"+text.substring(cur_index,text_length)+"</span>"),parts.join("")},suggest.setCurrent=function(node){$("li.current",this.$suggest_container).toggleClass("current",!1),$(node).closest("li").toggleClass("current",!0)},suggest.changeCurrent=function(dir){var $suggest=this.$suggest_container,$selected=$("li.current",$suggest),$items=$suggest.find("li");if($selected.toggleClass("current",!1),!this._popup_opened)return void this.suggest(this._text);if($items.length){if(dir>0){var $next=$selected.nextAll("li:first");0===$selected.length?($("li:first",$suggest).addClass("current"),this.$input.val(this.getText(0))):0===$next.length?this.$input.val(this._suggest_text):($next.addClass("current"),this.$input.val(this.getText($items.index($selected)+1)))}else{var $prev=$selected.prevAll("li:first");if(0===$selected.length){var $item=$("li:last",$suggest).addClass("current");this.$input.val(this.getText($items.index($item)))}else 0===$prev.length?this.$input.val(this._suggest_text):($prev.addClass("current"),this.$input.val(this.getText($items.index($selected)-1)))}this.scrollCurrentIntoView()}},suggest.getCached=function(index){var text=this._suggest_text;if(this._data.has(text))for(var items=this._data.getSync(text),label_key=this.label_key,i=0,pos=0;i<items.length;i++){var item=items[i];if(item[label_key]){if(pos===index)return item;pos++}}return{}},suggest.getText=function(index){var cached=this.getCached(index);return cached[this.label_key]?cached[this.label_key]:""},suggest.selectItem=function($item){var $suggest=this.$suggest_container;$suggest||($item=$("")),$item=$item||$suggest.find("li.current");var text,$input=this.$input,success=!1;if(this._selected=null,0===$item.length)text=$input.val(),this._selected=this._getInputValue();else{var index=$suggest.find("li").index($item);text=this.getText(index),$input.val(text),this._selected=this.getCached(index),success=!!text}return this._text=text,this.popup.trigger("close"),this.trigger("selected",this._selected),success},suggest.getCurrentValue=function(){return this._selected||this._getInputValue()},suggest._getInputValue=function(){var text=this.$input.val();return this._selected||{label:text}},suggest.showLoader=function(){this.$loader&&this.$loader.toggleClass("loader_new__show",!0)},suggest.hideLoader=function(){this.$loader&&this.$loader.toggleClass("loader_new__show",!1)},suggest.scrollCurrentIntoView=function(){var dy=3,$current=this.$suggest_container.find("li.current");if($current.length){var wrapper=this.$popup_wrapper[0],top=wrapper.scrollTop+dy,height=this.$popup_wrapper.outerHeight(),bottom=top+height,cur_top=wrapper.scrollTop+$current.position().top,cur_height=$current.outerHeight(),cur_bottom=cur_top+cur_height;cur_bottom>bottom&&(wrapper.scrollTop=cur_bottom-height-dy),top>cur_top&&(wrapper.scrollTop=cur_top-dy)}},suggest._isReady=function(){return!!this.$suggest_container},nb.define("suggest",suggest)}(jQuery,document),function($){var ds=function(){};ds.prototype.init=function(options){return this.options=options,this.cache={},this},ds.prototype.has=function(key){return key.toLowerCase()in this.cache},ds.prototype.get=function(){},ds.prototype.getSync=function(key){return this.cache[key.toLowerCase()]},ds.prototype.prepareData=function(data){return data};var ajaxDS=function(){};nb.inherit(ajaxDS,ds),ajaxDS.prototype.init=function(options){return ds.prototype.init.call(this,options),this._requests={},this.url=options.url,this.retry_count="undefined"==typeof options.retry_count?3:+options.retry_count,this.max_items=options.max_items,this.timeout=options.timeout,this.dataType=options.dataType||"jsonp",this},ajaxDS.prototype.get=function(req){var query=req.key.toLowerCase();query in this._requests||this._createRequest(req),this._requests[query].retry()},ajaxDS.prototype.createRequestData=function(text){var query={};return query[this.options.query_param_name]=text,query[this.options.max_param_name]=this.max_items,nb.extend({},this.options.default_params,query)},ajaxDS.prototype._createRequest=function(req){var that=this,query=req.key.toLowerCase();if(!(query in this._requests)){var request={retries_left:this.retry_count,retry:null};request.retry=function(){if(0===request.retries_left)return req.onfail(),void delete that._requests[query];req.onstart();var params=that.createRequestData(query);$.ajax({url:that.url,type:"GET",data:params,dataType:that.dataType,success:function(data){var parsed_data=that.prepareData(data,!params.q);that.cache[query]=parsed_data,req.onsuccess(parsed_data)},error:function(){request.retry()},timeout:that.timeout}),request.retries_left--},this._requests[query]=request}};var arrayDS=function(){};nb.inherit(arrayDS,ds),arrayDS.prototype.init=function(options){return ds.prototype.init.call(this,options),this._keys=null,this.key_name=options.key,this.ar=this.prepareData(options.data),this},arrayDS.prototype.prepareData=function(ar){return ar=ar.slice(0)},arrayDS.prototype.get=function(req){function match(key,query){return key.indexOf(query)>=0}var item,key,i,found=[],ar=this.ar,keys=this._keys,key_name=this.key_name,query=req.key.toLowerCase();if(req.onstart(),query in this.cache)return void req.onsuccess(this.cache[query]);if(keys)for(i=0;i<keys.length;i++)item=ar[i],key=keys[i],match(key,query)&&found.push(item);else for(keys=this._keys=[],i=0;i<ar.length;i++)item=ar[i],key=keys[i]=(""+item[key_name]).toLowerCase(),match(key,query)&&found.push(item);this.cache[query]=found,req.onsuccess(found)},nb.suggest={},nb.suggest.ds=ds,nb.suggest.ajaxDS=ajaxDS,nb.suggest.arrayDS=arrayDS}(jQuery),function(){var _id=0,node2error={},fieldErrorDefaults={isError:!0,errorClass:"is-wrong",buttons:"",ok:function(){},retry:function(){},cancel:function(){}},popupDefaultOptions={how:{dir:"right"}},findParentPopup=function(node){var parent=$(node).parentsUntil(".popup-holder","[data-nb]").last()[0];return parent&&(parent=nb.block(parent),"popup"===parent._type)?parent:null};nb.define("field-error",{showFor:function(element,options,context){this.context=context,this.options=no.extend({returnValue:!1},fieldErrorDefaults,options),element&&$(element).is(":visible")&&(this.element=element,this.$element=$(element),this.elementId=this._getNodeId(this.element)),this.element?this._showPopupForElement():this._showModalPopup(),this.options.isError&&this._highlight(),this.options.focus&&this._focusOnElement()},cancel:function(){this.popup?this.popup.trigger("close"):this.destroy()},_getNodeId:function(node){var id=node.getAttribute("id");return id||(id="ph-"+_id++,node.setAttribute("id",id)),id},_highlight:function(){this.$element&&this.$element.toggleClass(this.options.errorClass,!0)},_focusOnElement:function(){this.$element&&this.$element.focus()},_showPopupForElement:function(){var that=this,data=this._getPopupData(),okClicked=!1,popupNode=$(ns.renderNode(data,"error-popup")).appendTo(document.body)[0],popup=this.popup=nb.block(popupNode,{click:function(){return okClicked=!0,that.options.ok(),that._focusOnElement(),popup.trigger("close"),that.options.returnValue},close:function(){okClicked||that.options.cancel(),that.destroy()}}),popupOptions=no.extend({where:this.element},popupDefaultOptions,this.options.popup),id=this.elementId;node2error[id]&&node2error[id].destroy(),node2error[id]=this,this.popup.trigger("toggle",popupOptions);var closeError=function(){that.popup&&that.popup.trigger("close")};this.$element.bind("click.error",function(){return $(popupNode).trigger("click"),!1}).bind("input.error",closeError).bind("keydown.error",closeError);var parentPopup=findParentPopup(this.element);parentPopup&&parentPopup.on("popup-before-close",closeError)},_showModalPopup:function(){var that=this,data=this._getPopupData(),okClicked=!1,cancelClicked=!1,popupNode=$(ns.renderNode(data,"error-ballon")).appendTo(document.body)[0],ok=function(){okClicked=!0,popup.trigger("close"),ph.actions.restorePage(that.context).then(function(){that.options.ok()})},popup=this.popup=nb.block(popupNode,{click:function(evt){return $(evt.target).closest(".js-error-close").length||data.buttons?void 0:(ok(),that.options.returnValue)},"click .js-ok":function(){return ok(),!1},"click .js-cancel":function(){return cancelClicked=!0,that.options.cancel(),popup.trigger("close"),!1},"popup-before-close":function(){okClicked||cancelClicked||that.options.cancel(),that.destroy()}});popup.ignoreEsc=!0,ph.errors.addItem(popup)},_getPopupData:function(){var data=this.options.data,message=this.options.message||ns.renderString(data,this.options.messageId);ns.assert(message,"field-error","error message must be set");var title=ns.renderString(data,this.options.titleId);return no.extend({title:title,message:message,buttons:this.options.buttons},data)},destroy:function(){this._destroyed||(this._destroyed=!0,this.popup&&(this.popup.trigger("ph-destroy"),this.popup.destroy(),ns.removeNode(this.popup.node),this.popup=null),this.$element&&(this.$element.unbind(".error"),this.$element.removeClass(this.options.errorClass),this.$element=null,node2error[this.elementId]===this&&(node2error[this.elementId]=null)),this.context&&this.context.destroy(),nb.Block.prototype.destroy.call(this))}})}(),nb.define("textarea-autoheight",{events:{init:"onInit",input:"updateHeight"},onInit:function(){var that=this;this.$node=$(this.node),setTimeout(function(){that.updateHeight()},0),this.setMaxHeight()},setMaxHeight:function(){var minimalExpandHeight=100,windowPartHeight=2*$(window).height()/3,expandHeight=minimalExpandHeight>windowPartHeight?minimalExpandHeight:windowPartHeight;this.$node.css({"max-height":expandHeight,overflow:"hidden"})},updateHeight:function(){this.$node.height(0).height(this.node.scrollHeight),ph.resized()}}),function(){var copyStyle=function($from,prop,dest){var _value=$from.css(prop);_value&&(dest[prop]=_value)},block={};block.events={init:"onInit","click .nb-text":"onTextClick","click .nb-text-edit":"onPencilClick","blur .nb-editable-text__value-new":"onBlur","ph-page-leave":"onBlur"},block.onInit=function(){this._classes={empty:"nb-editable-text__empty-value"},this._nodes={$value:$(".nb-text",this.node),$editor:$(".field",this.node),$newValue:$(".nb-editable-text__value-new",this.node),newValue:$(".nb-editable-text__value-new",this.node)[0]};var _style={};copyStyle(this._nodes.$value,"line-height",_style),copyStyle(this._nodes.$value,"font-size",_style),this._nodes.$editor.css({"line-height":_style["line-height"],padding:_style.padding}),this._nodes.$newValue.css({"line-height":_style["line-height"],"font-size":_style["font-size"]}),this._new_value=nb.block(this._nodes.newValue),this._rawValue=ns.deentityify(this._nodes.$newValue.val()),this._emptyText=this.nbdata().edit.emptyText,this._editEmpty=this.nbdata().edit.editEmpty,this._nowrap=!!this.nbdata().edit.nowrap,this._mode=null,this.setViewMode()},block.resetValue=function(value){this._rawValue=value},block.onTextClick=function(){return this.startEdit(null,!1),!1},block.onPencilClick=function(){return this.startEdit(null,!0),!1},block.startEdit=function(value,viaPencil){this._mode="edit",this._nodes.$value.toggleClass(this._classes.empty,!1),this._nodes.$value.toggleClass("is-hidden",!0),this._nodes.$editor.toggleClass("is-hidden",!1),this.trigger("nb-text-edit",viaPencil),this._nodes.$newValue.val(value||this._rawValue||(this._editEmpty?this._emptyText:"")).focus(),this._new_value.updateHeight(),ph.utils.moveCaretToEnd(this._nodes.newValue)},block.setViewMode=function(saved){this._mode="view",this._nodes.$editor.toggleClass("is-hidden",!0);var displayValue=ns.entityify(this._rawValue||this._emptyText);this._nowrap||(displayValue=ph.utils.nl2br(displayValue)),this._nodes.$value.html(displayValue),this._nodes.$value.toggleClass(this._classes.empty,0===this._rawValue.length),this._nodes.$value.toggleClass("is-hidden",!1),this.trigger("nb-text-edit-end",saved)},block.onBlur=function(){"edit"===this._mode&&this.save(),$("body").focus()},block.save=function(viaKeyboard){var newValue=$.trim(this._nodes.$newValue.val()),changed=this._rawValue!==newValue;return this._rawValue=newValue,this.setViewMode(),changed&&this.trigger("save",{value:newValue,viaKeyboard:viaKeyboard}),!1},block.cancelEdit=function(){"edit"===this._mode&&this.setViewMode(!1)},block.onPressEnter=function(){this.save(!0)},nb.define("editable-text",block),ph.keyboard.registerBlock("editable-text",{enter:{method:"onPressEnter",last:!0,selector:".nb-editable-text__value-new"},esc:{method:"cancelEdit",last:!0,selector:".nb-editable-text__value-new"}})}(),function(){nb.define("editable-tags",{events:{init:"onInit","click .js-editable-tags-view":"onTagsViewClick","click .js-editable-tags-edit-pencil":"onTagsPencilClick","click .js-editable-tags-edit-link":"onTagsLinkClick","blur .js-editable-tags-input":"onBlur","ph-page-leave":"onPageLeave"},onInit:function(){this._class={editable:"editable-tags_edit"},this._nodes={$input:$(".js-editable-tags-input",this.node),input:$(".js-editable-tags-input",this.node)[0]},this._valueOld=this._nodes.$input.val(),this._mode="view"},onTagsViewClick:function(evt){return evt&&$(evt.target).hasClass("js-tag")?void 0:(this.startEdit(),this.metrikaCounter(["tags","start edit","on field"]),!1)},onTagsPencilClick:function(){return this.startEdit(),this.metrikaCounter(["tags","start edit","on pencil"]),!1},onTagsLinkClick:function(){return this.startEdit(),this.metrikaCounter(["tags","start edit","on link"]),!1},startEdit:function(){this.trigger("nb-tags-edit-start"),this._setModeEdit(),this.$inputBlock=nb.block(this._nodes.$input[0]),this.$inputBlock.updateHeight()},startSave:function(viaKeyboard){if("edit"===this._mode){this._setModeView();var newValue=this._nodes.$input.val().trim(),oldValue=this._valueOld.trim();newValue!==oldValue&&(this.trigger("nb-tags-save",{value:newValue}),this.metrikaCounter(["tags","save edit",viaKeyboard?"keyboard":"click"]))}},cancelEdit:function(){this._setModeView(),this._nodes.$input.val(this._valueOld),this.trigger("nb-tags-edit-end"),this.metrikaCounter(["tags","cancel edit"])},_setModeEdit:function(){this._mode="edit",$(this.node).toggleClass(this._class.editable,!0),this._nodes.$input.focus(),ph.utils.moveCaretToEnd(this._nodes.input)},_setModeView:function(){this._mode="view",$(this.node).toggleClass(this._class.editable,!1),$("body").focus()},onBlur:function(){this.startSave()},onPageLeave:function(){this.startSave()},onPressEnter:function(){this.startSave(!0)},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}),ph.keyboard.registerBlock("editable-tags",{enter:{method:"onPressEnter",last:!0,selector:".js-editable-tags-input"},esc:{method:"cancelEdit",last:!0,selector:".js-editable-tags-input"}})}(),function(){var utils=ph.utils,block={};block.events={init:"onInit","click .collapse-text__expander":"onToggle"},block.onInit=function(){var data=this.nbdata();this._classes={main:"collapse-text",collapsed:"collapse-text_collapsed",expanded:"collapse-text_expanded"};var $node=$(this.node);this._nodes={$node:$node,$text:$node.is(".nb-text")?$node:$node.find(".nb-text"),$expander:$(".collapse-text__expander",this.node)};var _rows=data.collapse.rows;this._always=data.collapse.always;var _lineHeight=data["line-height"]||utils.cssValue(this._nodes.$text,"line-height"),_paddingTop=utils.cssValue(this._nodes.$text,"padding-top"),_paddingBottom=utils.cssValue(this._nodes.$text,"padding-bottom");this._textMaxHeight=_rows*_lineHeight,this._paddings=_paddingTop+_paddingBottom,this.enable(!0)},block.collapse=function(){this._toggle(!0)},block.expand=function(){this._toggle(!1)},block.onToggle=function(){return this._toggle(),!1},block.enable=function(tryCollapse){this._nodes.$node.toggleClass(this._classes.main,!0);var needCollapse=this._always||this._nodes.$text.outerHeight(!0)-this._paddings>this._textMaxHeight;needCollapse&&this._nodes.$expander.removeClass("is-hidden");var collapse=tryCollapse&&needCollapse||this._nodes.$node.hasClass(this._classes.collapsed);this._toggle(collapse)},block.disable=function(){this._nodes.$node.toggleClass(this._classes.main,!1),this._nodes.$text.css("max-height","none"),this._nodes.$expander.toggleClass("is-hidden",!0),delete this._collapsed},block.isCollapsed=function(){return this._collapsed},block._toggle=function(collapse){"undefined"==typeof collapse&&(collapse=!this._nodes.$node.hasClass(this._classes.collapsed)),this._collapsed!==collapse&&(this._collapsed=collapse,this._nodes.$node.toggleClass(this._classes.collapsed,collapse),this._nodes.$node.toggleClass(this._classes.expanded,!collapse),this._nodes.$text.css("max-height",collapse?this._textMaxHeight:"none"),this.trigger(collapse?"collapsed":"expanded"))},nb.define("collapse-text",block)}(),nb.define("two-faced-button",{events:{init:function(){this._nodes={$label:$(".js-nb-label",this.node)},this._labels=this.nbdata().labels;var defaultMode=this.nbdata()["default-mode"];defaultMode&&this.setMode(defaultMode)}},setMode:function(mode){var label=this._labels[mode];if(!label)throw"[two-faced-button] unknown mode "+mode;this._nodes.$label.html(label)}}),nb.define("button-group",{events:{init:"onInit","click .js-button:not(.is-checked)":"setAsCurrent","change .js-select":"setAsCurrent"},onInit:function(){this._classes={current:"is-checked",item:"js-button",button:"js-button",select:"js-select"},this.$node=$(this.node)},getValue:function(){var $current=this.$node.find("."+this._classes.current),$select=$current.find("select"),value=$select.val()||$current.data("val");return value},selectFirst:function(){this.$node.find("."+this._classes.item+":first").trigger("click").focus()},setValue:function(value){var $itemToSelect=this.$node.find("."+this._classes.item+'[data-val="'+value+'"]');$itemToSelect?(this._clearCurrent(),$itemToSelect.toggleClass(this._classes.current,!0)):this.selectFirst()},setAsCurrent:function(evt){var _value,$item=$(evt.target).closest("."+this._classes.item),$select=$item.find("select");this._clearCurrent(),$select.length?_value=$select.val():(_value=$item.data("val"),this.$node.find("select").val("")),_value&&$item.toggleClass(this._classes.current,!0),this.trigger("selected",_value)},_clearCurrent:function(){$("."+this._classes.item,this.$node).removeClass(this._classes.current)}}),function(){var base={getOptions:function(){return{tail_selector:".popup-tail",tail_width:12,tail_offset:8}},onInit:function(){var that=this;this._onResize=function(){that.trigger("move")}},onClickClose:function(){return this.trigger("close"),!1},show:function(){var that=this,$node=$(this.node);$node.removeClass("_hidden"),setTimeout(function(){$node.addClass("_show"),that.trigger("ph-show-end")},10),this.trigger("show")},hide:function(){$(this.node).addClass("_hidden").removeClass("_show"),this.trigger("hide")}};nb.define("islands-popup",no.extend(base,{events:{init:"onInit",open:"onOpen",close:"onClose","click .js-close":"onClickClose"},onOpen:function(){nb.on("ph-resize",this._onResize)},onClose:function(){nb.off("ph-resize",this._onResize)}}),"popup"),nb.define("islands-ballon",no.extend(base,{events:{init:"onInit",open:"onOpen",close:"onClose","click .js-close":"onClickClose"},onOpen:function(){nb.on("ph-resize",this._onResize)},onClose:function(){nb.off("ph-resize",this._onResize)}}),"ballon"),nb.define("islands-ballon-fixed",no.extend(base,{events:{init:"onInit","click .js-close":"onClickClose"},isPopup:function(){return!1
},_move:function(){}}),"ballon"),nb.define("islands-modal-popup",no.extend(base,{events:{"click .js-close":"onClickClose"}}),"modal")}(),function(){var GeoSuggestDataSource=function(map){this.map=map};nb.inherit(GeoSuggestDataSource,nb.suggest.ajaxDS),GeoSuggestDataSource.prototype.init=function(){return nb.suggest.ajaxDS.prototype.init.call(this,{url:"//suggest-maps.yandex.ru/suggest-geo",max_items:10,max_param_name:"n",query_param_name:"part",default_params:{v:5,search_type:"tp",highlight:0}}),this},GeoSuggestDataSource.prototype.prepareData=function(data){return data[1].map(function(item){var type=item[0],name=item[1],fullName="geo"===type?item[2]:name;return{name:name,fullName:fullName}})},GeoSuggestDataSource.prototype.createRequestData=function(text){var data=nb.suggest.ajaxDS.prototype.createRequestData.call(this,text),b=this.map.getBounds(),c=this.map.getCenter(),spn1=Math.abs((b[1][1]-b[0][1]).toFixed(6)),spn2=Math.abs((b[1][0]-b[0][0]).toFixed(6));return 1e-6>spn1&&(spn1=360),data.spn=[spn1,spn2].join(","),data.ll=[c[1].toFixed(6),c[0].toFixed(6)].join(","),data},nb.suggest.GeoSuggestDataSource=GeoSuggestDataSource}(),function(){var mapTypes={schema:"yandex#map",satellite:"yandex#satellite",hybrid:"yandex#hybrid"},fotkiMapTypes={schema:"schema","yandex#map":"schema","yandex#satellite":"satellite","yandex#hybrid":"hybrid"};nb.define("map",{events:{init:"oninit","click .js-save:not(.is-disabled)":"onSave","click .js-modify":"startEdit","click .js-cancel":"cancel","click .js-map-remove:not(.is-disabled)":"removeMarker","dblclick .js-location":"panToMarker","ph-map-click":"moveMarker"},oninit:function(){this._mark=null,this._fixedMark=null,this.ready=new Vow.Promise,this._nodes={location:$(".js-location",this.node)[0],$location:$(".js-location",this.node),$save:$(".js-save",this.node),$remove:$(".js-map-remove",this.node),modify:$(".js-modify",this.node)[0]},this.canEdit=!!this._nodes.modify,ph.loadModule("map").then(this.init,this)},init:function(){var that=this,map=this.map=new ymaps.Map($(".map-container",this.node)[0],{center:[55.76,37.64],zoom:7,behaviors:["drag","dblClickZoom","multiTouch","scrollZoom"]}),topOffset=this.canEdit?49:0,typeSelector=new ymaps.control.TypeSelector({mapTypes:["yandex#map","yandex#satellite","yandex#hybrid"]});map.controls.add(typeSelector,{top:8+topOffset,right:8});var zoomControl=new ymaps.control.SmallZoomControl;if(map.controls.add(zoomControl,{top:43+topOffset,right:8}),this.canEdit){this.modifyButton=nb.block(this._nodes.modify),this._handleMapClick();var ds=new nb.suggest.GeoSuggestDataSource(this.map).init(),suggest=this.suggest=nb.block(this._nodes.location);suggest.setDataSource(ds),suggest.on("selected",this.onItemSelected.bind(this)),this._updateButtons()}map.events.add("typechange",function(){that.metrikaCounter(["map","change layer",that.getMapType()])}),zoomControl.events.add("zoomchange",function(evt){that.metrikaCounter(["map","scale",evt.get("newZoom")>evt.get("oldZoom")?"+":"-"])}),that.ready.fulfill()},setMarker:function(point,options){var mark=this._createMarker([point.lat,point.lon]);return this._setMarker(mark,options)},startEdit:function(){this.setEditMode(),this.panToMarker(),this.count("start edit")},setViewMode:function(){this.$node.toggleClass("map_view",!0),this.$node.toggleClass("map_edit",!1),this._mark&&this._mark.options.set("draggable",!1)},setEditMode:function(){this.isEditMode()||(this.$node.toggleClass("map_view",!1),this.$node.toggleClass("map_edit",!0),this._nodes.$location.focus(),this._mark&&this._mark.options.set("draggable",!0),this.count("show in edit mode"))},isEditMode:function(){return this.$node.hasClass("map_edit")},moveMarker:function(evt,coords){var mark=this._createMarker(coords);this.count(this.hasMarker()?"move pin":"drop pin"),this._setMarker(mark,{pan:!0})},hasMarker:function(){return!!this._mark},onSave:function(){return this.count("save"),this._mark||this._setMarkerFor(this.suggest.getCurrentValue()),this._triggerMapSave(),!1},cancel:function(){if(this._resetMarker(),this._clearSuggest(),this.setViewMode(),this._error){var error=this._error;this._error=null,error.cancel()}},onItemSelected:function(evt,selected){this._setMarkerFor(selected,{zoom:16}),this.count("choose suggest")},redraw:function(){this.map.container.fitToViewport()},removeMarker:function(){this._removeMarker(),this._clearSuggest(),this.count("remove location")},panToMarker:function(){this._mark&&this.map.panTo(this._mark.geometry.getCoordinates(),{delay:0,flying:!1})},fixState:function(){this._fixedMark=this._mark,this._fixedCoords=this._fixedMark?this._fixedMark.geometry.getCoordinates():null,this._updateButtons()},showError:function(options,data){var that=this,mapNode=this.node,details=data.details,context=details.context,oldData=details.oldData,newData=details.newData,isMapVisible=this.$node.is(":visible"),errorOptions=no.extend(options,{ok:function(){that.setEditMode(),isMapVisible||data.showPopup(),that._resetState(oldData),newData?that.setMarker({lat:newData.lat,lon:newData.lon},{mapType:newData.mapType,zoom:newData.zoom}):that._fixedMark&&that._setMarker(that._fixedMark)},cancel:function(){that._resetState(oldData),that.cancel()}});isMapVisible&&(errorOptions.element=$(".js-modify:visible",mapNode)[0],errorOptions.popup={how:{where:"bottom right",what:"top right"}}),this._error=ph.errors.showError(context,errorOptions),this._error.on("ph-destroy",function(){this._error=null})},getMapType:function(){return fotkiMapTypes[this.map.getType()]||fotkiMapTypes.schema},_clearSuggest:function(){this.suggest&&this.suggest.clear()},_triggerMapSave:function(){var map=this.map,mark=this._mark,data=null;if(mark){var coords=mark.geometry.getCoordinates();data={lat:coords[0],lon:coords[1],mapType:this.getMapType(),zoom:map.getZoom()}}this.fixState(),this.panToMarker(),this.setViewMode(),this.trigger("ph-map-save",data)},_resetState:function(data){if(this._mark&&(this._removeMarker(),this._mark=null),data){var mark=this._createMarker([data.lat,data.lon]);this._setMarker(mark)}this.fixState()},_resetMarker:function(){this._fixedMark?(this._fixedMark.geometry.setCoordinates(this._fixedCoords),this._mark!==this._fixedMark&&this._setMarker(this._fixedMark)):this._removeMarker()},_setMarkerFor:function(item,options){var that=this,address=item.fullName||item.label,promise=this._geocode(address);promise.then(function(geoObject){var mark=that._createMarker(geoObject.geometry.getCoordinates());that._setMarker(mark,options)},function(){that._removeMarker()})},_createMarker:function(coords){var that=this,placemark=new ymaps.Placemark(coords,{},{draggable:this.isEditMode(),preset:"twirl#photographerIcon"});return placemark.events.add("dragstart",function(){that._clearSuggest()}),placemark.events.add("dragend",function(){that._updateButtons(),that.count("drag & drop pin")}),placemark},_setMarker:function(mark,options){var promise=new Vow.Promise;return options=options||{},this._removeMarker(),this._mark=mark,this.map.geoObjects.add(mark),options.mapType&&this.map.setType(mapTypes[options.mapType||"schema"]),options.zoom?this.map.setCenter(mark.geometry.getCoordinates(),options.zoom||16,{callback:function(){promise.fulfill()},checkZoomRange:!0}):options.pan?this.map.panTo(this._mark.geometry.getCoordinates(),{delay:0,flying:!1}):this.map.setCenter(mark.geometry.getCoordinates()),this._updateButtons(),promise},_removeMarker:function(){this._mark&&(this.map.geoObjects.remove(this._mark),this._mark=null,this._updateButtons())},_geocode:function(query){var promise=new Vow.Promise;return ymaps.geocode(query).then(function(found){var l=found.geoObjects.getLength();return 0===l?void promise.reject("not found"):void promise.fulfill(found.geoObjects.get(0))},function(){promise.reject("error")}),promise},_toggleButton:function($button,enabled){$button.toggleClass("is-disabled",!enabled)},_handleMapClick:function(){var that=this,map=this.map,delay=300;map.events.add("click",function(evt){that._mapActive||that._addTimer||!that.isEditMode()||(that._addTimer=setTimeout(function(){var coords=evt.get("coords");that.trigger("ph-map-click",coords),that._addTimer=null},delay))}),map.events.add("actionbegin",function(){that._addTimer&&(clearTimeout(that._addTimer),that._addTimer=null),that._mapActive=!0}),map.events.add("actionend",function(){that._mapActive=!1}),map.events.add("actionbreak",function(){that._mapActive=!1})},_updateButtons:function(){if(this.canEdit){var markCoords=this._mark?this._mark.geometry.getCoordinates():null,changed=this._mark!==this._fixedMark||markCoords!==this._fixedCoords,binded=!!this._mark;this._toggleButton(this._nodes.$save,changed),this._toggleButton(this._nodes.$remove,binded),this.modifyButton.setMode(binded?"edit":"add")}},count:function(){var defaultOptions=["map",this._fixedMark?"change location":"set location",ph.metrika.mode()],options=Array.prototype.slice.call(arguments,0);this.metrikaCounter(defaultOptions.concat(options))},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])})}(),nb.define("copy-to-clipboard",{events:{init:"onInit",copied:"onCopyDone"},onInit:function(){var that=this;this.$node=$(this.node),ph.loadModule("clipboard").then(function(){that.$node.removeClass("is-hidden"),that._init(),ph.resized()})},onCopyDone:function(){this.$node.focus(),this.trigger("saved")},_init:function(){ph.clipboard.glue(this.node),ph.clipboard.on("mouseOver",function(){var text=$(this).attr("data-clipboard-text");ph.clipboard.setText(text)})},setData:function(data){this.$node.attr("data-clipboard-text",data)}}),function(){nb.define("blog-code",{events:{init:"onInit","change .js-add-name":"onChangeAddName","change .js-select":"onChangeSize","click .js-code":"selectCode"},onInit:function(){var that=this;this._nodes={$addName:$(".js-add-name",this.node),code:$(".js-code",this.node)[0],$code:$(".js-code",this.node),select:$(".js-select",this.node)[0],$select:$(".js-select",this.node),save:$(".js-save-code",this.node)[0],$save:$(".js-save-code",this.node)},this.format=nb.block($(".js-format",this.node)[0]),this.format.on("selected",function(evt,value){value?(that.updateCode(),that.savePref("format",value),that.metrikaCounter(["choose type",value])):this.selectFirst()}),this._code={},this._clipboard=nb.block(this._nodes.save),this._clipboard.on("saved",function(){that.trigger("saved")}),navigator.userAgent.match(/(iPod|iPhone|iPad)/)||this._nodes.$code.prop("readonly",!0)},onChangeAddName:function(){var addName=this._nodes.$addName.is(":checked");this.savePref("addName",addName),this.updateCode(),this.metrikaCounter([addName?"include name":"exclude name"])},onChangeSize:function(){var size=this._nodes.$select.val();this.savePref("size",size),this.updateCode(),this.metrikaCounter(["choose size",size])},applyPrefs:function(){var settings=this._getSettings(),promises=[];for(var prefName in settings)settings.hasOwnProperty(prefName)&&promises.push(this._applyPref(prefName));Vow.all(promises).then(this.updateCode,this)},_applyPref:function(prefName){var that=this;return ph.controllers.user.getLocalPref("blog-code-"+prefName).then(function(value){if("undefined"!=typeof value)switch(prefName){case"format":that.format.setValue(value);break;case"size":that._nodes.$select.val(value);break;case"addName":that._nodes.$addName.prop("checked",value)}})},savePref:function(name,value){return name&&"undefined"!=typeof value?ph.controllers.user.setLocalPref("blog-code-"+name,value):void 0},selectCode:function(){this._nodes.$code.focus().select()},setPhoto:function(photo){this._photo=photo,this._pageUrl=ph.utils.getShareLinkBlogCode(photo.getData()),this.updateCode()},updateCode:function(){var code=this.getCode();this._nodes.$code.val(code),this._clipboard.setData(code)},getCode:function(){var settings=this._getSettings(),key=this._hash(settings);return this._code[key]||(this._code[key]=this._generateCode(settings))},reset:function(){this._code={}},_generateCode:function(settings){var data={photo:this._photo.getData(),settings:settings,pageUrl:this._pageUrl};return ns.renderString(data,"blog-code-generate")},_getSettings:function(){return{size:this._nodes.$select.val(),addName:this._nodes.$addName.is(":checked"),format:this.format.getValue()}},_hash:function(settings){return[settings.size,settings.format,settings.addName?1:0].join(":")},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer","code for blog"])})}(),function(){nb.define("complain",{events:{init:"onInit","click .js-button-send":"onClickButtonSend","click .js-send-one-more":"onClickButtonSendOneMore","change .toggler-controller":"_onChangeForm","change .js-copyright .toggler-controller":"_onChangeCopyright","change .js-other .toggler-controller":"_onChangeOther","input .js-link-to-origin":"_onChangeForm","input .js-matter":"_onChangeForm"},onInit:function(){var that=this;this._popup=nb.block($(this.node).closest(".js-complain-popup")[0]),this._class={disabled:"is-disabled",hidden:"is-hidden"},this._nodes={$form:$(".complain-form_new",this.node),$inputLinkToOrigin:$(".js-link-to-origin",this.node),$inputMatter:$(".js-matter",this.node),$buttonSend:$(".js-button-send",this.node),$result:$(".complain-form_sent",this.node),$buttonSendNew:$(".js-send-one-more",this.node),$errorSend:$(".js-error-send",this.node),$errorExist:$(".js-error-exist",this.node)},this._checkboxes={$all:$(".toggler-controller",this.node),$copyright:$(".js-copyright .toggler-controller",this.node),$contest:$(".js-contest .toggler-controller",this.node),$porn:$(".js-pron .toggler-controller",this.node),$violence:$(".js-violence .toggler-controller",this.node),$spam:$(".js-spam .toggler-controller",this.node),$other:$(".js-other .toggler-controller",this.node)},this._inputs={$all:$(".input",this.node),$linkToOrigin:$(".js-link-to-origin .input",this.node),$matter:$(".js-matter .input",this.node)};var _computeMaxHeight=function(){var $node=$(that.node),maxHeight=$node.offset().top+$node.height();maxHeight=maxHeight>0?maxHeight:"none",$node.css({"max-height":maxHeight})};_computeMaxHeight(),that._popup.trigger("move"),nb.on("ph-resize",_computeMaxHeight),this._popup.on("close",function(){nb.off("ph-resize",_computeMaxHeight)}),this._popup.on("open",function(){nb.on("ph-resize",_computeMaxHeight)})},_onChangeForm:function(){this._toggleButtonSend(),this.hideErrorSend(),this.hideErrorExist()},_onChangeCopyright:function(){this._nodes.$inputLinkToOrigin.toggleClass(this._class.hidden,!this._checkboxes.$copyright.is(":checked")),this._popup.trigger("move")},_onChangeOther:function(){this._nodes.$inputMatter.toggleClass(this._class.hidden,!this._checkboxes.$other.is(":checked")),this._popup.trigger("move")},_toggleButtonSend:function(disable){var isBlankForm=!this._checkboxes.$all.is(":checked")||""===$.trim(this._inputs.$matter.val())&&this._checkboxes.$other.is(":checked")||""===$.trim(this._inputs.$linkToOrigin.val())&&this._checkboxes.$copyright.is(":checked");this._nodes.$buttonSend.toggleClass(this._class.disabled,disable||isBlankForm)},onClickButtonSend:function(){this._nodes.$buttonSend.hasClass("is-disabled")||this.trigger("ph-click-send-complain"),this._toggleButtonSend(!0),this.hideErrorSend(),this.hideErrorExist()},onClickButtonSendOneMore:function(){this.trigger("ph-click-send-one-more")},resetForm:function(){this._checkboxes.$all.prop("checked",!1),this._inputs.$all.prop("value",""),this._onChangeCopyright(),this._onChangeOther(),this.hideErrorSend(),this.hideErrorExist(),this._toggleButtonSend()},showForm:function(){this._nodes.$result.addClass(this._class.hidden),this._nodes.$form.removeClass(this._class.hidden),this._popup.trigger("move")},showResult:function(){this._nodes.$form.addClass(this._class.hidden),this._nodes.$result.removeClass(this._class.hidden),this._popup.trigger("move")},showErrorSend:function(){this._nodes.$errorSend.removeClass(this._class.hidden),this._toggleButtonSend(),this._popup.trigger("move")},showErrorExist:function(){this._nodes.$errorExist.removeClass(this._class.hidden),this._toggleButtonSend(!0),this._popup.trigger("move")},hideErrorSend:function(){this._nodes.$errorSend.addClass(this._class.hidden),this._popup.trigger("move")},hideErrorExist:function(){this._nodes.$errorExist.addClass(this._class.hidden),this._popup.trigger("move")},getData:function(){var isCheckedCopyright=this._checkboxes.$copyright.is(":checked"),isCheckedOther=this._checkboxes.$other.is(":checked"),params={copyright:isCheckedCopyright,contest:this._checkboxes.$contest.is(":checked"),contestId:this.nbdata()["contest-id"],porn:this._checkboxes.$porn.is(":checked"),violence:this._checkboxes.$violence.is(":checked"),spam:this._checkboxes.$spam.is(":checked"),other:isCheckedOther,linkToOrigin:isCheckedCopyright?this._inputs.$linkToOrigin.val():"",matter:isCheckedOther?this._inputs.$matter.val():""};return params}})}(),nb.define("progress-button",{events:{init:"onInit"},onInit:function(){this.state=null,this.popup=null,this.defaultText=this.$node.html()},setPopup:function(popup){var that=this;this.popup=popup,this.popup.on("close",function(){that.popup=null})},setProgress:function(){this.state="progress",this.$node.toggleClass("progress-button_done",!1),this.$node.toggleClass("progress-button_progress",!0)},setDone:function(){var that=this;this.state="done";var completedText=this.nbdata()["completed-text"],textNodeSelector=this.nbdata()["text-node-selector"];if(textNodeSelector?this.$node.find(textNodeSelector).html(completedText):this.$node.html(completedText),this.$node.toggleClass("progress-button_progress",!1),this.$node.toggleClass("progress-button_done",!0),this.popup){var $toggler=$(this.popup.toggler);$toggler.is(":visible")?this.popup.trigger("move"):setTimeout(function(){that.popup.trigger("close")},1e3)}},reset:function(){this.state=null,this.$node.html(this.defaultText),this.$node.toggleClass("progress-button_progress",!1),this.$node.toggleClass("progress-button_done",!1)}}),function(){nb.define("link-counter",{events:{click:"onClick"},onClick:ph.metrika.countLink(function(){var metrikaCounter=ph.metrika.generateMetrikaCounter(this.nbdata()["link-counter"]);metrikaCounter([this.$node.data("link")])})})}(),nb.define("send-to-contest",{events:{init:"onInit","click .js-send":"validateAndSend","click .js-contest-rules":"countViewContestRules","click .js-general-rules":"countViewGeneralRules"},onInit:function(){this._nodes={title:$(".js-title",this.node)[0],$title:$(".js-title",this.node),tags:$(".js-tags",this.node)[0],$tags:$(".js-tags",this.node)}},setFields:function(data){this._nodes.$title.val(data.title),this._nodes.$tags.val((data.tags||[]).join(", "))},validateAndSend:function(){var data={title:this._nodes.$title.val().trim(),tags:this._nodes.$tags.val().trim(),contestId:this.nbdata("contest-id")};return""===data.title?this._showError("invalid_title_is_empty",this._nodes.title):""===data.tags?this._showError("invalid_tags_are_empty",this._nodes.tags):this.trigger("send",data),this.metrikaCounter(["send to contest","send"]),!1},_showError:function(errorId,node){ph.errors.showError(ph.actions.createContext(),{messageId:errorId,element:node,popup:{how:{dir:"right"}}})},countViewContestRules:function(){this.metrikaCounter(["send to contest","view contest rules"])},countViewGeneralRules:function(){this.metrikaCounter(["send to contest","view general rules"])},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}),nb.define("revoke-from-contest",{events:{"click .js-go-to-contest":"countGoToContest","click .js-revoke":"revoke"},revoke:function(){return this.trigger("revoke",this.nbdata("contest-id")),this.metrikaCounter(["revoke from contest","revoke"]),!1},countGoToContest:ph.metrika.countLink(function(){this.metrikaCounter(["revoke from contest","go to contest page"])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}),yr.externals["ns-url"]=function(path){return ns.router.url(path)},yr.externals["ns-generate-url"]=function(id,params){return ns.router.generateUrl(id,params)},function(){var utils=ph.utils,getData=function(model,default_value){return yr.nodeset2data(model)||default_value},nodeset2array=function(nodeset){var result,data=yr.nodeset2data(nodeset)||[];return result=Array.isArray(data)?data:data.item&&Array.isArray(data.item)?data.item:[data]},externals=yr.externals=yr.externals||{};externals.generateUrl=function(page,model,moreParams){var params;switch(moreParams=moreParams||{},page){case"photo":var photo=getData(model);return params=no.extend(moreParams,{"author-login":no.jpath(".author.login",photo),"image-id":no.jpath(".imageId",photo),"album-id":no.jpath(".albumId",photo)}),utils.generateUrl(page,params);case"user-profile":var profile=getData(model),login=no.jpath(".user.login",profile);return utils.generateUrl("user-profile",{"author-login":login});case"commenter-profile":var commenter=getData(model),commenterLogin=no.jpath(".login",commenter);return utils.generateUrl("user-profile",{"author-login":commenterLogin});case"album":var album=getData(model);return params={"author-login":album.author.login,"album-id":album.albumId},utils.generateUrl(page,params);case"user-tag":var tag=getData(model);return params={"author-login":moreParams["author-login"],tag:tag.name},utils.generateUrl("user-tag",params);case"contest":var contest=getData(model);return params={"contest-id":contest&&contest.contestId||moreParams.id},utils.generateUrl(page,params);case"calendar":var data=getData(model);return params={date:ph.utils.formatDate(data.date,"YYYY-MM")},utils.generateUrl(page,params);case"tag":return utils.generateUrl(page,{tag:getData(model).tagText});default:return utils.generateUrl(page,moreParams)}},externals.generateUrlFull=function(page,model,moreParams){return ph.utils.fullUrl(externals.generateUrl(page,model,moreParams))},externals.generateDeanimatedUrl=function(url){var breakSymbol="_",head=url.split(breakSymbol),tail=head.pop();return head.push("GIF"+tail),head.join(breakSymbol)},externals.getAvatarUrl=function(uid){return ph.utils.getAvatarUrl(uid)},externals.formatDate=function(milliseconds,format){return ph.utils.formatDate(milliseconds,format)},externals.formatDateRelative=function(milliseconds){return ph.utils.formatDateRelative(milliseconds)},externals.formatDateNow=function(format){return ph.utils.formatDate(void 0,format)},externals.formatDateWithTZ=function(dateString,format){return ph.utils.formatDateWithTZ(dateString,format)},externals.nl2br=function(str){return ph.utils.nl2br(str)},externals.plural=function(num,f0,f1,f3,f5){return ph.utils.plural(num,f0,f1,f3,f5)},externals.getMedals=function(more){return utils.groupMedals(getData(more))},externals.number=function(str){return parseInt(str,10)},externals.sum=function(nodeset){var sum=0;return nodeset.forEach(function(element){sum+=element.data}),sum},externals.isCurrentUserAdult=function(uid){return ph.utils.isAdult(uid)},externals.length=function(str){return(getData(str)||"").length},externals.strlen=function(str){return(str||"").length},externals.has=function(ar,value){return nodeset2array(ar).indexOf(value)>=0},externals.split=function(str,delimiter){return(str||"").split(delimiter)},externals.filterDifferentSizes=function(photo){var data=getData(photo);if(!data.sizes)return[];var sizes=ph.utils.sizes,selected=[],prev=null;for(var sizeName in sizes){var size=data.sizes[sizeName],orig=data.sizes.orig,isDifferentSize=!1;size&&(isDifferentSize=orig?!prev||orig.width>=size.width&&size.width!==prev.width||orig.height>=size.width&&size.height!==prev.height||"orig"===sizeName:!prev||size.width!==prev.width||size.height!==prev.height||"orig"===sizeName,isDifferentSize&&selected.push(sizeName),prev=size)}return selected},externals.getClosestSize=function(photo,sizeName){return ph.utils.getClosestSize(getData(photo),sizeName)},externals.getClosestSizeForViewer=function(photo,sizeName){var photoData=getData(photo)||{},params={"author-login":no.jpath(".author.login",photoData),"image-id":no.jpath(".imageId",photoData)},photoLite=ns.Model.get("photo-lite",params);return photoLite.isValid()?ph.utils.getClosestSize(photoLite.getData(),sizeName)||ph.utils.getClosestSize(photoData,sizeName):ph.utils.getClosestSize(photoData,sizeName)},externals.getCoverSize=function(photo,sizeName){return ph.utils.getCoverSize(getData(photo),sizeName)},externals.__unsafeHTML=function(str){return str?ns.deentityify(str):str},externals.reverse=function(arr){return arr.reverse()},externals.escape=function(str){return ns.entityify(str)},externals.getBackgroundUrl=function(){var url=ph.utils.getOldFotkiContextUrl(ns.page.current.params);return url?ph.utils.appendParams(url,{_next:1}):""},externals.getShareLink=function(photo){var data=getData(photo);return ph.utils.getShareLink(data)},externals.isAuthor=function(photo,auth){return no.jpath(".author.uid",getData(photo))==no.jpath(".uid.value",getData(auth))},externals["null"]=function(){return yr.object2nodeset(null)},externals.object=function(nodeset){return getData(nodeset)},externals.canEditImageType=function(photo){var data=getData(photo);return data&&["jpg","jpeg","png"].indexOf(data.imageFormat||"jpg")>=0},externals.timestamp=function(){return+new Date},externals.breakNumber=function(number){for(var str=""+(number||"0"),len=str.length,count=len%3||3,parts=[];str.length;)parts.push(str.substring(0,count)),str=str.substring(count),count=3;return parts},externals.bigRandom=function(){return(Math.random()+"").substring(2)},externals.getArray=function(length){return new Array(length)}}();var yr=yr||require("yate/lib/runtime.js");!function(){function p0(m,c0){return cmpSN("ok",selectNametest("status",c0,[]))}function p2(m,c0){return cmpSN("error",selectNametest("status",c0,[]))}function p10(m,c0){return!simpleBoolean("referers",c0)&&!simpleBoolean("error",c0)}function p11(m,c0){return simpleBoolean("referers",c0)&&!simpleBoolean("error",c0)}function p12(m,c0){return simpleBoolean("error",c0)}function p13(m,c0){return simpleBoolean("special",c0)}function p15(m,c0){return!simpleBoolean("exif",c0)&&!simpleBoolean("error",c0)}function p16(m,c0){return simpleBoolean("exif",c0)&&!simpleBoolean("error",c0)}function p24(m,c0){return nodeset2boolean(m.s(j86,c0))}function p25(m,c0){return cmpSN(1,selectNametest("fired",c0,[]))||cmpSN(0,selectNametest("fired",c0,[]))}function p28(m,c0){return cmpSN("hide-ads",selectNametest("name",c0,[]))}function p29(m,c0){return cmpSN("image not found",m.n(j40,m.k("k1","photo",c0.doc.root)))}function p30(m,c0){return cmpSN("image is blocked",m.n(j40,m.k("k1","photo",c0.doc.root)))}function p31(m,c0){return cmpSN("image not found",m.n(j40,m.k("k1","photo-rights",c0.doc.root)))}function p32(m,c0){return cmpSN("access denied",m.n(j40,m.k("k1","photo-rights",c0.doc.root)))||cmpSN("access denied",m.n(j40,m.k("k1","photo",c0.doc.root)))}function p33(m,c0){return simpleBoolean("askAlbumPassword",c0)}function p34(m,c0){return cmpSN(1,m.s(j14,c0))}function p35(m,c0){return cmpSN(1,m.s(j150,c0))&&!yr.externals.isCurrentUserAdult(nodeset2scalar(m.n(j151,m.k("k0","auth",c0.doc.root))))&&!cmpNN(m.n(j152,m.k("k0","photo",c0.doc.root)),m.n(j151,m.k("k0","auth",c0.doc.root)))}function p36(m,c0){return cmpSN(1,m.s(j13,c0))}function p37(m,c0){return cmpSN("court-verdict",selectNametest("templateType",c0,[]))}function p38(m,c0){return cmpSN("agreement",selectNametest("type",c0,[]))||cmpSN("agreement-other",selectNametest("type",c0,[]))}function p39(m,c0){return cmpSN("fullscreen",m.s(j126,c0.doc.root))}function p41(m,c0){return cmpSN("album not found",m.n(j40,m.k("k1","album-info",c0.doc.root)))}function p42(m,c0){return cmpSN("access denied",m.n(j40,m.k("k1","photo-rights",c0.doc.root)))}function p44(m,c0){return cmpSN("contest",selectNametest("type",c0,[]))||cmpSN("photoofday",selectNametest("type",c0,[]))||cmpSN("top",selectNametest("type",c0,[]))}function p45(m,c0){return cmpNN(m.n(j152,m.k("k0","photo",c0.doc.root)),m.n(j151,m.k("k0","auth",c0.doc.root)))&&nodeset2boolean(m.n(j182,m.k("k0","photo-rights",c0.doc.root)))}function p46(m,c0){return 1==selectNametest("item",c0,[]).length}function p48(m,c0){return selectNametest("item",c0,[]).length>1}function p49(m,c0){return cmpSN("photoofday",selectNametest("type",c0,[]))}function p50(m,c0){return cmpSN("top",selectNametest("type",c0,[]))}function p51(m,c0){return cmpSN("contest",selectNametest("type",c0,[]))}function p52(m,c0){return cmpSN("contest",selectNametest("type",c0,[]))&&!simpleBoolean("place",c0)}function p53(m,c0){return cmpSN("contest",selectNametest("type",c0,[]))&&cmpSN("voting-started",selectNametest("state",c0,[]))&&simpleBoolean("place",c0)}function p54(m,c0){return!nodeset2boolean(m.n(j203,m.k("k0","photo-rights",c0.doc.root)))}function p55(m,c0){return!!nodeset2boolean(m.n(j219,m.k("k0","photo",c0.doc.root)))}function p56(m,c0){return!nodeset2boolean(m.n(j17,m.k("k0","photo",c0.doc.root)))}function p57(m,c0){return!cmpSN("finished",m.s(j240,c0))}function p58(m,c0){return nodeset2boolean(m.s(j150,c0))}var cmpNN=yr.cmpNN,cmpSN=yr.cmpSN,nodeset2xml=yr.nodeset2xml,nodeset2boolean=yr.nodeset2boolean,nodeset2attrvalue=yr.nodeset2attrvalue,nodeset2scalar=yr.nodeset2scalar,scalar2attrvalue=yr.scalar2attrvalue,xml2attrvalue=yr.xml2attrvalue,scalar2xml=yr.scalar2xml,simpleScalar=(yr.xml2scalar,yr.simpleScalar),simpleBoolean=yr.simpleBoolean,selectNametest=yr.selectNametest,closeAttrs=yr.closeAttrs,M=new yr.Module,j1=[0,"models",0,"*",2,p0];M.k0={},M.k0.n=function(m,c0){return m.s(j1,c0.doc.root)},M.k0.u=function(m,c0){return c0.name},M.k0.b=function(m,c0){function p1(m,c0){return"status"!=c0.name}var r0=[],j2=[0,"*",2,p1];return r0=m.s(j2,c0)},M.k0.ut="scalar",M.k0.bt="nodeset";var j3=[0,"models",0,"*",2,p2];M.k1={},M.k1.n=function(m,c0){return m.s(j3,c0.doc.root)},M.k1.u=function(m,c0){return c0.name},M.k1.b=function(m,c0){function p3(m,c0){return"status"!=c0.name}var r0=[],j4=[0,"*",2,p3];return r0=m.s(j4,c0)},M.k1.ut="scalar",M.k1.bt="nodeset",M.f0=function(m,c0,i0,l0,v0,v1,v2,v3,v4,v5){v1=void 0===v1?[]:v1,v2=void 0===v2?[]:v2,v3=void 0===v3?[]:v3,v4=void 0===v4?[]:v4,v5=void 0===v5?[]:v5;var r0=[];return r0=yr.externals["_ns-view-call"]([c0.doc.root],v0,v1,v2,v3,v4,v5)},M.f1=function(m,c0,i0,l0,v6,v7,v8,v9,v10,v11,v12){v8=void 0===v8?[]:v8,v9=void 0===v9?[]:v9,v10=void 0===v10?[]:v10,v11=void 0===v11?[]:v11,v12=void 0===v12?[]:v12;var r0=[];return r0=yr.externals["_ns-model-call"]([c0.doc.root],v6,v7,v8,v9,v10,v11,v12)},M.f2=function(m,c0,i0,l0,v13,v14,v15,v16,v17,v18){v15=void 0===v15?[]:v15,v16=void 0===v16?[]:v16,v17=void 0===v17?[]:v17,v18=void 0===v18?[]:v18;var r0=[];return r0=yr.externals["_ns-view-call-scalar"]([c0.doc.root],v13,v14,v15,v16,v17,v18)},M.f3=function(m,c0,i0,l0,v19,v20,v21,v22,v23,v24,v25){v22=void 0===v22?[]:v22,v23=void 0===v23?[]:v23,v24=void 0===v24?[]:v24,v25=void 0===v25?[]:v25;var r0=[];return r0=yr.externals["_ns-model-call-scalar"]([c0.doc.root],v19,v20,v21,v22,v23,v24,v25)},M.f4=function(m,c0,i0,l0,a0,v26,v27,v28,v29){var r0="";return r0+=closeAttrs(a0),r0+='<label class="tumbler '+scalar2attrvalue(v28)+'">',r0+="<input",a0.a={type:new yr.scalarAttr("checkbox"),"class":new yr.scalarAttr("tumbler__checkbox")},a0.s="input",v29&&(a0.a.checked=new yr.scalarAttr("checked")),r0+=closeAttrs(a0),r0+="",r0+='<span class="tumbler__input">',r0+='<span class="tumbler__inner">',r0+='<span class="tumbler__state tumbler__state_left">'+scalar2xml(v26)+"</span>",r0+='<span class="tumbler__state tumbler__state_right">'+scalar2xml(v27)+"</span>",r0+="</span>",r0+="</span>",r0+="</label>"};var j9=[0,"item"],j10=[1,0];M.f5=function(m,c0,i0,l0,a0,v30){var r0="";r0+=closeAttrs(a0);for(var items0=m.n(j9,yr.array2nodeset(yr.externals.breakNumber(v30))),i1=0,l1=items0.length;l1>i1;i1++){var c1=items0[i1];r0+='<span class="stat__item-digit">'+nodeset2xml(m.s(j10,c1))+"</span>"}return r0},M.f6=function(m,c0,i0,l0,a0,v31,v32,v33){v32=void 0===v32?!1:v32,v33=void 0===v33?!1:v33;
var r0="";if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("spinner-yellow spinner-yellow_size_"+v31)},a0.s="div",v32){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" spinner-centered"):new yr.scalarAttr(" spinner-centered")}if(v33){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" spinner-inverted"):new yr.scalarAttr(" spinner-inverted")}return r0+=closeAttrs(a0),r0+='<div class="spinner-yellow-circle"></div>',r0+="</div>"},M.f7=function(m,c0,i0,l0,v34){function p4(m,c0){return c0.name==v34}var r0=[],r1={};r1.enter="Enter",r1.esc="Esc",r1.left="←",r1.right="→",r1.space="Пробел",r1.shift="Shift",r1.alt="Alt",r1.ctrl="Ctrl",r1.meta="Meta";var v35=r1,j11=[0,"*",2,p4];return r0=m.n(j11,yr.object2nodeset(v35))},M.f8=function(m,c0,i0,l0,v36){function p5(m,c0){return c0.name==v36}var r0=[],r1={};r1["shortcuts: show"]="Показать список клавиатурных сокращений",r1["view photo: prev"]="Предыдущая фотография",r1["view photo: next"]="Следующая фотография",r1["view photo: like"]="Поставить фотографии отметку «Нравится»",r1["slideshow: toggle"]="Включить / выключить слайдшоу (в режиме «На всё окно»)",r1["layout: toggle"]="Включить / выключить режим «На всё окно»",r1["exif: toggle"]="Показать EXIF";var v37=r1,j12=[0,"*",2,p5];return r0=m.n(j12,yr.object2nodeset(v37))},M.f9=function(m,c0,i0,l0,a0,v38){var r0="";return r0+=closeAttrs(a0),r0+='<div class="shortcut-key">',r0+='<div class="button-content">',r0+=nodeset2boolean(m.f("f7",c0,i0,l0,v38))?nodeset2xml(m.f("f7",c0,i0,l0,v38)):scalar2xml(v38),r0+="</div>",r0+="</div>"},M.f10=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<a class="link" target="_blank" href="//yandex.ru/legal/ugc_takedown/">Подробности</a>'},M.f11=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="image__note">',r0+="На этот файл поступила жалоба, доступ к нему заблокирован. ",r0+=m.f("f10",c0,i0,l0,a0),r0+="</div>"},M.f12=function(m,c0,i0,l0,a0,v39){v39=void 0===v39?[]:v39;var r0="";return r0+=closeAttrs(a0),r0+=nodeset2scalar(v39)},M.f13=function(m,c0,i0,l0,a0,v40){v40=void 0===v40?[]:v40;var r0="";return r0+=closeAttrs(a0),r0+=yr.externals.nl2br(nodeset2scalar(v40))};var j13=[0,"flags",0,"blocked"],j14=[0,"flags",0,"lostInStorage"],j15=[0,"access",0,"privilege"],j16=[0,"access",0,"passworded"],j17=[0,"askAlbumPassword"],j18=[0,"access",0,"storagePrivate"];M.f14=function(m,c0,i0,l0,v41,v42){v41=void 0===v41?[]:v41,v42=void 0===v42?[]:v42;var r0="",v43=m.n(j13,v41),v44=m.n(j14,v41),v45=!cmpSN("public",m.n(j15,v41)),v46=nodeset2boolean(m.n(j16,v41))||nodeset2boolean(m.n(j17,v41)),v47=m.n(j18,v41);return r0+=nodeset2boolean(v43)||nodeset2boolean(v44)||v45||v46||nodeset2boolean(v47)?"":"1"};var j19=[0,"author-login"],j20=[0,"user",0,"displayName"];M.f15=function(m,c0,i0,l0,v48,v49){v48=void 0===v48?[]:v48,v49=void 0===v49?[]:v49;var r0=[];return r0=nodeset2boolean(m.n(j20,v48))?m.n(j20,v48):m.n(j19,v49)};var j21=[0,"title"],j22=[0,"fileName"],j23=[0,"description"],j24=[0,"openGraphUrl"],j25=[0,"imageFormat"];M.f16=function(m,c0,i0,l0,v50,v51,v52,v53){v50=void 0===v50?[]:v50,v51=void 0===v51?[]:v51,v52=void 0===v52?[]:v52,v53=void 0===v53?[]:v53;var r0="",r1=[];r1=nodeset2boolean(m.n(j21,v50))?m.n(j21,v50):m.n(j22,v50);var v54=r1,v55="«"+nodeset2scalar(v54)+"»",v56=m.f("f15",c0,i0,l0,v52,v53);return r0+=nodeset2boolean(m.n(j24,v50))&&cmpSN("gif",m.n(j25,v50))?"Смотреть полностью на Яндекс.Фотках":nodeset2boolean(m.n(j23,v51))?"Фото "+v55+", автор "+nodeset2scalar(v56)+" на Яндекс.Фотках":nodeset2scalar(v54)},M.f17=function(m,c0,i0,l0,v57,v58,v59,v60){v57=void 0===v57?[]:v57,v58=void 0===v58?[]:v58,v59=void 0===v59?[]:v59,v60=void 0===v60?[]:v60;var r0="";return r0+=nodeset2boolean(m.n(j23,v58))?nodeset2scalar(m.n(j23,v58)):"Фото, автор "+nodeset2scalar(m.f("f15",c0,i0,l0,v59,v60))+" на Яндекс.Фотках"},M.f18=function(m,c0,i0,l0,v61){v61=void 0===v61?[]:v61;var r0="",r1="";r1+=nodeset2boolean(m.n(j25,v61))?nodeset2scalar(m.n(j25,v61)):"jpg";var v62=r1;return r0+="."+v62};var j26=[0,"value"],j27=[0,"url"],j28=[0,"width"],j29=[0,"height"];M.f19=function(m,c0,i0,l0,v63,v64){v63=void 0===v63?[]:v63;var r0={},r1={};r1.width=300,r1.height=300;var v65=r1,r1={};r1.width=800,r1.height=800;var v66=r1,v67=m.n(j26,yr.object2nodeset(yr.externals.getClosestSize(v63,v65))),v68=m.n(j26,yr.object2nodeset(yr.externals.getClosestSize(v63,v66))),v69=m.f("f18",c0,i0,l0,v63);return nodeset2boolean(m.n(j24,v63))&&cmpSN("gif",m.n(j25,v63))?(r0.url=yr.nodeset2data(m.n(j24,v63)),r0.width=yr.nodeset2data(m.n(j28,v67)),r0.height=yr.nodeset2data(m.n(j29,v67))):"og"==v64?(r0.url=yr.nodeset2data(m.n(j24,v63)),r0.width=yr.nodeset2data(m.n(j28,v67)),r0.height=yr.nodeset2data(m.n(j29,v67))):(r0.url=nodeset2scalar(m.n(j27,v68))+v69,r0.width=yr.nodeset2data(m.n(j28,v68)),r0.height=yr.nodeset2data(m.n(j29,v68))),r0},M.f20=function(m,c0,i0,l0,v70){v70=void 0===v70?[]:v70;var r0="",v71=m.n(j25,v70);return r0+=cmpSN("gif",v71)?"image/gif":cmpSN("png",v71)?"image/png":"image/jpeg"};var j31=[0,"views",0,"*"],j32=[0,"*"],j33=[0,"tree",0,"*"],j37=[0,"views",0,"*"],j38=[0,"views",0,"ns-view-collection-container",0,"*"],j39=[0,"tag"],j40=[0,"name"],j41=[0,"photo"],j42=[0,"flags",0,"hideOriginal"],j43=[0,"sizes",0,"all"],j47=[0,"settings",0,"size"],j49=[0,"settings",0,"format"],j50=[0,"flags",0,"hasStillGif"],j52=[0,"settings",0,"addName"],j55=[1,0,2,p10],j56=[2,p11],j57=[1,0,2,p12],j58=[0,"referers",0,"referers",0,"referer"],j61=[0,"total"],j62=[0,"referer"],j64=[0,"referers",0,"referers",0,"referer",0,"count"],j66=[0,"referer",2,p13],j68=[0,"ya"],j70=[2,p15],j71=[2,p16],j72=[2,p12],j76=[0,"added"],j82=[0,"dateTimeOriginal"],j83=[0,"camera"],j86=[0,"market",0,"modelId"],j87=[0,"camera",2,p24],j88=[0,"market",0,"hid"],j89=[0,"market",0,"vendor"],j90=[0,"market",0,"model"],j91=[0,"lens"],j93=[0,"flash",2,p25],j94=[0,"exposureProgram"],j98=[0,"photo",0,"sizes",0,"xxs",0,"url"],j101=[0,"app"],j102=[0,"content"],j103=[0,"overlay"],j112=[0,"not-found"],j113=[0,"head"],j114=[0,"foot"],j116=[0,"pod"],j117=[0,"teaser"],j118=[0,"tags",0,"tag"],j119=[0,"views",0,"teaser-banner"],j120=[0,"teaser-banner"],j121=[0,"preferences",0,"preference",1,0,2,p28],j122=[0,"enabled"],j123=[0,"stream"],j124=[0,"ads-direct"],j125=[0,"bar"],j126=[0,"params",0,"mode"],j128=[0,"views",0,"photo-box"],j129=[0,"views",0,"photo-ears"],j130=[0,"views",0,"photo-flags-box"],j131=[0,"views",0,"photo-edit-box"],j132=[0,"views",0,"tray"],j133=[0,"views",0,"bar"],j134=[0,"views",0,"panel"],j135=[0,"photo-contest"],j137=[0,"photo-box"],j138=[0,"photo-image"],j139=[0,"photo-image",4,p29],j140=[0,"photo-image",4,p30],j141=[0,"blockReason"],j142=[0,"photo-image",4,p31],j143=[0,"photo-image",4,p32],j144=[0,"sizeName"],j145=[0,"value",0,"url"],j146=[0,"photo",2,p33],j148=[0,"photo",2,p34],j149=[0,"options",0,"isOwner"],j150=[0,"flags",0,"porno"],j151=[0,"uid",0,"value"],j152=[0,"author",0,"uid"],j153=[0,"photo",2,p35],j154=[0,"photo",2,p36],j156=[0,"blockReason",2,p37],j158=[0,"blockReason",2,p38],j159=[0,"photo-image-contest"],j160=[0,"panel"],j161=[0,"panel",4,p39],j162=[0,"views",0,"panel-box"],j163=[0,"views",0,"ads"],j164=[0,"photo-author"],j165=[0,"user",0,"uid"],j166=[0,"params",0,"author-login"],j168=[0,"profile"],j169=[0,"viewerUserRelation",0,"userIsFavoriteAuthorOfViewer"],j170=[0,"photo-info"],j171=[0,"photo-info",4,p41],j172=[0,"photo-info",4,p29],j173=[0,"views",0,"photo-author"],j174=[0,"photo-info",4,p42],j176=[0,"canEdit"],j177=[0,"position"],j178=[0,"photo-slider-info-item"],j179=[0,"photo-tags"],j180=[0,"*",2,p44],j181=[0,"tags"],j182=[0,"actions",0,"canAddTag"],j183=[0,"tags",4,p45],j184=[0,"*",2,p46],j186=[0,"*",2,p48],j187=[0,"*",2,p49],j189=[0,"*",2,p50],j190=[0,"*",2,p51],j192=[0,"*",2,p52],j193=[0,"votingStartDate"],j195=[0,"*",2,p53],j196=[0,"votingFinishDate"],j197=[0,"photo-on-map"],j198=[0,"params",0,"image-id"],j199=[0,"boundCoord"],j200=[0,"actions",0,"canBindGeo"],j202=[0,"photo-like"],j203=[0,"needToAskPassword"],j204=[0,"photo-like",4,p54],j205=[0,"uid"],j206=[0,"actions"],j207=[0,"options"],j208=[0,"likeCount"],j209=[0,"canLike"],j210=[0,"likeAnimate"],j211=[0,"like"],j212=[0,"photo-favorite"],j213=[0,"photo-favorite",4,p54],j214=[0,"canFavorite"],j215=[0,"favorite"],j218=[0,"photo-to-disk"],j219=[0,"sizes",0,"orig"],j220=[0,"photo-to-disk",4,p55],j222=[0,"disk",0,"diskUrl"],j223=[0,"photo-views"],j224=[0,"photo-views",4,p56],j226=[0,"photo-controls"],j227=[0,"views",0,"photo-on-map"],j228=[0,"views",0,"send-to-contest"],j229=[0,"views",0,"photo-views"],j230=[0,"views",0,"photo-like"],j231=[0,"views",0,"photo-favorite"],j232=[0,"views",0,"photo-to-disk"],j233=[0,"photo-controls",4,p39],j236=[0,"sizes"],j239=[0,"flags",0,"hasExif"],j240=[0,"contest",0,"state"],j241=[0,"contestBindings",0,"contestBinding",2,p57],j242=[0,"contest"],j243=[0,"imageStatus"],j244=[0,"contestId"],j245=[0,"sizes",0,"orig",0,"url"],j247=[0,"photo-ears"],j248=[0,"photo-edit"],j249=[0,"canEditReason"],j250=[0,"aviaryEnabled"],j253=[0,"photo",0,"areas"],j256=[0,"flags"],j257=[0,"porno"],j258=[0,"commentsDisabled"],j259=[0,"hideOriginal"],j261=[0,"photo-flags"],j262=[0,"photo",2,p58],j264=[0,"comments"],j265=[0,"ads"],j266=[0,"tray"],j267=[0,"tray",4,p39],j268=[0,"tray-container"],j269=[0,"send-to-contest"],j270=[0,"activeContest"],j271=[0,"contest",0,"contestId"],j274=[0,"startDate"],j278=[0,"imageCount"],j279=[0,"userCount"],j280=[0,"texts",0,"description"],j282=[0,"active"],j283=[0,"models",0,"photo"],j284=[0,"models",0,"photo-rights"],j285=[0,"models",0,"photoMore"],j286=[0,"models",0,"profile"];M.t0=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("ns-root")},a0.s="div",r0+=m.a(m,0,m.s(j31,c0),"ns-view",a0),r0+=closeAttrs(a0),r0+="</div>"},M.t0.j=1,M.t0.a=1,M.t1=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.n(j33,yr.document(m.s(j10,c0))),"ns-build-view",a0)},M.t1.j=j32,M.t1.a=0,M.t2=function(m,c0,i0,l0,a0){var r0="",v72=simpleScalar("state",c0.doc.root);if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("ns-view-"+c0.name),"data-key":new yr.scalarAttr(nodeset2scalar(selectNametest("key",c0.doc.root,[])))},a0.s="div","placeholder"==v72){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ns-view-placeholder"):new yr.scalarAttr(" ns-view-placeholder"),r0+=nodeset2boolean(selectNametest("collection",c0.doc.root,[]))?m.a(m,0,m.s(j10,c0),"ns-view-collection",a0):m.a(m,0,m.s(j10,c0),"ns-view-desc",a0)}else{var r1="",a1={a:{}};r1+=m.a(m,0,m.s(j10,c0),"ns-view-add-class",a1);var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addxml(r1):new yr.xmlAttr(r1),r0+=m.a(m,0,m.s(j10,c0),"ns-view-add-attrs",a0),r0+="loading"==v72?m.a(m,0,m.s(j10,c0),"ns-view-async-content",a0):"error"==v72?m.a(m,0,m.s(j10,c0),"ns-view-error-content",a0):m.a(m,0,m.s(j10,c0),"ns-view-content",a0)}return r0+=closeAttrs(a0),r0+="</div>"},M.t2.j=j32,M.t2.a=0,M.t3=function(m,c0){var r0="";return r0},M.t3.j=j32,M.t3.a=0,M.t4=function(m,c0){var r0="";return r0},M.t4.j=j32,M.t4.a=0,M.t5=function(m,c0,i0,l0,a0){var r0="";return nodeset2boolean(selectNametest("collection",c0.doc.root,[]))?(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("ns-view-container-desc")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"ns-view-collection",a0),r0+=closeAttrs(a0),r0+="</div>"):r0+=m.a(m,0,m.s(j10,c0),"ns-view-desc",a0),r0},M.t5.j=j32,M.t5.a=0,M.t6=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j37,c0.doc.root),"ns-view",a0)},M.t6.j=j32,M.t6.a=0,M.t7=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j38,c0.doc.root),"ns-view",a0)},M.t7.j=j32,M.t7.a=0,M.t8=function(m,c0){var r0="";return r0},M.t8.j=j32,M.t8.a=0,M.t9=function(m,c0){var r0="";return r0},M.t9.j=j32,M.t9.a=0,M.t10=function(m,c0){var r0="";return r0},M.t10.j=j32,M.t10.a=0,M.t11=function(m,c0){var r0="";return r0},M.t11.j=j32,M.t11.a=0,M.t12=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="collapse-text__expander is-hidden"></div>'},M.t12.j=j32,M.t12.a=0,M.t13=function(m,c0,i0,l0,a0,v73,v74){var r0="";r0+=closeAttrs(a0),r0+='<label class="field nb-editable-text is-hidden">',r0+='<span class="field-content">',r0+="<textarea",a0.a={"class":new yr.scalarAttr("input-controller nb-editable-text__value-new"),type:new yr.scalarAttr("text")},a0.s="textarea";var tmp0=a0.a["class"];return a0.a["class"]=tmp0?tmp0.addscalar(" _init"):new yr.scalarAttr(" _init"),a0.a["data-nb"]=new yr.scalarAttr("textarea-autoheight"),v73&&(a0.a.placeholder=new yr.scalarAttr(v73)),r0+=closeAttrs(a0),r0+=scalar2xml(v74),r0+="</textarea>",r0+='<span class="input-view"> </span>',r0+="</span>",r0+="</label>"},M.t13.j=j32,M.t13.a=0,M.t14=function(m,c0,i0,l0,a0,v75,v76){var r0="";return r0+=closeAttrs(a0),v76?(r0+='<div class="editable-tags__view editable-tags__edit js-editable-tags-view">',r0+='<div class="nb-text">',selectNametest("tag",c0,[]).length>0?(r0+='<span class="editable-tags__title">Метки: </span>',r0+=m.a(m,0,selectNametest("tag",c0,[]),"editable-tags-item",a0,v75)):r0+='<span class="link js-editable-tags-edit-link">Добавьте метки</span>',r0+="</div>",r0+="</div>",r0+='<div class="editable-tags__input">',r0+='<div class="editable-tags__title">Метки: </div>',r0+='<label class="field">',r0+='<span class="field-content">',r0+="<textarea",a0.a={"class":new yr.scalarAttr("input-controller js-editable-tags-input"),type:new yr.scalarAttr("text")},a0.s="textarea",a0.a["data-nb"]=new yr.scalarAttr("textarea-autoheight"),r0+=m.a(m,0,selectNametest("tag",c0,[]),"editable-tags-item-plain",a0),r0+=closeAttrs(a0),r0+="</textarea>",r0+='<span class="input-view"> </span>',r0+="</span>",r0+="</label>",r0+="</div>"):(r0+='<div class="editable-tags__view js-editable-tags-view">',r0+='<div class="nb-text">',r0+='<span class="photo-tags__total">Метки:</span>',r0+=m.a(m,0,selectNametest("tag",c0,[]),"editable-tags-item",a0,v75),r0+="</div>",r0+="</div>"),r0},M.t14.j=j32,M.t14.a=0,M.t15=function(m,c0,i0,l0,a0,v77){var r0="";return r0+=closeAttrs(a0),i0>0&&(r0+=", "),r0+='<a class="link js-tag" href="'+scalar2attrvalue(yr.externals.generateUrl("user-tag",m.s(j10,c0),v77))+'" data-tag-name="'+nodeset2attrvalue(selectNametest("name",c0,[]))+'">',r0+=nodeset2xml(selectNametest("name",c0,[])),r0+="</a>"},M.t15.j=j39,M.t15.a=0,M.t16=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),i0>0&&(r0+=", "),r0+=nodeset2xml(selectNametest("name",c0,[]))},M.t16.j=j39,M.t16.a=0,M.t17=function(m,c0,i0,l0,a0,v78,v79){var r0="";return r0+=closeAttrs(a0),r0+='<div class="map" data-nb="map">',r0+='<div class="map-container"></div>',v78&&v79&&(r0+='<div class="map-controls map-controls_view js-view-binded">',r0+='<div class="map-controls__right">',r0+='<button class="small-button js-modify" type="button" data-nb="two-faced-button" data-nb-labels="{ add: \'Привязать\', edit: \'Изменить\' }" data-nb-default-mode="add">',r0+='<span class="button-content js-nb-label"></span>',r0+="</button>",r0+="</div>",r0+="</div>",r0+='<div class="map-controls map-controls_white map-controls_edit">',r0+='<div class="map-controls__left">',r0+='<button class="small-button small-button_icon map-controls__remove js-map-remove" type="button">',r0+='<span class="button-content">',r0+='<span class="icon_trash-16"></span>',r0+="</span>",r0+="</button>",r0+="</div>",r0+='<div class="map-controls__right">',r0+='<button class="small-action-button map-controls__save js-save" type="button">',r0+='<span class="button-content">Сохранить</span>',r0+="</button>",r0+='<div class="map-close js-cancel" title="Отмена">',r0+='<span class="popup-close"></span>',r0+="</div>",r0+="</div>",r0+='<div class="map-controls__center">',r0+="<input",a0.a={"class":new yr.scalarAttr("small-input map-controls__location js-location"),type:new yr.scalarAttr("text"),value:new yr.scalarAttr(""),placeholder:new yr.scalarAttr("Местоположение")},a0.s="input",a0.a["data-nb"]=new yr.scalarAttr("suggest"),a0.a["data-nb-label-key"]=new yr.scalarAttr("name"),a0.a["data-nb-theme-class"]=new yr.scalarAttr("popup popup_to_top geo-suggest"),a0.a["data-nb-popup-selector"]=new yr.scalarAttr(".js-map-suggest"),a0.a["data-nb-min_length"]=new yr.scalarAttr("2"),a0.a["data-nb-expand-popup-to-input"]=new yr.scalarAttr("true"),r0+=closeAttrs(a0),r0+="",r0+='<div class="popup popup_to_top map-suggest js-map-suggest" data-nb="islands-popup">',r0+='<div class="suggest-scrollbox"></div>',r0+="</div>",r0+="</div>",r0+="</div>"),r0+="</div>",r0+='<div class="popup-tail"></div>'},M.t17.j=j32,M.t17.a=0,M.t18=function(m,c0,i0,l0,a0,v80){v80=void 0===v80?[]:v80;var r0="";return r0+=closeAttrs(a0),r0+='<div class="blog-code js-blog-code" data-nb="blog-code">',r0+='<div class="blog-code-row">',r0+='<div class="group js-format" data-nb="button-group">',r0+='<button class="small-button toggle-button js-button is-checked" type="button" data-val="html">',r0+='<span class="button-content">HTML</span>',r0+="</button>",r0+='<button class="small-button toggle-button js-button" type="button" data-val="bbCode">',r0+='<span class="button-content">bbCode</span>',r0+="</button>",r0+="</div>",r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("blog-code-row")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"blog-code__sizes",a0,v80),r0+=closeAttrs(a0),r0+="</div>",r0+='<div class="blog-code-row">',r0+='<label class="toggler">',r0+='<input class="toggler-controller js-add-name" type="checkbox" checked="checked"/>',r0+='<span class="checkbox toggler-view">',r0+='<span class="checkbox-icon"> </span>',r0+="</span>",r0+="Добавить в код название фото",r0+="</label>",r0+="</div>",r0+='<div class="blog-code-row">',r0+='<textarea class="small-input blog-code__code js-code" rows="6" cols="70"></textarea>',r0+="</div>",r0+='<div class="blog-code-row js-save-code-row">',r0+='<button class="small-button js-save-code is-hidden" type="button" data-nb="copy-to-clipboard">',r0+='<span class="button-content">Скопировать код</span>',r0+="</button>",r0+="</div>",r0+="</div>",r0+='<div class="popup-tail"></div>',r0+='<div class="popup-close js-close"></div>'},M.t18.j=j41,M.t18.a=0,M.t19=function(m,c0,i0,l0,a0,v81){function p6(m,c1){return cmpSN(c1.name,v89)}function p8(m,c1){return cmpSN(c1.name,v89)}function p7(m,c1){return cmpSN(c1.name,v89)}v81=void 0===v81?[]:v81;var r0="",v82=m.s(j10,c0),v83=m.n(j42,v82),r1={};r1.xxxs="50 px",r1.xxs="75 px",r1.xs="100 px",r1.s="150 px",r1.m="300 px",r1.l="500 px",r1.xl="800 px",r1.xxl="1024 px",r1.xxxl="1280 px",r1.x4l="1600 px",r1.x5l="2560 px",r1.orig="Оригинал";var v84=r1,r1=[];r1.push("x4l"),r1.push("x5l"),r1.push("orig");for(var v85=r1,v86=m.n(j9,yr.array2nodeset(yr.externals.filterDifferentSizes(v82))),r1=[],items0=m.n(j43,v81),i1=0,l1=items0.length;l1>i1;i1++){var c1=items0[i1],v87=m.s(j10,c1);yr.externals.has(v86,nodeset2scalar(v87))&&(!nodeset2boolean(v83)||nodeset2boolean(v83)&&!yr.externals.has(yr.array2nodeset(v85),nodeset2scalar(v87)))&&r1.push(nodeset2scalar(v87))}var v88=r1;r0+=closeAttrs(a0),r0+='<span class="small-button select-wrap">',r0+='<select class="select js-select">';for(var items0=m.n(j9,yr.array2nodeset(v88)),i1=0,l1=items0.length;l1>i1;i1++){var c1=items0[i1],v89=m.s(j10,c1),j44=[0,"sizes",0,"*",2,p6],v90=m.n(j44,v82);if(r0+='<option value="'+nodeset2attrvalue(v89)+'">',nodeset2boolean(m.n(j28,v90))&&nodeset2boolean(m.n(j29,v90)))if(cmpSN("orig",v89)){var j46=[0,"*",2,p8];r0+=nodeset2xml(m.n(j46,yr.object2nodeset(v84))),r0+=" ("+nodeset2xml(m.n(j28,v90))+"×"+nodeset2xml(m.n(j29,v90))+" px)"}else r0+=nodeset2xml(m.n(j28,v90))+"×"+nodeset2xml(m.n(j29,v90))+" px";else{var j45=[0,"*",2,p7];r0+=nodeset2xml(m.n(j45,yr.object2nodeset(v84)))}r0+="</option>"}return r0+="</select>",r0+='<span class="select-focus"></span>',r0+="</span>"},M.t19.j=j41,M.t19.a=0,M.t20=function(m,c0,i0,l0,a0){function p9(m,c0){return cmpSN(c0.name,m.s(j47,c0.doc.root))}var r0="",v91=selectNametest("photo",c0,[]),j48=[0,"sizes",0,"*",2,p9],v92=m.n(j48,v91),v93=m.s(j49,c0.doc.root),r1="";r1+=nodeset2boolean(m.n(j50,v91))?yr.externals.generateDeanimatedUrl(nodeset2scalar(m.n(j27,v92))):nodeset2scalar(m.n(j27,v92));var v94=r1,r1=[];r1=yr.externals.strlen(nodeset2scalar(m.n(j21,v91)))>0?m.n(j21,v91):m.n(j22,v91);var v95=r1;if(r0+=closeAttrs(a0),cmpSN("bbCode",v93))r0+="[url="+nodeset2xml(selectNametest("pageUrl",c0,[]))+"]",r0+="[img]",r0+=scalar2xml(v94),nodeset2boolean(m.n(j25,v91))&&(r0+=".",r0+=nodeset2xml(m.n(j25,v91))),r0+="[/img]",r0+="[/url]",nodeset2boolean(m.s(j52,c0))&&(r0+="\n",r0+=nodeset2xml(v95));else{if(r0+='<a href="'+xml2attrvalue(simpleScalar("pageUrl",c0))+'" target="_blank">',r0+="<img",a0.a={src:new yr.scalarAttr(v94),width:new yr.scalarAttr(nodeset2scalar(m.n(j28,v92))),height:new yr.scalarAttr(nodeset2scalar(m.n(j29,v92))),border:new yr.scalarAttr("0")},a0.s="img",nodeset2boolean(m.n(j25,v91))){var tmp0=a0.a.src;a0.a.src=tmp0?tmp0.addscalar("."+nodeset2scalar(m.n(j25,v91))):new yr.scalarAttr("."+nodeset2scalar(m.n(j25,v91)))}nodeset2boolean(m.s(j52,c0))&&(a0.a.title=new yr.scalarAttr(nodeset2scalar(v95)),a0.a.alt=new yr.scalarAttr(nodeset2scalar(v95))),r0+=closeAttrs(a0),r0+="",r0+="</a>"}return r0},M.t20.j=1,M.t20.a=1,M.t21=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j55,c0),"stat-loading",a0),r0+=m.a(m,0,m.s(j56,c0.doc.root),"stat-loaded",a0),r0+=m.a(m,0,m.s(j57,c0),"stat-error",a0),r0+=closeAttrs(a0),r0+='<div class="popup-close js-close"></div>',r0+='<div class="popup-tail"></div>'},M.t21.j=j32,M.t21.a=0,M.t22=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="popup-content popup-content_stat js-stat-content">',r0+='<div class="stat__loading">Загрузка просмотров…</div>',r0+="</div>"},M.t22.j=j32,M.t22.a=0,M.t23=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="popup-content popup-content_stat">',r0+='<div class="stat__error">Ошибка при получении просмотров</div>',r0+="</div>"},M.t23.j=j32,M.t23.a=0,M.t24=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div>",r0+="<div",a0.a={"class":new yr.scalarAttr("popup-content popup-content_stat popup-content_head")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"stat-summary",a0),r0+=closeAttrs(a0),r0+="</div>",r0+='<div class="popup-content popup-content_stat">',r0+='<div class="stat__title">Источники</div>',r0+=m.a(m,0,m.s(j58,c0),"stat-item",a0),r0+=m.a(m,0,m.s(j10,c0),"stat-more",a0),r0+="</div>",r0+="</div>"},M.t24.j=1,M.t24.a=1,M.t25=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="stat__title">Количество просмотров</div>',r0+='<div class="stat__item stat__item_head">',r0+='<span class="stat__item-inner">',r0+='<span class="stat__item-content">',r0+='<span class="stat__item-name">Сегодня</span>',r0+="</span>",r0+="</span>",r0+='<span class="stat__item-counter">'+m.f("f5",c0,i0,l0,a0,simpleScalar("day",c0))+"</span>",r0+="</div>",r0+='<div class="stat__item stat__item_head">',r0+='<span class="stat__item-inner">',r0+='<span class="stat__item-content">',r0+='<span class="stat__item-name">За 7 дней</span>',r0+="</span>",r0+="</span>",r0+='<span class="stat__item-counter">'+m.f("f5",c0,i0,l0,a0,simpleScalar("week",c0))+"</span>",r0+="</div>",r0+='<div class="stat__item stat__item_head">',r0+='<span class="stat__item-inner">',r0+='<span class="stat__item-content">',r0+='<span class="stat__item-name">Всего</span>',r0+="</span>",r0+="</span>",r0+='<span class="stat__item-counter">'+m.f("f5",c0,i0,l0,a0,simpleScalar("total",c0))+"</span>",r0+="</div>"},M.t25.j=j32,M.t25.a=0,M.t26=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="stat__item">',r0+='<span class="stat__item-inner">',r0+='<span class="stat__item-content">',r0+='<span class="stat__item-bull">'+scalar2xml(i0+1)+".</span>",r0+="<span",a0.a={"class":new yr.scalarAttr("stat__item-name"),title:new yr.scalarAttr(nodeset2scalar(selectNametest("url",c0,[])))},a0.s="span",r0+=m.a(m,0,m.s(j10,c0),"stat-item-body",a0),r0+=closeAttrs(a0),r0+="</span>",r0+="</span>",r0+="</span>",r0+='<span class="stat__item-counter">'+m.f("f5",c0,i0,l0,a0,simpleScalar("count",c0))+"</span>",r0+="</div>"},M.t26.j=j62,M.t26.a=0,M.t27=function(m,c0,i0,l0,a0){var r0="",v96=yr.externals.sum(m.s(j64,c0)),v97=simpleScalar("total",c0)-v96;return r0+=closeAttrs(a0),v97>0&&(r0+='<div class="stat__item">',r0+='<span class="stat__item-inner">',r0+='<span class="stat__item-content">',r0+='<span class="stat__item-bull"></span>',r0+='<span class="stat__item-name">Остальные</span>',r0+="</span>",r0+="</span>",r0+='<span class="stat__item-counter">'+m.f("f5",c0,i0,l0,a0,v97)+"</span>",r0+="</div>"),r0},M.t27.j=j32,M.t27.a=0,M.t28=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<a class="link js-stat-link" href="http://'+nodeset2attrvalue(selectNametest("url",c0,[]))+'" target="_blank">',r0+=nodeset2xml(selectNametest("url",c0,[])),r0+="</a>"},M.t28.j=j62,M.t28.a=0,M.t29=function(m,c0,i0,l0,a0){function p14(m,c0){return cmpSN(c0.name,v99)}var r0="",r1={},r2={};r2.title="Яндекс.Фотки",r2.ya="1",r1.fotki=r2;var r2={};r2.title="Яндекс",r2.ya="1",r1.yandex=r2;var r2={};r2.title="Яндекс на устройствах",r2.ya="1",r1["yandex-embeded"]=r2;var r2={};r2.title="Яндекс.Почта",r2.ya="1",r1["mail-ya"]=r2;var r2={};r2.title="Яндекс.Карты",r2.ya="1",r1.maps=r2;var r2={};r2.title="Яндекс.Виджет в телевизорах LG",r2.ya="1",r1["hw-lg"]=r2;var r2={};r2.title="Яндекс.Панель для Opera",r2.ya="1",r1["panel-opera"]=r2;var r2={};r2.title="Яндекс.Открытки",r2.ya="1",r1["cards-ya"]=r2;var r2={};r2.title="Записи друзей на Я.ру",r2.ya="1",r1["friend-ya"]=r2;var r2={};r2.title="Яндекс.Виджет",r2.ya="1",r1["widget-ya"]=r2;var r2={};r2.title="Почта",r1.mail=r2;var r2={};r2.title="Микроблоги",r1.microblog=r2;var r2={};r2.title="Ленты друзей",r1.friend=r2;var r2={};r2.title="RSS",r1.RSS=r2;var r2={};r2.title="Лента друзей в LiveJournal",r1["friend-lj"]=r2;var r2={};r2.title="Социальные сети",r1.social=r2;var v98=r1,v99=selectNametest("special",c0,[]),j67=[0,"*",2,p14],v100=m.n(j67,yr.object2nodeset(v98));if(r0+=closeAttrs(a0),r0+="<span",a0.a={"class":new yr.scalarAttr("stat__item-special")},a0.s="span",nodeset2boolean(v100)&&nodeset2boolean(m.n(j68,v100))){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" stat__item-special-ya"):new yr.scalarAttr(" stat__item-special-ya")}return r0+=closeAttrs(a0),nodeset2boolean(v100)&&nodeset2boolean(m.n(j27,v100))?(r0+='<a class="link js-stat-link" href="'+nodeset2attrvalue(m.n(j27,v100))+'">',r0+=nodeset2xml(m.n(j21,v100)),r0+="</a>"):r0+=nodeset2xml(nodeset2boolean(v100)?m.n(j21,v100):v99),r0+="</span>"},M.t29.j=j66,M.t29.a=0,M.t30=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("popup-content popup-content_details text js-details-content")},a0.s="div",r0+=m.a(m,0,m.s(j70,c0.doc.root),"details-loading",a0),r0+=m.a(m,0,m.s(j71,c0.doc.root),"details-loaded",a0),r0+=m.a(m,0,m.s(j72,c0.doc.root),"details-error",a0),r0+=closeAttrs(a0),r0+="</div>",r0+='<div class="popup-tail"></div>',r0+='<div class="popup-close js-close"></div>'},M.t30.j=1,M.t30.a=1,M.t31=function(m,c0,i0,l0,a0){function p17(m,c0){return"camera"==c0.name||"lens"==c0.name}function p18(m,c0){return"camera"!=c0.name&&"lens"!=c0.name}var r0="",v101=selectNametest("photo",c0.doc.root,[]),j74=[0,"exif",0,"*",2,p17],j75=[0,"exif",0,"*",2,p18];return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("details__col details__col_name")},a0.s="div",r0+=m.a(m,0,m.s(j74,c0.doc.root),"details-item-name",a0),r0+=m.a(m,0,m.s(j75,c0.doc.root),"details-item-name",a0),r0+=m.a(m,0,m.n(j76,v101),"details-item-name",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("details__col details__col_value")},a0.s="div",r0+=m.a(m,0,m.s(j74,c0.doc.root),"details-item-value",a0),r0+=m.a(m,0,m.s(j75,c0.doc.root),"details-item-value",a0),r0+=m.a(m,0,m.n(j76,v101),"details-item-value",a0),r0+=closeAttrs(a0),r0+="</div>"},M.t31.j=1,M.t31.a=1,M.t32=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="details__loading">Загрузка EXIF…</div>'},M.t32.j=1,M.t32.a=1,M.t33=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="details__error">Ошибка при получении EXIF</div>'},M.t33.j=1,M.t33.a=1,M.t34=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),selectNametest("*",c0,[]).length?(r0+='<div class="details__group">',r0+="<div",a0.a={"class":new yr.scalarAttr("details__name details_group")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"details-name",a0),r0+=closeAttrs(a0),r0+="</div>",r0+=m.a(m,0,selectNametest("*",c0,[]),"details-item-name",a0),r0+="</div>"):(r0+="<div",a0.a={"class":new yr.scalarAttr("details__name")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"details-name",a0),r0+=closeAttrs(a0),r0+="</div>"),r0},M.t34.j=j32,M.t34.a=0,M.t35=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),selectNametest("*",c0,[]).length?(r0+='<div class="details__group">',r0+='<div class="details__value details_group">',r0+=" ",r0+="</div>",r0+=m.a(m,0,selectNametest("*",c0,[]),"details-item-value",a0),r0+="</div>"):(r0+="<div",a0.a={"class":new yr.scalarAttr("details__value")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"details-value",a0),r0+=closeAttrs(a0),r0+="</div>"),r0},M.t35.j=j32,M.t35.a=0,M.t36=function(m,c0,i0,l0,a0){function p19(m,c0){return c0.name==v103}function p20(m,c0){return c0.name==v103}var r0="",r1={};r1.camera="Камера",r1.make="Производитель",r1.model="Модель",r1.lens="Объектив",r1.isoSpeed="Чувствительность (ISO)",r1.fNumber="Диафрагма",r1.focalLength="Фокусное расстояние",r1.colorSpace="Пространство цветов",r1.artist="Автор",r1.copyright="Авторские права",r1.software="Программа",r1.dateTimeOriginal="Время съёмки",r1.added="Дата загрузки",r1.exposureTime="Выдержка",r1.exposureBias="Компенсация экспозиции",r1.exposureProgram="Режим съёмки",r1.flash="Вспышка",r1.fired="Использована",r1.mode="Режим",r1.redEye="Защита от красных глаз";var v102=r1,v103=c0.name,j77=[0,"*",2,p19];if(r0+=closeAttrs(a0),nodeset2boolean(m.n(j77,yr.object2nodeset(v102)))){var j78=[0,"*",2,p20];r0+=nodeset2xml(m.n(j78,yr.object2nodeset(v102)))}else r0+=scalar2xml(v103);return r0},M.t36.j=j32,M.t36.a=0,M.t37=function(m,c0,i0,l0,a0){function p21(m,c0){return c0.name==v107}function p22(m,c0){return c0.name==""+yr.nodeset2scalar(v108)}function p23(m,c0){return c0.name==""+yr.nodeset2scalar(v108)}var r0="",r1={};r1["false"]="нет",r1["true"]="да",r1.unknown="неизвестно";var v104=r1,r1={};r1.fNumber="f/";var v105=r1,r1={};r1.exposureTime=" сек",r1.focalLength=" мм",r1.exposureBias=" eV";var v106=r1,v107=c0.name,v108=m.s(j10,c0),j79=[0,"*",2,p21],v109=m.n(j79,yr.object2nodeset(v105)),v110=m.n(j79,yr.object2nodeset(v106)),r1=[],j80=[0,"*",2,p22];if(nodeset2boolean(m.n(j80,yr.object2nodeset(v104)))){var j81=[0,"*",2,p23];r1=m.n(j81,yr.object2nodeset(v104))}else r1=v108;var v111=r1;return r0+=closeAttrs(a0),r0+=nodeset2xml(v109),r0+=nodeset2xml(v111),r0+=nodeset2xml(v110)},M.t37.j=j32,M.t37.a=0,M.t38=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=scalar2xml(yr.externals.formatDateWithTZ(nodeset2scalar(m.s(j10,c0)),"D MMMM YYYY, HH:mm:ss"))},M.t38.j=j82,M.t38.a=0,M.t39=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=scalar2xml(yr.externals.formatDate(nodeset2scalar(m.s(j10,c0)),"D MMMM YYYY, HH:mm:ss"))},M.t39.j=j76,M.t39.a=0,M.t40=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("details__name")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"details-name",a0),r0+=closeAttrs(a0),r0+="</div>"},M.t40.j=j83,M.t40.a=0,M.t41=function(m,c0,i0,l0,a0){var r0="",v112="ru",v113="//market.yandex."+v112+"/search.xml?cvredirect=1&text="+nodeset2scalar(selectNametest("make",c0,[]))+" "+nodeset2scalar(selectNametest("model",c0,[]));return r0+=closeAttrs(a0),r0+='<div class="details__value" title="'+nodeset2attrvalue(selectNametest("make",c0,[]))+" "+nodeset2attrvalue(selectNametest("model",c0,[]))+'">',r0+='<a class="outer-link js-model" href="'+scalar2attrvalue(v113)+'" target="_blank">',r0+=nodeset2xml(selectNametest("make",c0,[])),r0+=" ",r0+=nodeset2xml(selectNametest("model",c0,[])),r0+="</a>",r0+="</div>"
},M.t41.j=j83,M.t41.a=0,M.t42=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("details__name")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"details-name",a0),r0+=closeAttrs(a0),r0+="</div>",r0+='<div class="details__name">',r0+=" ",r0+="</div>"},M.t42.j=j87,M.t42.a=0,M.t43=function(m,c0,i0,l0,a0){var r0="",v114="ru",r1="";r1+="//market.yandex."+v114+"/model.xml?modelid="+nodeset2scalar(m.s(j86,c0)),nodeset2boolean(m.s(j88,c0))&&(r1+="&hid="+nodeset2scalar(m.s(j88,c0)));var v115=r1,v116="/search.xml?grouping=on&modelid="+nodeset2scalar(m.s(j86,c0));return r0+=closeAttrs(a0),r0+='<div class="details__value" title="'+nodeset2attrvalue(m.s(j89,c0))+" "+nodeset2attrvalue(m.s(j90,c0))+'">',r0+='<a class="outer-link js-model" href="'+scalar2attrvalue(v115)+'" target="_blank">',r0+=nodeset2xml(m.s(j89,c0)),r0+=" ",r0+=nodeset2xml(m.s(j90,c0)),r0+="</a>",r0+="</div>",r0+='<div class="details__value">',r0+='<a class="link js-model-shots" href="'+scalar2attrvalue(v116)+'">снимки, сделанные этим устройством</a>',r0+="</div>"},M.t43.j=j87,M.t43.a=0,M.t44=function(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("details__value")},a0.s="div";var r1="",a1={a:{}};return r1+=m.a(m,0,m.s(j10,c0),"details-value",a1),a0.a.title=new yr.xmlAttr(r1),r0+=m.a(m,0,m.s(j10,c0),"details-value",a0),r0+=closeAttrs(a0),r0+="</div>"},M.t44.j=j91,M.t44.a=0,M.t45=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("details__name")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"details-name",a0),r0+=closeAttrs(a0),r0+="</div>"},M.t45.j=j93,M.t45.a=0,M.t46=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="details__value">',r0+=simpleBoolean("fired",c0)?"сработала":"отключена",r0+="</div>"},M.t46.j=j93,M.t46.a=0,M.t47=function(m,c0,i0,l0,a0){function p26(m,c0){return c0.name==""+yr.nodeset2scalar(v118)}function p27(m,c0){return c0.name==""+yr.nodeset2scalar(v118)}var r0="",r1={};r1[0]="авто",r1[1]="ручной",r1[2]="обычный",r1[3]="приоритет диафрагмы",r1[4]="приоритет выдержки",r1[5]="творческий",r1[6]="спорт",r1[7]="портрет",r1[8]="пейзаж";var v117=r1,v118=m.s(j10,c0),r1=[],j95=[0,"*",2,p26];if(nodeset2boolean(m.n(j95,yr.object2nodeset(v117)))){var j96=[0,"*",2,p27];r1=m.n(j96,yr.object2nodeset(v117))}else r1=v118;var v119=r1;return r0+=closeAttrs(a0),r0+=nodeset2xml(v119)},M.t47.j=j94,M.t47.a=0,M.t48=function(m,c0,i0,l0,a0,v120){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("complain js-complain"),"data-nb":new yr.scalarAttr("complain")},a0.s="div",v120&&(a0.a["data-nb-contest-id"]=new yr.scalarAttr(v120)),r0+=closeAttrs(a0),r0+='<div class="popup-content complain-form complain-form_new">',r0+='<div class="complain-form__row complain-form__head">',r0+="Укажите причину жалобы",r0+="</div>",r0+='<div class="complain-form__group">',r0+='<div class="complain-form__row js-copyright">',r0+='<label class="toggler">',r0+='<input class="toggler-controller" type="checkbox"/>',r0+='<span class="checkbox toggler-view"><span class="checkbox-icon"> </span></span>',r0+="Фото нарушает авторские права",r0+="</label>",r0+="</div>",v120&&(r0+='<div class="complain-form__row js-contest">',r0+='<label class="toggler">',r0+='<input class="toggler-controller" type="checkbox"/>',r0+='<span class="checkbox toggler-view"><span class="checkbox-icon"> </span></span>',r0+="Фото нарушает правила конкурса",r0+="</label>",r0+="</div>"),r0+='<div class="complain-form__row js-pron">',r0+='<label class="toggler">',r0+='<input class="toggler-controller" type="checkbox"/>',r0+='<span class="checkbox toggler-view"><span class="checkbox-icon"> </span></span>',r0+="Порнография",r0+="</label>",r0+="</div>",r0+='<div class="complain-form__row js-spam">',r0+='<label class="toggler">',r0+='<input class="toggler-controller" type="checkbox"/>',r0+='<span class="checkbox toggler-view"><span class="checkbox-icon"> </span></span>',r0+="Спам",r0+="</label>",r0+="</div>",r0+='<div class="complain-form__row js-violence">',r0+='<label class="toggler">',r0+='<input class="toggler-controller" type="checkbox"/>',r0+='<span class="checkbox toggler-view"><span class="checkbox-icon"> </span></span>',r0+="Демонстрация насилия и жестокости",r0+="</label>",r0+="</div>",r0+='<div class="complain-form__row js-other">',r0+='<label class="toggler">',r0+='<input class="toggler-controller" type="checkbox"/>',r0+='<span class="checkbox toggler-view"><span class="checkbox-icon"> </span></span>',r0+="Другое",r0+="</label>",r0+="</div>",r0+="</div>",r0+='<div class="complain-form__row js-link-to-origin is-hidden">',r0+='<input class="input" type="text" value="" placeholder="Укажите ссылку на оригинал"/>',r0+="</div>",r0+='<div class="complain-form__row js-matter is-hidden">',r0+='<textarea class="input" rows="5" cols="20" placeholder="Опишите суть жалобы"></textarea>',r0+="</div>",r0+='<div class="complain-form__row complain-form__error is-hidden js-error-send">',r0+="Жалоба не отправлена, попробуйте ещё раз.",r0+="</div>",r0+='<div class="complain-form__row complain-form__error is-hidden js-error-exist">',r0+="Подобная жалоба уже находится на рассмотрении.",r0+="</div>",r0+='<div class="complain-form__row">',r0+='<span class="button is-disabled js-button-send">',r0+='<span class="button-content">Отправить жалобу</span>',r0+="</span>",r0+="</div>",r0+='<div class="complain-form__row complain-form__note">',r0+="Если публикация этого изображения нарушает ваши права, действуйте согласно ",r0+='<a class="link js-help" href="'+scalar2attrvalue(yr.externals.generateUrl("rights"))+'" target="_blank">инструкции</a>',r0+=".",r0+="</div>",r0+="</div>",r0+='<div class="popup-content complain-form complain-form_sent is-hidden">',r0+='<div class="complain-form__row complain-form__head">',r0+="Жалоба отправлена модератору",r0+="</div>",r0+='<div class="complain-form__row complain-form__one-more">',r0+='<a class="link js-send-one-more">Отправить ещё жалобу</a>',r0+="</div>",r0+="</div>",r0+="</div>",r0+='<div class="popup-tail"></div>',r0+='<div class="popup-close js-close"></div>'},M.t48.j=j32,M.t48.a=0,M.t49=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Неправильный формат ссылки"},M.t49.j=1,M.t49.a=1,M.t50=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="popup error-popup" data-nb="islands-ballon">',r0+='<div class="popup-tail"></div>',r0+=simpleScalar("message",c0),r0+="</div>"},M.t50.j=1,M.t50.a=1,M.t51=function(m,c0,i0,l0,a0){var r0="";if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("popup error-popup error-popup-ballon error-popup-ballon-fixed with-close is-hidden"),"data-nb":new yr.scalarAttr("islands-ballon-fixed")},a0.s="div",simpleBoolean("photo",c0)){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" with-photo"):new yr.scalarAttr(" with-photo")}return r0+=closeAttrs(a0),r0+='<div class="popup-close popup__close js-error-close"></div>',simpleBoolean("photo",c0)&&(r0+='<div class="error-popup-photo" style="background-image: url(\''+nodeset2attrvalue(m.s(j98,c0))+"');\"></div>"),r0+='<span class="error-popup-message">',r0+=simpleScalar("message",c0),r0+="</span>",simpleBoolean("buttons",c0)&&(r0+="<div",a0.a={"class":new yr.scalarAttr("error-popup-buttons")},a0.s="div",r0+=m.a(m,0,m.n(j9,yr.array2nodeset(yr.externals.split(simpleScalar("buttons",c0),","))),"error-popup-button",a0),r0+=closeAttrs(a0),r0+="</div>"),r0+="</div>"},M.t51.j=1,M.t51.a=1,M.t52=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),cmpSN("ok",m.s(j10,c0))&&(r0+='<button class="small-action-button js-ok" type="button">',r0+='<span class="button-content">Да</span>',r0+="</button>"),cmpSN("retry",m.s(j10,c0))&&(r0+='<button class="small-action-button js-ok" type="button">',r0+='<span class="button-content">Повторить</span>',r0+="</button>"),cmpSN("cancel",m.s(j10,c0))&&(r0+='<button class="small-button popup__close js-cancel" type="button">',r0+='<span class="button-content">Отменить</span>',r0+="</button>"),cmpSN("close",m.s(j10,c0))&&(r0+='<button class="small-button popup__close js-cancel" type="button">',r0+='<span class="button-content">Закрыть</span>',r0+="</button>"),r0},M.t52.j=j32,M.t52.a=0,M.t53=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_edit">',r0+='<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="16" height="16"><path fill="currentColor" d="M 7.6517 10.4633 L 5.0068 10.9922 L 5.5359 8.3475 L 13.8833 0 L 15.9991 2.1158 L 7.6517 10.4633 ZM 2 13.9991 L 12 13.9991 L 12 8.9991 L 14 8.9991 L 14 15.9991 L 0 15.9991 L 0 1.9991 L 7 1.9991 L 7 3.9991 L 2 3.9991 L 2 13.9991 Z"></path></svg>',r0+="</span>"},M.t53.j=1,M.t53.a=1,M.t54=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_trash">',r0+='<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="14" height="18" viewBox="-2.5 499.5 14 18"><path fill="currentColor" d="M-2.5,502.5v-2h5v-1h4v1h5v2H-2.5z M10.5,517.5h-12v-14h12V517.5z M2.5,505.5h-2v10h2V505.5z M5.5,505.5h-2v10 h2V505.5z M8.5,505.5h-2v10h2V505.5z"></path></svg>',r0+="</span>"},M.t54.j=1,M.t54.a=1,M.t55=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_access">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="16" height="16"><path fill="currentColor" d="M 12.8904 4.5254 C 14.5604 6.8686 14.3457 10.1412 12.2434 12.2434 C 10.1412 14.3457 6.8685 14.5604 4.5253 12.8905 L 12.8904 4.5254 ZM 3.1111 11.4763 C 1.4412 9.133 1.6559 5.8604 3.7582 3.7582 C 5.8604 1.6559 9.133 1.4412 11.4762 3.1112 L 3.1111 11.4763 ZM 2.3439 13.6577 C 2.5834 13.8971 2.8329 14.1196 3.0934 14.3223 C 6.2319 16.7649 10.7729 16.5424 13.6577 13.6577 C 16.5424 10.7729 16.7649 6.2319 14.3223 3.0935 C 14.1196 2.833 13.8971 2.5834 13.6577 2.3439 C 13.4182 2.1045 13.1686 1.882 12.9081 1.6793 C 9.7697 -0.7633 5.2288 -0.5408 2.3439 2.3439 C -0.5408 5.2287 -0.7633 9.7697 1.6793 12.9081 C 1.882 13.1686 2.1045 13.4182 2.3439 13.6577 ZM 1.6793 12.9081 L 1.6368 12.9506 L 2.3439 13.6577 C 2.1045 13.4182 1.882 13.1686 1.6793 12.9081 ZM 13.6577 2.3439 L 12.9506 1.6369 L 12.9081 1.6793 C 13.1686 1.882 13.4182 2.1045 13.6577 2.3439 ZM 14.3223 3.0935 L 14.3647 3.0511 L 13.6577 2.3439 C 13.8971 2.5834 14.1196 2.833 14.3223 3.0935 ZM 2.3439 13.6577 L 3.051 14.3648 L 3.0934 14.3223 C 2.8329 14.1196 2.5834 13.8971 2.3439 13.6577 Z"></path></svg>',r0+="</span>"},M.t55.j=1,M.t55.a=1,M.t56=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_help">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="16" height="16"><path fill="currentColor" d="M 8.0001 0 C 3.582 0 0 3.5821 0 8 C 0 12.418 3.582 16 8.0001 16 C 12.418 16 16.0001 12.418 16.0001 8 C 16.0001 3.5821 12.418 0 8.0001 0 ZM 9 12.9999 L 7 12.9999 L 7 11 L 9 11 L 9 12.9999 ZM 11.5928 6.7798 C 11.3262 7.1309 10.7578 7.6079 9.8857 8.2129 C 9.4355 8.5253 9.1563 8.7753 9.0459 8.9658 C 8.9375 9.1563 8.8887 9.496 8.8984 9.9863 L 6.959 9.9863 C 6.9551 9.7539 6.9521 9.6113 6.9521 9.5625 C 6.9521 9.039 7.0562 8.6075 7.2642 8.27 C 7.4712 7.9312 7.8872 7.5508 8.5098 7.1278 C 9.1339 6.7061 9.5059 6.4292 9.6279 6.2979 C 9.8164 6.0908 9.9092 5.8618 9.9092 5.6129 C 9.9092 5.267 9.7432 4.9702 9.4111 4.7231 C 9.0791 4.4771 8.6318 4.354 8.0688 4.354 C 7.527 4.354 7.0732 4.4828 6.7081 4.7402 C 6.3438 4.998 6.0928 5.3911 5.9561 5.918 L 3.9951 5.7157 C 4.0508 4.9599 4.4371 4.1611 5.1538 3.6328 C 5.8712 3.1049 6.8121 2.8408 7.978 2.8408 C 9.2041 2.8408 10.1797 3.1089 10.9044 3.6431 C 11.6279 4.1768 11.9912 4.9551 11.9912 5.665 C 11.9912 6.0581 11.8574 6.4302 11.5928 6.7798 Z"></path></svg>',r0+="</span>"},M.t56.j=1,M.t56.a=1,M.t57=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_18plus">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="29" height="14"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M7,0H4.52C4.17,0.9,3.53,1.69,2.59,2.36C1.66,3.03,0.8,3.5,0,3.73 v2.8C1.53,6.04,2.86,5.25,4,4.2V14h3V0z"></path><path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M13.36,8.17c0.25-0.47,0.62-0.7,1.14-0.7 c0.44,0,0.8,0.22,1.08,0.62C15.86,8.5,16,9.06,16,9.73c0,0.78-0.14,1.38-0.42,1.79c-0.28,0.41-0.64,0.61-1.05,0.61 c-0.44,0-0.81-0.2-1.09-0.64C13.14,11.07,13,10.47,13,9.7C13,9.14,13.11,8.63,13.36,8.17z M13.41,2.38 c0.28-0.34,0.64-0.51,1.11-0.51c0.43,0,0.79,0.17,1.07,0.51C15.86,2.71,16,3.15,16,3.7c-0.09,0.6-0.25,1.07-0.48,1.4 c-0.24,0.34-0.58,0.5-1.04,0.5c-0.45,0-0.76-0.16-0.95-0.5C13.34,4.78,13.16,4.32,13,3.72C13,3.16,13.13,2.73,13.41,2.38z M10.63,7.89C10.2,8.5,10,9.17,10,9.9c0,1.33,0.48,2.38,1.47,3.14c0.81,0.64,1.86,0.96,3.11,0.96c1.33,0,2.39-0.38,3.2-1.17 C18.59,12.06,19,11.04,19,9.79c0-0.75-0.23-1.4-0.67-1.99c-0.45-0.58-1.11-1.02-1.95-1.33c0.82-0.26,1.46-0.64,1.93-1.15 C18.77,4.83,19,4.24,19,3.59c0-1.02-0.41-1.88-1.19-2.57C17.03,0.35,15.92,0,14.5,0c-1.44,0-2.55,0.35-3.33,1.02 C10.39,1.71,10,2.57,10,3.59c0,0.61,0.2,1.18,0.61,1.69c0.41,0.51,1.08,0.9,1.98,1.19C11.69,6.81,11.03,7.28,10.63,7.89z"></path><polygon fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" points="21,6 21,8 24,8 24,11 26,11 26,8 29,8 29,6 26,6 26,3 24,3 24,6"></polygon></svg>',r0+="</span>"},M.t57.j=1,M.t57.a=1,M.t58=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_16 icon_pseudo icon_layout-expand">',r0+='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="13"><polygon fill="currentColor" points="1,0 1,5 3,5 3,2 13,2 13,10 9,10 9,12 15,12 15,0"></polygon><polygon fill="currentColor" points="0,6 0,12 8,12 8,6.02"></polygon></svg>',r0+="</span>"},M.t58.j=1,M.t58.a=1,M.t59=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_16 icon_pseudo icon_layout-collapse">',r0+='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="13"><polygon fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" points="7,0 7,2 14,2 14,7 16,7 16,0"></polygon><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M0,3v10h13V3H0z M2,5h9v6H2V5z"></path></svg>',r0+="</span>"},M.t59.j=1,M.t59.a=1,M.t60=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_share">',r0+='<svg xmlns="http://www.w3.org/2000/svg" width="12" height="17"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M6.98 12h-1.98v-6h-3l4-6 4 6h-3l-.02 6zm-6.98 5v-9h2l-.02 7h8.02v-7h2v9h-12z"></path></svg>',r0+="</span>"},M.t60.j=1,M.t60.a=1,M.t61=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_16 icon_pseudo icon_lock">',r0+='<svg width="12" height="15" xmlns="http://www.w3.org/2000/svg"><path d="m11,6l0,-1c0,0 -0.062,-5 -5,-5s-5,5 -5,5l0,1l-1,0l0,7c0,0 0,2 2,2l8,0c0,0 2,0.062 2,-2l0,-7l-1,0zm-2,0l-6,0l0,-1c0,0 0,-3 3,-3s3,3 3,3l0,1z" clip-rule="evenodd" fill-rule="evenodd" fill="currentColor"></path></svg>',r0+="</span>"},M.t61.j=1,M.t61.a=1,M.t62=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_16 icon_pseudo icon_medal">',r0+='<svg xmlns="http://www.w3.org/2000/svg" width="15" height="14" viewBox="-2.5 115.5 15 14" enable-background="new -2.5 115.5 15 14">',r0+='<path fill="currentColor" d="M12.454 117.5c-.103-.269-.719-1-.994-1h-1.987v-1h-8.946s.005.663 0 1h-1.987c-.275 0-.89.731-.994 1-.266.693.67 2.411 1.882 3.521.569.52 2.751 1.089 2.736 1.16.423.476 2.339 1.619 2.339 2.319v3l-1.988 1h-.994c.036.497 0 1 0 1h6.957000000000001v-1c0-.01-.994 0-.994 0l-1.988-1v-3c0-.701 1.916-1.844 2.339-2.319-.015-.071 2.168-.641 2.736-1.16 1.214-1.11 2.15-2.828 1.883-3.521zm-13.914 0h1.988c.037 1.174.119 2.182.944 3.689-.64-.01-1.187-.219-1.631-.625-1.147-1.051-1.583-3.064-1.301-3.064zm11.619 3.064c-.444.406-.991.615-1.631.625.826-1.507.908-2.515.945-3.689h1.988c.281 0-.154 2.013-1.302 3.064z"></path>',r0+="</svg>",r0+="</span>"},M.t62.j=1,M.t62.a=1,M.t63=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_pseudo icon_rotate-ccw">',r0+='<svg class="svg-icon" xmlns="http://www.w3.org/2000/svg" width="15" height="16"><g><path fill="currentColor" d="M 11 11.9 C 13.2823 11.4367 15 9.419 15 7 C 15 4.2385 12.7615 2 10 2 C 9.2889 2 8.6125 2.1474 8 2.415 L 8 3.535 C 8.5883 3.1947 9.2714 3 10 3 C 12.2092 3 14 4.7908 14 7 C 14 8.8639 12.7252 10.431 11 10.875 L 11 11.9 Z"></path><path fill="currentColor" d="M 5 2.5 L 8 0 L 8 5 L 5 2.5 Z"></path><path fill="currentColor" d="M 0 7 L 0 16 L 9 16 L 9 7 L 0 7 Z"></path></g></svg>',r0+="</span>"},M.t63.j=1,M.t63.a=1,M.t64=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_pseudo icon_cross js-go-back">',r0+='<svg xmlns="http://www.w3.org/2000/svg" width="31" height="31"><path fill="currentColor" d="M0,29.698l1.414,1.414l14.142-14.142l14.142,14.142 l1.414-1.414L16.971,15.556L31.113,1.414L29.698,0L15.556,14.142L1.414,0L0,1.414l14.142,14.142L0,29.698z"></path></svg>',r0+="</span>"},M.t64.j=1,M.t64.a=1,M.t65=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_pseudo icon_cross-small">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="14" height="14"><path fill="currentColor" d="M14.5,0.2l-0.7-0.7L7.5,5.799L1.2-0.5L0.5,0.2l6.3,6.3 l-6.3,6.299L1.2,13.5l6.3-6.3l6.3,6.3l0.7-0.701L8.2,6.5L14.5,0.2z"></path></svg>',r0+="</span>"},M.t65.j=1,M.t65.a=1,M.t66=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_pin">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="11" height="18"><path fill="currentColor" d="M11 5.361c0-2.961-2.462-5.361-5.5-5.361-3.037 0-5.5 2.4-5.5 5.361s2.463 5.362 5.5 5.362l-1.965 7.277c4.666-6.319 7.465-9.027 7.465-12.639zm-7.621 0c0-1.142.949-2.067 2.121-2.067s2.121.926 2.121 2.067c0 1.143-.949 2.068-2.121 2.068s-2.121-.925-2.121-2.068z"></path></svg>',r0+="</span>"},M.t66.j=1,M.t66.a=1,M.t67=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_eye">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="19" height="19"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M9,4.561c-1.08,0-1.96,0.96-1.96,2.06c0,1.131,0.88,2.04,1.96,2.04 c1.061,0,1.98-0.909,1.98-2.04C10.98,5.521,10.061,4.561,9,4.561z M13.41,6.62c0-2.51-1.99-4.57-4.41-4.57S4.59,4.11,4.59,6.62 c0,2.52,1.99,4.58,4.41,4.58S13.41,9.14,13.41,6.62z M18,6.62c0,0-3.62,6.49-9,6.49S0,6.62,0,6.62s3.62-6.51,9-6.51S18,6.62,18,6.62 z"></path></svg>',r0+="</span>"},M.t67.j=1,M.t67.a=1,M.t68=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_heart">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="16.998" height="14"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M12.398.04c-.257-.025-.498-.04-.723-.04-1.812 0-2.681 1.346-3.676 2.348-.993-1.002-1.863-2.348-3.674-2.348-.226 0-.468.015-.724.04-1.569.127-3.381 1.345-3.601 3.694v.773c.206 2.247 2.192 5.015 7.999 8.493 5.808-3.478 7.796-6.246 8.001-8.493v-.773c-.221-2.349-2.034-3.567-3.602-3.694z"></path></svg>',r0+="</span>"},M.t68.j=1,M.t68.a=1,M.t69=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_star">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="17" height="15"><polygon fill="currentColor" points="8.5,0 10.971,4.939 17,6 12.5,9.57 13.439,15 8.5,12.439 3.561,15 4.5,9.57 0,6 6.029,4.939"></polygon></svg>',r0+="</span>"},M.t69.j=1,M.t69.a=1,M.t70=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_code">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="19" height="11"><path fill="currentColor" d="M 0 5.5 L 5.6043 11 L 7.0053 9.625 L 2.8022 5.5 L 7.0053 1.3751 L 5.6043 0 L 1.4011 4.125 L 0 5.5 ZM 19 5.5 L 17.5989 4.125 L 13.3957 0 L 11.9947 1.3751 L 16.1978 5.5 L 11.9947 9.625 L 13.3957 11 L 19 5.5 Z"></path></svg>',r0+="</span>"},M.t70.j=1,M.t70.a=1,M.t71=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_envelope">',r0+='<svg version="1" xmlns="http://www.w3.org/2000/svg" width="20" height="13" class="svg-icon"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M18 0h-16c-1.104 0-2 .896-2 2v9c0 1.104.896 2 2 2h16c1.104 0 2-.896 2-2v-9c0-1.104-.896-2-2-2zm.537 2.051c.029.09.057.181.057.281v8.336c0 .097-.027.186-.056.273l-5.673-4.437 5.672-4.453zm-1.056-.645l-6.544 5.125h-1.874l-6.544-5.125h14.962zm-16.02 9.535c-.028-.088-.055-.177-.055-.273v-8.336c0-.1.028-.191.057-.281l5.672 4.453-5.674 4.437zm.871.653l-.119-.024 5.707-4.449 1.08.848h2l1.079-.848 5.708 4.448-.119.024h-15.336z"></path></svg>',r0+="</span>"},M.t71.j=1,M.t71.a=1,M.t72=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_what">',r0+='<svg version="1" xmlns="http://www.w3.org/2000/svg" width="17" height="17" class="svg-icon"><path fill="currentColor" d="M8.458.073c-4.631 0-8.385 3.754-8.385 8.385s3.754 8.384 8.385 8.384 8.384-3.753 8.384-8.384-3.753-8.385-8.384-8.385zm0 15.481c-3.919 0-7.096-3.178-7.096-7.096 0-3.919 3.177-7.096 7.096-7.096 3.918 0 7.096 3.177 7.096 7.096 0 3.918-3.178 7.096-7.096 7.096zm-1.11-2.624h2.028v-1.99h-2.028v1.99zm3.579-8.566c-.25-.25-.579-.458-.988-.626-.409-.169-.919-.252-1.531-.252-.474 0-.903.08-1.286.239-.383.16-.71.381-.982.665-.27.285-.481.621-.633 1.007-.15.388-.23.814-.239 1.279h1.899c0-.233.025-.451.078-.652.051-.203.131-.38.239-.53s.245-.271.413-.362c.168-.091.368-.136.601-.136.345 0 .614.095.808.284.194.19.292.483.292.88.007.231-.034.426-.124.582-.09.154-.209.296-.355.425-.147.13-.306.259-.479.388-.172.129-.336.282-.49.459-.155.177-.291.389-.408.639-.117.25-.187.561-.212.93v.581h1.744v-.49c.034-.259.118-.474.251-.646.134-.173.286-.325.459-.459.172-.133.355-.267.549-.399.193-.134.37-.295.529-.485.16-.189.293-.417.401-.684.106-.267.16-.608.16-1.021 0-.25-.054-.519-.16-.808-.108-.289-.286-.557-.536-.808z"></path></svg>',r0+="</span>"},M.t72.j=1,M.t72.a=1,M.t73=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_gear">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="22" height="22"><path fill="currentColor" d="M20.197,4.553l1.813,3.692l-2.62,1.985c0.066,0.626,0.077,1.264-0.012,1.909l2.535,2.057l-1.9,3.62l-3.203-0.84 c-0.426,0.384-0.898,0.711-1.394,1l-0.039,3.23l-4.093,0.798l-1.366-2.978c-0.298-0.048-0.6-0.099-0.898-0.177 c-0.263-0.069-0.518-0.151-0.769-0.242l-2.606,1.975l-3.226-2.62l1.521-2.897c-0.287-0.478-0.52-0.985-0.702-1.512l-3.249-0.762 l0.051-4.08l3.287-0.643c0.201-0.522,0.458-1.01,0.755-1.467L2.636,3.652l3.29-2.492l2.585,2.097 c0.532-0.169,1.088-0.267,1.652-0.328l1.442-2.933l4.07,0.957l-0.039,3.246c0.485,0.309,0.919,0.68,1.324,1.073L20.197,4.553z M12.176,7.067C9.949,6.483,7.674,7.769,7.093,9.938c-0.579,2.168,0.754,4.4,2.979,4.984c2.229,0.583,4.504-0.7,5.084-2.872 C15.735,9.882,14.403,7.651,12.176,7.067z"></path></svg>',r0+="</span>"},M.t73.j=1,M.t73.a=1,M.t74=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_door">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="16" height="16"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M5 0L    5 2 14 2 14 14 5 14 5 16 16 16 16 0zM0 6h6v-3l6 5-6 5v-3h-6v-4z"></path></svg>',r0+="</span>"},M.t74.j=1,M.t74.a=1,M.t75=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_comment">',r0+='<svg width="18" height="17" xmlns="http://www.w3.org/2000/svg" class="svg-icon"><path d="m9,13l-0.42,-0.01l-4.58,4.01l0,-4.61c-2.41,-0.77 -4,-2.46 -4,-5.89c0,-3.59 2.16,-6.5 9,-6.5c7,0 9.01,2.91 9,6.5c-0.02,4.49 -4.028999,6.5 -9,6.5z" fill="currentColor"></path></svg>',r0+="</span>"},M.t75.j=1,M.t75.a=1,M.t76=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_letter">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="16" height="16"><path fill="currentColor" d="M0 2v12h16v-12h-16zm8 6l-7-5h14l-7 5z"></path></svg>',r0+="</span>"},M.t76.j=1,M.t76.a=1,M.t77=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_ufo">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="21" height="16"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M11.329 13.33c-1.646.435-3.189.65-4.356.646-.376-.001-.759-.023-1.1-.088l-.258-.062-.033.002c-.559.014-1.084 0-1.573-.037-1.895-.152-3.389-.713-3.692-1.843-.291-1.087.722-2.356 2.297-3.424.606-.409 1.045-.89 1.293-1.455 1.15-1.808 1.452-4.478 4.082-5.277l.506-.134c2.684-.603 4.269 1.569 6.164 2.572.433.321 1.065.522 1.863.623 1.896.15 3.393.71 3.692 1.841.301 1.133-.722 2.356-2.297 3.424-.405.275-.855.546-1.348.808l-.028.016-.197.186c-.265.223-.585.431-.908.615-1.013.579-2.461 1.152-4.107 1.587zm-.186-1.182c1.421-.36 2.476-.758 3.321-1.212.425-.229.646-.412.862-.573.194-.145.156-.275-.24-.382-.271-.073-.392-.045-.887-.04-.986.011-2.325.324-3.759.631-2.178.467-3.438 1.289-4.118 1.812-.336.261.09.514 1.117.468.985-.043 2.283-.342 3.704-.704zm-6.625.297c-.182-.688.642-1.42 1.504-1.913 1.013-.579 2.597-1.205 4.242-1.639 1.646-.435 3.184-.767 4.35-.764 1.004.004 2.265.254 2.446.939 0 0 .294-.117.542-.277 1.271-.818 1.356-1.229 1.195-1.836-.16-.606-.966-.962-2.955-1.12-1.888-.15-3.707-.241-6.378.464-2.67.706-4.552 1.908-6.121 2.967-1.635 1.102-1.854 1.836-1.776 2.313.072.433.495.94 2.485 1.099.859.067.466-.233.466-.233z"></path></svg>',r0+="</span>"},M.t77.j=1,M.t77.a=1,M.t78=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_disk">',r0+='<svg xmlns="http://www.w3.org/2000/svg" class="svg-icon" width="20" height="20" viewBox="0 0 20 20"><path fill-rule="evenodd" clip-rule="evenodd" fill="currentColor" d="M0.58,8.413c-0.1,0.11-0.21,0.23-0.29,0.33 C0.37,8.643,0.47,8.533,0.58,8.413z M0.29,8.743l-0.01,0.02L0.29,8.743z M0.28,8.763C0.16,8.903,0.06,9.043,0,9.153 C0.05,9.073,0.14,8.933,0.28,8.763z M8.65,4.313c-4.86,1.37-7.11,3.09-8.07,4.1c0.95-1.05,2.64-2.54,3.2-3.57 c0.72-1.31,0.73-3.76,3.82-4.64c3.1-0.87,4.34,1.29,5.51,2.01c1.13,0.69,3.25,1.04,4.53,1.43C16.36,3.273,13.55,2.933,8.65,4.313z M17.64,3.643l0.06,0.02L17.64,3.643z M17.7,3.663c0.14,0.04,0.27,0.09,0.39,0.13C17.98,3.753,17.86,3.703,17.7,3.663z M18.09,3.793 c0.16,0.07,0.29,0.12,0.35,0.16C18.34,3.893,18.22,3.843,18.09,3.793z M9.99,9.113c-2.19,0.55-3.86,1.4-3.71,1.92 c0.15,0.52,2.01,0.37,4.2-0.18c2.19-0.56,3.89-1.31,3.74-1.82C14.07,8.513,12.18,8.563,9.99,9.113z M14.98,9.693 c-1.01,0.68-2.53,1.33-4.32,1.78c-1.79,0.45-3.45,0.61-4.68,0.5c-2.94,0.16-5.11-0.34-5.37-1.23c-0.37-1.32,3.47-3.32,8.54-4.6 s9.45-1.36,9.82-0.04C19.23,6.993,17.6,8.443,14.98,9.693z"></path></svg>',r0+="</span>"},M.t78.j=1,M.t78.a=1,M.t79=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="icon icon_thumb-up">',r0+='<svg viewBox="0 0 21 23" xmlns="http://www.w3.org/2000/svg" width="21" height="23"><path d="M 11.0012 -0.0015 L 3.9908 10.9985 L 3.9908 18.9985 C 3.9908 18.9985 3.9287 22.9985 7.9968 22.9985 L 14.882 22.9985 C 14.882 22.9985 14.9221 23.0015 14.9935 23.0015 C 15.5334 23.0015 17.8787 22.8315 18.7628 19.936 L 20.8909 12.9985 C 20.8909 12.9985 21.9551 8.9985 16.8849 8.9985 L 14.0057 8.9985 C 14.0057 8.9985 13.9637 9.001 13.8912 9.001 C 13.3915 9.001 11.4521 8.8818 11.9714 6.9985 L 12.879 3.7173 C 12.879 3.7173 13.8492 -0.0015 11.0012 -0.0015 M 7.9968 20.9985 C 6.0251 20.9985 5.9938 18.8735 5.9938 18.8735 L 5.9938 11.5615 L 10.6257 3.9365 C 11.1885 3.9365 10.3132 6.1865 10.3132 6.1865 C 8.4975 10.9985 13.0355 10.9985 13.0355 10.9985 L 16.8849 10.9985 C 19.5139 10.9985 18.888 12.9985 18.888 12.9985 C 18.888 12.9985 18.0743 15.5649 17.1295 18.9829 C 16.5163 20.9224 15.1255 20.9995 14.9104 20.9995 C 14.8918 20.9995 14.882 20.9985 14.882 20.9985 L 7.9968 20.9985 M 1.9878 9.9985 L -0.0151 9.9985 L -0.0151 21.9985 L 1.9878 21.9985 L 1.9878 9.9985" fill="currentColor"></path></svg>',r0+="</span>"},M.t79.j=1,M.t79.a=1,M.t80=function(m,c0,i0,l0,a0,v121,v122,v123,v124){var r0="";if(v123){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button_checked"):new yr.scalarAttr(" ghost-button_checked")}if(v122){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" animate"):new yr.scalarAttr(" animate")}if(v121){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" js-like"):new yr.scalarAttr(" js-like"),a0.a.title=new yr.scalarAttr(v123?"Больше не нравится":"Мне нравится")}else{var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button_inactive"):new yr.scalarAttr(" ghost-button_inactive")}return r0+=m.a(m,0,[c0.doc.root],"icon_heart",a0),r0+=closeAttrs(a0),r0+='<span class="ghost-button__counter">'+scalar2xml(v124)+"</span>"},M.t80.j=j32,M.t80.a=0,M.t81=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" app"},M.t81.j=j101,M.t81.a=0,M.t82=function(m,c0,i0,l0,a0){var r0="",v125=nodeset2scalar(m.k("k0","region",c0.doc.root)),r1="";"Украина"==v125?r1+="//yandexgaua.hit.gemius.pl/redot.gif?id=okrlPPNuySwvX_98NSdul5SsfbuiXmMwBN835Et7rb..K7":"Беларусь"==v125&&(r1+="//yandexgaby.hit.gemius.pl/redot.gif?id=nAfg60BtI8pzszYSnTB8wqSf.jiiPiM6ZD3uq4sVz.f.L7");var v126=r1;return r0+=m.a(m,0,m.s(j10,c0),"ns-view-desc",a0),r0+=closeAttrs(a0),r0+='<i style="background:url(//www.tns-counter.ru/V13a****yandex_ru/ru/CP1251/tmsec=yandex_fotki/'+scalar2attrvalue(yr.externals.bigRandom())+')"></i>',v126&&(r0+='<i style="background:url('+scalar2attrvalue(v126)+')"></i>'),r0},M.t82.j=j101,M.t82.a=0,M.t83=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" content"},M.t83.j=j102,M.t83.a=0,M.t84=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" overlay"},M.t84.j=j103,M.t84.a=0,M.t85=function(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0),r0+='<div class="popup shortcuts" data-nb="islands-modal-popup">',r0+="<h3>Клавиатурные сокращения</h3>";for(var items0=selectNametest("keys",c0.doc.root,[]),i1=0,l1=items0.length;l1>i1;i1++){var c1=items0[i1];r0+=m.a(m,0,m.s(j10,c1),"shortcut",a0)}return r0+="</div>"},M.t85.j=1,M.t85.a=1,M.t86=function(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0),r0+='<div class="shortcut">';for(var items0=selectNametest("keys",c0,[]),i1=0,l1=items0.length;l1>i1;i1++){var c1=items0[i1];i1>0&&(r0+=" / "),simpleBoolean("shift",c1)&&(r0+=m.f("f9",c1,i1,l1,a0,"shift"),r0+=" + "),simpleBoolean("alt",c1)&&(r0+=m.f("f9",c1,i1,l1,a0,"alt"),r0+=" + "),simpleBoolean("ctrl",c1)&&(r0+=m.f("f9",c1,i1,l1,a0,"ctrl"),r0+=" + "),simpleBoolean("meta",c1)&&(r0+=m.f("f9",c1,i1,l1,a0,"meta"),r0+=" + "),r0+=m.f("f9",c1,i1,l1,a0,simpleScalar("keyName",c1))}return r0+='<div class="shortcut-action">',r0+=nodeset2xml(m.f("f8",c0,i0,l0,simpleScalar("actionName",c0))),r0+="</div>",r0+="</div>"},M.t86.j=j32,M.t86.a=0,M.t87=function(m,c0){var r0="";return r0},M.t87.j=j112,M.t87.a=0,M.t88=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=nodeset2scalar(m.f("f0",c0,i0,l0,"renderComponent"))},M.t88.j=j113,M.t88.a=0,M.t89=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=nodeset2scalar(m.f("f0",c0,i0,l0,"renderComponent"))},M.t89.j=j113,M.t89.a=0,M.t90=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=nodeset2scalar(m.f("f0",c0,i0,l0,"renderComponent"))},M.t90.j=j113,M.t90.a=0,M.t91=function(m,c0,i0,l0,a0){var r0="",v127=m.k("k0","ticket",c0.doc.root),r1={};r1.ticket=yr.nodeset2data(v127);var v128=r1;return r0+=closeAttrs(a0),r0+='<div class="foot">',r0+='<div class="foot-copyright">',r0+="<a",a0.a={"class":new yr.scalarAttr("unlike-link unlike-link_small-gap unlike-link_faded js-link"),"data-link":new yr.scalarAttr("help"),href:new yr.scalarAttr(yr.externals.generateUrl("help")),title:new yr.scalarAttr("Помощь")},a0.s="a",r0+=m.a(m,0,[c0.doc.root],"icon_what",a0),r0+=closeAttrs(a0),r0+="</a>",r0+="<a",a0.a={"class":new yr.scalarAttr("unlike-link unlike-link_small-gap unlike-link_faded js-link"),"data-link":new yr.scalarAttr("feedback"),href:new yr.scalarAttr(yr.externals.generateUrl("feedback")),title:new yr.scalarAttr("Обратная связь")},a0.s="a",r0+=m.a(m,0,[c0.doc.root],"icon_envelope",a0),r0+=closeAttrs(a0),r0+="</a>",r0+='<a class="unlike-link unlike-link_small-gap js-link" data-link="termofuse" href="'+scalar2attrvalue(yr.externals.generateUrl("legal"))+'">Условия использования</a>',r0+='<span class="foot-copyright-date">© 2008—'+scalar2xml(yr.externals.formatDateNow("YYYY"))+" </span>",r0+='<a class="unlike-link unlike-link_no-gap js-link" data-link="go to Yandex" href="'+scalar2attrvalue(yr.externals.generateUrl("yandex"))+'">«Яндекс»</a>',r0+="</div>",r0+='<div class="foot-aliases">',r0+='<a class="unlike-link js-link" data-link="blog" href="'+scalar2attrvalue(yr.externals.generateUrl("blog"))+'">Блог</a>',r0+='<a class="unlike-link js-link" data-link="mobile version" href="'+scalar2attrvalue(yr.externals.generateUrl("mobile",yr.externals["null"](),v128))+'">Мобильная версия</a>',r0+='<a class="unlike-link js-link" data-link="widgets" href="'+scalar2attrvalue(yr.externals.generateUrl("widgets"))+'">Виджеты</a>',r0+="</div>",r0+="</div>"
},M.t91.j=j114,M.t91.a=0,M.t92=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=nodeset2scalar(m.f("f0",c0,i0,l0,"renderComponentHTML"))},M.t92.j=j116,M.t92.a=0,M.t93=function(m,c0,i0,l0,a0){var r0="",v129=m.n(j118,m.k("k0","popular-tags",c0.doc.root));return r0+=v129.length>0?m.a(m,0,m.s(j10,c0),"popular-tag",a0):m.a(m,0,m.s(j10,c0),"no-popular-tag",a0)},M.t93.j=j117,M.t93.a=0,M.t94=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"no-popular-tag",a0)},M.t94.j=j117,M.t94.a=0,M.t95=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("teaser")},a0.s="div",r0+=m.a(m,0,m.s(j119,c0.doc.root),"ns-view",a0),r0+=closeAttrs(a0),r0+='<div class="teaser__partner js-popular-tags">',r0+=nodeset2scalar(m.f("f0",c0,i0,l0,"renderComponentHTML")),r0+="</div>",r0+="</div>"},M.t95.j=j117,M.t95.a=0,M.t96=function(m,c0,i0,l0,a0){var r0="",tmp0=a0.a["class"];return a0.a["class"]=tmp0?tmp0.addscalar(" is-hidden"):new yr.scalarAttr(" is-hidden"),r0+=m.a(m,0,m.s(j119,c0.doc.root),"ns-view",a0)},M.t96.j=j117,M.t96.a=0,M.t97=function(m,c0,i0,l0,a0){var r0="",tmp0=a0.a["class"];return a0.a["class"]=tmp0?tmp0.addscalar(" teaser__banner"):new yr.scalarAttr(" teaser__banner"),r0},M.t97.j=j120,M.t97.a=0,M.t98=function(m,c0,i0,l0,a0){var r0="",v130=m.k("k0","photoguide",c0.doc.root),v131=m.n(j118,m.k("k0","popular-tags",c0.doc.root)),v132=!!nodeset2boolean(m.n(j121,m.k("k0","preferences",c0.doc.root))),v133=m.n(j122,v130);if(nodeset2boolean(v131)&&v131.length>0&&(nodeset2boolean(v133)||!v132)){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" teaser__banner"):new yr.scalarAttr(" teaser__banner"),r0+=closeAttrs(a0),nodeset2boolean(v133)&&(r0+='<div class="teaser__banner-head is-hidden js-photo-guide-title">',r0+='<div class="teaser__banner-title">',r0+=nodeset2xml(m.n(j21,v130)),r0+="</div>",r0+="</div>"),r0+='<div class="teaser__target" id="yandex_rtb_R-I-94178-8"></div>'}return r0},M.t98.j=j120,M.t98.a=0,M.t99=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=nodeset2scalar(m.f("f2",c0,i0,l0,"renderComponentHTML","async"))},M.t99.j=j123,M.t99.a=0,M.t100=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=nodeset2scalar(m.f("f0",c0,i0,l0,"renderComponentHTML"))},M.t100.j=j123,M.t100.a=0,M.t101=function(m,c0,i0,l0,a0){var r0="",v134=!!nodeset2boolean(m.n(j121,m.k("k0","preferences",c0.doc.root)));if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("ads-direct")},a0.s="div",v134){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" is-hidden"):new yr.scalarAttr(" is-hidden")}return r0+=closeAttrs(a0),r0+='<div class="ads-direct__target" id="yandex_direct_D-I-94178-9"></div>',r0+="</div>"},M.t101.j=j124,M.t101.a=0,M.t102=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=cmpSN("fullscreen",m.s(j126,c0.doc.root))?" bar bar_dark":" bar"},M.t102.j=j125,M.t102.a=0,M.t103=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"ns-view-desc",a0)},M.t103.j=j125,M.t103.a=0,M.t104=function(m,c0,i0,l0,a0){var r0="";if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("photo")},a0.s="div",cmpSN("fullscreen",m.s(j126,c0.doc.root))){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" photo_dark photo_no-panel"):new yr.scalarAttr(" photo_dark photo_no-panel")}return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("closer js-go-back-area")},a0.s="div",r0+=m.a(m,0,[c0.doc.root],"icon_cross-small",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("photo__frame")},a0.s="div",r0+=m.a(m,0,m.s(j128,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j129,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j130,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j131,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j132,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j133,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j10,c0),"photo-is-updating",a0),r0+=closeAttrs(a0),r0+="</div>",r0+=m.a(m,0,m.s(j134,c0.doc.root),"ns-view",a0),r0+="</div>"},M.t104.j=j41,M.t104.a=0,M.t105=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="photo-is-updating photo-is-updating_hidden js-spinner">',r0+=m.f("f6",c0,i0,l0,a0,"xl",!0,!0),r0+="</div>"},M.t105.j=j41,M.t105.a=0,M.t106=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="photo photo_dark photo_no-panel photo_simple">',r0+="<div",a0.a={"class":new yr.scalarAttr("closer js-go-back-area")},a0.s="div",r0+=m.a(m,0,[c0.doc.root],"icon_cross-small",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("photo__frame")},a0.s="div",r0+=m.a(m,0,m.s(j128,c0.doc.root),"ns-view",a0),r0+=closeAttrs(a0),r0+="</div>",r0+=m.a(m,0,m.s(j134,c0.doc.root),"ns-view",a0),r0+="</div>"},M.t106.j=j135,M.t106.a=0,M.t107=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" photo-box js-photo-box"},M.t107.j=j137,M.t107.a=0,M.t108=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" image-wrap"},M.t108.j=j138,M.t108.a=0,M.t109=function(m,c0,i0,l0,a0){var r0="",v135=m.k("k0","photo",c0.doc.root);return r0+=m.a(m,0,v135,"photo-image",a0)},M.t109.j=j138,M.t109.a=0,M.t110=function(m,c0){var r0="";return r0},M.t110.j=j138,M.t110.a=0,M.t111=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"error-image-not-found",a0)},M.t111.j=j139,M.t111.a=0,M.t112=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"photo-blocked",a0,m.n(j141,m.k("k0","photo-rights",c0.doc.root)))},M.t112.j=j140,M.t112.a=0,M.t113=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"error-image-not-found",a0)},M.t113.j=j142,M.t113.a=0,M.t114=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"error-access-denied",a0)},M.t114.j=j143,M.t114.a=0,M.t115=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="image-dummy">',r0+='<div class="image__inner">',r0+='<div class="image__header">Фото не найдено</div>',r0+='<div class="image__note">',r0+="Фото не найдено или у вас нет прав на его просмотр",r0+="</div>",r0+="</div>",r0+="</div>"},M.t115.j=j32,M.t115.a=0,M.t116=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="image-dummy">',r0+='<div class="image__inner">',r0+='<div class="image__header">Доступ ограничен</div>',r0+='<div class="image__note">',r0+="У вас нет прав на просмотр этой фотографии",r0+="</div>",r0+="</div>",r0+="</div>"},M.t116.j=j32,M.t116.a=0,M.t117=function(m,c0,i0,l0,a0){var r0="",v136=m.k("k0","image-box",c0.doc.root),r1={};r1.width=yr.nodeset2data(m.n(j28,v136)),r1.height=yr.nodeset2data(m.n(j29,v136));var v137=r1,v138=yr.externals.getClosestSizeForViewer(m.s(j10,c0),v137);return r0+=closeAttrs(a0),r0+="<img",a0.a={"class":new yr.scalarAttr("image js-image"),"data-size":new yr.scalarAttr(nodeset2scalar(m.n(j40,yr.object2nodeset(v138)))),"data-size-name":new yr.scalarAttr(nodeset2scalar(m.n(j144,yr.object2nodeset(v138))))},a0.s="img",nodeset2boolean(m.n(j40,yr.object2nodeset(v138)))&&(a0.a.src=new yr.scalarAttr(nodeset2scalar(m.n(j145,yr.object2nodeset(v138))))),r0+=closeAttrs(a0),r0+=""},M.t117.j=j41,M.t117.a=0,M.t118=function(m,c0,i0,l0,a0){var r0="",tmp0=a0.a["class"];return a0.a["class"]=tmp0?tmp0.addscalar(" image-wrap_well"):new yr.scalarAttr(" image-wrap_well"),r0+=closeAttrs(a0),r0+='<div class="image-dummy">',r0+='<div class="image__inner">',r0+='<div class="image__header">Альбом защищён паролем</div>',r0+='<div class="image__note">',r0+='<div class="group">',r0+='<input class="input group-item js-album-password" type="password" placeholder="Введите пароль" style="width:200px"/>',r0+='<button class="button group-item js-button-password-check is-disabled" type="button">',r0+="<span",a0.a={"class":new yr.scalarAttr("button-content")},a0.s="span",r0+=m.a(m,0,[c0.doc.root],"icon_lock",a0),r0+=closeAttrs(a0),r0+="</span>",r0+="</button>",r0+="</div>",r0+="</div>",r0+="</div>",r0+="</div>"},M.t118.j=j146,M.t118.a=0,M.t119=function(m,c0,i0,l0,a0){var r0="",v139=m.n(j149,m.k("k0","photo-rights",c0.doc.root));return r0+=closeAttrs(a0),r0+='<div class="image-dummy">',r0+='<div class="image__inner">',r0+='<div class="image__header">Фото не найдено</div>',r0+='<div class="image__note">',r0+="Произошёл технический сбой.",nodeset2boolean(v139)&&(r0+="<br/>",r0+="Обратитесь в службу поддержки: ",r0+='<a class="link" href="mailto:support@yandex.ru">support@yandex.ru</a>'),r0+="</div>",r0+="</div>",r0+="</div>"},M.t119.j=j148,M.t119.a=0,M.t120=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="image-dummy image-dummy_blocked image-dummy_18plus">',r0+='<div class="image__inner">',r0+='<div class="image__header">Запретный контент</div>',r0+='<div class="image__note">',r0+="Если вам меньше 18 лет, то фото нанесёт непоправимый вред вашей психике. ",r0+="Повлияет на будущие поступки и мировоззрение",r0+="</div>",r0+='<div class="image__form">',r0+='<button class="button button_gap-right js-button-gte18">',r0+='<span class="button-content">Да, я старше 18</span>',r0+="</button>",r0+='<button class="button js-button-lt18">',r0+='<span class="button-content">Нет</span>',r0+="</button>",r0+="</div>",r0+="</div>",r0+="</div>"},M.t120.j=j153,M.t120.a=0,M.t121=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"photo-blocked",a0,selectNametest("blockReason",c0,[]))},M.t121.j=j154,M.t121.a=0,M.t122=function(m,c0,i0,l0,a0,v140){v140=void 0===v140?[]:v140;var r0="";return r0+=closeAttrs(a0),r0+='<div class="image-dummy image-dummy_blocked">',r0+='<div class="image__inner">',r0+='<div class="image__header">Фото заблокировано</div>',r0+=nodeset2boolean(v140)?m.a(m,0,v140,"photo-image-block-reason",a0):m.f("f11",c0,i0,l0,a0),r0+="</div>",r0+="</div>"},M.t122.j=j32,M.t122.a=0,M.t123=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="image__note">',r0+="На этот файл поступила жалоба, доступ к нему заблокирован. ",r0+=m.f("f10",c0,i0,l0,a0),r0+="</div>"},M.t123.j=j141,M.t123.a=0,M.t124=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="image__note">',r0+="Доступ к файлу заблокирован ",r0+=simpleBoolean("url",c0)?'<a href="'+nodeset2attrvalue(selectNametest("url",c0,[]))+'" class="link" target="_blank">по решению суда</a>':"по решению суда",r0+=". ",r0+="<br/>",r0+=m.f("f10",c0,i0,l0,a0),r0+="</div>"},M.t124.j=j156,M.t124.a=0,M.t125=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=m.f("f11",c0,i0,l0,a0)},M.t125.j=j158,M.t125.a=0,M.t126=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Что-то пошло не так"},M.t126.j=1,M.t126.a=1,M.t127=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Введите пароль"},M.t127.j=1,M.t127.a=1,M.t128=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Неверный пароль"},M.t128.j=1,M.t128.a=1,M.t129=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" image-wrap"},M.t129.j=j159,M.t129.a=0,M.t130=function(m,c0,i0,l0,a0){var r0="",v141=m.k("k0","image-box",c0.doc.root),r1={};r1.width=yr.nodeset2data(m.n(j28,v141)),r1.height=yr.nodeset2data(m.n(j29,v141));var v142=r1,v143=m.f("f0",c0,i0,l0,"yateGetContestImage"),v144=yr.externals.getClosestSize(v143,v142);return r0+=closeAttrs(a0),nodeset2boolean(v143)&&(r0+="<img",a0.a={"class":new yr.scalarAttr("image js-image"),"data-size":new yr.scalarAttr(nodeset2scalar(m.n(j40,yr.object2nodeset(v144)))),"data-size-name":new yr.scalarAttr(nodeset2scalar(m.n(j144,yr.object2nodeset(v144))))},a0.s="img",nodeset2boolean(m.n(j40,yr.object2nodeset(v144)))&&(a0.a.src=new yr.scalarAttr(nodeset2scalar(m.n(j145,yr.object2nodeset(v144))))),r0+=closeAttrs(a0),r0+=""),r0},M.t130.j=j159,M.t130.a=0,M.t131=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" panel js-panel"},M.t131.j=j160,M.t131.a=0,M.t132=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" panel js-panel is-hidden"},M.t132.j=j161,M.t132.a=0,M.t133=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("panel__inner")},a0.s="div",r0+=m.a(m,0,m.s(j162,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j163,c0.doc.root),"ns-view",a0),r0+=closeAttrs(a0),r0+="</div>"},M.t133.j=j160,M.t133.a=0,M.t134=function(m,c0,i0,l0,a0){function p40(){return!v148}var r0="",v145=m.k("k0","profile",c0.doc.root),v146=m.n(j165,v145),r1=[];r1=nodeset2boolean(m.n(j20,v145))?m.n(j20,v145):m.s(j166,c0.doc.root);var v147=r1,v148=cmpNN(m.n(j151,m.k("k0","auth",c0.doc.root)),v146),j167=[4,p40];return r0+=closeAttrs(a0),r0+='<div class="author">',r0+='<div class="userpic" style="background-image: url('+scalar2attrvalue(yr.externals.getAvatarUrl(nodeset2scalar(v146)))+');"></div>',r0+='<div class="author__inner">',r0+='<div class="author__row">',r0+='<a class="username link js-username" href="'+scalar2attrvalue(yr.externals.generateUrl("user-profile",v145))+'">',r0+=nodeset2xml(v147),r0+="</a>",r0+="</div>",r0+=m.a(m,0,m.n(j167,v145),"photo-info-button-follow",a0),r0+="</div>",r0+="</div>"},M.t134.j=j164,M.t134.a=0,M.t135=function(m,c0,i0,l0,a0){var r0="",v149=m.s(j169,c0);return r0+=closeAttrs(a0),r0+='<div class="author__row">',r0+='<div class="small-pseudo-button js-follow">',nodeset2boolean(v149)?(r0+='<span class="button-content">',r0+="Отписаться",r0+="</span>"):(r0+='<span class="button-content">',r0+="Подписаться",r0+="</span>"),r0+="</div>",r0+="</div>"},M.t135.j=j168,M.t135.a=0,M.t136=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"normal-content",a0)},M.t136.j=j170,M.t136.a=0,M.t137=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"normal-content",a0)},M.t137.j=j171,M.t137.a=0,M.t138=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j173,c0.doc.root),"ns-view",a0)},M.t138.j=j172,M.t138.a=0,M.t139=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j173,c0.doc.root),"ns-view",a0)},M.t139.j=j174,M.t139.a=0,M.t140=function(m,c0,i0,l0,a0){function p43(){return!nodeset2boolean(v151)}var r0="",v150=m.k("k0","photo",c0.doc.root),v151=m.n(j17,v150),j175=[4,p43],v152=m.n(j175,v150);if(nodeset2boolean(v152)){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" js-metrika-visible"):new yr.scalarAttr(" js-metrika-visible")}return r0+=m.a(m,0,m.s(j173,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,v152,"photo-view-panel__title",a0),r0+=m.a(m,0,v150,"photo-view-panel__info",a0),r0+=m.a(m,0,v152,"photo-view-panel__description",a0)},M.t140.j=j170,M.t140.a=0,M.t141=function(m,c0,i0,l0,a0){var r0="",v153=m.s(j10,c0),v154=m.k("k0","photo-position",c0.doc.root),v155=m.k("k0","album-info",c0.doc.root),v156=m.n(j149,m.k("k0","photo-rights",c0.doc.root)),v157=m.n(j176,m.k("k0","photo-rights",c0.doc.root));return r0+=closeAttrs(a0),nodeset2boolean(v155)&&(r0+='<div class="photo-album">',r0+='<a class="link js-album-link" href="'+scalar2attrvalue(yr.externals.generateUrl("album",v155))+'" title="Альбом">',r0+=scalar2xml(yr.externals.__unsafeHTML(nodeset2scalar(m.n(j21,v155)))),r0+="</a>",nodeset2scalar(m.n(j177,v154))>=0&&nodeset2scalar(m.n(j61,v154))>0&&(r0+='<span class="photo-position">',r0+=", фото ",r0+=scalar2xml(nodeset2scalar(m.n(j177,v154))+1)+" из "+nodeset2xml(m.n(j61,v154)),r0+="</span>"),r0+="</div>"),r0+='<div class="photo-info">',r0+="Добавлено ",r0+=scalar2xml(yr.externals.formatDate(nodeset2scalar(m.n(j76,v153)),"D.MM.YYYY")),nodeset2boolean(v156)&&nodeset2boolean(v157)&&(r0+=m.a(m,0,m.s(j10,c0),"photo-view-panel__public-toggler",a0)),r0+="</div>"},M.t141.j=j41,M.t141.a=0,M.t142=function(m,c0,i0,l0,a0){var r0="",v158=cmpSN("public",m.s(j15,c0));return r0+=closeAttrs(a0),r0+=". ",r0+='<a class="link link_alt-text js-toggle-privacy">',v158?(r0+='<span class="link__content-default">',r0+="Доступно всем",r0+="</span>",r0+='<span class="link__content-alt">',r0+="Сделать приватным",r0+="</span>"):(r0+='<span class="link__content-default">',r0+="Приватное фото",r0+="</span>",r0+='<span class="link__content-alt">',r0+="Сделать доступным",r0+="</span>"),r0+="</a>"},M.t142.j=j41,M.t142.a=0,M.t143=function(m,c0,i0,l0,a0){var r0="",v159=m.k("k0","album-info",c0.doc.root);return r0+=closeAttrs(a0),nodeset2boolean(v159)&&(r0+='<div class="photo-album">',r0+='<a class="link" href="'+scalar2attrvalue(yr.externals.generateUrl("album",v159))+'">',r0+=scalar2xml(yr.externals.__unsafeHTML(nodeset2scalar(m.n(j21,v159)))),r0+="</a>",r0+="</div>"),r0},M.t143.j=j146,M.t143.a=0,M.t144=function(m,c0,i0,l0,a0){var r0="",v160=m.k("k0","auth",c0.doc.root),v161=m.s(j10,c0),v163=(nodeset2scalar(m.n(j22,v161)),cmpNN(m.n(j152,v161),m.n(j151,v160))),v164=m.n(j176,m.k("k0","photo-rights",c0.doc.root));if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("photo-title js-nb-title")},a0.s="div",v163&&nodeset2boolean(v164))a0.a["data-nb"]=new yr.scalarAttr("editable-text collapse-text"),a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 2 }"),a0.a["data-nb-edit"]=new yr.scalarAttr("{ emptyText: '"+nodeset2scalar(m.n(j22,v161))+"', nowrap: true, editEmpty: true }"),r0+=closeAttrs(a0),r0+='<div class="small-pseudo-button nb-text-edit">',r0+='<span class="button-content">',r0+='<span class="icon icon_small-edit-black"></span>',r0+="</span>",r0+="</div>",r0+='<div class="photo-title__value nb-text nb-editable-text_editable">',r0+=m.f("f12",c0,i0,l0,a0,m.n(j21,v161)),r0+="</div>",r0+=m.a(m,0,m.s(j10,c0),"collapse-text",a0),r0+=m.a(m,0,m.s(j10,c0),"editable-text",a0,"Заголовок",nodeset2scalar(m.n(j21,v161)));else{if(a0.a["data-nb"]=new yr.scalarAttr("collapse-text"),a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 2 }"),r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("photo-title__value nb-text")},a0.s="div",nodeset2boolean(m.n(j21,v161)))r0+=closeAttrs(a0),r0+=m.f("f12",c0,i0,l0,a0,m.n(j21,v161));else{var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" nb-editable-text__empty-value"):new yr.scalarAttr(" nb-editable-text__empty-value"),r0+=closeAttrs(a0),r0+=nodeset2xml(m.n(j22,v161))}r0+=closeAttrs(a0),r0+="</div>",r0+=m.a(m,0,m.s(j10,c0),"collapse-text",a0)}return r0+=closeAttrs(a0),r0+="</div>"},M.t144.j=j41,M.t144.a=0,M.t145=function(m,c0,i0,l0,a0){var r0="",v165=m.k("k0","auth",c0.doc.root),v166=m.s(j10,c0),v167=m.k("k0","photo-more",c0.doc.root),v168=cmpNN(m.n(j152,v166),m.n(j151,v165)),v169=m.n(j176,m.k("k0","photo-rights",c0.doc.root));if(r0+=closeAttrs(a0),nodeset2boolean(m.n(j23,v167))||v168&&nodeset2boolean(v169)){r0+="<div",a0.a={"class":new yr.scalarAttr("photo-description js-nb-description")},a0.s="div",a0.a["data-nb"]=new yr.scalarAttr("collapse-text"),a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 2 }");var tmp0=a0.a["class"];if(a0.a["class"]=tmp0?tmp0.addscalar(" collapse-text_multiline"):new yr.scalarAttr(" collapse-text_multiline"),v168&&nodeset2boolean(v169)){var tmp0=a0.a["data-nb"];a0.a["data-nb"]=tmp0?tmp0.addscalar(" editable-text"):new yr.scalarAttr(" editable-text"),a0.a["data-nb-edit"]=new yr.scalarAttr("{ emptyText: 'Введите описание' }"),r0+=closeAttrs(a0),r0+='<div class="small-pseudo-button nb-text-edit">',r0+='<span class="button-content">',r0+='<span class="icon icon_small-edit-black"></span>',r0+="</span>",r0+="</div>",r0+='<div class="photo-description__value nb-text nb-editable-text_editable">',r0+=m.f("f13",c0,i0,l0,a0,m.n(j23,v167)),r0+="</div>",r0+=m.a(m,0,m.s(j10,c0),"collapse-text",a0),r0+=m.a(m,0,m.s(j10,c0),"editable-text",a0,"Описание",nodeset2scalar(m.n(j23,v167)))}else r0+=closeAttrs(a0),r0+='<div class="photo-description__value nb-text">',nodeset2boolean(m.n(j23,v167))&&(r0+=m.f("f13",c0,i0,l0,a0,m.n(j23,v167))),r0+="</div>",r0+=m.a(m,0,m.s(j10,c0),"collapse-text",a0);r0+=closeAttrs(a0),r0+="</div>"}return r0},M.t145.j=j41,M.t145.a=0,M.t146=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось сохранить описание"},M.t146.j=1,M.t146.a=1,M.t147=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось сохранить заголовок"},M.t147.j=1,M.t147.a=1,M.t148=function(m,c0,i0,l0,a0){var r0="",v170=m.k("k0","photo",c0.doc.root);return r0+=closeAttrs(a0),r0+='<div class="slider-info">',r0+="<div",a0.a={"class":new yr.scalarAttr("slider-info__right")},a0.s="div",r0+=m.a(m,0,v170,"photo-slider-info__position",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("slider-info__inner")},a0.s="div",r0+=m.a(m,0,v170,"photo-slider-info__title",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="</div>"},M.t148.j=j178,M.t148.a=0,M.t149=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=simpleBoolean("title",c0)?m.f("f12",c0,i0,l0,a0,selectNametest("title",c0,[])):nodeset2xml(selectNametest("fileName",c0,[]))},M.t149.j=j41,M.t149.a=0,M.t150=function(m,c0,i0,l0,a0){var r0="",v171=m.k("k0","photo-position",c0.doc.root);return r0+=closeAttrs(a0),nodeset2scalar(m.n(j177,v171))>=0&&nodeset2scalar(m.n(j61,v171))>0&&(r0+=scalar2xml(nodeset2scalar(m.n(j177,v171))+1)+" из "+nodeset2xml(m.n(j61,v171))),r0},M.t150.j=j41,M.t150.a=0,M.t151=function(m,c0,i0,l0,a0){var r0="",v172=m.n(j17,m.k("k0","tags",c0.doc.root));if(!nodeset2boolean(v172)){var v173=m.n(j180,yr.array2nodeset(yr.externals.getMedals(m.k("k0","photo-more",c0.doc.root)))),r1={};nodeset2boolean(v173)&&(r1.item=yr.nodeset2data(v173));var v174=r1,tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" js-metrika-visible"):new yr.scalarAttr(" js-metrika-visible"),r0+=m.a(m,0,m.k("k0","tags",c0.doc.root),"photo-view-panel__tags",a0),r0+=m.a(m,0,yr.object2nodeset(v174),"photo-view-panel__honors",a0)}return r0},M.t151.j=j179,M.t151.a=0,M.t152=function(m,c0){var r0="";return r0},M.t152.j=j179,M.t152.a=0,M.t153=function(m,c0,i0,l0,a0){var r0="",r1={};r1["author-login"]=yr.nodeset2data(m.s(j166,c0.doc.root));var v175=r1;return r0+=closeAttrs(a0),m.s(j118,c0).length>0&&(r0+="<div",a0.a={"class":new yr.scalarAttr("photo-tags js-collapsed-text")},a0.s="div",a0.a["data-nb"]=new yr.scalarAttr("collapse-text"),a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 1 }"),r0+=m.a(m,0,selectNametest("tags",c0,[]),"editable-tags",a0,v175,!1),r0+=m.a(m,0,m.s(j10,c0),"collapse-text",a0),r0+=closeAttrs(a0),r0+="</div>"),r0},M.t153.j=j181,M.t153.a=0,M.t154=function(m,c0,i0,l0,a0){var r0="",r1={};r1["author-login"]=yr.nodeset2data(m.s(j166,c0.doc.root));var v176=r1;r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("photo-tags")},a0.s="div";var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" js-collapsed-text"):new yr.scalarAttr(" js-collapsed-text"),a0.a["data-nb"]=new yr.scalarAttr("collapse-text"),a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 1 }");var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" js-editable-tags"):new yr.scalarAttr(" js-editable-tags");var tmp0=a0.a["data-nb"];return a0.a["data-nb"]=tmp0?tmp0.addscalar(" editable-tags"):new yr.scalarAttr(" editable-tags"),r0+=closeAttrs(a0),r0+='<div class="small-pseudo-button js-editable-tags-edit-pencil">',r0+='<span class="button-content">',r0+='<span class="icon icon_small-edit-black"></span>',r0+="</span>",r0+="</div>",r0+=m.a(m,0,selectNametest("tags",c0,[]),"editable-tags",a0,v176,!0),r0+=m.a(m,0,m.s(j10,c0),"collapse-text",a0),r0+="</div>"},M.t154.j=j183,M.t154.a=0,M.t155=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="photo-honors">',r0+="<div",a0.a={"class":new yr.scalarAttr("medals-wrapper medals-wrapper_solo")},a0.s="div",r0+=m.a(m,0,selectNametest("item",c0,[]),"medal",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="</div>"},M.t155.j=j184,M.t155.a=0,M.t156=function(m,c0,i0,l0,a0){function p47(m,c0){return c0.name==v178}var r0="",r1={};r1[1]="Одна награда",r1[2]="Две награды",r1[3]="Три награды",r1[4]="Четыре награды",r1[5]="Пять наград",r1[6]="Шесть наград",r1[7]="Семь наград",r1[8]="Восемь наград",r1[9]="Девять наград",r1[10]="Десять наград";var v177=r1,v178=selectNametest("item",c0,[]).length;if(r0+=closeAttrs(a0),r0+='<div class="photo-honors__total">',v178>10)r0+=scalar2xml(yr.externals.plural(v178,"","$0 награда","$0 награды","$0 наград"));else{var j185=[0,"*",2,p47];r0+=nodeset2xml(m.n(j185,yr.object2nodeset(v177)))}return r0+="</div>"},M.t156.j=j32,M.t156.a=0,M.t157=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("photo-honors collapse-text_collapsed js-medals")},a0.s="div",a0.a["data-nb"]=new yr.scalarAttr("collapse-text"),a0.a["data-nb-collapse"]=new yr.scalarAttr("{ rows: 1, always: true }"),r0+=closeAttrs(a0),r0+='<div class="nb-text"></div>',r0+="<div",a0.a={"class":new yr.scalarAttr("medals-wrapper js-medals-wrapper")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"photo-honors__total",a0),r0+=m.a(m,0,selectNametest("item",c0,[]),"medal",a0),r0+=closeAttrs(a0),r0+="</div>",r0+=m.a(m,0,m.s(j10,c0),"collapse-text",a0),r0+="</div>"},M.t157.j=j186,M.t157.a=0,M.t158=function(m,c0,i0,l0,a0){var r0="",v179=yr.externals.formatDate(simpleScalar("date",c0),"D MMMM YYYY"),v180="Фото Дня за "+v179;return r0+=closeAttrs(a0),r0+='<div class="medal-wrapper medal_photoofday-wrapper js-medal_photoofday" title="'+scalar2attrvalue(v180)+'">',r0+='<span class="medal medal-photoofday"></span>',r0+="<a",a0.a={"class":new yr.scalarAttr("medal__link")},a0.s="a",a0.a.href=new yr.scalarAttr(yr.externals.generateUrl("calendar",m.s(j10,c0))),r0+=closeAttrs(a0),r0+="Фото дня",r0+="</a>",r0+='<span class="medal__place">',r0+=scalar2xml(v179),r0+="</span>",r0+="</div>"},M.t158.j=j187,M.t158.a=0,M.t159=function(m,c0,i0,l0,a0){var r0="",v181=yr.externals.formatDate(simpleScalar("date",c0),"D MMMM YYYY"),v182="Было в ТОП "+v181;return r0+=closeAttrs(a0),r0+='<div class="medal-wrapper medal_photoofday-wrapper js-medal_photoofday" title="'+scalar2attrvalue(v182)+'">',r0+='<span class="medal medal-top"></span>',r0+='<span class="medal__name">',r0+="Было в ТОП",r0+="</span>",r0+='<span class="medal__place">',r0+=scalar2xml(v181),r0+="</span>",r0+="</div>"},M.t159.j=j189,M.t159.a=0,M.t160=function(m,c0,i0,l0,a0){var r0="",r1="";cmpSN(1,selectNametest("place",c0,[]))&&(r1+="medal-gold"),cmpSN(2,selectNametest("place",c0,[]))&&(r1+="medal-silver"),cmpSN(3,selectNametest("place",c0,[]))&&(r1+="medal-bronse"),(simpleScalar("place",c0)>3||0==selectNametest("place",c0,[]).length)&&(r1+="medal-pure");var v183=r1,v184=yr.externals.plural(simpleScalar("place",c0),"","$0 место","$0 место","$0 место"),v185=yr.externals.formatDate(simpleScalar("date",c0),"D MMMM YYYY"),v186=v184+' в конкурсе "'+nodeset2scalar(selectNametest("name",c0,[]))+'"';return r0+=closeAttrs(a0),r0+='<div class="medal-wrapper" title="'+scalar2attrvalue(v186)+'">',r0+='<span class="medal '+scalar2attrvalue(v183)+'"></span>',r0+="<a",a0.a={"class":new yr.scalarAttr("medal__link")},a0.s="a",a0.a.href=new yr.scalarAttr(yr.externals.generateUrl("contest",yr.externals["null"](),yr.externals.object(m.s(j10,c0)))),r0+=closeAttrs(a0),r0+=nodeset2xml(selectNametest("name",c0,[])),r0+="</a>",r0+='<span class="medal__place">',r0+=scalar2xml(v184)+", "+scalar2xml(v185),r0+="</span>",r0+="</div>"},M.t160.j=j190,M.t160.a=0,M.t161=function(m,c0,i0,l0,a0){var r0="",v187="medal-white",v188='Конкурс "'+nodeset2scalar(selectNametest("name",c0,[]))+'"';return r0+=closeAttrs(a0),r0+='<div class="medal-wrapper" title="'+scalar2attrvalue(v188)+'">',r0+="<span",a0.a={"class":new yr.scalarAttr("medal "+v187)},a0.s="span",cmpSN("submitted",selectNametest("status",c0,[]))&&(a0.a.title=new yr.scalarAttr("После проверки модератором фото будет доступно среди других фотографий-участниц конкурса")),cmpSN("accepted",selectNametest("status",c0,[]))&&(a0.a.title=new yr.scalarAttr("Начало голосования "+yr.externals.formatDate(simpleScalar("votingStartDate",c0),"D MMMM YYYY"))),r0+=closeAttrs(a0),r0+="</span>",r0+="<a",a0.a={"class":new yr.scalarAttr("medal__link")},a0.s="a",a0.a.href=new yr.scalarAttr(yr.externals.generateUrl("contest",yr.externals["null"](),yr.externals.object(m.s(j10,c0)))),r0+=closeAttrs(a0),r0+=nodeset2xml(selectNametest("name",c0,[])),r0+="</a>",r0+='<span class="medal__place">',r0+=cmpSN("submitted",selectNametest("status",c0,[]))?"Фото на модерации":"Фото участвует в конкурсе",r0+="</span>",r0+="</div>"},M.t161.j=j192,M.t161.a=0,M.t162=function(m,c0,i0,l0,a0){var r0="",v189="medal-white",v190='Конкурс "'+nodeset2scalar(selectNametest("name",c0,[]))+'"',v191=yr.externals.plural(simpleScalar("place",c0),"","место $0","место $0","место $0");return r0+=closeAttrs(a0),r0+='<div class="medal-wrapper" title="'+scalar2attrvalue(v190)+'">',r0+="<span",a0.a={"class":new yr.scalarAttr("medal "+v189)},a0.s="span",a0.a.title=new yr.scalarAttr("Голосование продлится до "+yr.externals.formatDate(simpleScalar("votingFinishDate",c0),"D MMMM YYYY")),r0+=closeAttrs(a0),r0+="</span>",r0+="<a",a0.a={"class":new yr.scalarAttr("medal__link")},a0.s="a",a0.a.href=new yr.scalarAttr(yr.externals.generateUrl("contest",yr.externals["null"](),yr.externals.object(m.s(j10,c0)))),r0+=closeAttrs(a0),r0+=nodeset2xml(selectNametest("name",c0,[])),r0+="</a>",r0+='<span class="medal__place">',r0+="участвует в конкурсе, "+scalar2xml(v191),r0+="</span>",r0+="</div>"},M.t162.j=j195,M.t162.a=0,M.t163=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось сохранить метки"},M.t163.j=1,M.t163.a=1,M.t164=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Нельзя добавить больше 30 меток"},M.t164.j=1,M.t164.a=1,M.t165=function(m,c0,i0,l0,a0){var r0="",v192=m.k("k0","photo-more",c0.doc.root),v193="_"+nodeset2scalar(m.s(j166,c0.doc.root))+"-"+nodeset2scalar(m.s(j198,c0.doc.root))+"-"+nodeset2scalar(m.s(j126,c0.doc.root)),v194="photo-map"+v193,v195=cmpNN(m.n(j152,m.k("k0","photo",c0.doc.root)),m.n(j151,m.k("k0","auth",c0.doc.root))),v196=!!nodeset2boolean(m.n(j199,v192)),v197=m.n(j200,m.k("k0","photo-rights",c0.doc.root)),v198=v196||v195,v199=v196||v195&&nodeset2boolean(v197);if(v198){if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("ghost-button"),title:new yr.scalarAttr("Это фото на карте")},a0.s="div",v199){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" js-photo-map-toggler"):new yr.scalarAttr(" js-photo-map-toggler"),a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v194+"', how: { where: 'left top', what: 'left bottom' } }")}else{var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button_inactive"):new yr.scalarAttr(" ghost-button_inactive")}r0+=m.a(m,0,[c0.doc.root],"icon_pin",a0),r0+=closeAttrs(a0),r0+='<span class="button-content">',r0+=nodeset2boolean(m.n(j199,v192))?"На карте":"Привязать к карте",r0+="</span>",r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("popup popup_to_top map-popup js-map-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v194)},a0.s="div",r0+=m.a(m,0,v192,"map",a0,v195,v197),r0+=closeAttrs(a0),r0+="</div>"}else{var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" is-hidden"):new yr.scalarAttr(" is-hidden")}return r0},M.t165.j=j197,M.t165.a=0,M.t166=function(m,c0){var r0="";return r0},M.t166.j=j197,M.t166.a=0,M.t167=function(m,c0){var r0="";return r0},M.t167.j=j197,M.t167.a=0,M.t168=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось привязать фотографию к карте"},M.t168.j=1,M.t168.a=1,M.t169=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось удалить привязку к карте"},M.t169.j=1,M.t169.a=1,M.t170=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" ghost-button"},M.t170.j=j202,M.t170.a=0,M.t171=function(m,c0,i0,l0,a0){var r0="",tmp0=a0.a["class"];return a0.a["class"]=tmp0?tmp0.addscalar(" is-hidden"):new yr.scalarAttr(" is-hidden"),r0},M.t171.j=j202,M.t171.a=0,M.t172=function(m,c0,i0,l0,a0){var r0="",v200=!!nodeset2boolean(m.n(j205,m.k("k0","auth",c0.doc.root))),v201=m.n(j206,m.k("k0","photo-rights",c0.doc.root)),v202=m.n(j207,m.k("k0","photo-rights",c0.doc.root)),v203=m.n(j208,m.k("k0","photo",c0.doc.root)),v204=!(!nodeset2boolean(m.n(j209,v201))&&v200),v205=nodeset2scalar(m.n(j210,v202)),v206=nodeset2scalar(m.n(j211,v202)),v207=nodeset2scalar(v203);
return r0+=m.a(m,0,m.s(j10,c0),"like",a0,v204,v205,v206,v207)},M.t172.j=j204,M.t172.a=0,M.t173=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" ghost-button"},M.t173.j=j212,M.t173.a=0,M.t174=function(m,c0,i0,l0,a0){var r0="",v208=!!nodeset2boolean(m.n(j205,m.k("k0","auth",c0.doc.root))),v209=m.n(j206,m.k("k0","photo-rights",c0.doc.root)),v210=m.n(j207,m.k("k0","photo-rights",c0.doc.root));if(!nodeset2boolean(m.n(j214,v209))&&v208){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button ghost-button_inactive"):new yr.scalarAttr(" ghost-button ghost-button_inactive")}else{var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button js-favorite"):new yr.scalarAttr(" ghost-button js-favorite")}if(nodeset2boolean(v210))if(nodeset2scalar(m.n(j215,v210))){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button_checked"):new yr.scalarAttr(" ghost-button_checked"),a0.a.title=new yr.scalarAttr("Убрать из избранного"),r0+=m.a(m,0,[c0.doc.root],"icon_star",a0),r0+=closeAttrs(a0),r0+='<span class="button-content">',r0+="В избранном",r0+="</span>"}else{a0.a.title=new yr.scalarAttr("Добавить в избранное"),r0+=m.a(m,0,[c0.doc.root],"icon_star",a0),r0+=closeAttrs(a0),r0+='<span class="button-content">',r0+="В избранное",r0+="</span>"}else{var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" is-hidden"):new yr.scalarAttr(" is-hidden")}return r0},M.t174.j=j213,M.t174.a=0,M.t175=function(m,c0,i0,l0,a0){var r0="",tmp0=a0.a["class"];return a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button is-hidden"):new yr.scalarAttr(" ghost-button is-hidden"),r0},M.t175.j=j218,M.t175.a=0,M.t176=function(m,c0,i0,l0,a0){var r0="",v211=cmpSN(1,m.n(j150,m.k("k0","photo",c0.doc.root)))&&!yr.externals.isCurrentUserAdult(nodeset2scalar(m.n(j151,m.k("k0","auth",c0.doc.root))))&&!cmpNN(m.n(j152,m.k("k0","photo",c0.doc.root)),m.n(j151,m.k("k0","auth",c0.doc.root))),v212=!cmpSN(1,m.n(j14,m.k("k0","photo",c0.doc.root)))&&!cmpSN(1,m.n(j13,m.k("k0","photo",c0.doc.root)))&&!v211;if(!v212){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button_inactive"):new yr.scalarAttr(" ghost-button_inactive")}var tmp0=a0.a["class"];return a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button js-to-disk"):new yr.scalarAttr(" ghost-button js-to-disk"),a0.a["data-nb"]=new yr.scalarAttr("progress-button"),a0.a["data-nb-completed-text"]=new yr.scalarAttr("Сохранено на Диск"),a0.a["data-nb-text-node-selector"]=new yr.scalarAttr(".button-content"),a0.a.title=new yr.scalarAttr("Сохранить на Яндекс.Диск"),r0+=m.a(m,0,[c0.doc.root],"icon_disk",a0),r0+=closeAttrs(a0),r0+='<span class="button-content">',r0+="Сохранить на Диск",r0+="</span>"},M.t176.j=j220,M.t176.a=0,M.t177=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="photo-to-disk__error">',r0+="Не удалось сохранить фотографию на Диск",r0+="</span>"},M.t177.j=1,M.t177.a=1,M.t178=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="photo-to-disk__message">',r0+="Фотография сохранена на Диск ",r0+='<a href="'+nodeset2attrvalue(m.s(j222,c0.doc.root))+'" class="link" target="_blank">в папку «Фотки»</a>',r0+="</span>"},M.t178.j=1,M.t178.a=1,M.t179=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<span class="photo-to-disk__error">',r0+="Не хватает места на Диске. ",r0+='<a href="//disk.yandex.ru/pay" class="link" target="_blank">Увеличить</a>',r0+="</span>"},M.t179.j=1,M.t179.a=1,M.t180=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" ghost-button"},M.t180.j=j223,M.t180.a=0,M.t181=function(m,c0,i0,l0,a0){var r0="",tmp0=a0.a["class"];return a0.a["class"]=tmp0?tmp0.addscalar(" is-hidden"):new yr.scalarAttr(" is-hidden"),r0},M.t181.j=j223,M.t181.a=0,M.t182=function(m,c0,i0,l0,a0){var r0="",v213=m.k("k0","views",c0.doc.root),v214="_"+nodeset2scalar(m.s(j166,c0.doc.root))+"-"+nodeset2scalar(m.s(j198,c0.doc.root)),v215="stat"+v214,v216=m.n(j13,m.k("k0","photo",c0.doc.root));if(a0.a.title=new yr.scalarAttr("Просмотры"),nodeset2boolean(m.n(j61,v213))&&!nodeset2boolean(v216))a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v215+"', how: { where: 'center top', what: 'center bottom' } }"),r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("popup popup_to_top stat-popup js-stat-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v215)},a0.s="div",r0+=m.a(m,0,v213,"stat",a0),r0+=closeAttrs(a0),r0+="</div>";else{var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button_inactive"):new yr.scalarAttr(" ghost-button_inactive")}return r0+=m.a(m,0,[c0.doc.root],"icon_eye",a0),r0+=m.a(m,0,v213,"stat-counter",a0)},M.t182.j=j224,M.t182.a=0,M.t183=function(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0),r0+='<span class="ghost-button__counter js-stat-counter">';for(var items0=m.n(j9,yr.array2nodeset(yr.externals.breakNumber(simpleScalar("total",c0)))),i1=0,l1=items0.length;l1>i1;i1++){var c1=items0[i1];r0+='<span class="stat__item-digit">'+nodeset2xml(m.s(j10,c1))+"</span>"}return r0+="</span>"},M.t183.j=j32,M.t183.a=0,M.t184=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" photo-controls"},M.t184.j=j226,M.t184.a=0,M.t185=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("photo-controls__left")},a0.s="div",r0+=m.a(m,0,m.s(j227,c0.doc.root),"ns-view",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("photo-controls__right")},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"item-layout-toggle",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("photo-controls__inner")},a0.s="div",nodeset2boolean(m.n(j17,m.k("k0","photo",c0.doc.root)))?r0+=m.a(m,0,m.s(j10,c0),"photo-controls-error-mode",a0):(r0+=m.a(m,0,m.s(j10,c0),"item-slideshow",a0),r0+=m.a(m,0,m.s(j228,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j229,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j230,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j231,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j10,c0),"item-share",a0),r0+=m.a(m,0,m.s(j232,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j10,c0),"item-more",a0)),r0+=closeAttrs(a0),r0+="</div>"},M.t185.j=j226,M.t185.a=0,M.t186=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"photo-controls-error-mode",a0)},M.t186.j=j226,M.t186.a=0,M.t187=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j227,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j228,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j229,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j230,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j231,c0.doc.root),"ns-view",a0),r0+=m.a(m,0,m.s(j232,c0.doc.root),"ns-view",a0)},M.t187.j=j226,M.t187.a=0,M.t188=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="ghost-button js-slideshow">',r0+='<div class="ghost-button__inner ghost-button__inner_play">',r0+="Слайдшоу",r0+="</div>",r0+='<div class="ghost-button__inner ghost-button__inner_pause">',r0+='<span class="icon icon_pseudo icon_pause"></span>',r0+="</div>",r0+="</div>"},M.t188.j=j233,M.t188.a=0,M.t189=function(m,c0,i0,l0,a0){var r0="",v217=nodeset2scalar(m.s(j126,c0.doc.root));if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("ghost-button js-layout-toggle")},a0.s="div","fullscreen"==v217){a0.a.title=new yr.scalarAttr("Уменьшить область просмотра"),r0+=m.a(m,0,[c0.doc.root],"icon_layout-collapse",a0)}else{a0.a.title=new yr.scalarAttr("Увеличить область просмотра"),r0+=m.a(m,0,[c0.doc.root],"icon_layout-expand",a0)}return r0+=closeAttrs(a0),r0+="</div>"},M.t189.j=j226,M.t189.a=0,M.t190=function(m,c0,i0,l0,a0){var r0="",v218="_"+nodeset2scalar(m.s(j166,c0.doc.root))+"-"+nodeset2scalar(m.s(j198,c0.doc.root))+"-"+nodeset2scalar(m.s(j126,c0.doc.root)),v219="photo-share"+v218,v220="blog-code"+v218,v221="share"+v218,v222=m.n(j13,m.k("k0","photo",c0.doc.root));if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("ghost-button"),title:new yr.scalarAttr("Поделиться")},a0.s="div",nodeset2boolean(v222)){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button_inactive"):new yr.scalarAttr(" ghost-button_inactive")}else{var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" js-share"):new yr.scalarAttr(" js-share"),a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v219+"', how: { where: 'center top', what: 'center bottom' } }")}if(r0+=closeAttrs(a0),r0+='<div class="popup popup_to_top js-photo-share-popup _hidden" data-nb="islands-popup" id="'+scalar2attrvalue(v219)+'">',r0+='<div class="popup-tail"></div>',r0+='<div class="menu">',r0+='<div class="popup__share-menu" id="'+scalar2attrvalue(v221)+'"></div>',nodeset2boolean(m.n(j236,m.k("k0","photo",c0.doc.root)))){r0+="<a",a0.a={"class":new yr.scalarAttr("menu-item js-blog-code")},a0.s="a",a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v220+"', where: '.js-share:visible', how: { where: 'center top', what: 'center bottom' } }"),r0+=m.a(m,0,[c0.doc.root],"icon_code",a0),r0+=closeAttrs(a0),r0+="Код для блога",r0+="</a>"}return r0+="<a",a0.a={"class":new yr.scalarAttr("menu-item is-hidden js-copy-link"),"data-nb":new yr.scalarAttr("copy-to-clipboard")},a0.s="a",a0.a["data-clipboard-text"]=new yr.scalarAttr(yr.externals.getShareLink(m.k("k0","photo",c0.doc.root))),r0+=closeAttrs(a0),r0+='<span class="icon icon_copy"></span>',r0+="Скопировать ссылку",r0+="</a>",r0+="</div>",r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("popup popup_to_top blog-code-popup js-blog-code-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v220)},a0.s="div",r0+=m.a(m,0,m.k("k0","photo",c0.doc.root),"blog-code",a0,m.k("k0","blog-code-settings",c0.doc.root)),r0+=closeAttrs(a0),r0+="</div>",r0+=m.a(m,0,[c0.doc.root],"icon_share",a0),r0+='<span class="button-content">',r0+="Поделиться",r0+="</span>",r0+="</div>"},M.t190.j=j226,M.t190.a=0,M.t191=function(m,c0,i0,l0,a0){var r0="",v223=m.k("k0","auth",c0.doc.root),v224=m.k("k0","photo",c0.doc.root),v225=!!nodeset2boolean(m.n(j151,v223)),v226=cmpNN(m.n(j152,v224),m.n(j151,v223)),v227=m.n(j13,v224),v228="_"+nodeset2scalar(m.s(j166,c0.doc.root))+"-"+nodeset2scalar(m.s(j198,c0.doc.root)),v229="photo-more"+v228,v230="details"+v228,v231="complain"+v228,v232=v226||!nodeset2boolean(m.n(j150,v224))||nodeset2boolean(m.n(j150,v224))&&yr.externals.isCurrentUserAdult(nodeset2scalar(m.n(j151,v223))),v233=nodeset2boolean(m.n(j219,v224))&&v232,v234=!v226&&v225;if(r0+=closeAttrs(a0),nodeset2boolean(m.n(j239,v224))||v233||v234){var v235=m.n(j241,m.k("k0","photo-more",c0.doc.root)),v236=m.n(j242,v235),r1="";r1+=nodeset2boolean(v235)&&!cmpSN("rejected",m.n(j243,v235))?nodeset2scalar(m.n(j244,v236)):"";var v237=r1;if(r0+="<div",a0.a={"class":new yr.scalarAttr("ghost-button"),title:new yr.scalarAttr("Ещё")},a0.s="div",nodeset2boolean(v227)){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button_inactive"):new yr.scalarAttr(" ghost-button_inactive")}else{var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" nb js-more"):new yr.scalarAttr(" nb js-more"),a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v229+"', how: { where: 'center top', what: 'center bottom' } }")}r0+=closeAttrs(a0),r0+='<div class="popup popup_to_top js-photo-more-popup _hidden" data-nb="islands-popup" id="'+scalar2attrvalue(v229)+'">',r0+='<div class="popup-tail"></div>',r0+='<div class="menu">',nodeset2boolean(m.n(j239,v224))&&(r0+="<a",a0.a={"class":new yr.scalarAttr("menu-item js-exif")},a0.s="a",a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v230+"', where: '.js-more:visible', how: { where: 'center top', what: 'center bottom' } }"),r0+=closeAttrs(a0),r0+="Показать EXIF",r0+="</a>"),v233&&(r0+='<a class="menu-item js-show-original" href="'+nodeset2attrvalue(m.n(j245,v224))+'" target="_blank">',r0+="Открыть оригинал",r0+="</a>"),v234&&(r0+="<a",a0.a={"class":new yr.scalarAttr("menu-item")},a0.s="a",a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v231+"', where: '.js-more:visible', how: { where: 'center top', what: 'center bottom' } }"),r0+=closeAttrs(a0),r0+="Пожаловаться",r0+="</a>"),r0+="</div>",r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("popup details-popup js-details-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v230)},a0.s="div",r0+=m.a(m,0,[c0.doc.root],"details",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="<div",a0.a={"class":new yr.scalarAttr("popup complain-popup js-complain-popup _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v231)},a0.s="div",r0+=m.a(m,0,m.k("k0","photo",c0.doc.root),"complain",a0,v237),r0+=closeAttrs(a0),r0+="</div>",r0+='<span class="icon icon_pseudo icon_more">',r0+="• • •",r0+="</span>",r0+="</div>"}return r0},M.t191.j=j226,M.t191.a=0,M.t192=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" photo-ears _hidden"},M.t192.j=j247,M.t192.a=0,M.t193=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"item-prev",a0),r0+=m.a(m,0,m.s(j10,c0),"item-next",a0)},M.t193.j=j247,M.t193.a=0,M.t194=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="photo-ears__left js-prev">',r0+='<span class="icon icon_arrow-left"></span>',r0+="</div>"},M.t194.j=j247,M.t194.a=0,M.t195=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="photo-ears__right js-next">',r0+='<span class="icon icon_arrow-right"></span>',r0+="</div>"},M.t195.j=j247,M.t195.a=0,M.t196=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" photo-edit"},M.t196.j=j248,M.t196.a=0,M.t197=function(m,c0,i0,l0,a0){var r0="",v238=m.n(j149,m.k("k0","photo-rights",c0.doc.root)),v239=m.n(j176,m.k("k0","photo-rights",c0.doc.root)),v240=cmpSN("yes",m.n(j249,m.k("k0","photo-rights",c0.doc.root))),v241=yr.externals.canEditImageType(m.k("k0","photo",c0.doc.root));return nodeset2boolean(v238)&&nodeset2boolean(v239)&&(v240&&v241&&(nodeset2boolean(m.n(j250,m.k("k0","settings",c0.doc.root)))&&(r0+=m.a(m,0,m.s(j10,c0),"item-edit",a0)),r0+=m.a(m,0,m.s(j10,c0),"item-rotate",a0)),r0+=m.a(m,0,m.s(j10,c0),"item-delete",a0),r0+=m.a(m,0,m.s(j10,c0),"item-access",a0)),r0},M.t197.j=j248,M.t197.a=0,M.t198=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("pseudo-button group-item js-rotate"),title:new yr.scalarAttr("Повернуть")},a0.s="div",r0+=m.a(m,0,[c0.doc.root],"icon_rotate-ccw",a0),r0+=closeAttrs(a0),r0+="</div>"},M.t198.j=j248,M.t198.a=0,M.t199=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("pseudo-button group-item js-edit"),title:new yr.scalarAttr("Редактировать…")},a0.s="div",r0+=m.a(m,0,[c0.doc.root],"icon_edit",a0),r0+=closeAttrs(a0),r0+='<span class="button-label">',r0+="Редактировать",r0+="</span>",r0+="</div>"},M.t199.j=j248,M.t199.a=0,M.t200=function(m,c0,i0,l0,a0){var r0="",v242="_"+nodeset2scalar(m.s(j166,c0.doc.root))+"-"+nodeset2scalar(m.s(j198,c0.doc.root)),v243="before-edit"+v242;if(r0+=closeAttrs(a0),r0+='<div class="popup js-popup-before-edit _hidden" data-nb="islands-modal-popup" id="'+scalar2attrvalue(v243)+'">',r0+='<div class="popup-content">',r0+='<div class="popup__head">Данные об отмеченных людях будут потеряны</div>',nodeset2boolean(m.s(j253,c0.doc.root))){var v244=m.s(j253,c0.doc.root).length;r0+='<div class="popup__row">',r0+="На фото "+scalar2xml(yr.externals.plural(v244,"","отмечен $0 человек","отмечено $0 человека","отмечено $0 человек"))+".",r0+="</div>"}return r0+="<br/>",r0+='<div class="popup__foot">',r0+='<a class="small-button js-continue">',r0+='<span class="button-content">Продолжить</span>',r0+="</a>",r0+='<a class="small-button js-cancel">',r0+='<span class="button-content">Отменить все изменения</span>',r0+="</a>",r0+="</div>",r0+="</div>",r0+='<div class="popup-close js-close"></div>',r0+="</div>"},M.t200.j=1,M.t200.a=1,M.t201=function(m,c0,i0,l0,a0){var r0="",v245="_"+nodeset2scalar(m.s(j166,c0.doc.root))+"-"+nodeset2scalar(m.s(j198,c0.doc.root)),v246="confirm"+v245;return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("pseudo-button group-item js-delete"),title:new yr.scalarAttr("Удалить")},a0.s="div",a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v246+"'}"),r0+=m.a(m,0,[c0.doc.root],"icon_trash",a0),r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("popup js-popup-delete  _hidden"),"data-nb":new yr.scalarAttr("islands-modal-popup"),id:new yr.scalarAttr(v246)},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"photo-edit-dialog-delete",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="</div>"},M.t201.j=j248,M.t201.a=0,M.t202=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="popup-content">',r0+="<p>Удалить фото вместе с оценками и комментариями?</p>",r0+='<div class="popup__foot">',r0+='<a class="small-action-button js-delete-agree">',r0+='<span class="button-content">Удалить</span>',r0+="</a>",r0+='<a class="small-button js-cancel js-close">',r0+='<span class="button-content">Отменить</span>',r0+="</a>",r0+="</div>",r0+="</div>",r0+='<div class="popup-close js-x js-close"></div>'},M.t202.j=j32,M.t202.a=0,M.t203=function(m,c0,i0,l0,a0){var r0="",v247="_"+nodeset2scalar(m.s(j166,c0.doc.root))+"-"+nodeset2scalar(m.s(j198,c0.doc.root)),v248="access"+v247;return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("pseudo-button group-item js-access"),title:new yr.scalarAttr("Доступ")},a0.s="div",a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v248+"'}"),r0+=m.a(m,0,[c0.doc.root],"icon_access",a0),r0+=closeAttrs(a0),r0+='<span class="icon_arrow-dropdown"></span>',r0+="<div",a0.a={"class":new yr.scalarAttr("popup js-popup-access _hidden"),"data-nb":new yr.scalarAttr("islands-popup"),id:new yr.scalarAttr(v248)},a0.s="div",r0+=m.a(m,0,m.s(j10,c0),"photo-edit-popup-access",a0),r0+=closeAttrs(a0),r0+="</div>",r0+="</div>"},M.t203.j=j248,M.t203.a=0,M.t204=function(m,c0,i0,l0,a0){var r0="",v249=m.n(j256,m.k("k0","photo",c0.doc.root)),v250=m.n(j257,v249),v251=!nodeset2boolean(m.n(j258,v249)),v252=!nodeset2boolean(m.n(j259,v249));return r0+=closeAttrs(a0),r0+='<div class="menu">',r0+='<label class="menu-row toggler">',r0+="<input",a0.a={"class":new yr.scalarAttr("toggler-controller js-is-pron"),type:new yr.scalarAttr("checkbox")},a0.s="input",nodeset2boolean(v250)&&(a0.a.checked=new yr.scalarAttr("checked")),r0+=closeAttrs(a0),r0+="",r0+='<span class="checkbox toggler-view"><span class="checkbox-icon"> </span></span>',r0+="Только для взрослых",r0+="</label>",r0+='<label class="menu-row toggler">',r0+="<input",a0.a={"class":new yr.scalarAttr("toggler-controller js-enable-comments"),type:new yr.scalarAttr("checkbox")},a0.s="input",v251&&(a0.a.checked=new yr.scalarAttr("checked")),r0+=closeAttrs(a0),r0+="",r0+='<span class="checkbox toggler-view"><span class="checkbox-icon"> </span></span>',r0+="Разрешить комментарии",r0+="</label>",r0+='<label class="menu-row menu-row_print-orig toggler">',r0+="<input",a0.a={"class":new yr.scalarAttr("toggler-controller js-enable-print"),type:new yr.scalarAttr("checkbox")},a0.s="input",v252&&(a0.a.checked=new yr.scalarAttr("checked")),r0+=closeAttrs(a0),r0+="",r0+='<span class="checkbox toggler-view"><span class="checkbox-icon"> </span></span>',r0+='<span class="toggle-view-label">',r0+="Разрешить печать",r0+="<br/>",r0+="и просмотр оригинала",r0+="</span>",r0+="</label>",r0+='<div class="menu-separator"></div>',r0+="<div",a0.a={"class":new yr.scalarAttr("menu-row"),"data-nb":new yr.scalarAttr("progress-button")},a0.s="div",a0.a["data-nb-completed-text"]=new yr.scalarAttr("URL изменён"),r0+=closeAttrs(a0),r0+='<a class="link js-invalidate-url">',r0+="Изменить URL",r0+="</a>",r0+="<span",a0.a={"class":new yr.scalarAttr("js-invalidate-url-help"),title:new yr.scalarAttr("Публикации по предыдущему URL будут потеряны.")},a0.s="span",r0+=m.a(m,0,[c0.doc.root],"icon_help",a0),r0+=closeAttrs(a0),r0+="</span>",r0+="</div>",r0+="</div>",r0+='<div class="popup-tail"></div>'},M.t204.j=j32,M.t204.a=0,M.t205=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось удалить фотографию"},M.t205.j=1,M.t205.a=1,M.t206=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось повернуть фотографию"},M.t206.j=1,M.t206.a=1,M.t207=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось сохранить изображение"},M.t207.j=1,M.t207.a=1,M.t208=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Редактирование фотографии недоступно"},M.t208.j=1,M.t208.a=1,M.t209=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" photo-flags"},M.t209.j=j261,M.t209.a=0,M.t210=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.k("k0","photo",c0.doc.root),"photo-flags-item",a0)},M.t210.j=j261,M.t210.a=0,M.t211=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("photo-flag-item"),title:new yr.scalarAttr("Только для взрослых")},a0.s="div",r0+=m.a(m,0,[c0.doc.root],"icon_18plus",a0),r0+=closeAttrs(a0),r0+="</div>"},M.t211.j=j262,M.t211.a=0,M.t212=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" comments"},M.t212.j=j264,M.t212.a=0,M.t213=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="comment comments_message">',r0+="Загрузка комментариев",r0+="</div>"},M.t213.j=j264,M.t213.a=0,M.t214=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="<div>",r0+='<div class="js-comments"></div>',r0+="</div>"},M.t214.j=j264,M.t214.a=0,M.t215=function(m,c0,i0,l0,a0){var r0="",tmp0=a0.a.style;return a0.a.style=tmp0?tmp0.addscalar(" display: none;"):new yr.scalarAttr(" display: none;"),r0},M.t215.j=j264,M.t215.a=0,M.t216=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Комментарии скрыты"},M.t216.j=1,M.t216.a=1,M.t217=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Автор запретил комментировать фотографии"},M.t217.j=1,M.t217.a=1,M.t218=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Автор запретил комментировать фотографию"},M.t218.j=1,M.t218.a=1,M.t219=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Вы заблокированы автором фотографии"},M.t219.j=1,M.t219.a=1,M.t220=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Вы заблокированы модератором"},M.t220.j=1,M.t220.a=1,M.t221=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Возможность комментировать временно недоступна"},M.t221.j=1,M.t221.a=1,M.t222=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Возможность комментировать временно недоступна"},M.t222.j=1,M.t222.a=1,M.t223=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Комментарии под Фото дня скрыты"},M.t223.j=1,M.t223.a=1,M.t224=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Можно оставить один комментарий под Фото дня. Если автор ответит на него, вы сможете продолжить общение."},M.t224.j=1,M.t224.a=1,M.t225=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось добавить комментарий"},M.t225.j=1,M.t225.a=1,M.t226=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось удалить комментарий"},M.t226.j=1,M.t226.a=1,M.t227=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Неверно введены контрольные цифры"},M.t227.j=1,M.t227.a=1,M.t228=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось заблокировать автора комментария"},M.t228.j=1,M.t228.a=1,M.t229=function(m,c0,i0,l0,a0){var r0="";return r0+=m.a(m,0,m.s(j10,c0),"banner",a0)},M.t229.j=j265,M.t229.a=0,M.t230=function(m,c0,i0,l0,a0){var r0="",v253=m.k("k0","preferences",c0.doc.root),v254=!!nodeset2boolean(m.n(j121,v253));if(r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("banner-placeholder js-banner-placeholder")},a0.s="div",v254){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" is-hidden"):new yr.scalarAttr(" is-hidden")}return r0+=closeAttrs(a0),r0+='<div class="banner-wrapper js-banner-wrapper">',r0+='<div class="banner js-banner">',r0+='<div class="banner__inner" id="yandex_ad_R-94178-6"></div>',r0+="</div>",r0+="</div>",r0+="</div>"},M.t230.j=j32,M.t230.a=0,M.t231=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" tray tray_hidden"},M.t231.j=j266,M.t231.a=0,M.t232=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" tray tray_hidden tray_dark"},M.t232.j=j267,M.t232.a=0,M.t233=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" tray-container"},M.t233.j=j268,M.t233.a=0,M.t234=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+=" send-to-contest-button"},M.t234.j=j269,M.t234.a=0,M.t235=function(m,c0,i0,l0,a0){function p59(m,c0){return cmpNN(m.s(j271,c0),m.n(j244,v256))}var r0="",v255=yr.externals.isAuthor(m.k("k0","photo",c0.doc.root),m.k("k0","auth",c0.doc.root));if(v255){var v256=m.n(j270,m.k("k0","photo-rights",c0.doc.root)),j272=[0,"contestBindings",0,"contestBinding",2,p59],v257=m.n(j272,m.k("k0","photo-more",c0.doc.root)),v258=m.n(j241,m.k("k0","photo-more",c0.doc.root)),v259=m.n(j242,v258);if(nodeset2boolean(v258)&&!cmpSN("rejected",m.n(j243,v258))){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button"):new yr.scalarAttr(" ghost-button"),r0+=m.a(m,0,v259,"revoke-button",a0)}else if(nodeset2boolean(v256)&&!nodeset2boolean(v257)){var tmp0=a0.a["class"];a0.a["class"]=tmp0?tmp0.addscalar(" ghost-button"):new yr.scalarAttr(" ghost-button"),r0+=m.a(m,0,v256,"send-button",a0)}}return r0},M.t235.j=j269,M.t235.a=0,M.t236=function(m,c0,i0,l0,a0){var r0="",v260=m.s(j10,c0),v261="send-to-contest_"+nodeset2scalar(m.s(j166,c0.doc.root))+"-"+nodeset2scalar(m.s(j198,c0.doc.root));return a0.a.title=new yr.scalarAttr("Отправить фото на конкурс"),a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v261+"', where: '.bar:visible', how: { where: 'left top', what: 'left bottom' } }"),r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("popup popup_to_top send-to-contest-popup js-send-to-contest _hidden"),"data-nb":new yr.scalarAttr("islands-popup send-to-contest"),id:new yr.scalarAttr(v261)},a0.s="div",a0.a["data-nb-contest-id"]=new yr.scalarAttr(nodeset2scalar(m.n(j244,v260))),r0+=m.a(m,0,v260,"send-popup-body",a0),r0+=closeAttrs(a0),r0+='<div class="popup-close popup__close"></div>',r0+="</div>",r0+=m.a(m,0,[c0.doc.root],"icon_medal",a0),r0+='<span class="button-content">',r0+="На конкурс",r0+="</span>"},M.t236.j=j32,M.t236.a=0,M.t237=function(m,c0,i0,l0,a0){var r0="",v262=m.s(j10,c0),v263=m.n(j274,v262),v264=m.n(j193,v262),v266=(m.n(j196,v262),yr.externals.generateUrl("contest",v262));return r0+=closeAttrs(a0),r0+='<div class="send-to-contest">',r0+='<div class="send-to-contest-left">',r0+='<h2 class="contest-title">'+nodeset2xml(selectNametest("name",c0,[]))+"</h2>",r0+='<ul class="contest-details">',r0+='<li class="contest-theme">',simpleBoolean("logoUrl",c0)?(r0+="Тему предлагает ",r0+='<img class="contest-theme-logo" src="'+nodeset2attrvalue(selectNametest("logoUrl",c0,[]))+'"/>'):(r0+="Конкурс от ",r0+='<span class="contest-theme-by-fotki">Яндекс.Фоток</span>'),r0+="</li>",simpleBoolean("subject",c0)&&(r0+="<li>",r0+="Тема: "+nodeset2xml(selectNametest("subject",c0,[])),r0+="</li>"),simpleBoolean("genre",c0)&&(r0+="<li>",r0+="Жанр: "+nodeset2xml(selectNametest("genre",c0,[])),r0+="</li>"),r0+="<li>",r0+="Фотографии принимаются ",r0+=yr.externals.formatDate(nodeset2scalar(v263),"YYYY")==yr.externals.formatDate(nodeset2scalar(v264),"YYYY")?yr.externals.formatDate(nodeset2scalar(v263),"MMMM")==yr.externals.formatDate(nodeset2scalar(v264),"MMMM")?"c "+scalar2xml(yr.externals.formatDate(nodeset2scalar(v263),"D"))+" по "+scalar2xml(yr.externals.formatDate(nodeset2scalar(v264),"D MMMM YYYY")):"c "+scalar2xml(yr.externals.formatDate(nodeset2scalar(v263),"D MMMM"))+" по "+scalar2xml(yr.externals.formatDate(nodeset2scalar(v264),"D MMMM YYYY")):"c "+scalar2xml(yr.externals.formatDate(nodeset2scalar(v263),"D MMMM YYYY"))+" по "+scalar2xml(yr.externals.formatDate(nodeset2scalar(v264),"D MMMM YYYY")),r0+="</li>",r0+="<li>",r0+="Голосование продлится до "+scalar2xml(yr.externals.formatDate(simpleScalar("votingFinishDate",c0),"D MMMM YYYY")),r0+="</li>",r0+="</ul>",r0+='<p class="contest-participants-count">',r0+="Сейчас в конкурсе принимает участие "+scalar2xml(yr.externals.plural(nodeset2scalar(m.n(j278,v262)),"$0 фотографий","$0 фотография","$0 фотографии","$0 фотографий")),r0+=" от "+scalar2xml(yr.externals.plural(nodeset2scalar(m.n(j279,v262)),"$0 пользователей","$0 пользователя","$0 пользователей","$0 пользователей"))+".",r0+="</p>",r0+=nodeset2scalar(m.n(j280,v262)),r0+="</div>",r0+='<div class="send-to-contest-right">',r0+='<div class="send-to-contest-right-inner">',r0+='<div class="contest-row">',r0+="<label>",r0+="Укажите название фото",r0+='<input class="small-input js-title" type="text" placeholder="Название фото"/>',r0+="</label>",r0+="</div>",r0+='<div class="contest-row">',r0+="<label>",r0+="Добавьте метки",r0+='<textarea class="small-input js-tags" placeholder="Например: лес, новый год, отпуск"></textarea>',r0+="</label>",r0+="</div>",r0+='<div class="contest-row">',r0+="Отправляя фото вы принимаете ",r0+='<a href="'+scalar2attrvalue(v266)+'#contest-rules" class="link js-contest-rules" target="_blank">правила конкурса</a>',r0+=" и ",r0+='<a href="'+scalar2attrvalue(v266)+'#contest-full-rules" class="link js-general-rules" target="_blank">общие правила участия</a>',r0+="</div>",r0+='<div class="contest-row">',r0+='<button class="small-action-button js-send" type="button">',r0+='<span class="button-content">Отправить фото</span>',r0+="</button>",r0+="</div>",r0+="</div>",r0+="</div>",r0+="</div>"},M.t237.j=j32,M.t237.a=0,M.t238=function(m,c0,i0,l0,a0){var r0="",v267=m.s(j10,c0),v268="revoke-from-contest_"+nodeset2scalar(m.s(j166,c0.doc.root))+"-"+nodeset2scalar(m.s(j198,c0.doc.root));return a0.a.title=new yr.scalarAttr("Снять фото с конкурса"),a0.a["data-nb"]=new yr.scalarAttr("popup-toggler"),a0.a["data-nb-popup-toggler"]=new yr.scalarAttr("{ id: '"+v268+"', how: { where: 'center top', what: 'center bottom' } }"),r0+=closeAttrs(a0),r0+="<div",a0.a={"class":new yr.scalarAttr("popup popup_to_top send-to-contest-popup js-revoke-from-contest _hidden"),"data-nb":new yr.scalarAttr("islands-popup revoke-from-contest"),id:new yr.scalarAttr(v268)},a0.s="div",a0.a["data-nb-contest-id"]=new yr.scalarAttr(nodeset2scalar(m.n(j244,v267))),r0+=m.a(m,0,v267,"revoke-popup-body",a0),r0+=closeAttrs(a0),r0+='<div class="popup-tail"></div>',r0+="</div>",r0+=m.a(m,0,[c0.doc.root],"icon_medal",a0),r0+='<span class="button-content">',r0+="На конкурсе",r0+="</span>"},M.t238.j=j32,M.t238.a=0,M.t239=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+='<div class="menu">',r0+='<a class="menu-item js-go-to-contest" href="'+scalar2attrvalue(yr.externals.generateUrl("contest",m.s(j10,c0)))+'">',r0+="На страницу конкурса",r0+="</a>",r0+='<a class="menu-item js-revoke">',r0+="Не участвовать",r0+="</a>",r0+="</div>"},M.t239.j=j32,M.t239.a=0,M.t240=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось добавить фото на конкурс"},M.t240.j=1,M.t240.a=1,M.t241=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не удалось снять фото с конкурса"},M.t241.j=1,M.t241.a=1,M.t242=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не указан заголовок"},M.t242.j=1,M.t242.a=1,M.t243=function(m,c0,i0,l0,a0){var r0="";return r0+=closeAttrs(a0),r0+="Не указаны метки"},M.t243.j=1,M.t243.a=1,M.t244=function(m,c0,i0,l0,a0){var r0="",v269=m.k("k0","contests-settings",c0.doc.root),v270=m.k("k1","contest",c0.doc.root);
return r0+=closeAttrs(a0),nodeset2boolean(m.n(j282,v269))&&!nodeset2boolean(v270)&&(r0+='<div class="photo-well photo-well_contest photo-well-animated-group_contest"></div>'),r0},M.t244.j=j242,M.t244.a=0,M.t245=function(m,c0){var r0="";return r0},M.t245.j=1,M.t245.a=1,M.t246=function(m,c0){var r0="";return r0},M.t246.j=1,M.t246.a=1,M.t247=function(m,c0){var r0="";return r0},M.t247.j=1,M.t247.a=1,M.t248=function(m,c0,i0,l0,a0){var r0="",v271=m.s(j283,c0.doc.root),v272=m.s(j284,c0.doc.root),v273=m.s(j285,c0.doc.root),v274=m.s(j286,c0.doc.root),v275=selectNametest("params",c0.doc.root,[]),v276=selectNametest("share-url",c0.doc.root,[]),v277=m.f("f14",c0,i0,l0,v271,v272);if(r0+=closeAttrs(a0),v277){var v278=m.f("f16",c0,i0,l0,v271,v273,v274,v275),v279=m.f("f17",c0,i0,l0,v271,v273,v274,v275),v280=m.f("f19",c0,i0,l0,v271,"default"),v281=m.f("f19",c0,i0,l0,v271,"og"),v282=m.f("f19",c0,i0,l0,v271,"twitter"),v283=m.f("f20",c0,i0,l0,v271);r0+='<meta name="medium" content="image"/>',r0+='<meta name="title" content="'+scalar2attrvalue(v278)+'"/>',r0+='<meta name="description" content="'+scalar2attrvalue(v279)+'"/>',r0+='<link rel="image_src" type="'+scalar2attrvalue(v283)+'" href="'+nodeset2attrvalue(m.n(j27,yr.object2nodeset(v280)))+'"/>',r0+='<meta name="mrc__share_description" content="'+scalar2attrvalue(v279)+'"/>',r0+='<meta property="og:site_name" content="Яндекс.Фотки"/>',r0+='<meta property="og:type" content="article"/>',r0+='<meta property="og:title" content="'+scalar2attrvalue(v278)+'"/>',r0+='<meta property="og:description" content="'+scalar2attrvalue(v279)+'"/>',r0+='<meta property="og:url" content="'+nodeset2attrvalue(v276)+'"/>',r0+='<meta property="og:image" content="'+nodeset2attrvalue(m.n(j27,yr.object2nodeset(v281)))+'?share=og"/>',r0+='<meta name="twitter:card" value="photo"/>',r0+='<meta name="twitter:site" value="@yandexfotki"/>',r0+='<meta name="twitter:url" value="'+nodeset2attrvalue(v276)+'"/>',r0+='<meta name="twitter:title" value="'+scalar2attrvalue(v278)+'"/>',r0+='<meta name="twitter:image" value="'+nodeset2attrvalue(m.n(j27,yr.object2nodeset(v282)))+'?share=twi"/>',r0+='<meta name="twitter:image:width" value="'+nodeset2attrvalue(m.n(j28,yr.object2nodeset(v282)))+'"/>',r0+='<meta name="twitter:image:height" value="'+nodeset2attrvalue(m.n(j29,yr.object2nodeset(v282)))+'"/>'}return r0},M.t248.j=1,M.t248.a=1,M.t249=function(m,c0,i0,l0,a0){var r0="";r0+=closeAttrs(a0),r0+="<script>",r0+="var __nsInit = function() {\n";for(var items0=selectNametest("models",c0,[]),i1=0,l1=items0.length;l1>i1;i1++){var c1=items0[i1];r0+="ns.Model.get('"+nodeset2xml(selectNametest("id",c1,[]))+"', "+nodeset2xml(selectNametest("paramsString",c1,[]))+").restoreModel("+nodeset2xml(selectNametest("dataString",c1,[]))+");\n"}return r0+="};",r0+="</script>"},M.t249.j=1,M.t249.a=1,M.matcher={"":{"":["t0"]},"ns-view":{"*":["t1"]},"ns-build-view":{"*":["t2"]},"ns-view-add-class":{"*":["t3"],app:["t81","t3"],content:["t83","t3"],overlay:["t84","t3"],bar:["t102","t3"],"photo-box":["t107","t3"],"photo-image":["t108","t3"],"photo-image-contest":["t129","t3"],panel:["t132","t131","t3"],"photo-like":["t170","t3"],"photo-favorite":["t173","t3"],"photo-views":["t180","t3"],"photo-controls":["t184","t3"],"photo-ears":["t192","t3"],"photo-edit":["t196","t3"],"photo-flags":["t209","t3"],comments:["t212","t3"],tray:["t232","t231","t3"],"tray-container":["t233","t3"],"send-to-contest":["t234","t3"]},"ns-view-add-attrs":{"*":["t4"]},"ns-view-content":{"*":["t5"],app:["t82","t5"],"not-found":["t87","t5"],head:["t90","t5"],foot:["t91","t5"],pod:["t92","t5"],teaser:["t93","t5"],"teaser-banner":["t98","t5"],stream:["t100","t5"],"ads-direct":["t101","t5"],bar:["t103","t5"],photo:["t104","t5"],"photo-contest":["t106","t5"],"photo-image":["t109","t5"],"photo-image-contest":["t130","t5"],panel:["t133","t5"],"photo-author":["t134","t5"],"photo-info":["t136","t5"],"photo-slider-info-item":["t148","t5"],"photo-tags":["t151","t5"],"photo-on-map":["t165","t5"],"photo-like":["t172","t5"],"photo-favorite":["t174","t5"],"photo-to-disk":["t176","t175","t5"],"photo-views":["t182","t5"],"photo-controls":["t185","t5"],"photo-ears":["t193","t5"],"photo-edit":["t197","t5"],"photo-flags":["t210","t5"],comments:["t214","t5"],ads:["t229","t5"],"send-to-contest":["t235","t5"]},"ns-view-desc":{"*":["t6"]},"ns-view-collection":{"*":["t7"]},"ns-view-async-content":{"*":["t10","t8"],head:["t88","t10","t8"],"teaser-banner":["t97","t10","t8"],stream:["t99","t10","t8"],"photo-on-map":["t166","t10","t8"],comments:["t213","t10","t8"],contest:["t244","t10","t8"]},"ns-view-error-content":{"*":["t11","t9"],head:["t89","t11","t9"],teaser:["t94","t11","t9"],"photo-image":["t114","t113","t112","t111","t110","t11","t9"],"photo-info":["t139","t138","t137","t11","t9"],"photo-tags":["t152","t11","t9"],"photo-on-map":["t167","t11","t9"],"photo-like":["t171","t11","t9"],"photo-views":["t181","t11","t9"],"photo-controls":["t186","t11","t9"],comments:["t215","t11","t9"]},"collapse-text":{"*":["t12"]},"editable-text":{"*":["t13"]},"editable-tags":{"*":["t14"]},"editable-tags-item":{tag:["t15"]},"editable-tags-item-plain":{tag:["t16"]},map:{"*":["t17"]},"blog-code":{photo:["t18"]},"blog-code__sizes":{photo:["t19"]},"blog-code-generate":{"":["t20"]},stat:{"*":["t21"]},"stat-loading":{"*":["t22"]},"stat-error":{"*":["t23"]},"stat-loaded":{"":["t24"]},"stat-summary":{"*":["t25"]},"stat-item":{referer:["t26"]},"stat-more":{"*":["t27"]},"stat-item-body":{referer:["t29","t28"]},details:{"":["t30"]},"details-loaded":{"":["t31"]},"details-loading":{"":["t32"]},"details-error":{"":["t33"]},"details-item-name":{"*":["t34"],camera:["t42","t40","t34"],flash:["t45","t34"]},"details-item-value":{"*":["t35"],camera:["t43","t41","t35"],lens:["t44","t35"],flash:["t46","t35"]},"details-name":{"*":["t36"]},"details-value":{"*":["t37"],dateTimeOriginal:["t38","t37"],added:["t39","t37"],exposureProgram:["t47","t37"]},complain:{"*":["t48"]},"complain-wrong-url":{"":["t49"]},"error-popup":{"":["t50"]},"error-ballon":{"":["t51"]},"error-popup-button":{"*":["t52"]},icon_edit:{"":["t53"]},icon_trash:{"":["t54"]},icon_access:{"":["t55"]},icon_help:{"":["t56"]},icon_18plus:{"":["t57"]},"icon_layout-expand":{"":["t58"]},"icon_layout-collapse":{"":["t59"]},icon_share:{"":["t60"]},icon_lock:{"":["t61"]},icon_medal:{"":["t62"]},"icon_rotate-ccw":{"":["t63"]},icon_cross:{"":["t64"]},"icon_cross-small":{"":["t65"]},icon_pin:{"":["t66"]},icon_eye:{"":["t67"]},icon_heart:{"":["t68"]},icon_star:{"":["t69"]},icon_code:{"":["t70"]},icon_envelope:{"":["t71"]},icon_what:{"":["t72"]},icon_gear:{"":["t73"]},icon_door:{"":["t74"]},icon_comment:{"":["t75"]},icon_letter:{"":["t76"]},icon_ufo:{"":["t77"]},icon_disk:{"":["t78"]},"icon_thumb-up":{"":["t79"]},like:{"*":["t80"]},"keyboard-shortcuts":{"":["t85"]},shortcut:{"*":["t86"]},"popular-tag":{teaser:["t95"]},"no-popular-tag":{teaser:["t96"]},"photo-is-updating":{photo:["t105"]},"error-image-not-found":{"*":["t115"]},"error-access-denied":{"*":["t116"]},"photo-image":{photo:["t121","t120","t119","t118","t117"]},"photo-blocked":{"*":["t122"]},"photo-image-block-reason":{blockReason:["t125","t124","t123"]},"error_something-goes-wrong":{"":["t126"]},"error_album-password-empty":{"":["t127"]},"error_album-password-wrong":{"":["t128"]},"photo-info-button-follow":{profile:["t135"]},"normal-content":{"photo-info":["t140"]},"photo-view-panel__info":{photo:["t143","t141"]},"photo-view-panel__public-toggler":{photo:["t142"]},"photo-view-panel__title":{photo:["t144"]},"photo-view-panel__description":{photo:["t145"]},"error_save-description":{"":["t146"]},"error_save-title":{"":["t147"]},"photo-slider-info__title":{photo:["t149"]},"photo-slider-info__position":{photo:["t150"]},"photo-view-panel__tags":{tags:["t154","t153"]},"photo-view-panel__honors":{"*":["t157","t155"]},"photo-honors__total":{"*":["t156"]},medal:{"*":["t162","t161","t160","t159","t158"]},"error_edit-tags":{"":["t163"]},"error_edit-tags-limit":{"":["t164"]},"error_map-bind-failed":{"":["t168"]},"error_map-unbind-failed":{"":["t169"]},"error_photo-to-disk-failed":{"":["t177"]},"message_photo-to-disk-success":{"":["t178"]},"error_photo-to-disk-out-of-quota":{"":["t179"]},"stat-counter":{"*":["t183"]},"photo-controls-error-mode":{"photo-controls":["t187"]},"item-slideshow":{"photo-controls":["t188"]},"item-layout-toggle":{"photo-controls":["t189"]},"item-share":{"photo-controls":["t190"]},"item-more":{"photo-controls":["t191"]},"item-prev":{"photo-ears":["t194"]},"item-next":{"photo-ears":["t195"]},"item-rotate":{"photo-edit":["t198"]},"item-edit":{"photo-edit":["t199"]},"photo-before-edit-dialog":{"":["t200"]},"item-delete":{"photo-edit":["t201"]},"photo-edit-dialog-delete":{"*":["t202"]},"item-access":{"photo-edit":["t203"]},"photo-edit-popup-access":{"*":["t204"]},"error_photo-remove-failed":{"":["t205"]},"error_photo-rotate-failed":{"":["t206"]},"error_image-edit-failed":{"":["t207"]},"error_image-edit-unavailable":{"":["t208"]},"photo-flags-item":{photo:["t211"]},"comments_state-hidden":{"":["t216"]},"comments_state-disabled-for-user":{"":["t217"]},"comments_state-disabled-for-image":{"":["t218"]},"comments_state-user-banned-by-author":{"":["t219"]},"comments_state-user-banned-by-moderator":{"":["t220"]},"comments_state-readonly":{"":["t221"]},"comments_state-unavailable":{"":["t222"]},"comments_state-pod-comments-none":{"":["t223"]},"comments_state-pod-comments-restricted":{"":["t224"]},"error_could-not-add-comment":{"":["t225"]},"error_could-not-remove-comment":{"":["t226"]},"error_captcha-invalid":{"":["t227"]},"error_user-ban-failed":{"":["t228"]},banner:{"*":["t230"]},"send-button":{"*":["t236"]},"send-popup-body":{"*":["t237"]},"revoke-button":{"*":["t238"]},"revoke-popup-body":{"*":["t239"]},"error_send-to-contest":{"":["t240"]},"error_revoke-from-contest":{"":["t241"]},invalid_title_is_empty:{"":["t242"]},invalid_tags_are_empty:{"":["t243"]},"meta-tags-not-found":{"":["t245"]},"meta-tags-index":{"":["t246"]},"meta-tags-contest-vote":{"":["t247"]},"meta-tags-photo":{"":["t248"]},"server-render-init-script":{"":["t249"]}},M.imports=[],yr.register("main",M)}(),function(){var unloaded=!1;$(window).bind("beforeunload",function(){unloaded=!0});var queue=[],visible=[],max=3,gap=10,errors={};errors.showError=function(context,options){if(options="string"==typeof options?{messageId:options}:options||{},context&&(context.pageLeft&&!options.persistent||unloaded))return void context.destroy();var node=$('<div data-nb="field-error"/>')[0],error=nb.block(node);return error.showFor(options.element,options,context),error},errors.addItem=function(popup){var that=this,item={popup:popup,height:null};queue.push(item),item.popup.on("ph-destroy",function(){that._removeItem(item),that._update()}),this._update()},errors._removeItem=function(item){var index=visible.indexOf(item);0>index||visible.splice(index,1)},errors._update=function(){this._updatePositions(),this._showMore()},errors._showMore=function(){for(var count=visible.length;count++<max&&queue.length;)this._showItem(queue.splice(0,1)[0])},errors._showItem=function(item){var prevItem=visible[visible.length-1],$popup=$(item.popup.node);$popup.removeClass("is-hidden"),item.popup.trigger("toggle",{where:document.body,how:{where:"top right",what:"top left"}}),this._updatePosition(item,prevItem),visible.push(item)},errors._updatePositions=function(){for(var i=0;i<visible.length;i++)this._updatePosition(visible[i],visible[i-1])},errors._updatePosition=function(item,prevItem){var bottom,prevItemHeight,left=gap;prevItem?(prevItemHeight=prevItem.height||(prevItem.height=prevItem.popup.$node.outerHeight()),bottom=prevItem.bottom+prevItemHeight+gap):bottom=40+gap,item.bottom=bottom,item.popup.$node.css({left:left,bottom:bottom,top:"initial"})},ph.errors=errors}(),ph.ERRORS={imageNotFound:"image not found"},ns.layout.define("app",{app:{"head-box@":"head&","content@":{},"foot-box@":"foot","overlay@":{}}}),ns.layout.define("not-found",{"app content@":"not-found"},"app"),ns.layout.define("index",{"app content@":{pod:!0,teaser:{"teaser-banner&":!0},"contest&":!0,"stream&":!0,"ads-direct&":!0,"scroll-memory":!0}},"app");var overlayLayout=function(params){var layout={photo:{"photo-box@":{"photo-image":!0},"photo-ears":!0,"photo-flags-box@":{"photo-flags":!0},"photo-edit-box@":{"photo-edit":!0},panel:{"panel-box@":{"panel-container":{"photo-author":!0,"photo-info-box@":"photo-info","photo-tags":!0,"comments-container@":"comments&"}},"ads&":!0},bar:{"controls@":{"photo-controls":{"photo-on-map&":!0,"send-to-contest":!0,"photo-views":!0,"photo-like":!0,"photo-favorite":!0,"photo-to-disk":!0}}},tray:{"tray-container":{"photo-slider-info@":{"photo-slider-info-item":!0},"tray-box@":{"slider&":!0}}}}},context=params.context||"album",mode=params.mode||"view",isAlbumContext="album"===context,isViewMode="view"===mode,isFullscreenMode="fullscreen"===mode;return isAlbumContext&&isViewMode||(layout.photo["photo-edit-box@"]=null),isFullscreenMode&&delete layout.photo.panel,isViewMode&&(layout.photo.tray["tray-container"]["photo-slider-info@"]=null),layout};ns.layout.define("photo",{"app head-box@":{},"app foot-box@":{},"app overlay@":overlayLayout},"app"),ns.layout.define("contest-vote",{"app head-box@":{},"app content@":{},"app foot-box@":{},"app overlay@":{"photo-contest":{"photo-box@":{"photo-image-contest":!0,"photo-image-overlay":!0}}}},"app"),ph.params={hiddenParams:{},getModelParamValue:function(modelId,pName){var _params,modelInfo=ns.Model.infoLite(modelId),currentParams=ns.page.current.params;return _params="function"==typeof modelInfo.params?modelInfo.params(currentParams):modelInfo.params,_params[pName]},sliderDataParams:function(params){return ph.params._sliderDataParams(params)},sliderDataPageParams:function(params){var pageSize=20,context=params.context;("recent"===context||"popular"===context||"calendar"===context)&&(pageSize=40);var _params=ph.params._sliderDataParams(params);return _params.page=params.page||0,_params["page-size"]=params["page-size"]||pageSize,_params},sliderViewParams:function(params){return ph.params._sliderDataParams(params,["mode"])},_sliderDataParams:function(params,addParams){var keys,strict,context;switch(addParams=addParams||[],context=params.context){case"search":keys=["context","search-author","how","noreask","search-text","tags","type","modelid","chastity"],strict=!1;break;case"contest":keys=["context","contest-id"],strict=!0;break;case"tag":keys=["context","tag","author-login"],strict=!0;break;case"recent":case"popular":keys=["context","offset"],strict=!1;break;default:context?(keys=["context"],strict=!0):params["author-login"]&&params["album-id"]&&(keys=["author-login","album-id"],strict=!0)}return keys?ph.utils.pick(params,keys.concat(addParams),strict):{}},commentsParams:function(params){var defaultCount=7,_params=ph.utils.pick(params,["author-login","image-id"]);return _params["roots-sort-order"]="desc",_params["replies-sort-order"]="asc","comment-id"in params?(_params["comment-id"]=params["comment-id"],_params.count=params.count||defaultCount-1):"comment-id"in ph.params.hiddenParams?(_params["comment-id"]=ph.params.hiddenParams["comment-id"],_params.count=params.count||defaultCount-1):(_params.index=0,_params.count=params.count||defaultCount),_params},commentsViewParams:function(params){var _params=ph.utils.pick(params,["author-login","image-id"]);return ph.params.hiddenParams["comment-id"]&&(_params["comment-id"]=ph.params.hiddenParams["comment-id"]),_params},oldSearchParams:function(params){return ph.utils.transformParams(params,{text:["search-text"],p:["page"],type:["type"],modelid:["modelid"],tags:["tags"],noreask:["noreask"],how:["how"],search_author:["search-author"],grouping:[null,"off"]})},photoPositionParams:function(params){return ph.utils.pick(params,["author-login","image-id","context","contest-id","tag"])},photoInfoViewParams:function(params){var _params=ph.params.photoPositionParams(params);return"album-id"in params&&(_params["album-id"]=params["album-id"]),_params}},function(){var getNearestMultipleOf=function(num,divider){var mod=num%divider;return num+(0===mod?0:divider-mod)},generateSequence=function(from,to,reverse){for(var result=[],i=from;to>=i;i++)result.push(i);return reverse?result.reverse():result},DynamicModelCollection=function(){};no.inherit(DynamicModelCollection,ns.ModelCollection);var _invalidate=DynamicModelCollection.prototype.invalidate;DynamicModelCollection.prototype._init=function(){ns.ModelCollection.prototype._init.apply(this,arguments),ns.assert(this.info.dynamic,"dynamicModelCollection","info.dynamic was not specified for '%s'",this.id),this._pageSize=ph.params.getModelParamValue(this.info.dynamic.pagingModel,"page-size"),ns.assert(this._pageSize,"dynamicModelCollection","Paging model '%s' must have 'page-size' parameter set",this.info.dynamic.pagingModel),this._dynamicReset(),this.listenToMutations()},DynamicModelCollection.prototype._dynamicReset=function(){this.dynamic={},this.dynamic.pageSize=this._pageSize,this.dynamic.pages={}},DynamicModelCollection.prototype.invalidate=function(){return this._dynamicReset(),_invalidate.apply(this,arguments)},DynamicModelCollection.prototype.sync=function(visible){var fixedPages,pageFrom=visible.pages.from,pageTo=visible.pages.to;!this.firstDataPortionLoaded&&"page"in ns.page.current.params&&(fixedPages=this.fixInitialPages(),pageFrom=fixedPages.from,pageTo=fixedPages.to);var pageMaxIndex=this.getPageMaxIndex(pageTo),models=this.models;models.length<pageMaxIndex+1&&(this.insert(this.createFakeModels(models.length,pageMaxIndex)),this.notifyNewItemsLoaded()),this.requestPages(generateSequence(pageFrom,pageTo))},DynamicModelCollection.prototype.fixInitialPages=function(){var pageCurrent=Math.max(+ns.page.current.params.page||0,0);return{from:pageCurrent,to:pageCurrent}},DynamicModelCollection.prototype.syncCurrent=function(){this.syncPagesHash()&&this.notifySyncNeeded()},DynamicModelCollection.prototype.getItemIndex=function(params){for(var models=this.models,i=0;i<models.length;i++){var model=models[i];if(this.isModelGood(model)&&this.compareParams(model.params,params))return i}return-1},DynamicModelCollection.prototype.getItem=function(index){var model=this.models[index];return this.isModelGood(model)?model:null},DynamicModelCollection.prototype.listenToMutations=function(){var that=this;this.on("ns-model-remove",function(evt,models){if(!that.isMutating&&models&&models.length){var oldTotal=that.dynamic.total;that.dynamic.total-=models.length,that.syncPagesHash(),that.notifyTotalChanged(oldTotal)}})},DynamicModelCollection.prototype.requestPages=function(pages){for(var i=0;i<pages.length;i++){var page=pages[i];!this.dynamic.pages[page]&&this.pageExists(page)&&this.requestPage(page)}},DynamicModelCollection.prototype.pageExists=function(page){if(!this.firstDataPortionLoaded)return 0===Object.keys(this.dynamic.pages).length;var firstPageIndex=page*this.dynamic.pageSize;return firstPageIndex<this.dynamic.total},DynamicModelCollection.prototype.requestPage=function(page){var beforeRequestPromise,that=this,promise=new Vow.Promise;return this.dynamic.pages[page]=promise,beforeRequestPromise=this.beforePageRequest(page),beforeRequestPromise?(beforeRequestPromise.then(function(){that.requestPagingModel(page).then(function(pagingModel){that.onPagingModelLoaded(page,pagingModel)}).fail(function(){that.onPagingModelLoadFail(page)})}),beforeRequestPromise.fail(function(){that.onPagingModelLoadFail(page)})):this.requestPagingModel(page).then(function(pagingModel){that.onPagingModelLoaded(page,pagingModel)}).fail(function(){that.onPagingModelLoadFail(page)}),promise},DynamicModelCollection.prototype.beforePageRequest=function(){return Vow.fulfill()},DynamicModelCollection.prototype.onPagingModelLoaded=function(page,pagingModel){var models=this.models;this.firstDataPortionLoaded=!0,this.isMutating=!0;var totalChanged=!1,extracted=this.extractPageData(pagingModel,page),newModels=extracted.models,newTotal=extracted.total,oldTotal=this.dynamic.total;newTotal!==this.dynamic.total&&(this.dynamic.total=newTotal,this.removeRedundantItems(),totalChanged=!0);for(var to,indexes=this.generateIndexesForPage(page),lastIndex=(indexes[0],indexes[indexes.length-1]),newIndex=0,from=null,i=0;i<indexes.length;i++){var index=indexes[i],model=models[index];this.isModelGood(model)?null!==from&&(to=index-1,this.replaceItems(from,to,from+newIndex,newModels),newIndex+=from-to,from=null):null===from&&(from=index)}this.replaceItems(from,lastIndex,from+newIndex,newModels),from=null,this.isMutating=!1,this.dynamic.pages[page].fulfill(),this.syncPagesHash(),totalChanged&&this.notifyTotalChanged(oldTotal),this.notifyNewItemsLoaded(page)},DynamicModelCollection.prototype.onPagingModelLoadFail=function(page){this._resetPage(page)},DynamicModelCollection.prototype.replaceItems=function(from,to,offset,newItems){null!==from&&(this.removeItems(from,to),this.insert(newItems.slice(from-offset,to-offset+1),from))},DynamicModelCollection.prototype.removeRedundantItems=function(){this.dynamic.total<this.models.length&&this.removeItems(this.dynamic.total,this.models.length-1)},DynamicModelCollection.prototype.removeItems=function(from,to){var models=this.models,indexes=generateSequence(from,to).filter(function(index){return!!models[index]});this.remove(indexes.reverse())},DynamicModelCollection.prototype.syncPagesHash=function(){for(var changed=!1,models=this.models,l=Math.min(this.dynamic.total,getNearestMultipleOf(models.length,this.dynamic.pageSize)),i=0;l>i;i++){var page=Math.floor(i/this.dynamic.pageSize);if(this.isPageLoaded(page)){var model=models[i];this.isModelGood(model)||(null!=this.dynamic.pages[page]&&(changed=!0),this._resetPage(page))}}return changed},DynamicModelCollection.prototype._resetPage=function(page){var pagePromise=this.dynamic.pages[page];pagePromise&&!pagePromise.isResolved()&&pagePromise.reject(),this.dynamic.pages[page]=void 0},DynamicModelCollection.prototype.createFakeModels=function(from,to){for(var models=[],i=from;to>=i;i++)models.push(this.createFakeModel(i));return models},DynamicModelCollection.prototype.generateIndexesForPage=function(page){var from=page*this.dynamic.pageSize,to=this.getPageMaxIndex(page);return generateSequence(from,to)},DynamicModelCollection.prototype.getPageMaxIndex=function(page){var pageSize=this.dynamic.pageSize,pageLastIndex=(page+1)*pageSize-1;if(null==this.dynamic.total)return pageLastIndex;var total=this.dynamic.total;return pageLastIndex+1>total?total-1:pageLastIndex},DynamicModelCollection.prototype.isPageLoaded=function(page){var promise=this.dynamic.pages[page];return promise&&promise.isResolved()},DynamicModelCollection.prototype.isModelGood=function(model){return model&&model.isValid()&&!this.isFakeModel(model)},DynamicModelCollection.prototype.notifyTotalChanged=function(oldTotal){this.trigger("total-changed",this.dynamic.total,oldTotal)},DynamicModelCollection.prototype.notifyNewItemsLoaded=function(page){this.trigger("new-items-loaded",page)},DynamicModelCollection.prototype.notifySyncNeeded=function(){this.trigger("sync-needed")},DynamicModelCollection.prototype.createFakeModel=function(){throw new Error("[dynamicModelCollection] you need to implement createFakeModel() method")},DynamicModelCollection.prototype.isFakeModel=function(){throw new Error("[dynamicModelCollection] you need to implement isFakeModel() method")},DynamicModelCollection.prototype.extractPageData=function(){throw new Error("[dynamicModelCollection] you need to implement extractPageData() method")},DynamicModelCollection.prototype.compareParams=function(){throw new Error("[dynamicModelCollection] you need to implement compareParams() method")},DynamicModelCollection.prototype.requestPagingModel=function(){throw new Error("[dynamicModelCollection] you need to implement requestPagingModel ) method")},ph.DynamicModelCollection=DynamicModelCollection}(),ns.Model.define("auth",{methods:{extractData:function(data){var error=no.jpath(".auth.error",data);if(error&&"OK"!==error)return{};var uid=no.jpath(".auth.uid.value",data);if(!uid)return{};var sessionStatus=(no.jpath(".auth.status.value",data)||"").toLowerCase();if("need_reset"===sessionStatus)return null;if("valid"!==sessionStatus)return{};var result=no.extend({},data.auth),profile=no.jpath(".profile.result",data);return profile&&no.extend(result,{"photo-profile":profile}),result},extractError:function(result){result=result||{};var sessionStatus=(no.jpath(".auth.status.value",result)||"").toLowerCase();return"need_reset"===sessionStatus?{name:"auth:need_reset"}:ns.Model.prototype.extractError.call(this,result.auth)},canRequest:function(){var error=this.getError();return error&&"pdd"===error.name?!1:ns.Model.prototype.canRequest.apply(this,arguments)},isAuthValid:function(){return!!this.get(".uid.value")},hasProfile:function(){return!!this.get(".photo-profile")}}}),ns.Model.define("profile",{params:{"author-login":null}}),ns.Model.define("ticket"),ns.Model.define("region"),ns.Model.define("preferences",{methods:{extractData:function(data){if(!data)return null;if(data.error){var errorName=data.error.name;if("user not found"===errorName)return{error:errorName}}return ns.Model.prototype.extractData.apply(this,arguments)},isSet:function(name){return!!no.jpath('.preferences.preference.[ .name == "'+name+'" ]',this.getData())}}}),function(){var photoParams={"author-login":null,"image-id":null},PhotoLite=function(){};no.inherit(PhotoLite,ns.Model),PhotoLite.prototype.hasDataChanged=function(newData){var oldData=this.getData();return!oldData||!this.isValid()||newData.updated!==oldData.updated||newData.version!==oldData.version||no.jpath(".sizes.orig.url",newData)!==no.jpath(".sizes.orig.url",oldData)},ns.Model.define("photo-lite",{params:photoParams},PhotoLite),ns.Model.define("photo",{params:photoParams,methods:{extractData:function(result){var data=ns.Model.prototype.extractData.call(this,result),redirectModel=ns.Model.get("photo-initial-redirect",{});return redirectModel.isRedirectNeeded()&&data&&data.albumId&&redirectModel.setRedirectInfo(data.albumId),data}}},PhotoLite)}(),ns.Model.define("photo-info-state",{params:{"author-login":null,"image-id":null},getInitialData:function(){return{titleCollapsed:void 0,descriptionCollapsed:void 0}}},ph.LocalModel),ns.Model.define("photo-more",{params:{"author-login":null,"image-id":null}}),ns.Model.define("photo-rights",{params:{"author-login":null,"image-id":null}}),ns.Model.define("photo-position",{params:ph.params.photoPositionParams}),ns.Model.define("photo-initial-redirect",{params:{},methods:{canRequest:function(){return!1},extractError:function(){return this.getError()},extractData:function(){return this.getData()},isRedirectNeeded:function(){var pageInfo=ns.page.current;return"photo"===pageInfo.page&&!pageInfo.params["album-id"]},getAlbumId:function(){return no.jpath(".album-id",this.getError())},setAsValid:function(){this.setData({})},setRedirectInfo:function(albumId){this.setError({name:"ph-photo-redirect-to-url-with-album","album-id":albumId})}}}),ns.Model.get("photo-initial-redirect",{}).setAsValid(),ns.Model.define("pod",{}),ns.Model.define("pod-author-profile"),ns.Model.define("album",{params:{"author-login":null,"album-id":null,"page-size":20,page:0},split:{items:".images.images.image",model_id:"photo",params:{"author-login":".author.login","image-id":".imageId"}}}),ns.Model.define("comments-state",{params:ph.params.commentsViewParams,getInitialData:function(){return{"show-ads":void 0}},methods:{showAds:function(){this.get(".show-ads")||this.set(".show-ads",!0)},hideAds:function(){this.get(".show-ads")&&this.set(".show-ads",!1)}}},ph.LocalModel),ns.Model.define("comments-more",{params:ph.params.commentsParams,split:{items:".comments.comment",model_id:"comment",params:{id:".id"}}}),ns.Model.define("comments",{params:ph.params.commentsParams,split:{items:".comments.comment",model_id:"comment",params:{id:".id"}},methods:{onItemChanged:no.nop,onItemTouched:no.nop,onItemDestroyed:no.nop}}),ns.Model.define("comment",{params:{id:null}}),ns.Model.define("comment-add-so",{params:{"author-login":null,"image-id":null}}),ns.Model.define("contest",{params:{},methods:{extractData:function(result){if(result&&!result.error&&this._isContestIdValid(result)){var data=result.result,voteKey=no.jpath(".photo.result.voteKey",data),contestData=no.extend({},no.jpath(".contest.result",data),{voteKey:voteKey});return this._innerModels={},this._createModelPhoto("vote-photo",".photo.result.images.images.image",data),this._createModelProfile("vote-photo-profile",".votePhotoProfile.result",data),this._createModelPhoto("contest-photo",".contest.result.images",data),this._createModelProfile("contest-photo-profile",".contestPhotoProfile.result",data),this._createModelPhoto("random-pod",".dummy.result",[data]),contestData}},extractError:function(result){return this._isContestIdValid(result)?ns.Model.prototype.extractError.apply(this,arguments):{name:"contest is not active"}},_isContestIdValid:function(result){var contestId=no.jpath(".result.contest.result.contestId",result),contestIdFromParams=ns.page.current.params["contest-id"];return!contestIdFromParams||contestIdFromParams==contestId},_createModelPhoto:function(name,jpath,data){var modelData=no.jpath(jpath,data);if(modelData){var innerModel=ns.Model.get("photo",{"author-login":no.jpath(".author.login",modelData[0]),"image-id":no.jpath(".imageId",modelData[0])});this._innerModels[name]=innerModel.getData()?innerModel:innerModel.setData(modelData[0])}},_createModelProfile:function(name,jpath,data){var modelData=no.jpath(jpath,data);modelData&&(this._innerModels[name]=ns.Model.get("profile",{"author-login":no.jpath(".user.login",modelData)}).setData(modelData))},getInnerModel:function(name){return this._innerModels[name]},getRestoreData:function(){var data={self:this.getData()};return this._setInnerModelRestoreData("vote-photo",data),this._setInnerModelRestoreData("vote-photo-profile",data),this._setInnerModelRestoreData("contest-photo",data),this._setInnerModelRestoreData("contest-photo-profile",data),this._setInnerModelRestoreData("random-pod",data),data},_setInnerModelRestoreData:function(name,data){var innerModel=this.getInnerModel(name);innerModel&&(data[name]={id:innerModel.id,params:innerModel.params,data:innerModel.getRestoreData()})},restoreModel:function(data){this._innerModels={};var info;for(var name in data)info=data[name],"self"===name?this.setData(data.self):this._innerModels[name]=ns.Model.get(info.id,info.params).restoreModel(info.data)}}}),ns.Model.define("photo-to-vote",{params:{"contest-id":null}}),ns.Model.define("photo-near-context",{params:{context:null,"author-login":null,"image-id":null,"page-size":20,"contest-id":null,tag:null}}),ns.Model.define("tags",{params:{"author-login":null,"image-id":null}}),ns.Model.define("album-info",{params:{"author-login":null,"album-id":null}}),ns.Model.define("blog-code-settings",{getInitialData:function(){return{sizes:{all:["orig","x5l","x4l","xxxl","xxl","xl","l","m","s","xs","xxs","xxxs"]}}}},ph.LocalModel),ns.Model.define("exif",{params:{"author-login":null,"image-id":null}}),ns.Model.define("views",{params:{"author-login":null,"image-id":null,referers:null}}),ns.Model.define("slider-context",{params:ph.params.sliderDataParams,split:{items:".images.images.image",model_id:"photo-lite",params:{"author-login":".author.login","image-id":".imageId"}},dynamic:{pagingModel:"do-get-context-page"},disableJpathDataChecks:!0,methods:{onItemChanged:function(){},createFakeModel:function(){return ns.Model.get("photo-lite",{"author-login":0,"image-id":this._getFakeIndex()}).setData({fake:!0})},isFakeModel:function(model){return model.get(".fake")},extractPageData:function(pagingModel,page){var that=this,insertion=pagingModel.models;insertion=ph.utils.uniq(insertion,function(m){return m.key}),insertion=insertion.filter(function(m){return-1===that.models.indexOf(m)});var pageSize=this.dynamic.pageSize,total=pagingModel.get(".images.total")||0,countRaw=pagingModel.models.length,count=insertion?insertion.length:0,calcTotal=page*pageSize+count,calcRawTotal=page*pageSize+countRaw,totalConfirmed=this.dynamic.totalConfirmed=this.dynamic.totalConfirmed||calcRawTotal,totalMax=this.dynamic.totalMax=this.dynamic.totalMax||Math.max(total,calcRawTotal);
return count>0&&pageSize>countRaw?(this.dynamic.totalConfirmed=calcTotal,this.dynamic.totalMax=calcTotal,{models:insertion,total:calcTotal}):(count>0&&(this.dynamic.totalConfirmed=Math.max(totalConfirmed,calcRawTotal),this.dynamic.totalMax=Math.max(totalMax,Math.max(total,calcRawTotal))),0===count&&(totalConfirmed>calcRawTotal&&(this.dynamic.totalConfirmed=0),totalMax>calcRawTotal&&countRaw>=0&&pageSize>countRaw&&(this.dynamic.totalMax=calcRawTotal)),{models:insertion,total:this.dynamic.totalMax})},compareParams:function(p1,p2){return p1["author-login"]==p2["author-login"]&&p1["image-id"]==p2["image-id"]},fixInitialPages:function(){return this._isStreamContext()?{from:0,to:0}:ph.DynamicModelCollection.prototype.fixInitialPages.apply(this,arguments)},beforePageRequest:function(page){return this._isStreamContext()&&page>0?this.dynamic.pages[page-1]:Vow.fulfill()},requestPagingModel:function(page){var offset,that=this,promise=new Vow.Promise,params=no.extend({},ns.page.current.params,{page:page});if(this._isStreamContext()){if(page==this.get(".paging.page")&&(offset=this.get(".paging.offset")),!offset&&page>0)return promise.reject(),promise;params.offset=offset}return ph.controllers.slider.getAlbumPage(params).then(function(context){var model=context.model;that.set(".paging.offset",model.get(".images.paging.offset"),{silent:!0}),that.set(".paging.page",model.get(".images.paging.page"),{silent:!0}),promise.fulfill(model)}).fail(function(){promise.reject()}),promise},hasMore:function(){return!!this.get(".paging.offset")},_isStreamContext:function(){var context=this.params.context;return"popular"===context||"recent"===context},_getFakeIndex:function(){return this._fakeIndex||(this._fakeIndex=0),this.key+"_"+this._fakeIndex++}}},ph.DynamicModelCollection),ns.Model.define("settings"),ns.Model.define("app-state",{getInitialData:function(){return{"is-adult":void 0,"photo-ads-disabled":!1,"photo-ads-loaded":!1,"photo-ads-reload-count":0}},methods:{setIsAdult:function(){var uid=ns.Model.get("auth").get(".uid.value")||"0";ph.utils.setIsAdult(uid)&&this.set(".is-adult",!0)},arePhotoAdsDisabled:function(){return this.get(".photo-ads-disabled")},enablePhotoAds:function(){this.get(".photo-ads-disabled")&&this.set(".photo-ads-disabled",!1)},disablePhotoAds:function(){this.get(".photo-ads-disabled")||this.set(".photo-ads-disabled",!0)},reloadAds:function(){var count=this.get(".photo-ads-reload-count");count=(count+1)%100,this.set(".photo-ads-reload-count",count),this.set(".photo-ads-loaded",!0)}}},ph.LocalModel),ns.Model.define("photos-ads-state",{params:{},getInitialData:function(){return this.options={showCountLimit:3,showTimeLimit:30},this.secondsTimestamp=0,this.showsLeft=0,{disabled:!0,loaded:!1,loading:!1,reload:0}},methods:{countShow:function(){var secondsNow=Date.now()/1e3,secondsDiff=secondsNow-this.secondsTimestamp,timeoutReached=secondsDiff>=this.options.showTimeLimit;this.get(".loading")||(this.showsLeft>0?this.showsLeft--:this.showsLeft<=0&&timeoutReached&&this.set(".loading",!0))},setNewAdsLoaded:function(){var reloadCount=this.get(".reload"),secondsNow=Date.now()/1e3;this.set(".loaded",!0,{silent:!0}),this.set(".loading",!1,{silent:!0}),this.showsLeft=this.options.showCountLimit,this.set(".reload",reloadCount+1),this.secondsTimestamp=secondsNow,this.countShow()},handleAdsLoadFail:function(){this.set(".loading",!1,{silent:!0})},enableAds:function(){this.get(".disabled")&&this.set(".disabled",!1)},disableAds:function(){this.get(".disabled")||(this.set(".loaded",!1),this.set(".disabled",!0))},areAdsDisabled:function(){return this.get(".disabled")}}},ph.LocalModel),ns.Model.define("panel-state",{getInitialData:function(){return{disabled:!1,skipping:!1}},methods:{isUserScroll:function(){return!this.get(".disabled")&&!this.get(".skipping")},skipNextScrollEvent:function(){var that=this;this._skipTimer&&clearTimeout(this._skipTimer),this.set(".skipping",!0),this._skipTimer=setTimeout(function(){that.set(".skipping",!1),that._skipTimer=null},50)},disable:function(){this.set(".disabled",!0)},enable:function(){this.skipNextScrollEvent(),this.set(".disabled",!1)}}},ph.LocalModel),ns.Model.define("save-to-disk-state",{params:{"author-login":null,"image-id":null},getInitialData:function(){return{"save-image-state":void 0}},methods:{reset:function(){this.set(".save-image-state",void 0)},setRunning:function(){this.set(".save-image-state","running")},setDone:function(){this.set(".save-image-state","done")}}},ph.LocalModel),ns.Model.define("image-box",{getInitialData:function(){return{width:-1,height:-1}},methods:{getDimensions:function(){return{width:this.get(".width"),height:this.get(".height")}},setDimensions:function(width,height){(width!==this.get(".width")||height!==this.get(".height"))&&this.setData({width:width,height:height})}}},ph.LocalModel),ns.Model.define("popular-tags",{params:{},methods:{extractData:function(data){return data&&data.result?data.result:{nodata:!0}}}}),ns.Model.define("photoguide",{}),ns.Model.define("contests-settings",{getInitialData:function(){return{active:!0}}},ph.LocalModel),ns.Model.define("do-agreement-accept",{params:{ticket:null}}),ns.Model.define("do-photo-description-edit",{params:{"image-id":null,description:null,ticket:null}}),ns.Model.define("do-photo-edit",{params:{"image-id":null,"access-rights":null,"disable-comments":null,"hide-orig":null,"invalidate-links":null,porno:null,ticket:null}}),ns.Model.define("do-photo-title-edit",{params:{"image-id":null,title:null,ticket:null}}),ns.Model.define("do-photo-complain",{params:{"author-login":null,"image-id":null,types:null,url:null,comment:null,"contest-id":null,ticket:null},methods:{extractData:function(result){return result&&result.result&&result.result.complete?result.result:void 0},extractError:function(result){return result?result.error||result.result.rejectReason:void 0}}}),ns.Model.define("do-photo-remove",{params:{"image-id":null,ticket:null}}),ns.Model.define("do-photo-rotate",{params:{ticket:null,"image-id":null,angle:null}}),ns.Model.define("do-photo-to-disk-start",{params:{"author-id":null,"image-id":null,ticket:null}}),ns.Model.define("do-photo-to-disk-status",{params:{"job-id":null,ticket:null}}),function(){var modelExtractor=function(){};no.inherit(modelExtractor,ns.ModelCollection),modelExtractor.prototype.preprocessData=function(data){var dataNew={comment:[]};return dataNew.comment.push(data),dataNew},ns.Model.define("do-comment-add",{params:{"author-login":null,"image-id":null,content:null,"parent-comment-id":null,"cap-key":null,"cap-rep":null,"display-name":null,so:null,ticket:null},split:{items:".comment",model_id:"comment",params:{id:".id"}}},modelExtractor)}(),ns.Model.define("do-comment-delete",{params:{"author-login":null,"image-id":null,"comment-id":null,ticket:null}}),ns.Model.define("do-tag-edit",{params:{"author-login":null,"image-id":null,tags:null,ticket:null}}),ns.Model.define("do-captcha-get",{params:{ticket:null}}),ns.Model.define("do-like-set",{params:{"author-login":null,"image-id":null,operation:null,ticket:null}}),ns.Model.define("do-favorite-set",{params:{"author-login":null,"image-id":null,operation:null,ticket:null}}),ns.Model.define("do-geo-bind",{params:{"author-login":null,"image-id":null,latitude:null,longitude:null,mapType:null,zoomLevel:null,ticket:null}}),ns.Model.define("do-geo-unbind",{params:{"author-login":null,"image-id":null,ticket:null}}),ns.Model.define("do-user-ban",{params:{"user-ids":null,ticket:null}}),ns.Model.define("do-user-follow",{params:{"author-login":null,ticket:null}}),ns.Model.define("do-user-unfollow",{params:{"author-ids":null,ticket:null}}),ns.Model.define("do-password-check",{params:{ticket:null,"album-id":null,password:null,"author-id":null}}),ns.Model.define("do-get-context-page",{params:ph.params.sliderDataPageParams,split:{items:".images.images.image",model_id:"photo-lite",params:{"author-login":".author.login","image-id":".imageId"}}}),ns.Model.define("do-send-to-contest",{params:{"author-login":null,"image-id":null,title:null,tags:null,"contest-id":null,ticket:null}}),ns.Model.define("do-revoke-from-contest",{params:{"author-login":null,"image-id":null,"contest-id":null,ticket:null}}),ns.Model.define("do-image-can-edit",{params:{ticket:null,"image-id":null}}),ns.Model.define("do-image-before-edit",{params:{ticket:null,"image-id":null,actions:null}}),ns.Model.define("do-image-edit",{params:{ticket:null,"image-id":null,actions:null}}),ns.Model.define("do-image-edit-status",{params:{ticket:null,"image-id":null}}),ns.Model.define("do-contest-vote",{params:{vote:null,"vote-key":null,"contest-id":null,tag:null,ticket:null}}),ns.Model.define("do-get-unread-mail",{params:{ticket:null}}),function(){var key2timer={},destroyModel=function(id,params){var m=ns.Model.get(id,params);m.isValid()&&ns.Model.destroy(m)},invalidateModels=function(id,filter){ns.Model.invalidate(id,filter)},cleanup=function(modelId,params){var cleanupHandler=cleanupHandlers[modelId];cleanupHandler(params)},cleanupHandlers={};cleanupHandlers.photo=function(params){destroyModel("photo",params),destroyModel("photo-lite",params),invalidateModels("photo-near-context"),invalidateModels("photo-position")};var errorHandlers={};errorHandlers["photo-rights"]={},errorHandlers["photo-rights"]["image not found"]=function(m){cleanup("photo",m.params)};var cacheFor=function(model,timeout,force){var key=model.key;(!key2timer[key]||force)&&(force&&key2timer[key]&&clearTimeout(key2timer[key]),key2timer[key]=setTimeout(function(){model.status=ns.M.STATUS.INVALID,key2timer[key]=null},timeout))};ph.modelsManager={cleanup:function(modelId,params){cleanup(modelId,params)},handleError:function(model){var error=model.getError();if(error){var modelHandlers=errorHandlers[model.id];if(modelHandlers){var errorHandler=modelHandlers[error.name];errorHandler&&errorHandler(model)}}},cacheFor:cacheFor}}(),ph.views={},ns.View.define("app",{models:["region"],events:{"ns-view-init":"onInit"},shortcuts:{"?":{method:"showShortcuts",name:"shortcuts: show"}},methods:{onInit:function(){this._popups={}},showShortcuts:function(){var popup=this._getShortcutsPopup();popup&&popup.trigger("toggle",{where:document.body})},_getShortcutsPopup:function(){var pageName=ns.page.current.page;return pageName in this._popups||(this._popups[pageName]=this._createShortcutsPopup(pageName)),this._popups[pageName]},_createShortcutsPopup:function(pageName){var popupNode,shortcuts=ph.keyboard.getDefs();return 1===shortcuts.length?null:(popupNode=$(ns.renderNode({keys:shortcuts},"keyboard-shortcuts")).appendTo(document.body)[0],nb.block(popupNode,{show:function(){ph.metrika.count(["desktop web","interface elements","image viewer","show hotkeys help",ph.metrika.mode(),pageName])}}))}}},ph.View),function(){var Icon=(React.addons.classSet,React.createClass({displayName:"Icon",shouldComponentUpdate:function(){return!1},render:function(){return React.createElement("span",{className:"icon icon_"+this.props.alias,dangerouslySetInnerHTML:{__html:ph.icon(this.props.alias)}})}}));ph.R.Icon=Icon}(),function(){var cx=React.addons.classSet,Author=React.createClass({displayName:"Author",getInitialState:function(){return{isFollowed:this.props.isFollowed,isButtonDisabled:!1}},componentWillReceiveProps:function(nextProps){this.setState({isFollowed:nextProps.isFollowed})},handleFollowButtonClick:function(){this.disableButton(),this.toggle(),this.props.onFollow(this.followButtonCallback)},followButtonCallback:function(result){result&&result.restore&&this.toggle(),this.enableButton()},disableButton:function(){this.setState({isButtonDisabled:!0})},enableButton:function(){this.setState({isButtonDisabled:!1})},toggle:function(){this.state.isFollowed?this.unfollow():this.follow()},follow:function(){this.setState({isFollowed:!0})},unfollow:function(){this.setState({isFollowed:!1})},render:function(){var buttonClasses=cx({"small-pseudo-button":!0,"is-disabled":this.state.isButtonDisabled}),photoLink=React.createElement("span",{className:"lite-author-image-name"},React.createElement("a",{className:"lite-link",href:this.props.imageUrl,dangerouslySetInnerHTML:{__html:this.props.imageTitle},onClick:this.props.onPhotoTitleClick})),button=React.createElement("span",{className:"lite-author-button"},React.createElement("span",{className:buttonClasses,onClick:this.state.isButtonDisabled?null:this.handleFollowButtonClick},React.createElement("span",{className:"button-content"},this.state.isFollowed?"Отписаться":"Подписаться")));return React.createElement("div",{className:"lite-author"},this.props.imageUrl?photoLink:null,React.createElement("span",{className:"lite-author-group"},React.createElement("span",{className:"lite-author-name"},React.createElement("a",{className:"lite-link js-username",href:this.props.profileUrl,onClick:this.props.onUsernameClick},this.props.name)),this.props.isButtonVisible?button:null))}});ph.R.Author=Author}(),ns.View.define("not-found",{events:{"ns-view-show":function(){ns.page.go("/404.xml","replace")}}}),function(){var Icon=ph.R.Icon,Head=React.createClass({displayName:"Head",componentDidMount:function(){this.props.handleComponentDidMount&&this.props.handleComponentDidMount(this.getDOMNode())},handleClickLink:ph.metrika.countLink(function(evt){var linkTitle=evt.currentTarget.getAttribute("data-link");this.props.metrikaCounter([linkTitle])}),handleSubmit:function(evt){var delay=50,form=evt.target;this.props.metrikaCounter(["search"]),setTimeout(function(){form.submit()},delay),evt.preventDefault()},render:function(){var userpic={backgroundImage:"url("+this.props.userAvatarUrl+")"},authPopupMetrikaParams="['desktop web', 'interface elements', 'header', 'auth popup']",userAuth=React.createElement("div",{className:"user-wrap"},React.createElement("div",{className:"user-controls"},React.createElement("a",{className:"clear-button",href:this.props.links.userSettings,onClick:this.handleClickLink,"data-link":"settings",title:"Настройки"},React.createElement("span",{className:"button-content"},React.createElement(Icon,{alias:"gear"})))),React.createElement("a",{className:"user",href:this.props.links.userProfile,"data-nb":"popup-toggler","data-nb-popup-toggler":"{ id: 'user-controls-popup', where: '.js-user-pic', how: { where: 'right bottom', what: 'right top' } }"},React.createElement("span",{className:"user-pic js-user-pic",style:userpic}," "),React.createElement("span",{className:"user-name"},this.props.userName)),React.createElement("div",{className:"popup popup_to_bottom _hidden js-user-popup","data-nb":"islands-popup",id:"user-controls-popup"},React.createElement("div",{className:"popup-tail"}),React.createElement("div",{className:"grand-menu grand-menu_icons"},React.createElement("a",{className:"grand-menu-item","data-nb":"link-counter","data-nb-link-counter":authPopupMetrikaParams,"data-link":"read mail",href:this.props.links.mail},React.createElement(Icon,{alias:"letter"}),React.createElement("span",{className:"js-mail-counter"},"Моя Почта")),React.createElement("a",{className:"grand-menu-item","data-nb":"link-counter","data-nb-link-counter":authPopupMetrikaParams,"data-link":"write mail",href:this.props.links.mailCompose},"Написать письмо"),React.createElement("a",{className:"grand-menu-item","data-nb":"link-counter","data-nb-link-counter":authPopupMetrikaParams,"data-link":"my disk",href:this.props.links.disk},React.createElement(Icon,{alias:"ufo"}),"Мой Диск"),React.createElement("div",{className:"grand-menu-separator"}),React.createElement("a",{className:"grand-menu-item","data-nb":"link-counter","data-nb-link-counter":authPopupMetrikaParams,"data-link":"passport",href:this.props.links.passport},"Паспорт"),React.createElement("a",{className:"grand-menu-item","data-nb":"link-counter","data-nb-link-counter":authPopupMetrikaParams,"data-link":"sign out",href:this.props.links.passportSignOut},"Выйти")))),userNoAuth=React.createElement("div",{className:"user-wrap"},React.createElement("div",{className:"user-controls"},React.createElement("a",{className:"button-v3",onClick:this.handleClickLink,"data-link":"sign in",href:this.props.links.passportSignIn},React.createElement("span",{className:"button-content"},React.createElement(Icon,{alias:"door"}),"Войти"))));return React.createElement("div",{className:"head"},this.props.isAuthorized?userAuth:userNoAuth,React.createElement("a",{className:"logo-v3",onClick:this.handleClickLink,"data-link":"go to Yandex",href:this.props.links.yandex}),React.createElement("form",{className:"group",onSubmit:this.handleSubmit,action:this.props.links.search},React.createElement("a",{className:"service-arrow group-item",onClick:this.handleClickLink,"data-link":"go to Fotki",href:this.props.links.root},"Фотки"),React.createElement("label",{className:"field-v3 group-item"},React.createElement("span",{className:"field-v3-content"},React.createElement("input",{className:"input-controller",type:"text",name:"text",maxLength:"90",tabIndex:"1"}),React.createElement("span",{className:"input-view-v3"}," "))),React.createElement("button",{className:"button-v3 group-item",type:"send"},React.createElement("span",{className:"button-content"},"Найти"))),React.createElement("div",{className:"group group_favorites"},React.createElement("a",{className:"action-button-v3 action-button_upload",onClick:this.handleClickLink,"data-link":"upload",href:this.props.links.upload},React.createElement("span",{className:"button-content"},React.createElement(Icon,{alias:"upload"}),React.createElement("span",{className:"button-text"},"Загрузить"))),React.createElement("a",{className:"unlike-link link_my",onClick:this.handleClickLink,"data-link":"my photos",href:this.props.links.my},"Мои фотки"),React.createElement("a",{className:"unlike-link link_wall",onClick:this.handleClickLink,"data-link":"lenta",href:this.props.links.userFeed},"Лента")))}});ph.R.Head=Head}(),ns.View.define("head",{models:["auth"],events:{"ns-view-htmlinit":"initComponent"},methods:{refreshUnread:function(node){var that=this,popup=this._popup=nb.block($(".js-user-popup",node)[0],null,"islands-popup");if(popup){var $mailCounter=popup.$node.find(".js-mail-counter"),maxMsg=99,refreshThrottle=6e4,promise=ph.controllers.user.checkUnread();promise.then(function(context){var count=context.model.get(".counters.unread");count>maxMsg?(count=maxMsg+"+ ",$mailCounter.text(count+" новых писем")):$mailCounter.text(ph.utils.plural(Number(count),"Новых писем нет","$0 новое письмо","$0 новых письма","$0 новых писем"))}),promise.always(function(){setTimeout(that.refreshUnread.bind(that),refreshThrottle)})}},onComponentDidMount:function(node){var auth=this.getModel("auth");auth.get(".uid.value")&&(this._popup&&this._popup.destroy(),this.refreshUnread(node))},getComponentProps:function(){var auth=this.getModel("auth"),propsLinks={passport:ph.utils.generateUrl("passport"),passportSignIn:ph.utils.generateUrl("passport",{action:"signIn"}),passportSignOut:ph.utils.generateUrl("passport",{action:"signOut"}),userProfile:ph.utils.generateUrl("user-profile",{"author-login":auth.get(".photo-profile.user.login")}),userSettings:ph.utils.generateUrl("tunes"),userFeed:ph.utils.generateUrl("favorites"),my:ph.utils.generateUrl("my"),upload:ph.utils.generateUrl("upload"),search:ph.utils.generateUrl("search"),root:ph.utils.generateUrl("root"),yandex:ph.utils.generateUrl("yandex"),disk:ph.utils.generateUrl("disk"),mail:ph.utils.generateUrl("mail"),mailCompose:ph.utils.generateUrl("mailCompose")},props={isAuthorized:!!auth.get(".uid.value"),userAvatarUrl:ph.utils.getAvatarUrl(auth.get(".uid.value")),userName:auth.get(".photo-profile.user.displayName")||auth.get(".login"),links:propsLinks,handleComponentDidMount:this.onComponentDidMount.bind(this),metrikaCounter:this.metrikaCounter.bind(this)};return props},renderComponent:function(){return React.renderToString(this.getComponent())},initComponent:function(){React.render(this.getComponent(),this.node)},getComponent:function(){return React.createElement(ph.R.Head,this.getComponentProps())},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","header"])}}),ns.View.define("foot",{models:["ticket"],events:{"click .js-link":"countLink"},methods:{countLink:ph.metrika.countLink(function(evt){var linkTitle=$(evt.currentTarget).data("link");this.metrikaCounter([linkTitle])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","footer"])}}),ns.View.define("photo-author-common",{methods:{initComponent:function(){React.render(this.getComponent(),this.node)},renderComponent:function(){return React.renderToString(this.getComponent())},getComponent:function(){return React.createElement(ph.R.Author,this.getComponentProps())},getPhotoDetails:function(){ns.assert.fail("photo-author-common","method not implemented")},getProfileModel:function(){ns.assert.fail("photo-author-common","method not implemented")},getViewNameForMetrika:function(){ns.assert.fail("photo-author-common","method not implemented")},getComponentProps:function(){var auth=this.getModel("auth"),photoDetails=this.getPhotoDetails(),profile=this.getProfileModel(),viewerUid=auth.get(".uid.value"),isViewerNotAuthor=viewerUid!=photoDetails.uid,props={name:photoDetails.displayName,profileUrl:ph.utils.generateUrl("user-profile",{"author-login":photoDetails.login}),avatarUrl:ph.utils.getAvatarUrl(photoDetails.uid),imageUrl:photoDetails.title?photoDetails.url:null,imageTitle:photoDetails.title,isButtonVisible:isViewerNotAuthor,isFollowed:profile?profile.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer"):!1,onFollow:this.toggleFollow.bind(this)};return props},toggleFollow:function(callback){var auth=this.getModel("auth"),profile=this.getProfileModel();if(ph.noAuthRedirect(auth))return void this.metrikaCounter(["subscribe unauth",this.getViewNameForMetrika()]);var wasFollowing=profile.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer"),promise=ph.controllers.photo.toggleFollow(profile);null!=promise&&(promise.then(function(){callback()}),promise.fail(function(){callback({restore:!0})}),this.metrikaCounter([wasFollowing?"unsubscribe":"subscribe",this.getViewNameForMetrika()]))},countGoToAuthorPage:ph.metrika.countLink(function(){var authorUid=this.getProfileModel().get(".user.uid"),currentUserUid=this.getModel("auth").get(".uid.value"),isAuthor=currentUserUid==authorUid;this.metrikaCounter(["click on author name or avatar",this.getViewNameForMetrika(),isAuthor?"author":"others"])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","actions"])}},ph.View),function(){!function(){var Blur=React.createClass({displayName:"Blur",drawToCanvas:function(canvas){var blurSize=50,canvasImage=new Image;canvasImage.src=this.props.image;var canvasContext=canvas.getContext("2d"),canvasWidth=canvas.width,canvasHeight=canvas.height;canvasImage.onload=function(){canvasContext.drawImage(canvasImage,0,0,canvasWidth,canvasHeight),ph.stackBlur.CanvasRGB(canvas,0,0,canvasWidth,canvasHeight,blurSize)}},componentDidMount:function(){this.drawToCanvas(this.getDOMNode())},render:function(){return React.createElement("canvas",{className:"blur"})}});ph.R.Blur=Blur}();var cx=(React.addons.CSSTransitionGroup,React.addons.classSet),Blur=ph.R.Blur,Author=ph.R.Author,PhotoOfDayItem=React.createClass({displayName:"PhotoOfDayItem",getInitialState:function(){return{isVisible:this.props.isVisible,isCached:!1}},getDefaultProps:function(){return{orientation:"portrait",url:null,imageUrl:null,imageBlurUrl:null,isVisible:!1}},componentWillMount:function(){this.setState({isCached:this.props.isVisible})},componentWillReceiveProps:function(nextProps){var isCached=this.state.isCached;this.setState({isVisible:nextProps.isVisible,isCached:isCached||nextProps.isVisible})},render:function(){var photoWellImageClasses=cx({"photo-well-image":!0,"photo-well-image_pod":!0,"photo-well-image_portrait":"landscape"!==this.props.orientation,"photo-well-image_is-visible":this.state.isVisible}),imageStyle=this.state.isCached?{backgroundImage:"url("+this.props.imageUrl+")"}:null,blur=this.state.isCached?React.createElement(Blur,{image:this.props.imageBlurUrl}):null;return"landscape"===this.props.orientation?React.createElement("a",{onClick:this.props.onImageClick,href:this.props.url,className:photoWellImageClasses,style:imageStyle}):React.createElement("a",{onClick:this.props.onImageClick,href:this.props.url,className:photoWellImageClasses},blur,React.createElement("span",{className:"photo-well-image-inner js-image",style:imageStyle}))}}),PhotoOfDayItemFoot=React.createClass({displayName:"PhotoOfDayItemFoot",getInitialState:function(){return{isButtonVisible:!0,isFollowed:!1,onFollow:function(callback){callback({restore:!0})},isVisible:this.props.isVisible,forceUpdate:!1}},componentWillReceiveProps:function(nextProps){this.setState(nextProps)},shouldComponentUpdate:function(nextProps,nextState){return(nextState.forceUpdate&&nextState.isVisible||nextState.isVisible&&nextState.isVisible!==this.state.isVisible)&&this.updateAuthor(),!0},componentDidMount:function(){this.state.isVisible&&this.updateAuthor()},updateAuthor:function(){var that=this,uid=this.props.authorUid,login=this.props.authorLogin,promise=this.props.getAsyncProps({login:login,uid:uid});promise.then(function(props){that.setState(React.addons.update(props,{$merge:{forceUpdate:!1}}))})},render:function(){return this.state.isVisible?React.createElement("div",{className:"photo-well-foot"},React.createElement(Author,{name:this.props.authorName,profileUrl:this.props.profileUrl,imageTitle:this.props.imageTitle,imageUrl:this.props.imageTitle?this.props.url:null,isButtonVisible:this.state.isButtonVisible,isFollowed:this.state.isFollowed,onFollow:this.state.onFollow,onPhotoTitleClick:this.state.countOpenPhoto,onUsernameClick:this.state.countGoToAuthorPage})):null}}),PhotoOfDay=React.createClass({displayName:"PhotoOfDay",getDefaultProps:function(){return{podUrl:null,podVoteUrl:null,isPodVoteVisible:!1,items:[]}},getInitialState:function(){return{index:0,items:this.props.items,forceUpdate:!1}},componentWillReceiveProps:function(){this.setState({forceUpdate:!0})},handleRightClick:function(){var nextIndex=this.state.index+1,index=nextIndex>=this.props.items.length?0:nextIndex;this.setState({index:index,forceUpdate:!1}),this.props.countTurnRight()},handleLeftClick:function(){var nextIndex=this.state.index-1,index=0>nextIndex?this.props.items.length-1:nextIndex;this.setState({index:index,forceUpdate:!1}),this.props.countTurnLeft()},render:function(){var podVote=this.props.isPodVoteVisible?React.createElement("a",{onClick:this.props.countGoToPodVote,className:"light-pseudo-button",href:this.props.podVoteUrl},React.createElement("span",{className:"button-content"},"Выбираем сейчас")):null,podDate=this.state.index>0?React.createElement("span",null,", ",this.props.items[this.state.index].podDate):null,left=this.state.index>0?React.createElement("span",{onClick:this.handleLeftClick,className:"icon icon_arrow-left"}):null,right=this.state.index<this.props.items.length-1?React.createElement("span",{onClick:this.handleRightClick,className:"icon icon_arrow-right"}):null,itemsFoot=this.state.items.map(function(item,index){return React.createElement(PhotoOfDayItemFoot,React.__spread({key:item.imageUrl},item,{isVisible:this.state.index===index,forceUpdate:this.state.forceUpdate}))}.bind(this)),items=this.state.items.map(function(item,index){return React.createElement(PhotoOfDayItem,React.__spread({key:item.imageUrl},item,{isVisible:this.state.index===index,onImageClick:this.props.countOpenPhoto}))}.bind(this));return React.createElement("div",{className:"photo-well photo-well_overlap"},React.createElement("div",{className:"photo-well-head"},React.createElement("div",{className:"photo-well-title"},React.createElement("a",{onClick:this.props.countGoToHallOfFame,className:"lite-link",href:this.props.podUrl},"Фото дня",podDate),podVote)),itemsFoot,React.createElement("div",{className:"photo-well-animated-group photo-well-animated-group_pod"},items),left,right)}});ph.R.PhotoOfDay=PhotoOfDay}(),ns.View.define("pod",{params:function(){return{context:"calendar"}},models:ph.utils.nsViewModels({pod:{"ns-model-changed":"renderComponent"},"slider-context":{"ns-model-changed":"renderComponent","ns-model-insert":"renderComponent","ns-model-remove":"renderComponent"}}),events:{"ns-view-show":"renderComponent"},methods:{getItemProps:function(model){var modelData=model.getData(),dimensions={height:520,width:1500},size=ph.utils.getCoverSize(modelData,dimensions),orientation=no.jpath(".value.height",size)>no.jpath(".value.width",size)?"portrait":"landscape",imageUrl="landscape"===orientation?no.jpath(".value.url",size):no.jpath(".value.url",ph.utils.getClosestSize(modelData,dimensions)),authorLogin=model.get(".author.login"),imageId=model.get(".imageId"),imageBlurUrl=authorLogin?ph.utils.generateUrl("editor-photo",{"author-login":authorLogin,"image-id":imageId,size:"s"}):null,url=authorLogin?ph.utils.generateUrl("photo",{"author-login":authorLogin,"image-id":imageId,"album-id":model.get(".albumId"),mode:"view",context:"calendar"}):null,profileUrl=authorLogin?ph.utils.generateUrl("user-profile",{"author-login":authorLogin}):null;return{orientation:orientation,imageUrl:imageUrl,imageBlurUrl:imageBlurUrl,podDate:ph.utils.formatDate(model.get(".podDate"),"D MMMM"),url:url,imageTitle:model.get(".title"),authorName:model.get(".author.displayName"),authorLogin:model.get(".author.login"),authorUid:model.get(".author.uid"),profileUrl:profileUrl,getAsyncProps:this.getAsyncProps.bind(this)}},getComponentProps:function(){return{items:this.getModel("slider-context").models.map(this.getItemProps.bind(this)),podUrl:ph.utils.generateUrl("hall-of-fame"),podVoteUrl:ph.utils.generateUrl("podvote"),isPodVoteVisible:this.getModel("pod").get(".currentHour")>20,countOpenPhoto:this.countOpenPhoto.bind(this),countGoToHallOfFame:this.countGoToHallOfFame.bind(this),countGoToPodVote:this.countGoToPodVote.bind(this),countTurnLeft:this.countTurnLeft.bind(this),countTurnRight:this.countTurnRight.bind(this)}},getComponent:function(){return React.createElement(ph.R.PhotoOfDay,this.getComponentProps())},renderComponentHTML:function(){return React.renderToString(this.getComponent())},renderComponent:function(){this.isVisible()&&React.render(this.getComponent(),this.node)},getAsyncProps:function(params){var that=this,promise=new Vow.Promise,authModel=ns.Model.get("auth"),profileModel=ns.Model.get("profile",{"author-login":params.login}),generateProps=function(){return{isButtonVisible:authModel.get(".uid.value")!=params.uid,isFollowed:profileModel?profileModel.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer"):!1,onFollow:function(callback){if(ph.noAuthRedirect(authModel))return void that.metrikaCounterSubscribe(["subscribe unauth","landing pod"]);var wasFollowing=profileModel.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer"),promise=ph.controllers.photo.toggleFollow(profileModel);null!=promise&&(promise.then(function(){callback()}),promise.fail(function(){callback({restore:!0})}),that.metrikaCounterSubscribe([wasFollowing?"unsubscribe":"subscribe","landing pod"]))},countGoToAuthorPage:ph.metrika.countLink(function(){var authorUid=profileModel.get(".user.uid"),currentUserUid=authModel.get(".uid.value"),isAuthor=currentUserUid==authorUid;that.metrikaCounterSubscribe(["click on author name or avatar","landing pod",isAuthor?"author":"others"])}),countOpenPhoto:that.countOpenPhoto.bind(that)}};return ns.request.models([authModel,profileModel]).then(function(){promise.fulfill(generateProps())}),promise},countOpenPhoto:function(){this.metrikaCounter(["show pod"])},countTurnLeft:function(){this.metrikaCounter(["show next pod"])},countTurnRight:function(){this.metrikaCounter(["show prev pod"])},countGoToHallOfFame:ph.metrika.countLink(function(){this.metrikaCounter(["halloffame"])}),countGoToPodVote:ph.metrika.countLink(function(){this.metrikaCounter(["podvote"])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","main page","pod block"]),metrikaCounterSubscribe:ph.metrika.generateMetrikaCounter(["desktop web","actions"])}}),function(){var cx=(React.addons.CSSTransitionGroup,React.addons.classSet),Author=ph.R.Author,PopularTagsItem=React.createClass({displayName:"PopularTagsItem",getInitialState:function(){return{isVisible:this.props.isVisible,isCached:!1}
},getDefaultProps:function(){return{url:null,imageUrl:null,isVisible:!1}},componentWillMount:function(){this.setState({isCached:this.props.isVisible})},componentWillReceiveProps:function(nextProps){var isCached=this.state.isCached;this.setState({isVisible:nextProps.isVisible,isCached:isCached||nextProps.isVisible})},render:function(){var photoWellImageClasses=cx({"photo-well-image":!0,"photo-well-image_tag":!0,"photo-well-image_is-visible":this.state.isVisible}),imageStyle=this.state.isCached?{backgroundImage:"url("+this.props.imageUrl+")"}:null;return React.createElement("a",{onClick:this.props.onImageClick,href:this.props.url,className:photoWellImageClasses,style:imageStyle})}}),PopularTagsItemHead=React.createClass({displayName:"PopularTagsItemHead",getInitialState:function(){return{isVisible:this.props.isVisible}},componentWillReceiveProps:function(nextProps){this.setState(nextProps)},render:function(){return this.state.isVisible?React.createElement("div",{className:"photo-well-title"},React.createElement("a",{onClick:this.props.countGoToTag,className:"lite-link",href:this.props.tagUrl},"#",this.props.tagText)):null}}),PopularTagsItemFoot=React.createClass({displayName:"PopularTagsItemFoot",getInitialState:function(){return{isButtonVisible:!0,isFollowed:!1,onFollow:function(callback){callback({restore:!0})},isVisible:this.props.isVisible,forceUpdate:!1}},componentWillReceiveProps:function(nextProps){this.setState(nextProps)},shouldComponentUpdate:function(nextProps,nextState){return(nextState.forceUpdate&&nextState.isVisible||nextState.isVisible&&nextState.isVisible!==this.state.isVisible)&&this.updateAuthor(),!0},componentDidMount:function(){this.state.isVisible&&this.updateAuthor()},updateAuthor:function(){var that=this,uid=this.props.authorUid,login=this.props.authorLogin,promise=this.props.getAsyncProps({login:login,uid:uid});promise.then(function(props){that.setState(React.addons.update(props,{$merge:{forceUpdate:!1}}))})},render:function(){return this.state.isVisible?React.createElement("div",{className:"photo-well-foot"},React.createElement(Author,{name:this.props.authorName,profileUrl:this.props.profileUrl,imageTitle:this.props.imageTitle,imageUrl:this.props.imageTitle?this.props.url:null,isButtonVisible:this.state.isButtonVisible,isFollowed:this.state.isFollowed,onFollow:this.state.onFollow,onPhotoTitleClick:this.state.countOpenPhoto,onUsernameClick:this.state.countGoToAuthorPage})):null}}),PopularTags=React.createClass({displayName:"PopularTags",getDefaultProps:function(){return{tagUrl:null,items:[],forceUpdate:!1}},getInitialState:function(){return{currentItemIndex:0,items:this.props.items}},componentWillReceiveProps:function(){this.setState({forceUpdate:!0})},handleTagButtonClick:function(newIndex){"function"==typeof this.props.countSelectTag&&this.props.countSelectTag(),this.setState({currentItemIndex:newIndex})},render:function(){var itemsHead=this.state.items.map(function(item,index){return React.createElement(PopularTagsItemHead,React.__spread({key:item.imageUrl},item,{isVisible:this.state.currentItemIndex===index,forceUpdate:this.state.forceUpdate}))}.bind(this)),itemsFoot=this.state.items.map(function(item,index){return React.createElement(PopularTagsItemFoot,React.__spread({key:item.imageUrl},item,{isVisible:this.state.currentItemIndex===index,forceUpdate:this.state.forceUpdate}))}.bind(this)),items=this.state.items.map(function(item,index){return React.createElement(PopularTagsItem,React.__spread({key:item.imageUrl},item,{isVisible:this.state.currentItemIndex===index,onImageClick:this.props.countOpenPhoto}))}.bind(this)),currentItem=this.state.items[this.state.currentItemIndex],buttons=({backgroundImage:"url("+currentItem.imageUrl+")"},this.state.items.map(function(item,index){if(index>4)return null;var handleClick=function(){this.handleTagButtonClick(index)}.bind(this),buttonClasses=cx({"small-shaded-pseudo-button":!0,"is-checked":this.state.currentItemIndex===index});return React.createElement("div",{key:item.imageUrl,onClick:handleClick,className:buttonClasses},React.createElement("span",{className:"button-content"},item.tagText))}.bind(this))),buttonGroup=React.createElement("div",{className:"photo-well-title-sup photo-well-title-sup_bottom-gap"},React.createElement("div",{className:"group"},buttons));return React.createElement("div",{className:"photo-well"},React.createElement("div",{className:"photo-well-head"},buttonGroup,itemsHead),itemsFoot,React.createElement("div",{className:"photo-well-animated-group photo-well-animated-group_tag"},items))}});ph.R.PopularTags=PopularTags}(),ns.View.define("teaser",{params:{},models:ph.utils.nsViewModels({"popular-tags":{"ns-model-changed":"renderComponent"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"renderComponent"},methods:{onHtmlInit:function(){this._componentNode=$(".js-popular-tags",this.node)[0]},getAsyncProps:function(params){var that=this,promise=new Vow.Promise,authModel=ns.Model.get("auth"),profileModel=ns.Model.get("profile",{"author-login":params.login}),generateProps=function(){return{isButtonVisible:authModel.get(".uid.value")!=params.uid,isFollowed:profileModel?profileModel.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer"):!1,onFollow:function(callback){if(ph.noAuthRedirect(authModel))return void that.metrikaCounterSubscribe(["subscribe unauth","landing popular tag"]);var wasFollowing=profileModel.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer"),promise=ph.controllers.photo.toggleFollow(profileModel);null!=promise&&(promise.then(function(){callback()}),promise.fail(function(){callback({restore:!0})}),that.metrikaCounterSubscribe([wasFollowing?"unsubscribe":"subscribe","landing popular tag"]))},countGoToAuthorPage:ph.metrika.countLink(function(){var authorUid=profileModel.get(".user.uid"),currentUserUid=authModel.get(".uid.value"),isAuthor=currentUserUid==authorUid;that.metrikaCounterSubscribe(["click on author name or avatar","landing tag",isAuthor?"author":"others"])}),countOpenPhoto:that.countGoToPhoto.bind(that)}};return ns.request.models([authModel,profileModel]).then(function(){promise.fulfill(generateProps())}),promise},getItemProps:function(tagData){var dimensions={height:300,width:1504},imageData=no.jpath(".image",tagData),imageUrl=no.jpath(".value.url",ph.utils.getCoverSize(imageData,dimensions)),authorLogin=no.jpath(".author.login",imageData),imageId=no.jpath(".imageId",imageData),url=authorLogin?ph.utils.generateUrl("photo",{"author-login":authorLogin,"image-id":imageId,"album-id":no.jpath(".albumId",imageData),mode:"view",context:"search","search-text":no.jpath(".tagText",tagData),tags:1,type:"image",chastity:1}):null,profileUrl=authorLogin?ph.utils.generateUrl("user-profile",{"author-login":authorLogin}):null,tagText=no.jpath(".tagText",tagData),tagUrl=ph.utils.generateUrl("tag",{tag:tagText});return{imageUrl:imageUrl,url:url,tagUrl:tagUrl,tagText:tagText,imageTitle:no.jpath(".title",imageData),authorName:no.jpath(".author.displayName",imageData),authorLogin:authorLogin,authorUid:no.jpath(".author.uid",imageData),profileUrl:profileUrl,countGoToTag:this.countGoToTag.bind(this),getAsyncProps:this.getAsyncProps.bind(this)}},getComponentProps:function(){var tags=this.getModel("popular-tags").get(".tags.tag");return{items:tags.map(this.getItemProps.bind(this)),countOpenPhoto:this.countGoToPhoto.bind(this),countSelectTag:this.countSelectTag.bind(this)}},getComponent:function(){return React.createElement(ph.R.PopularTags,this.getComponentProps())},renderComponentHTML:function(){return React.renderToString(this.getComponent())},renderComponent:function(){this.isVisible()&&this._componentNode&&React.render(this.getComponent(),this._componentNode)},countGoToPhoto:function(){this.metrikaCounter(["show tag photo"])},countGoToTag:ph.metrika.countLink(function(){this.metrikaCounter(["go to tag search"])}),countSelectTag:function(){this.metrikaCounter(["select tag"])},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","main page","daily tag block"]),metrikaCounterSubscribe:ph.metrika.generateMetrikaCounter(["desktop web","actions"])}}),ns.View.define("teaser-banner",{params:{},models:ph.utils.nsViewModels({photoguide:{"ns-model-changed":"keepValid"},"popular-tags":{"ns-model-changed":"keepValid"},preferences:{"ns-model-changed":{'.preferences.preference.[.name == "hide-ads"]':"invalidate"}}}),events:{"ns-view-htmlinit":"onHtmlInit"},methods:{onHtmlInit:function(){this.getModel("photoguide").get(".enabled")?this._renderPhotoGuideBanner().then(this._showPhotoGuideBannerTitle.bind(this)).fail(this._renderNormalBanner.bind(this)):this._renderNormalBanner()},_renderPhotoGuideBanner:function(){var promise=new Vow.Promise;return ph.loadModule("awaps").then(function(awaps){awaps.render("yandex_rtb_R-I-94178-8",22174,300,300,function(has_banner){has_banner?promise.fulfill():promise.reject()})}),promise},_renderNormalBanner:function(){this.getModel("preferences").isSet("hide-ads")||ph.loadModule("ads").then(function(){Ya.Context.AdvManager.render({blockId:"R-I-94178-8",renderTo:"yandex_rtb_R-I-94178-8",async:!0})})},_showPhotoGuideBannerTitle:function(){this.$node.find(".js-photo-guide-title").removeClass("is-hidden")}}}),function(){ph.R.Contest={},function(){var cx=React.addons.classSet,Icon=ph.R.Icon,ContestOverlay=React.createClass({displayName:"ContestOverlay",getInitialState:function(){return{disabled:!!this.props.disabled}},toggle:function(enable){this.setState({disabled:!enable})},handleMessageClick:function(){this.props.onMessageClick&&!this.state.disabled&&(this.props.onMessageClick(),this.toggle(!1))},handleLike:function(){this.props.onLike&&!this.state.disabled&&(this.props.onLike(),this.toggle(!1))},handleSkip:function(){this.props.onSkip&&!this.state.disabled&&(this.props.onSkip(),this.toggle(!1))},componentWillReceiveProps:function(nextProps){this.toggle(!nextProps.disabled)},shouldComponentUpdate:function(nextProps,nextState){return this.state.disabled!==nextState.disabled},componentDidMount:function(){"voting-photo-empty"===this.props.status&&this.props.forceCount&&this.props.countShowAllVoted()},componentDidUpdate:function(){"voting-photo-empty"===this.props.status&&this.props.forceCount&&this.props.countShowAllVoted()},render:function(){switch(this.props.status){case"voting-started":var buttonClasses=cx({"pseudo-button":!0,"is-inactive":this.state.disabled});return React.createElement("div",{className:"photo-well-overlay"},React.createElement("button",{className:buttonClasses,onClick:this.handleLike},React.createElement("span",{className:"button-content"},React.createElement(Icon,{alias:"thumb-up"}),"Нравится")),React.createElement("button",{className:buttonClasses,onClick:this.handleSkip},React.createElement("span",{className:"button-content"},"Не нравится")));case"voting-photo-empty":return React.createElement("div",{className:"photo-well-overlay"},React.createElement("div",{className:"photo-well-message",onClick:this.handleMessageClick},"Вы оценили все конкурсные фотографии"));case"upload-started":return React.createElement("div",{className:"photo-well-overlay"},React.createElement("div",{className:"photo-well-message",onClick:this.handleMessageClick},"Идёт приём фото на конкурс"));default:return React.createElement("div",{className:"photo-well-overlay"},React.createElement("div",{className:"photo-well-message",onClick:this.handleMessageClick},"Приём фото на конкурс завершён"))}}});ph.R.ContestOverlay=ContestOverlay}();var cx=(React.addons.CSSTransitionGroup,React.addons.classSet),Blur=ph.R.Blur,Overlay=ph.R.ContestOverlay,ContestImage=React.createClass({displayName:"ContestImage",getDefaultProps:function(){},render:function(){var imageClasses=cx({"photo-well-image":!0,"photo-well-image_contest":!0,"photo-well-image_is-visible":this.props.visible}),blur=React.createElement(Blur,{image:this.props.blurImageUrl}),imageKey=this.props.imageUrl||this.props.blurImageUrl,imageStyle={backgroundImage:"url('"+this.props.imageUrl+"')",cursor:this.props.imageUrl?"pointer":null},image=this.props.imageUrl?React.createElement("div",{className:"photo-well-image-inner",style:imageStyle}):null;return React.createElement("div",{className:imageClasses,onClick:this.props.onImageClick,key:imageKey},blur,image)}}),ContestInfo=React.createClass({displayName:"ContestInfo",shouldComponentUpdate:function(){return!1},render:function(){return React.createElement("div",{className:"photo-well-body"},React.createElement("div",{className:"contest-header"},"Конкурс"),React.createElement("div",{className:"contest-name"},React.createElement("a",{className:"lite-link",onClick:this.props.onContestTitleClick,href:this.props.contestUrl},this.props.contestName)),React.createElement("div",{className:"contest-line"},"Приём фотографий с ",this.props.contestStartDate," по ",this.props.uploadFinishDate,". Голосование — до ",this.props.votingFinishDate,"."),React.createElement("div",{className:"contest-line"},"Тема: ",this.props.contestSubject),React.createElement("div",{className:"contest-line"},"Жанр: ",this.props.contestGenre),React.createElement("div",{className:"contest-footer"},React.createElement("a",{className:"huge-light-pseudo-button",onClick:this.props.onContestTakePartClick,href:this.props.contestUrl},React.createElement("span",{className:"button-content"},"Участвовать"))))}}),Contest=React.createClass({displayName:"Contest",getInitialState:function(){return{inited:!1,loaded:!1,items:[{author:this.props.author,blur:this.props.blur,imageUrl:this.props.imageUrl,imageWidth:this.props.imageWidth,imageHeight:this.props.imageHeight}]}},handleMessageClick:function(){this.setState({loaded:!1}),this.props.overlay.onMessageClick()},handleLikeClick:function(){this.props.overlay.onLike&&(this.setState({loaded:!1}),this.props.overlay.onLike())},handleSkipClick:function(){this.props.overlay.onSkip&&(this.setState({loaded:!1}),this.props.overlay.onSkip())},loadImage:function(props){var that=this;that.load(props.imageUrl,function(){that.load(props.blur.imageUrl,function(){that.setState({loaded:!0})})})},load:function(src,callback){var img=new Image;img.onload=callback,img.src=src},componentWillReceiveProps:function(nextProps){var isUnmodified=this.props.imageUrl===nextProps.imageUrl,items=this.state.items;items.unshift({author:nextProps.author,blur:nextProps.blur,imageUrl:nextProps.imageUrl,imageWidth:nextProps.imageWidth,imageHeight:nextProps.imageHeight}),this.setState({loaded:isUnmodified,items:items}),this.loadImage(nextProps)},shouldComponentUpdate:function(nextProps,nextState){return this.state.loaded!==nextState.loaded},componentDidMount:function(){this.setState({inited:!0}),this.props.imageUrl?this.loadImage(this.props):this.setState({loaded:!0})},render:function(){var animationClasses=cx({"photo-well-animated-group":!0,"photo-well-animated-group_contest":!0}),loader=this.state.loaded?null:React.createElement("div",{className:"spinner-yellow spinner-yellow_size_xl spinner-centered spinner-inverted"},React.createElement("div",{className:"spinner-yellow-circle"})),currentItem=this.state.items[0],prevItem=this.state.items[1],images=prevItem?[React.createElement(ContestImage,{key:currentItem.imageUrl,blurImageUrl:currentItem.blur.imageUrl,imageUrl:currentItem.imageUrl,onImageClick:this.props.onImageClick,visible:!0}),React.createElement(ContestImage,{key:prevItem.imageUrl,blurImageUrl:prevItem.blur.imageUrl,imageUrl:prevItem.imageUrl,onImageClick:this.props.onImageClick,visible:!1})]:[React.createElement(ContestImage,{key:currentItem.imageUrl,blurImageUrl:currentItem.blur.imageUrl,imageUrl:currentItem.imageUrl,onImageClick:this.props.onImageClick,visible:!0})],overlay=this.state.inited?React.createElement(Overlay,{status:this.props.overlay.status,onLike:this.handleLikeClick,onSkip:this.handleSkipClick,countShowAllVoted:this.props.overlay.countShowAllVoted,forceCount:this.props.overlay.forceCount,disabled:!this.state.loaded}):null,aside=currentItem.author.name&&this.state.inited?React.createElement("div",{className:"photo-well-aside"},React.createElement("div",{className:"photo-well-aside-row"},React.createElement("a",{className:"lite-link",onClick:currentItem.author.onPhotoTitleClick,href:currentItem.author.imageUrl},currentItem.author.imageTitle)),React.createElement("div",{className:"photo-well-aside-row"},React.createElement("span",{className:"photo-well-aside-row-name"},"Автор: "),React.createElement("a",{className:"lite-link",onClick:currentItem.author.onUsernameClick,href:currentItem.author.profileUrl},currentItem.author.name))):null,head=currentItem.imageUrl?React.createElement("div",{className:"photo-well-head"},React.createElement("div",{className:"photo-well-title-sup"},React.createElement("span",{className:"photo-well-text"},"Конкурс")),React.createElement("div",{className:"photo-well-title"},React.createElement("a",{className:"lite-link",onClick:this.props.onContestTitleClick,href:this.props.contestUrl},this.props.contestName))):null,info=currentItem.imageUrl?null:React.createElement(ContestInfo,React.__spread({},this.props));return React.createElement("div",{className:"photo-well photo-well_contest"},head,info,aside,overlay,React.createElement("div",{className:animationClasses},this.state.inited?images:null),loader)}});ph.R.Contest.Block=Contest}(),ns.View.define("contest",{models:ph.utils.nsViewModels({ticket:{"ns-model-changed":"invalidate"},auth:{"ns-model-changed":"keepValid"},"contests-settings":{"ns-model-changed":"keepValid"},contest:{"ns-model-changed":"onContestModelChange"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"renderComponent"},methods:{onHtmlInit:function(){this.getModel("contest").getError()&&this.triggerEmptyContestEvent()},onShow:function(){this.renderComponent()},getComponentProps:function(){var that=this,imageAuthorLogin=this._models.photo.get(".author.login"),authorProps={name:this._models.photo.get(".author.displayName"),profileUrl:ph.utils.generateUrl("user-profile",{"author-login":imageAuthorLogin}),avatarUrl:ph.utils.getAvatarUrl(this._models.photo.get(".author.uid")),imageTitle:this._models.photo.get(".title")||this._models.photo.get(".fileName"),imageUrl:ph.utils.generateUrl("photo",{mode:"view","image-id":this._models.photo.get(".imageId"),"author-login":this._models.photo.get(".author.login"),"album-id":this._models.photo.get(".albumId")}),onUsernameClick:this.countGoToAuthorPage.bind(this),onPhotoTitleClick:this.countPhotoTitleClick.bind(this)},overlayProps={status:this._status,onSkip:function(){that.vote()},onLike:function(){that.vote(!0)},onMessageClick:this.updateContest.bind(this),countShowAllVoted:this.countShowAllVoted.bind(this),forceCount:this._forceCount},closestSize=ph.utils.getClosestSize(this._models.photo.getData(),{width:1504,height:600}),imageId=this._models.photo.get(".imageId"),blurProps={imageUrl:ph.utils.generateUrl("editor-photo",{"author-login":imageAuthorLogin,"image-id":imageId,size:"s"})},componentProps={author:authorProps,overlay:overlayProps,blur:blurProps,contestName:this._models.contest.get(".name"),contestUrl:ph.utils.getOldFotkiContextUrl({context:"contest","contest-id":this._models.contest.get(".contestId")}),imageUrl:no.jpath(".value.url",closestSize),imageWidth:no.jpath(".value.width",closestSize),imageHeight:no.jpath(".value.height",closestSize),onImageClick:this.openViewer.bind(this),onContestTitleClick:this.countContestTitleClick.bind(this)};return this._forceCount=!1,componentProps},openViewer:function(){var layout="contest-vote",params={"contest-id":this.getModel("contest").get(".contestId")};"voting-started"!==this._status?(layout="photo",params=no.extend({},params,{context:"contest",mode:"view","image-id":this._models.photo.get(".imageId"),"author-login":this._models.photo.get(".author.login"),"album-id":this._models.photo.get(".albumId")}),this.metrikaCounter(["show viewer"])):this.metrikaCounter(["show contest viewer"]);var url=ph.utils.generateUrl(layout,params);ns.page.go(url)},updateContest:function(){var that=this,promise=ns.request.models([this.getModel("contest")],{forced:!0});promise.fail(function(){that.renderComponent()})},onContestModelChange:function(){this.keepValid(),this.renderComponent()},renderComponent:function(){if(this._models={},this._models.contest=this.getModel("contest"),this.isVisible()&&this._models.contest&&this._models.contest.get(".contestId")){this._models.photo=this._models.contest.getInnerModel("contest-photo"),this._models.profile=this._models.contest.getInnerModel("contest-photo-profile"),this._status=this._models.contest.get(".state");var votingPhoto=this._models.contest.getInnerModel("vote-photo"),isVotingPhotoNotEmpty=!!votingPhoto&&!!votingPhoto.get(".imageId");"voting-started"===this._status&&(isVotingPhotoNotEmpty?(this._models.photo=this._models.contest.getInnerModel("vote-photo"),this._models.profile=this._models.contest.getInnerModel("vote-photo-profile")):this._status="voting-photo-empty");var componentProps;componentProps=this._models.photo&&this._models.profile?this.getComponentProps():this.getComponentPropsDummy(),React.render(React.createElement(ph.R.Contest.Block,componentProps),this.node)}},getComponentPropsDummy:function(){var randomPod=this._models.contest.getInnerModel("random-pod"),acceptPhotoStartDate=this._models.contest.get(".startDate"),acceptPhotoEndDate=this._models.contest.get(".votingStartDate"),componentProps={author:{},overlay:{status:this._status},blur:{imageUrl:ph.utils.generateUrl("editor-photo",{"author-login":randomPod.get(".author.login"),"image-id":randomPod.get(".imageId"),size:"s"})},contestName:this._models.contest.get(".name"),contestUrl:ph.utils.getOldFotkiContextUrl({context:"contest","contest-id":this._models.contest.get(".contestId")}),contestSubject:this._models.contest.get(".subject"),contestGenre:this._models.contest.get(".genre"),contestStartDate:moment(acceptPhotoStartDate).format(moment(acceptPhotoStartDate).format("MMMM")==moment(acceptPhotoEndDate).format("MMMM")?"D":"D MMMM"),uploadFinishDate:moment(acceptPhotoEndDate).format("D MMMM"),votingFinishDate:moment(this._models.contest.get(".votingFinishDate")).format("D MMMM"),onContestTitleClick:this.countContestTitleClick.bind(this),onContestTakePartClick:this.countContestTakePartClick.bind(this)};return componentProps},vote:function(like){if(this.metrikaCounter(["vote","from landing",like?"thumbsup":"skip"]),!ph.noAuthRedirect(this.getModel("auth"))){var that=this,promise=ph.controllers.photo.vote(like,this.getModel("contest"));null!=promise&&(promise.then(function(){that._forceCount=!0,that.updateContest();var authModel=that.getModel("auth");authModel.isValid()||ns.request.models([authModel],{forced:!0})}),promise.fail(function(){that.renderComponent()}))}},triggerEmptyContestEvent:function(){ns.events.trigger("ph-view-contest-empty")},countGoToAuthorPage:ph.metrika.countLink(function(){var authorUid=this._models.profile.get(".user.uid"),currentUserUid=this.getModel("auth").get(".uid.value"),isAuthor=currentUserUid==authorUid;this.metrikaCounterActions(["click on author name or avatar","landing contest",isAuthor?"author":"others"])}),countShowAllVoted:function(){this.metrikaCounter(["show all voted"])},countContestTitleClick:ph.metrika.countLink(function(){this.metrikaCounter(["go to contest"])}),countContestTakePartClick:ph.metrika.countLink(function(){this.metrikaCounter(["take part in contest"])}),countPhotoTitleClick:function(){this.metrikaCounter(["show viewer photo title"])},metrikaCounterActions:ph.metrika.generateMetrikaCounter(["desktop web","actions"]),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","main page","contest block"])}},ph.View),function(){var cx=React.addons.classSet,Icon=ph.R.Icon,StreamHead=React.createClass({displayName:"StreamHead",getInitialState:function(){return{gridTop:0,gridBottom:0,mode:"static"}},componentWillReceiveProps:function(nextProps){var that=this;this.props.windowWidth!==nextProps.windowWidth||this.props.isLoadingMore!==nextProps.isLoadingMore||nextProps.forceUpdateOffset?this.cacheBoundaries(function(){that.stickHeaderIfNeeded(nextProps.scrollTop)}):this.stickHeaderIfNeeded(nextProps.scrollTop)},componentDidMount:function(){var that=this;this.prepareToStick(),this.cacheBoundaries(function(){that.stickHeaderIfNeeded(that.props.scrollTop)})},prepareToStick:function(){var $headNode=$(this.getDOMNode()),$innerNode=$(this.getDOMNode()).children(".stream-head-inner");$headNode.css({height:$innerNode.outerHeight()})},stickHeaderIfNeeded:function(scrollTop){var that=this;this.state.gridBottom<scrollTop&&"fixed"===this.state.mode?this.cacheBoundaries(function(){that.setMode(scrollTop)}):this.setMode(scrollTop)},setMode:function(scrollTop){var mode;mode=this.state.gridTop<scrollTop&&this.state.gridBottom>=scrollTop?"fixed":"static",this.setState({mode:mode})},cacheBoundaries:function(callback){var boundaries=this.getBoundaries();this.setState({gridTop:boundaries.gridTop,gridBottom:boundaries.gridBottom},function(){"function"==typeof callback&&callback()})},getBoundaries:function(){var $grid=$(this.getDOMNode()).siblings(".stream-grid"),top=$grid.offset().top;return{gridTop:top,gridBottom:top+$grid.outerHeight()-64}},renderTab:function(context,title){var isCurrent=context===this.props.context;return isCurrent?React.createElement("span",{className:"stream-head-tab stream-head-tab-current"},title):React.createElement("span",{className:"stream-head-tab"},React.createElement("a",{className:"unlike-link",onClick:"popular"===context?this.handlePopularClick:this.handleRecentClick},title))},handleRecentClick:function(evt){this.handleClick("recent"),evt.stopPropagation()},handlePopularClick:function(evt){this.handleClick("popular"),evt.stopPropagation()},handleHeadClick:function(){this.handleClick("head")},handleClick:function(type){if("function"==typeof this.props.onHeadClick){var scrollToStreamHead="fixed"===this.state.mode;this.props.onHeadClick(type,scrollToStreamHead)}},render:function(){var headClasses=cx({"stream-head":!0,"stream-head_sticky-small":"fixed"===this.state.mode});return React.createElement("div",{className:headClasses},React.createElement("div",{className:"stream-head-inner",onClick:this.handleHeadClick},React.createElement("div",{className:"stream-head-aside"},React.createElement("a",{className:"unlike-link_faded js-stream-on-map",onClick:this.props.onMapClick,href:ph.utils.generateUrl("map")},React.createElement(Icon,{alias:"pin"}),"На карте")),React.createElement("div",{className:"stream-head-content"},this.renderTab("recent","Новые"),this.renderTab("popular","Популярные"),React.createElement("a",{className:"huge-pseudo-button js-stream-vote",onClick:this.props.onPopularVoteClick,href:ph.utils.generateUrl("vote-start")},React.createElement("span",{className:"button-content"},"Голосовать")))))}}),StreamItem=React.createClass({displayName:"StreamItem",propTypes:{context:React.PropTypes.oneOf(["recent","popular"])},getInitialState:function(){return{imgIsInserted:!1,imgUrl:this.props.item.get(".sizes.l.url"),top:0,bottom:0}},shouldComponentUpdate:function(nextProps,nextState){return this.state.imgIsInserted!==nextState.imgIsInserted},componentWillReceiveProps:function(nextProps){var insertImgIfNeeded=this.insertImgIfNeeded;this.props.windowWidth!==nextProps.windowWidth||nextProps.forceUpdateOffset?this.cacheBoundaries(function(){insertImgIfNeeded(nextProps.scrollTop,nextProps.windowHeight)}):insertImgIfNeeded(nextProps.scrollTop,nextProps.windowHeight)},componentDidMount:function(){var that=this;this.cacheBoundaries(function(){that.insertImgIfNeeded(that.props.scrollTop,that.props.windowHeight)})},insertImgIfNeeded:function(scrollTop,windowHeight){var that=this;if(!this.state.imgIsInserted){var getPosition=function(index,endPosition){var number=index+1,position=number-Math.floor(number/endPosition)*endPosition;return position||endPosition},setStateInFrame=function(frameNumber){var remainingFrames=frameNumber;remainingFrames>0&&requestAnimationFrame(function(){1===remainingFrames&&that.setState({imgIsInserted:!0}),remainingFrames--,setStateInFrame(remainingFrames)})},windowBottom=scrollTop+windowHeight;windowBottom>this.state.top&&this.state.bottom>scrollTop&&setStateInFrame(3*getPosition(this.props.index,8))}},cacheBoundaries:function(callback){var boundaries=this.getBoundaries();this.setState({top:boundaries.top,bottom:boundaries.bottom},function(){"function"==typeof callback&&callback()})},getBoundaries:function(){var $node=$(this.getDOMNode()).children(".stream-image-wrap"),top=$node.offset().top,bottom=top+$node.height();return{top:top,bottom:bottom}},render:function(){var imageClasses=cx({"stream-image":!0,"is-loaded":this.state.imgIsInserted}),imageStyle={};this.state.imgIsInserted&&(imageStyle={backgroundImage:"url("+this.state.imgUrl+")"});var context=this.props.context,imageUrlParams={mode:"view","author-login":this.props.item.params["author-login"],"image-id":this.props.item.params["image-id"],"album-id":this.props.item.get(".albumId"),context:context},authorUrlParams={"author-login":this.props.item.params["author-login"]};return React.createElement("div",{className:"stream-grid-item"},React.createElement("div",{className:"stream-image-wrap"},React.createElement("a",{className:imageClasses,onClick:"popular"===context?this.props.onPopularPhotoClick:this.props.onRecentPhotoClick,href:ph.utils.generateUrl("photo",imageUrlParams),style:imageStyle}),React.createElement("span",{className:"stream-image-overlay"},React.createElement("a",{className:"lite-link",onClick:"popular"===context?this.props.onPopularPhotoAuthorClick:this.props.onRecentPhotoAuthorClick,href:ph.utils.generateUrl("user-profile",authorUrlParams)},this.props.item.get(".author.displayName")))))}}),Stream=React.createClass({displayName:"Stream",getInitialState:function(){return{isLoadingMore:!1}},loadMore:function(){var that=this;this.setState({isLoadingMore:!0}),this.props.loadMore().then(function(){that.setState({isLoadingMore:!1})})},render:function(){var that=this,loadMore=null;if(this.props.showLoadMore){var loadMoreButtonClasses=cx({"huge-pseudo-button":!0,"is-disabled":this.state.isLoadingMore,"progress-button_progress":this.state.isLoadingMore});loadMore=React.createElement("div",{className:"stream-foot"},React.createElement("div",{className:loadMoreButtonClasses,onClick:this.loadMore},React.createElement("span",{className:"button-content"},"Показать ещё фото")))}var grid=null;if(this.props.async){grid=[];for(var i=0;40>i;i++)grid.push(React.createElement("div",{className:"stream-grid-item",key:"fake-grid-item.async."+i},React.createElement("div",{className:"stream-image-wrap"})))}else grid=this.props.items.map(function(item,index){return item.get(".fake")?React.createElement("div",{className:"stream-grid-item",key:"fake-grid-item."+item.params["image-id"]},React.createElement("div",{className:"stream-image-wrap"})):React.createElement(StreamItem,{key:item.key,item:item,index:index,context:that.props.context,scrollTop:that.props.scrollTop,windowHeight:that.props.windowSize.height,windowWidth:that.props.windowSize.width,forceUpdateOffset:that.props.forceUpdateOffset,onPopularPhotoClick:that.props.onPopularPhotoClick,onRecentPhotoClick:that.props.onRecentPhotoClick,onPopularPhotoAuthorClick:that.props.onPopularPhotoAuthorClick,onRecentPhotoAuthorClick:that.props.onRecentPhotoAuthorClick})});return React.createElement("div",{className:"stream"},React.createElement(StreamHead,{context:this.props.context,scrollTop:that.props.scrollTop,windowWidth:that.props.windowSize.width,isLoadingMore:that.state.isLoadingMore,forceUpdateOffset:that.props.forceUpdateOffset,onHeadClick:this.props.onHeadClick,onPopularVoteClick:this.props.onPopularVoteClick,onMapClick:this.props.onMapClick}),React.createElement("div",{className:"stream-grid"},grid),loadMore)}});ph.R.Stream=Stream}(),ns.View.define("stream",{params:{context:null},models:ph.utils.nsViewModels({"slider-context":{"ns-model-changed":"renderComponent","ns-model-insert":"renderComponent","ns-model-remove":"renderComponent"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","ph-scroll@show":"onScroll","ph-resize@show":"onResize","ph-view-contest-empty":"onViewContestEmpty"},methods:{onHtmlInit:function(){this._resetScrollState(),this.renderComponent()
},getCachedScrollTop:function(){return this._scrollTop||0},getCachedWindowSize:function(){return this._windowSize||{width:0,height:0}},getScrollTop:function(){return $(document).scrollTop()},getWindowSize:function(){return{width:$(window).width(),height:$(window).height()}},onScroll:function(){this._scrollTop=this.getScrollTop(),this.renderComponent()},onResize:function(){this._windowSize=this.getWindowSize()},onViewContestEmpty:function(){var that=this;this._updateOffset=!0,this.renderComponent().then(function(){that._updateOffset=!1})},isUpdateOffsetNeeded:function(){return this._updateOffset||!1},beforeUpdateHTML:function(){return this.isValid()||React.unmountComponentAtNode(this.node),ns.View.prototype.beforeUpdateHTML.apply(this,arguments)},onShow:function(){this._scrollTop=this.getScrollTop(),this._windowSize=this.getWindowSize(),this._doInitialScroll(),this.renderComponent(!0).then(function(){ns.events.trigger("ph-restore-scroll")})},loadMore:function(){var modelStream=this.getModel("slider-context"),page=modelStream.get(".paging.page"),contextMetrikaName="popular"===this.params.context?"top":"fresh";this.metrikaCounter(["show me more",contextMetrikaName,page+1]);var promise=modelStream.requestPage(page);return promise.then(this.triggerLoadedMore),promise},triggerLoadedMore:function(){ns.events.trigger("ph-view-stream-loaded-more")},getComponent:function(forAsyncRender){return React.createElement(ph.R.Stream,this.getComponentProps(forAsyncRender))},renderComponentHTML:function(mode){var forAsyncRender="async"===mode;return React.renderToString(this.getComponent(forAsyncRender))},renderComponent:function(forced){if(!this.isVisible()&&!forced)return null;var promise=new Vow.Promise;return React.render(this.getComponent(),this.node,function(){promise.fulfill()}),promise},getComponentProps:function(forAsyncRender){return{async:forAsyncRender,loadMore:this.loadMore.bind(this),showLoadMore:this.getModel("slider-context").hasMore(),items:this.getModel("slider-context").models,context:this.params.context,scrollTop:this.getCachedScrollTop(),windowSize:this.getCachedWindowSize(),forceUpdateOffset:this.isUpdateOffsetNeeded(),onPopularVoteClick:this.countPopularVote.bind(this),onMapClick:this.countMap.bind(this),onHeadClick:this.onStreamHeadClick.bind(this),onPopularPhotoClick:this.countPopularPhotoShow.bind(this),onRecentPhotoClick:this.countRecentPhotoShow.bind(this),onPopularPhotoAuthorClick:this.countPopularPhotoAuthorShow.bind(this),onRecentPhotoAuthorClick:this.countRecentPhotoAuthorShow.bind(this)}},onStreamHeadClick:function(type,scroll){var that=this;scroll?this._doScroll(function(){that.switchContext(type)}):this.switchContext(type)},switchContext:function(type){switch(type){case"popular":ns.page.go(ph.utils.generateUrl("index",{context:type})),this.countPopular();break;case"recent":ns.page.go(ph.utils.generateUrl("index",{context:type})),this.countRecent();break;case"head":this.countHeadClick()}},countPopularVote:ph.metrika.countLink(function(){this.metrikaCounter(["choose top"])}),countMap:ph.metrika.countLink(function(){this.metrikaCounter(["show map"])}),countPopular:function(){this.metrikaCounter(["show top photostream"])},countRecent:function(){this.metrikaCounter(["show fresh photostream"])},countHeadClick:function(){this.metrikaCounter(["photostream head click"])},countPopularPhotoShow:function(){this.metrikaCounter(["photostream","show photo","from top"])},countRecentPhotoShow:function(){this.metrikaCounter(["photostream","show photo","from fresh"])},countPopularPhotoAuthorShow:function(){this.metrikaCounter(["photostream","show photo author","from top"])},countRecentPhotoAuthorShow:function(){this.metrikaCounter(["photostream","show photo author","from fresh"])},_resetScrollState:function(){this.initialScrollDone=!1},_doInitialScroll:function(){var needScroll="stream"===ns.page.current.params.focus;this.initialScrollDone||(this.initialScrollDone=!0,needScroll&&this._doScroll())},_doScroll:function(callback){var that=this,gap=20;setTimeout(function(){$("html, body").animate({scrollTop:that.$node.offset().top+gap},500,function(){callback&&callback()})},100)},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","main page"])}}),function(){ns.View.define("ads-direct",{params:{},events:{"ns-view-htmlinit":"onHtmlInit","ph-view-stream-loaded-more@show":"onStreamLoadedMore"},models:ph.utils.nsViewModels({preferences:{"ns-model-changed":{'.preferences.preference.[.name == "hide-ads"]':"invalidate"}}}),methods:{onHtmlInit:function(){this.reloadAds()},reloadAds:function(){var isAdsDisabledByUser=this.models.preferences.isSet("hide-ads");isAdsDisabledByUser||ph.loadModule("ads").then(function(){Ya.Context.AdvManager.render({blockId:"D-I-94178-9",renderTo:"yandex_direct_D-I-94178-9",async:!0})})},onStreamLoadedMore:function(){this.reloadAds()}}})}(),ns.View.define("bar",{params:[{mode:null},{}]}),ns.View.define("tray",{params:{mode:null},events:{"ns-view-htmlinit":"onHtmlInit","ph-multiple-photo-album@show":"enableTray","ph-single-photo-album@show":"disableTray"},methods:{onHtmlInit:function(){this._classes={show:"tray_visible",hide:"tray_hidden"},this.disabled=!0},enableTray:function(){this.$node.removeClass(this._classes.hide),this.disabled=!1},disableTray:function(){this.$node.addClass(this._classes.hide),this.disabled=!0}}}),ns.View.define("tray-container",{}),function(){var key=function(params){return ns.Model.key("photo",params)},SliderItem=React.createClass({displayName:"SliderItem",handleClick:function(){var photoParams=this.props.photoParams,params=no.extend({},ns.page.current.params,{"author-login":photoParams["author-login"],"album-id":photoParams["album-id"],"image-id":photoParams["image-id"],page:photoParams.page});ns.page.go(ph.utils.generateUrl("photo",params),ph.fullscreen.isFullscreen()?"preserve":!1),this.props.metrikaCounter(["click on preview",ph.metrika.mode()])},render:function(){var photo=this.props.photo,className="slider-item",imageStyle={};return this.props.more.isBlocked?className+=" slider-item_restricted":this.props.more.is18plus?className+=" slider-item_18plus":this.props.more.isLost?className+=" slider-item_lost":this.props.photo.sizes?imageStyle.backgroundImage="url('"+this.props.photo.sizes.xxs.url+"')":className+=" slider-item_loading",this.props.isCurrent&&(className+=" slider-item_current"),React.createElement("div",{className:className,onClick:photo.fake?null:this.handleClick},React.createElement("div",{className:"photo-link",style:imageStyle}))}}),Scrolled={getVisible:function(scrollLeft){var pageSize=this.props.pageSize,itemSize=this.props.itemSize,scrollWrapperNode=this.refs["scroll-wrapper"].getDOMNode(),width=scrollWrapperNode.offsetWidth,leftEdge=scrollLeft||scrollWrapperNode.scrollLeft,rightEdge=leftEdge+width,firstItemIndex=Math.floor(leftEdge/itemSize),lastItemDelta=rightEdge%itemSize,lastItemIndex=0===lastItemDelta?rightEdge/itemSize-1:Math.floor(rightEdge/itemSize);this.state.total&&(lastItemIndex=Math.min(this.state.total-1,lastItemIndex));var firstPageIndex=Math.floor(firstItemIndex/pageSize),lastPageIndex=Math.floor(lastItemIndex/pageSize);return{items:{from:firstItemIndex,to:lastItemIndex},pages:{from:firstPageIndex,to:lastPageIndex}}},zip:function(visible,silent){var hardThreshold=5;visible=visible||this.visible;var pageFrom=visible.pages.from,pageTo=visible.pages.to,goodPageFrom=Math.max(pageFrom-hardThreshold-pageFrom%hardThreshold,0),goodPageToReserve=hardThreshold-pageTo%hardThreshold,goodPageTo=pageTo+hardThreshold+(goodPageToReserve===hardThreshold?0:goodPageToReserve),needUpdate=!1;this.pageFrom!==goodPageFrom&&(this.pageFrom=goodPageFrom,needUpdate=!0),this.pageTo!==goodPageTo&&(this.pageTo=goodPageTo,needUpdate=!0),needUpdate&&!silent&&this.forceUpdate()},scrollToPage:function(page,scrollToEnd){var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode(),sliderWidth=sliderOuterNode.offsetWidth,pageWidth=+this.props.pageSize*+this.props.itemSize;this._setScrollLeft(scrollToEnd?(page+1)*pageWidth-sliderWidth-this.props.itemsGap:page*pageWidth)},expandScrolled:function(scrollLeft){var pageSize=this.props.pageSize,itemSize=this.props.itemSize,sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode(),sliderInnerNode=this.refs.scrolled.getDOMNode(),sliderWidth=sliderOuterNode.offsetWidth,fullWidth=sliderInnerNode.offsetWidth;scrollLeft=scrollLeft||sliderOuterNode.scrollLeft;var hardExtendStepPages=5,pageWidth=pageSize*itemSize,extendGap=pageWidth,extendStep=hardExtendStepPages*pageWidth;if(scrollLeft+sliderWidth+extendGap>fullWidth){for(var newScrolledWidth=scrollLeft-scrollLeft%extendStep;extendGap>newScrolledWidth-(scrollLeft+sliderWidth);)newScrolledWidth+=extendStep;this.setScrolledWidth(newScrolledWidth)}},setScrolledWidth:function(newScrolledWidth){var oldScrolledWidth=this.state.scrolledWidth;newScrolledWidth=this.normalizeScrolledWidth(newScrolledWidth),oldScrolledWidth!=newScrolledWidth&&this.setState({scrolledWidth:newScrolledWidth})},normalizeScrolledWidth:function(newScrolledWidth,total){total=total||this.state.total;var maxScrollWidth=null!=total?this.getTotalWidth(total):1/0;return Math.min(newScrolledWidth,maxScrollWidth)},arrowsUpdate:function(){var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode(),sliderInnerNode=this.refs.scrolled.getDOMNode(),scrollLeft=sliderOuterNode.scrollLeft,sliderWidth=sliderOuterNode.offsetWidth,fullWidth=sliderInnerNode.offsetWidth,itemSize=this.props.itemSize,hideNext=scrollLeft+sliderWidth>fullWidth-itemSize/2,hidePrev=itemSize/2>scrollLeft;$(this.refs.nextArrow.getDOMNode())[hideNext?"fadeOut":"fadeIn"](),$(this.refs.prevArrow.getDOMNode())[hidePrev?"fadeOut":"fadeIn"]()},isItemFullyVisible:function(index){var itemLeftEdge=index*this.props.itemSize,itemRightEdge=(index+1)*this.props.itemSize-this.props.itemsGap,sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode(),scrollLeft=sliderOuterNode.scrollLeft,sliderWidth=sliderOuterNode.offsetWidth;return itemLeftEdge>=scrollLeft&&scrollLeft+sliderWidth>=itemRightEdge},scrollTo:function(index,animate){var newScrollLeft=this.props.itemSize*index;this._setScrollLeft(newScrollLeft,animate)},scrollLeft:function(){this._scrollBy(-3),this.props.metrikaCounter(["click to previous",ph.metrika.mode()])},scrollRight:function(){this._scrollBy(3),this.props.metrikaCounter(["click to next",ph.metrika.mode()])},_scrollBy:function(delta){var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode(),newScrollLeft=sliderOuterNode.scrollLeft+delta*this.props.itemSize;this._setScrollLeft(newScrollLeft)},_setScrollLeft:function(newScrollLeft,animate){var sliderOuterNode=this.refs["scroll-wrapper"].getDOMNode();this.expandScrolled(newScrollLeft),this.zip(this.getVisible(newScrollLeft),!0),this.forceUpdate(),animate="undefined"==typeof animate?!0:animate,animate?$(sliderOuterNode).animate({scrollLeft:newScrollLeft},300):sliderOuterNode.scrollLeft=newScrollLeft},getTotalWidth:function(total){if(total=total||this.state.total,null==total)throw new Error("[getTotalWidth] total was not specified");return total*this.props.itemSize-this.props.itemsGap}},MouseWheelScroll={enableMouseWheel:function(){var that=this;this.scrollLazyCallback||(this.scrollLazyCallback=ph.utils.lazyCallback(10,function(delta){delta=delta||0,0!==delta&&(that.refs["scroll-wrapper"].getDOMNode().scrollLeft-=delta)},function(value,args){var evt=args[0];return 0!==(evt.deltaX||0)?value:(evt.preventDefault(),value+evt.deltaY*evt.deltaFactor)}),$(this.refs["scroll-wrapper"].getDOMNode()).on("mousewheel",this.scrollLazyCallback))},disableMouseWheel:function(){this.scrollLazyCallback&&($(this.refs["scroll-wrapper"].getDOMNode()).off("mousewheel",this.scrollLazyCallback),this.scrollLazyCallback=null)}},Slider=React.createClass({displayName:"Slider",mixins:[Scrolled,MouseWheelScroll],getInitialState:function(){return{total:null,currentItemKey:null,scrolledWidth:0}},componentDidMount:function(){this.update()},componentDidUpdate:function(){this.update(),this.enableMouseWheel()},componentWillUnmount:function(){this.disableMouseWheel()},update:function(){this.expandScrolled(),this.visible=this.getVisible(),this.props.data.sync(this.visible),this.arrowsUpdate(),this.zip()},handleScroll:function(){this.update()},getItemIndex:function(params){return this._getItemIndex(key(params))},_getItemIndex:function(itemKey){for(var models=this.props.data.models,i=0;i<models.length;i++)if(key(models[i].params)===itemKey)return i;return-1},setCurrentItem:function(params){this.setState({currentItemKey:key(params)})},getCurrentItemIndex:function(){return this._getItemIndex(this.state.currentItemKey)},setTotal:function(total,callback){this.state.total!==total&&this.setState({total:total,scrolledWidth:this.normalizeScrolledWidth(this.state.scrolledWidth,total)},callback)},resetAllItems:function(){this.setState(this.getInitialState())},preloadNextImage:function(){if(null!=this.nextItemKey){var nextItem=this.refs[this.nextItemKey];if(nextItem&&nextItem.props.photo){var size=ph.utils.getClosestSize(nextItem.props.photo,this.props.getDimensions());size&&ph.utils.preloadImage(size.value.url)}}},render:function(){var setAsNext=!1;this.nextItemKey=null;for(var items=[],i=this.pageFrom*this.props.pageSize;i<Math.min(this.pageTo*this.props.pageSize,this.props.data.models.length);i++){var photoModel=this.props.data.models[i],photo=photoModel.getData();photo||(photo=this.props.data.createFakeModel(i).getData());var itemKey=key(photoModel.params);setAsNext&&(setAsNext=!1,this.nextItemKey=itemKey);var isCurrent=itemKey===this.state.currentItemKey;setAsNext=isCurrent;var more={};photo.fake||(more.isBlocked=photo.flags.blocked,more.isLost=photo.flags.lostInStorage,more.is18plus=photo.flags.porno&&!ph.utils.isAdult(this.props.uid)&&photo.author.uid!=this.props.uid);var photoParams={"author-login":photoModel.params["author-login"],"album-id":photoModel.get(".albumId"),"image-id":photoModel.params["image-id"],page:Math.floor(i/this.props.pageSize)};items.push(React.createElement(SliderItem,{photo:photo,photoParams:photoParams,isCurrent:isCurrent,more:more,index:i,key:itemKey,ref:itemKey,metrikaCounter:this.props.metrikaCounter}))}var paddingLeft=this.pageFrom*this.props.pageSize*this.props.itemSize,scrolledAreaStyle={paddingLeft:paddingLeft,width:this.state.scrolledWidth-paddingLeft};return React.createElement("div",{className:"slider"},React.createElement("div",{className:"slider-scroll-wrapper",ref:"scroll-wrapper",onScroll:this.handleScroll},React.createElement("div",{className:"slider-next-photo",ref:"nextArrow",style:{display:"none"},onClick:this.scrollRight},React.createElement("span",{className:"icon icon_arrow-right"})),React.createElement("div",{className:"slider-prev-photo",ref:"prevArrow",style:{display:"none"},onClick:this.scrollLeft},React.createElement("span",{className:"icon icon_arrow-left"})),React.createElement("div",{className:"slider-scroll",ref:"scrolled",style:scrolledAreaStyle},items)))}});ph.R.Slider=Slider}(),ns.View.define("slider",{params:ph.params.sliderViewParams,models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},"app-state":{"ns-model-changed":{".is-adult":"invalidate"}},"slider-context":{"ns-model-insert":"keepValid","ns-model-remove":"keepValid","ns-model-changed":"keepValid"},"image-box":{"ns-model-changed":"keepValid"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy","ns-view-show":"onShow","ns-view-hide":"onHide","ns-page-before-load@show":"onPageGo",mouseenter:"countSliderShow","ph-next-photo@show":"goToNextPhoto","ph-prev-photo@show":"goToPrevPhoto","ph-slider-sync@show":"onSliderSync","ph-resize@show":"onWindowResize","ph-slider-redraw@show":"onSliderRedrawRequest"},methods:{onHtmlInit:function(){this.collection=this.getModel("slider-context"),this.controller=ph.controllers.slider,this._initCallbacks()},getDimensions:function(){return this.getModel("image-box").getDimensions()},onHtmlDestroy:function(){this._destroySliderComponent()},onShow:function(){this._ensureSliderComponent(),this.collection.on("new-items-loaded",this._callbacks.redrawCallback),this.collection.on("sync-needed",this._callbacks.redrawCallback),this.collection.on("total-changed",this._callbacks.totalChangedCallback),this._syncCurrentItem(),this._notifyAboutSliderState()},onHide:function(){this.collection.off("new-items-loaded",this._callbacks.redrawCallback),this.collection.off("sync-needed",this._callbacks.redrawCallback),this.collection.off("total-changed",this._callbacks.totalChangedCallback)},onSliderRedrawRequest:function(){this.collection&&this.collection.syncCurrent()},_ensureSliderComponent:function(){var that=this,params=ns.page.current.params,context=params.context||"album";if("album"!==context||params["album-id"]){if(this._initDone)return void this._setTotalIfPresent();this._initDone=!0,this._initialScrollDone=!1,this.scrollQueue||(this.scrollQueue=new ph.Queue({skipCycles:!0,skipErrors:!0,keyFunc:function(params){return ns.Model.key("photo",params)}}));var itemPadding=10,itemSize=75+itemPadding,uid=no.jpath(".uid.value",this.getModelData("auth")),ready=new Vow.Promise,Slider=React.createElement(ph.R.Slider,{itemSize:itemSize,itemsGap:itemPadding,pageSize:this.collection.dynamic.pageSize,uid:uid,data:this.collection,metrikaCounter:this.metrikaCounter.bind(this),getDimensions:this.getDimensions.bind(this)}),sliderComponent=React.render(Slider,this.node,function(){ready.fulfill()});ready.then(function(){that.sliderComponent=sliderComponent,that._setTotalIfPresent()})}},_setTotalIfPresent:function(){this.sliderComponent&&this.collection.dynamic.total&&this._totalChanged()},_destroySliderComponent:function(){this.scrollQueue&&(this.scrollQueue.abortAll(!0),this.scrollQueue=null),this.sliderComponent&&(React.unmountComponentAtNode(this.node),this.sliderComponent=null,this._initDone=!1,this._initialScrollDone=!1)},onPageGo:function(evt,pair){var oldParams=pair[0].params,newParams=pair[1].params;(oldParams["author-login"]!=newParams["author-login"]||oldParams["image-id"]!=newParams["image-id"])&&this._syncCurrentItem(pair[1],!0,!0)},onSliderSync:function(){this._syncCurrentItem()},onWindowResize:function(){this.sliderComponent&&this.sliderComponent.forceUpdate()},goToNextPhoto:function(){this._goToPhoto(1)},goToPrevPhoto:function(){this._goToPhoto(-1)},_initCallbacks:function(){var that=this;this._callbacks={redrawCallback:function(){that.sliderComponent&&that.sliderComponent.forceUpdate()},totalChangedCallback:function(){that._totalChanged()}}},_totalChanged:function(){var that=this;if(!this._redirectIfAlbumIsEmpty()&&this.sliderComponent){var scrollCurrentIntoView=!1;this._initialScrollDone||(this._initialScrollDone=!0,scrollCurrentIntoView=!0),this.sliderComponent.setTotal(this.collection.dynamic.total,function(){that._syncCurrentItem(null,scrollCurrentIntoView),that._notifyAboutSliderState()})}},_notifyAboutSliderState:function(){this.collection.firstDataPortionLoaded&&ns.events.atrigger(this.collection.dynamic.total>1?"ph-multiple-photo-album":"ph-single-photo-album")},_goToPhoto:function(delta){if(0!==delta){var currentIndex=this.sliderComponent.getCurrentItemIndex();currentIndex>=0?this._goToPhotoByIndex(currentIndex+delta,delta>0):this._goToPhotoByIndex(0)}},_goToPhotoByIndex:function(newIndex,isNext){var that=this,total=this.collection.dynamic.total;if(this.sliderComponent&&this.collection.firstDataPortionLoaded&&!this._redirectIfAlbumIsEmpty()){newIndex>=total?newIndex=0:0>newIndex&&(newIndex=total-1);var nextPhoto=this.collection.getItem(newIndex);return nextPhoto?void this._redirectToPhotoPage(nextPhoto.getData()):void this.controller.getPhotoNearContext().then(function(context){if(!context.pageLeft){var photo=context.model.get(isNext?".next":".prev");photo?that._redirectToPhotoPage(photo):0!==newIndex&&that._goToPhotoByIndex(0)}})}},_redirectIfAlbumIsEmpty:function(){return this.collection.firstDataPortionLoaded&&this.collection.dynamic.total<=0?(ns.events.atrigger("ph-viewer-can-be-closed"),!0):!1},_redirectToPhotoPage:function(photoModelData){if(photoModelData&&this.sliderComponent){var url=this._generateUrl(photoModelData);if(url!==ns.page.currentUrl){ns.page.go(url,ph.fullscreen.isFullscreen()?"preserve":!1);var params={"author-login":photoModelData.author.login,"image-id":photoModelData.imageId};this.sliderComponent.setCurrentItem(params)}}},_generateUrl:function(photoModelData){var pageParams=no.extend({},ns.page.current.params,{"author-login":photoModelData.author.login,"album-id":photoModelData.albumId,"image-id":photoModelData.imageId});return ph.utils.generateUrl("photo",pageParams)},_syncCurrentItem:function(newPage,scrollIntoView,cancelOldScroll){var that=this;newPage=newPage||ns.page.current,scrollIntoView="undefined"==typeof scrollIntoView?!0:scrollIntoView,this.sliderComponent&&"photo"===newPage.page&&this.scrollQueue.add(newPage.params,function(){return that._asyncSetCurrentItem(newPage.params,scrollIntoView)},cancelOldScroll)},_asyncSetCurrentItem:function(params,scrollIntoView){var that=this,promise=new Vow.Promise;return that._getItemIndex(params).then(function(itemIndex){return that.sliderComponent?(that.sliderComponent.setCurrentItem(params),scrollIntoView&&!that.sliderComponent.isItemFullyVisible(itemIndex)&&that.sliderComponent.scrollTo(itemIndex),that.sliderComponent.preloadNextImage(),void promise.fulfill()):void promise.fulfill()}),promise},_getItemIndex:function(params){var itemIndex=this.sliderComponent.getItemIndex(params);if(itemIndex>=0)return Vow.fulfill(itemIndex);var promise=new Vow.Promise;return this.controller.getPhotoPosition(params).then(function(context){promise.fulfill(context.model.get(".position"))}).fail(function(details){no.jpath(".context.error.name",details)===ph.ERRORS.imageNotFound&&promise.fulfill(0)}),promise},countSliderShow:function(){ph.metrika.count(["desktop web","interface elements","image viewer","show slider",ph.metrika.mode()])},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer","previews"])}}),function(){ns.View.define("panel",{models:ph.utils.nsViewModels({"panel-state":{"ns-model-changed":"keepValid"}}),events:{"scroll@show":"onScroll"},methods:{onScroll:function(){ns.events.trigger("ph-panel-scroll",this.getModel("panel-state").isUserScroll())}}}),ns.View.define("panel-container",{params:[{"author-login":null,"image-id":null,"album-id":null,mode:null},{"author-login":null,"image-id":null,mode:null}],models:ph.utils.nsViewModels({"panel-state":{"ns-model-changed":"keepValid"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","ns-page-before-load@show":"onPageUpdate","ph-skip-panel-scroll@show":"onSkipScrollEvent","ph-panel-scroll-on@show":"onScrollOn","ph-panel-scroll-off@show":"onScrollOff"},methods:{onHtmlInit:function(){this.scrollPosition=0,this._nodes={$viewport:this.$node.closest(".js-panel")}},onShow:function(){var that=this;this.skipUserScroll(function(){that._nodes.$viewport.scrollTop(that.scrollPosition)})},onPageUpdate:function(){this.scrollPosition=this._nodes.$viewport.scrollTop()},onSkipScrollEvent:function(){this.skipUserScroll()},skipUserScroll:function(callback){this.getModel("panel-state").skipNextScrollEvent(),callback&&callback()},onScrollOn:function(){this.getModel("panel-state").enable()},onScrollOff:function(){this.getModel("panel-state").disable()}}})}(),ns.View.define("photo-common",{methods:{_updateDimensions:function(){var $imageBox=$(".js-photo-box",this.node);this.getModel("image-box").setDimensions($imageBox.width(),$imageBox.height())},_saveGoBackUrl:function(){if(!this.goBackUrl){var url=ph.prevUrl||document.referrer||null;ph.utils.isUrlGoodForReturn(url)||(url=ph.utils.getOldFotkiContextUrl(ns.page.current.params)),this.goBackUrl=url||"/"}},_closeViewer:function(){var url,params=ns.page.current.params;ph.slideshow.isRunning()&&ph.slideshow.stop(),"fullscreen"===params.mode?url=ph.utils.generateUrl("photo",no.extend({},params,{mode:"view"})):(url=this.goBackUrl,this.goBackUrl=null),ns.page.go(url)}}},ph.View),ns.View.define("photo",{params:{mode:null},models:ph.utils.nsViewModels({"photo-initial-redirect":{"ns-model-changed":"invalidate"},"image-box":{"ns-model-changed":"keepValid"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","click .js-go-back":"onClickGoBack","click .js-go-back-area":"onClickGoBackArea","ph-resize@show":"_updateDimensions","ph-close-viewer@show":"_closeViewer","ph-photo-saving@show":"showSpinner","ph-photo-save-done@show":"hideSpinner"},shortcuts:{esc:{method:"handleCloseViewerShortcut",last:!0}},methods:{onHtmlInit:function(){this._nodes={$spinner:$(".js-spinner",this.node)}},onShow:function(){this._saveGoBackUrl(),this._updateDimensions()},handleCloseViewerShortcut:function(evt){if(!nb.popup.someOpen()){var params=ns.page.current.params,isFullscreen="fullscreen"===params.mode;return this.metrikaCounter(isFullscreen?["go to white mode",ph.metrika.getEventSummary(evt)]:["close image viewer",ph.metrika.getEventSummary(evt)]),this._closeViewer(),!1}},onClickGoBack:function(){var params=ns.page.current.params,isFullscreen="fullscreen"===params.mode;return this.metrikaCounter(isFullscreen?["go to white mode","x"]:["close image viewer","x"]),this._closeViewer(),!1},onClickGoBackArea:function(){return this.metrikaCounter(["close image viewer","dark area"]),this._closeViewer(),!1},showSpinner:function(){this._nodes.$spinner.toggleClass("photo-is-updating_hidden",!1)},hideSpinner:function(){this._nodes.$spinner.toggleClass("photo-is-updating_hidden",!0)},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}},"photo-common"),ns.View.define("photo-contest",{models:ph.utils.nsViewModels({"image-box":{"ns-model-changed":"keepValid"}}),events:{"ns-view-show":"onShow","click .js-go-back-area":"onClickGoBack","ph-resize@show":"_updateDimensions"},shortcuts:{esc:{method:"handleCloseViewerShortcut",last:!0}},methods:{onShow:function(){this._saveGoBackUrl(),this._updateDimensions()},handleCloseViewerShortcut:function(){this._closeViewer()},onClickGoBack:function(){return this._closeViewer(),!1}}},"photo-common"),ns.View.define("photo-image-common",{methods:{_updateImageIfNeeded:function(photoData){if(photoData){var imageBoxModel=this.getModel("image-box"),boxSize=$(".js-image",this.node).data("size"),currentBoxSize=ph.utils.getClosestSize(photoData,imageBoxModel.getDimensions());currentBoxSize&&boxSize<currentBoxSize.name?(this.invalidate(),ph.redraw()):this.keepValid()}}}},ph.View),ns.View.define("photo-image",{params:[{"author-login":null,"image-id":null,"album-id":null,mode:null},{"author-login":null,"image-id":null,mode:null}],models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},photo:{"ns-model-changed":{".author":"invalidate",".sizes":"invalidate",".blockReason":"invalidate",".imageFormat":"invalidate",".flags.porno":"invalidate",".access.passworded":"invalidate",".askAlbumPassword":"invalidate",".flags.lostInStorage":"invalidate"}},"photo-rights":{"ns-model-changed":{".blockReason":"invalidate"}},"app-state":{"ns-model-changed":{".is-adult":"invalidate"}},"image-box":{"ns-model-changed":"onImageBoxChange"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","click .js-button-gte18":"onClickGte18","click .js-button-lt18":"onClickLt18","click .js-button-password-check":"checkPassword","input .js-album-password":"onInputPassword","ph-page-change@show":"onPageChange"},shortcuts:{enter:{method:"checkPassword",last:!0,selector:".js-album-password"}},methods:{onHtmlInit:function(){return ph.redirect.redirectToPhoto(this.getModel("photo"))?void(this.redirected=!0):(this._nodes={$buttonCheckPassword:$(".js-button-password-check",this.node),$inputPassword:$(".js-album-password",this.node),$image:$(".js-image",this.node),image:$(".js-image",this.node)[0]},void(this._classes={disabled:"is-disabled"}))},onImageBoxChange:function(){var photoData=this.getModelData("photo");this._updateImageIfNeeded(photoData)},onShow:function(){this.redirected||(this.countOnShow(),ph.slideshow.isRunning()&&(this._nodes.image?ph.utils.imgOnLoad(this._nodes.$image,function(){ns.events.trigger("ph-slideshow-image-show")}):ns.events.trigger("ph-slideshow-image-show")))},onInputPassword:function(){this._nodes.$buttonCheckPassword.toggleClass(this._classes.disabled,this._isPasswordEmpty())},_isPasswordEmpty:function(){return""===this._nodes.$inputPassword.val().trim()},checkPassword:function(evt){if(!this._isPasswordEmpty()){var that=this,password=this._nodes.$inputPassword.val().trim(),promise=ph.controllers.photo.checkPassword(this.getModel("photo"),password);promise.then(function(){ph.redraw(function(){that.countIfPassworded()}),that.metrikaCounter(["password enter","result","success"])}),promise.fail(function(details){var messages={"empty password":"error_album-password-empty","access denied":"error_album-password-wrong","ph-default":"error_something-goes-wrong"},error=no.jpath(".context.error.name",details),message=messages[error]||messages["ph-default"];that._showError(details.context,that._nodes.$inputPassword[0],message),that.metrikaCounter(["password enter","result","no luck"])}),this.metrikaCounter(["password enter",ph.metrika.getEventSummary(evt)])}},_showError:function(context,node,errorId){ph.errors.showError(context,{messageId:errorId,element:node,popup:{how:{dir:"left"}}})},onClickGte18:function(){this.getModel("app-state").setIsAdult();var redrawPromise=ph.redraw();redrawPromise.then(this.countIf18Plus,this),this.metrikaCounter(["18+ button reply","yes"])},onClickLt18:function(){ns.events.trigger("ph-next-photo"),this.metrikaCounter(["18+ button reply","no"])},countOnShow:function(){this.counted||(this.countImageView(),this.countIf18Plus(),this.countIfPassworded(),this.counted=!0)},onPageChange:function(){this.counted=!1},countImageView:function(){var contextInfo=ph.metrika.getContextInfo(),mParams=["show main image",ph.metrika.mode(),"from context",contextInfo.name];contextInfo.more&&mParams.push(contextInfo.more),mParams=mParams.concat([this.getModel("photo").get(".imageFormat")||"unknown",this._nodes.$image.data("size-name")||"uknown size"]),this.metrikaCounter(mParams)},countIf18Plus:function(){var photo=this.getModel("photo");if(photo.get(".flags.porno")){var authorUid=photo.get(".author.uid"),currentUserUid=this.getModel("auth").get(".uid.value"),isAuthor=currentUserUid==authorUid;this.metrikaCounter(["18+",isAuthor?"author":ph.utils.isAdult(currentUserUid)?"show image":"show stub"])}},countIfPassworded:function(){var photo=this.getModel("photo");if(photo.get(".access.passworded")){var authorUid=photo.get(".author.uid"),currentUserUid=this.getModel("auth").get(".uid.value"),isAuthor=currentUserUid==authorUid;this.metrikaCounter(["passworded",isAuthor?"author":photo.get(".askAlbumPassword")?"show stub":"show image"])}},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}},"photo-image-common"),ns.View.define("photo-image-contest",{models:ph.utils.nsViewModels({ticket:{"ns-model-changed":"invalidate"},auth:{"ns-model-changed":"invalidate"},contest:{"ns-model-changed":"invalidate"},"image-box":{"ns-model-changed":"onImageBoxChange"}}),methods:{yateGetContestImage:function(){return this._getPhotoData()},onImageBoxChange:function(){this._updateImageIfNeeded(this._getPhotoData())},_getPhotoData:function(){var contest=this.getModel("contest"),votePhoto=contest.getInnerModel("vote-photo");if(votePhoto&&votePhoto.get(".imageId"))return votePhoto.getData();var contestPhoto=contest.getInnerModel("contest-photo");return contestPhoto&&contestPhoto.get(".imageId")?contestPhoto.getData():null}}},"photo-image-common"),ns.View.define("photo-image-overlay",{models:ph.utils.nsViewModels({ticket:{"ns-model-changed":"invalidate"},auth:{"ns-model-changed":"keepValid"},contest:{"ns-model-changed":"onContestChange"}}),events:{"ns-view-htmlinit":"onHtmlInit"},methods:{onHtmlInit:function(){var contest=this.getModel("contest"),contestId=contest.get(".contestId"),params=ns.page.current.params;
return contestId?contestId!=params["contest-id"]?void ns.page.go(ph.utils.generateUrl("contest",params)):void React.render(React.createElement(ph.R.ContestOverlay,this.getComponentProps(contest)),this.node):void 0},onContestChange:function(){this.keepValid(),this.renderComponent()},renderComponent:function(){React.render(React.createElement(ph.R.ContestOverlay,this.getComponentProps(this.getModel("contest"))),this.node)},getComponentProps:function(contest){var that=this,status=contest.get(".state"),votePhotoId=contest.getInnerModel("vote-photo").get(".imageId");"voting-started"===status&&(votePhotoId||(status="voting-photo-empty"));var props={status:status,onSkip:function(){that.vote()},onLike:function(){that.vote(!0)},countShowAllVoted:this.countShowAllVoted.bind(this),forceCount:this._forceCount};return this._forceCount=!1,props},updateContest:function(){var that=this,contest=that.getModel("contest"),promise=ns.request.models([contest],{forced:!0});promise.then(function(){ph.redraw()}),promise.fail(function(){that.renderComponent()})},vote:function(like){if(this.metrikaCounter(["vote","from viewer",like?"thumbsup":"skip"]),!ph.noAuthRedirect(this.getModel("auth"))){var that=this,promise=ph.controllers.photo.vote(like,this.getModel("contest"));null!=promise&&(promise.then(function(){that._forceCount=!0,that.updateContest()}),promise.fail(function(){that.renderComponent()}))}},countShowAllVoted:function(){this.metrikaCounter(["show all voted"])},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","main page","contest block"])}}),ns.View.define("photo-author",{params:{"author-login":null,"image-id":null},models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},profile:{"ns-model-changed":{".viewerUserRelation.userIsFavoriteAuthorOfViewer":"invalidate",".user.displayName":"invalidate"}}}),events:{"click .js-follow":"toggleFollow","click .js-username":"countGoToAuthorPage"},methods:{toggleFollow:function(evt){var $buttonFollow=$(evt.target);if(!$buttonFollow.hasClass("is-disabled")){if($buttonFollow.addClass("is-disabled"),ph.noAuthRedirect(this.getModel("auth")))return void this.metrikaCounter(["subscribe unauth","image viewer"]);var profile=this.getModel("profile"),wasFollowing=profile.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer"),promise=ph.controllers.photo.toggleFollow(profile);null!=promise&&(promise.always(function(){ph.redraw()}),this.metrikaCounter([wasFollowing?"unsubscribe":"subscribe","image viewer"]))}},countGoToAuthorPage:ph.metrika.countLink(function(){var authorUid=this.getModel("profile").get(".user.uid"),currentUserUid=this.getModel("auth").get(".uid.value"),isAuthor=currentUserUid==authorUid;this.metrikaCounter(["click on author name or avatar","image viewer",isAuthor?"author":"others"])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","actions"])}}),ns.View.define("photo-info",{params:ph.params.photoInfoViewParams,models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},ticket:{"ns-model-changed":"invalidate"},photo:{"ns-model-changed":{".title":"invalidate",".access.privilege":"invalidate",".askAlbumPassword":"invalidate"}},"photo-rights":{"ns-model-changed":{".canEdit":"invalidate"}},"photo-more":{"ns-model-changed":{".description":"invalidate"}},"photo-position":{"ns-model-changed":"invalidate"},"album-info":{"ns-model-changed":{".title":"invalidate"}},"photo-info-state":{"ns-model-changed":"keepValid"}}),events:{"ns-view-htmlinit":"onViewHtmlInit","ns-view-show":"onShow","ns-page-before-load@show":"onPageLeave","click .js-toggle-privacy":"togglePrivacy","click .js-album-link":"countGoToAlbum","ph-page-change@show":"onPageChange"},methods:{onViewHtmlInit:function(){var that=this;this._nodes={$title:$(".js-nb-title",this.node),title:$(".js-nb-title",this.node)[0],$description:$(".js-nb-description",this.node),description:$(".js-nb-description",this.node)[0],$togglerPrivacy:$(".js-toggle-privacy",this.node)},this.title=this._initEditCollapsePair("title",this._nodes.$title,".titleCollapsed",function(newValue){that.saveTitle(newValue)}),this.description=this._initEditCollapsePair("description",this._nodes.$description,".descriptionCollapsed",function(newValue){that.saveDescription(newValue)})},onShow:function(){this.countOnShow()},togglePrivacy:function(){var photo=this.getModel("photo");if(!this._nodes.$togglerPrivacy.hasClass("is-disabled")&&photo){this._nodes.$togglerPrivacy.addClass("is-disabled");var wasPublic="public"===photo.get(".access.privilege"),promise=ph.controllers.photo.setParam("access-rights",photo,this.getModel("photo-rights"));null!=promise&&(promise.always(ph.redraw),this.metrikaCounter(["change privacy",wasPublic?"set private":"set public"]))}},onPageLeave:function(){this.title&&this.title.edit&&this.title.edit.trigger("ph-page-leave"),this.description&&this.description.edit&&this.description.edit.trigger("ph-page-leave")},saveDescription:function(newDescription){var that=this,photoMore=this.getModel("photo-more"),promise=ph.controllers.photo.saveDescription(newDescription,photoMore);return ph.redraw(),promise.fail(function(details){var newDescription=details.newDescription,oldDescription=details.oldDescription,context=details.context;that.description.edit.resetValue(oldDescription),ph.errors.showError(context,{messageId:"error_save-description",persistent:!0,element:that._nodes.description,popup:{how:{dir:"left"}},data:{photo:that.getModelData("photo")},ok:function(){that.description.edit.startEdit(newDescription)},cancel:function(){ph.redraw()}})}),!1},saveTitle:function(newTitle){var that=this,photo=this.getModel("photo"),promise=ph.controllers.photo.saveTitle(newTitle,photo);return ph.redraw(),promise.fail(function(details){var newTitle=details.newTitle,oldTitle=details.oldTitle,context=details.context;that.title.edit.resetValue(oldTitle),ph.errors.showError(context,{messageId:"error_save-title",persistent:!0,element:that._nodes.title,popup:{how:{dir:"left"}},data:{photo:photo.getData()},ok:function(){that.title.edit.startEdit(newTitle)},cancel:function(){ph.redraw()}})}),!1},fieldCollapseToggle:function(what,collapsed,stateJpath){this.getModel("photo-info-state").set(stateJpath,collapsed),this.countToggle(what,collapsed),ph.resized()},_initEditCollapsePair:function(what,$node,stateJpath,onSave){var that=this,node=$node[0];if(node){nb.block(node);var collapse=nb.block(node,null,"collapse-text"),collapsedState=this.getModel("photo-info-state").get(stateJpath);if("undefined"==typeof collapsedState?this.getModel("photo-info-state").set(stateJpath,collapse.isCollapsed()):collapse[this.getModel("photo-info-state").get(stateJpath)?"collapse":"expand"](),collapse.on("collapsed",this.fieldCollapseToggle.bind(this,what,!0,stateJpath)),collapse.on("expanded",this.fieldCollapseToggle.bind(this,what,!1,stateJpath)),!nb.hasBlock(node,"editable-text"))return{collapse:collapse};var edit=nb.block(node,null,"editable-text");return edit.on("nb-text-edit",function(evt,viaPencil){collapse.disable(),that.countStartEdit(what,viaPencil)}),edit.on("nb-text-edit-end",function(evt,saved){no.next(function(){collapse.enable(that.getModel("photo-info-state").get(stateJpath))}),saved===!1&&that.countCancelEdit(what)}),edit.on("save",function(evt,details){onSave(details.value),that.countSave(what,details.viaKeyboard)}),{edit:edit,collapse:collapse}}},countOnShow:function(){if(!this.counted){if(this.counted=!0,!this.$node.is(".js-metrika-visible"))return this.metrikaCounter(["title","show","hidden"]),void this.metrikaCounter(["description","show","hidden"]);var photo=this.getModel("photo"),photoMore=this.getModel("photo-more");this.metrikaCounter(["title","show",photo.get(".title")?"filled":"empty"]),this.metrikaCounter(["description","show",photoMore.get(".description")?"filled":"empty"])}},onPageChange:function(){this.counted=!1},countStartEdit:function(what,viaPencil){this.metrikaCounter([what,"start edit",viaPencil?"on pencil":"on field"])},countCancelEdit:function(what){this.metrikaCounter([what,"cancel edit"])},countSave:function(what,viaKeyboard){this.metrikaCounter([what,"save edit",viaKeyboard?"keyboard":"click"])},countToggle:function(what,collapsed){this.metrikaCounter([what,collapsed?"hide":"unhide"])},countGoToAlbum:ph.metrika.countLink(function(){this.metrikaCounter(["go to album"])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}}),ns.View.define("photo-slider-info"),ns.View.define("photo-slider-info-item",{params:ph.params.photoInfoViewParams,models:["photo","photo-position"]}),function(){var utils=ph.utils;ns.View.define("photo-tags",{params:{"author-login":null,"image-id":null},models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},photo:{"ns-model-changed":"keepValid"},"photo-rights":{"ns-model-changed":{".actions.canAddTag":"invalidate"}},"photo-more":{"ns-model-changed":{".podDate":"invalidate",".inTopFrom":"invalidate",".contestBindings.contestBinding":"invalidate"}},tags:{"ns-model-changed":"invalidate"}}),events:{"ns-view-htmlinit":"onViewHtmlInit","ns-view-show":"onShow","click .js-tag":"countGoToTagView","ph-page-change@show":"onPageChange"},methods:{onViewHtmlInit:function(){var that=this;this._nodes={$medals:$(".js-medals",this.node),$medalsWrapper:$(".js-medals-wrapper",this.node),$medalPhotoOfDay:$(".js-medal_photoofday",this.node),$tags:$(".js-editable-tags",this.node),tags:$(".js-editable-tags",this.node)[0]};var collapse,$tagsCollapseNode=$(this.node).find(".js-collapsed-text");if($tagsCollapseNode.length&&($tagsCollapseNode.attr("data-nb-line-height",24),collapse=nb.block($tagsCollapseNode[0],null,"collapse-text"),collapse.on("collapsed",this.onCollapsedBlockToggle.bind(this,"tags",!1)),collapse.on("expanded",this.onCollapsedBlockToggle.bind(this,"tags",!0))),this._nodes.$tags.length){var editableTags=this.editableTags=nb.block(this._nodes.tags,null,"editable-tags");editableTags.on("nb-tags-edit-start",function(){collapse.disable()}),editableTags.on("nb-tags-edit-end",function(){no.next(function(){collapse.enable()})}),editableTags.on("nb-tags-save",function(evt,details){that.editTags(details.value)})}if(this._nodes.$medals.length){var $medal=this._nodes.$medalsWrapper.find(".medal-wrapper:not(.medal_photoofday-wrapper)");if($medal.length){var _medalWidth=$medal.outerWidth(!0),_photoOfDayWidth=this._nodes.$medalPhotoOfDay.outerWidth(!0),_medalsWidthAvailable=this._nodes.$medals.outerWidth(!1);_medalsWidthAvailable-=utils.cssValue(this._nodes.$medals,"padding-left"),_medalsWidthAvailable-=utils.cssValue(this._nodes.$medals,"padding-right"),_medalsWidthAvailable-=_photoOfDayWidth,_medalsWidthAvailable-=_medalsWidthAvailable%_medalWidth,_medalsWidthAvailable+=_photoOfDayWidth,this._nodes.$medalsWrapper.css("max-width",_medalsWidthAvailable)}var medalsCollapse=nb.block(this._nodes.$medals[0]);medalsCollapse.on("collapsed",this.onCollapsedBlockToggle.bind(this,"awards",!1)),medalsCollapse.on("expanded",this.onCollapsedBlockToggle.bind(this,"awards",!0))}},onShow:function(){this.countOnShow(),ph.resized()},editTags:function(tagsString){var that=this,promise=ph.controllers.photo.editTags(tagsString,this.models);ph.redraw(),promise.then(ph.redraw),promise.fail(function(context){var messageId="error_edit-tags";context||(messageId="error_edit-tags-limit"),ph.errors.showError(context||null,{messageId:messageId,persistent:!0,element:that._nodes.tags,popup:{how:{dir:"left"}},data:{photo:that.getModelData("photo")},ok:function(){that.editableTags.startEdit()},cancel:function(){ph.redraw()}})})},onPageChange:function(){this.counted=!1},onCollapsedBlockToggle:function(what,expanded){this.countToggle(what,expanded),ph.resized()},countOnShow:function(){if(!this.counted){if(this.counted=!0,!this.$node.is(".js-metrika-visible"))return void this.metrikaCounter(["tags","show","hidden"]);var tagsCount=(this.getModel("tags").get(".tags.tag")||[]).length;this.metrikaCounter(["tags","show",ph.metrika.group(tagsCount,[0,5,10,20,30]),tagsCount]);var medals=ph.utils.groupMedals(this.getModelData("photo-more"));medals.length&&this.metrikaCounter(["awards","total",medals.length]);for(var contestCount=0,i=0;i<medals.length;i++)"photoofday"===medals[i].type?this.countMedal("pod"):"top"===medals[i].type?this.countMedal("top"):"contest"===medals[i].type&&contestCount++;contestCount>0&&this.metrikaCounter(["awards","types","contest",contestCount])}},countMedal:function(type){this.metrikaCounter(["awards","types",type])},countToggle:function(what,expanded){this.metrikaCounter([what,expanded?"unhide":"hide"])},countGoToTagView:ph.metrika.countLink(function(){this.metrikaCounter(["go to tag view"])}),metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}})}(),ns.View.define("photo-on-map",{params:{"author-login":null,"image-id":null,mode:null},models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},photo:{"ns-model-changed":"keepValid"},"photo-rights":{"ns-model-changed":{".actions.canBindGeo":"invalidate"}},"photo-more":{"ns-model-changed":{".boundCoord":"invalidate"}},ticket:{"ns-model-changed":"invalidate"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy"},methods:{onHtmlInit:function(){this._nodes={mapPopup:$(".js-map-popup",this.node)[0],map:$(".js-map-popup .map",this.node)[0],$mapPopupToggler:$(".js-photo-map-toggler",this.node)},this._createMapControl()},onHtmlDestroy:function(){this._destroyMapControl()},_createMapControl:function(){this.mapReadyPromise=this._prepareMapInit().then(this._endMapInit,this)},_destroyMapControl:function(){var map=this.map,mapPopup=this.mapPopup;this.map=null,this.mapPopup=null,mapPopup&&(mapPopup.trigger("close"),mapPopup.destroy()),map&&(map.cancel(),map.destroy()),this.mapReadyPromise=null},_onMapOpen:function(){this.map.canEdit&&!this.map.hasMarker()?this.map.setEditMode():this.map.setViewMode(),this.map.redraw()},_prepareMapInit:function(){var that=this,promise=new Vow.Promise;if(!this._nodes.mapPopup||!this._nodes.map)return promise.reject(),promise;var mapPopup=this.mapPopup=nb.block(this._nodes.mapPopup,{show:this.countMapShow.bind(this)});return ph.utils.once(mapPopup,"open",function(){var map=that.map=nb.block(that._nodes.map);promise.sync(map.ready)}),promise},_endMapInit:function(){var that=this,map=this.map,mapPopup=this.mapPopup,more=that.getModelData("photo-more");more&&more.boundCoord&&map.setMarker({lat:more.boundCoord.latitude,lon:more.boundCoord.longitude},{mapType:more.boundCoord.mapType,zoom:more.boundCoord.zoomlevel||more.boundCoord.zoomLevel}),map.fixState(),map.on("ph-map-save",function(evt,data){data?that._geoBind(data):that._geoUnbind()}),this._onMapOpen(),mapPopup.on("ph-show-end",this._onMapOpen.bind(this)),mapPopup.on("close",function(){map.cancel()})},_geoBind:function(data){var that=this,map=this.map,promise=ph.controllers.photo.geoBind(data,this.getModel("photo-more"));ph.redraw(),promise.fail(function(){ph.redraw()}),promise.fail(function(details){map.showError({persistent:!0,messageId:"error_map-bind-failed",data:{photo:that.getModelData("photo")}},{details:details,showPopup:function(){that._showMapPopup()}})})},_geoUnbind:function(){var that=this,map=this.map,promise=ph.controllers.photo.geoUnbind(this.getModel("photo-more"));promise&&(ph.redraw(),promise.fail(function(){ph.redraw()}),promise.fail(function(details){map.showError({persistent:!0,messageId:"error_map-unbind-failed",data:{photo:that.getModelData("photo")}},{details:details,showPopup:function(){that._showMapPopup()}})}))},_showMapPopup:function(){this._nodes.$mapPopupToggler.trigger("click")},countMapShow:function(){var that=this,authorUid=this.getModel("photo").get(".author.uid"),currentUserUid=this.getModel("auth").get(".uid.value"),isAuthor=currentUserUid==authorUid;this.mapReadyPromise.then(function(){that.metrikaCounter(["map","show map",isAuthor?"owner":"visitor",ph.metrika.mode(),that.map.getMapType()])})},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}}),ns.View.define("photo-like",{params:{"author-login":null,"image-id":null,mode:null},models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},photo:{"ns-model-changed":{".likeCount":"invalidate"}},"photo-rights":{"ns-model-changed":{".options.like":"invalidate"}}}),events:{click:"toggleLike","ph-page-change@show":"onPageChange"},shortcuts:{l:{method:"toggleLike",name:"view photo: like"}},methods:{toggleLike:function(evt){if(this.$node.hasClass("js-like")&&!ph.noAuthRedirect(this.getModel("auth"))){var photoRights=this.getModel("photo-rights"),wasLike=!!photoRights.get(".options.like"),promise=ph.controllers.photo.toggleLike(this.getModel("photo"),photoRights);null!=promise&&(ph.redraw().then(function(){photoRights.set(".options.likeAnimate",!1)}),promise.fail(ph.redraw),this.metrikaCounter([wasLike?"dislike":"like",ph.metrika.mode(),evt&&"click"===evt.type?"click":"shortcut"]))}},onPageChange:function(){this.$node.removeClass("animate")},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}},ph.View),ns.View.define("photo-favorite",{params:{"author-login":null,"image-id":null,mode:null},models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},"photo-rights":{"ns-model-changed":{".options.favorite":"invalidate"}}}),events:{click:"toggleFavorite"},methods:{toggleFavorite:function(){if(this.$node.hasClass("js-favorite")&&!ph.noAuthRedirect(this.getModel("auth"))){var wasFavorite=!!this.getModel("photo-rights").get(".options.favorite"),promise=ph.controllers.photo.toggleFavorite(this.getModel("photo-rights"));null!=promise&&(ph.redraw(),promise.fail(ph.redraw),this.metrikaCounter([wasFavorite?"remove from fav":"add to fav",ph.metrika.mode()]))}},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}}),ns.View.define("photo-to-disk",{params:{"author-login":null,"image-id":null,mode:null},models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},photo:{"ns-model-changed":{".sizes.orig":"invalidate"}},"save-to-disk-state":{"ns-model-changed":"updateButton"},ticket:{"ns-model-changed":"invalidate"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-show":"updateButton",click:"trySaveToDisk"},methods:{onHtmlInit:function(){var params=ph.params.hiddenParams;params.sd&&params.sk&&this.saveToDisk()},updateButton:function(){var progressButtonNode=this.$node.closest(".ghost-button")[0];if(progressButtonNode){var saveState=this.getModel("save-to-disk-state").get(".save-image-state"),progressButton=nb.block(progressButtonNode,null,"progress-button");if(progressButton)switch(saveState){case"running":progressButton.setProgress();break;case"done":progressButton.setDone();break;default:progressButton.reset()}}},trySaveToDisk:function(){this.metrikaCounter(["click"]);var auth=this.getModel("auth");return auth&&auth.isAuthValid()?void this.saveToDisk():(ph.redirectToPassportAndSave(this.getModel("ticket").getData()),!1)},saveToDisk:function(){if(!this.$node.is(".progress-button_progress, .ghost-button_inactive")){var that=this,state=this.getModel("save-to-disk-state"),photo=this.getModel("photo"),progressButton=nb.block(this.$node.closest(".ghost-button")[0],null,"progress-button");progressButton.setProgress(),state.setRunning();var timestampStart=+new Date,promise=ph.controllers.photo.saveToDisk(photo);promise.then(function(context){progressButton.setDone(),state.setDone();var time=Math.floor((+new Date-timestampStart)/1e3);that.metrikaCounter(["result","success","operation time in seconds",ph.metrika.group(time,[0,5,10,20]),time+": "+context.model.params["job-id"]]);var bubble=ph.errors.showError(context,{messageId:"message_photo-to-disk-success",persistent:!0,data:{photo:photo.getData(),disk:context.model.getData()},returnValue:!0});that.autoCloseBubble(bubble)}),promise.fail(function(context){progressButton.reset(),state.reset();var errorName=context.error.name||"no error name provided";that.metrikaCounter(["result","error",errorName]);var message="out of quota"===errorName?"error_photo-to-disk-out-of-quota":"error_photo-to-disk-failed",bubble=ph.errors.showError(context,{messageId:message,persistent:!0,data:{photo:photo.getData()},returnValue:!0});that.autoCloseBubble(bubble)})}},autoCloseBubble:function(bubble){var bubbleLifetime=3e4;setTimeout(function(){bubble&&bubble.cancel()},bubbleLifetime)},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer","save to disk"])}}),ns.View.define("photo-views",{params:{"author-login":null,"image-id":null,mode:null},models:ph.utils.nsViewModels({views:{"ns-model-changed":{".total":"invalidate"}},photo:{"ns-model-changed":{".flags.blocked":"invalidate"}}}),events:{"ns-view-htmlinit":"onHtmlInit"},methods:{onHtmlInit:function(){var that=this,popupNode=$(".js-stat-popup",this.node)[0];popupNode&&(this.popup=nb.block(popupNode,{show:function(){that.metrikaCounter(["show",ph.metrika.mode()])},"click .js-stat-link":function(){that.metrikaCounter(["click on referrer url"])}}),ph.utils.once(this.popup,"open",function(){that.getReferers()}))},getReferers:function(){var that=this,$statContent=$(".js-stat-content",this.popup.node),$statCounter=$(".js-stat-counter",this.node),updatePopup=function(data){$statContent.replaceWith(ns.renderNode(data,"stat")),that.popup.trigger("move")},updateCounter=function(data){$statCounter.replaceWith(ns.renderNode(data,"stat-counter"))};ph.controllers.photo.views().then(function(details){var data=details.model.getData();data&&no.jpath(".total",data)>=that.getModel("views").get(".total")?(updatePopup(data),updateCounter(data)):updatePopup({error:!0})},function(){updatePopup({error:!0})})},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer","statistics"])}}),ns.View.define("photo-controls",{params:{"author-login":null,"image-id":null,mode:null},models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},photo:{"ns-model-changed":{".flags.hideOriginal":"invalidate"}},"photo-more":{"ns-model-changed":{".contestBindings.contestBinding":"invalidate"}},"blog-code-settings":{"ns-model-changed":"keepValid"},ticket:{"ns-model-changed":"invalidate"},"app-state":{"ns-model-changed":{".is-adult":"invalidate"}}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy","ns-view-show":"onShow","ns-view-hide":"onHide","click .js-slideshow":"toggleSlideshow","click .js-layout-toggle":"toggleLayout","ph-fullscreen-change@show":"handleFullscreenChange","ph-slideshow-stop@init":"onSlideshowStop","ph-slideshow-image-show@show":"onImageShow"},shortcuts:{f:{method:"toggleLayout",name:"layout: toggle",last:!0},e:{method:"toggleExif",name:"exif: toggle",last:!0},space:{method:"toggleSlideshow",name:"slideshow: toggle",last:!0}},methods:{onHtmlInit:function(){var that=this;if(this.getModel("photo").isValid()){var nodes=this._nodes={copyToClipboard:$(".js-copy-link",this.$node)[0],blogCodePopup:$(".js-blog-code-popup",this.$node)[0],blogCode:$(".js-blog-code-popup .js-blog-code",this.$node)[0],photoSharePopup:$(".js-photo-share-popup",this.$node)[0],photoMorePopup:$(".js-photo-more-popup",this.$node)[0],complainPopup:$(".js-complain-popup",this.$node)[0],detailsPopup:$(".js-details-popup",this.$node)[0]};if(ph.loadModule("share").then(this._initShare,this),nodes.copyToClipboard&&(this._clipboard=nb.block(nodes.copyToClipboard),this._clipboard.on("saved",function(){var sharePopup=nb.block(that._clipboard.$node.closest(".popup")[0]);sharePopup.trigger("close"),that.metrikaCounter(["share",ph.metrika.mode(),"copy link"])})),nodes.photoSharePopup&&nb.block(nodes.photoSharePopup,{"click .js-vkontakte":function(){that.metrikaCounter(["share",ph.metrika.mode(),"vk"])},"click .js-odnoklassniki":function(){that.metrikaCounter(["share",ph.metrika.mode(),"odnoklassniki"])},"click .js-facebook":function(){that.metrikaCounter(["share",ph.metrika.mode(),"fb"])},"click .js-twitter":function(){that.metrikaCounter(["share",ph.metrika.mode(),"twitter"])},"click .js-blog-code":function(){that.metrikaCounter(["share",ph.metrika.mode(),"blog code"])}}),nodes.blogCodePopup&&nodes.blogCode){this.blogCodePopup=nb.block(nodes.blogCodePopup);var blogCode=this.blogCode=nb.block(nodes.blogCode);blogCode.setPhoto(this.getModel("photo"))}if(nodes.photoMorePopup&&nb.block(nodes.photoMorePopup,{show:function(){that.metrikaCounter(["show dots menu",ph.metrika.mode()])},"click .js-show-original":function(){that.metrikaCounter(["show original",ph.metrika.mode()])},"click .js-exif":function(){that.metrikaCounter(["EXIF","show",ph.metrika.mode(),"click"])}}),nodes.complainPopup){var handleOption=function(){var options=Array.prototype.slice.call(arguments,0);return function(){$(this).is(":checked")&&that.metrikaCounter(["complain","choose reason"].concat(options))}};this.complainPopup=nb.block(nodes.complainPopup,{show:function(){that.metrikaCounter(["complain","show",ph.metrika.mode()])},"click .js-help":function(){that.metrikaCounter(["complain","help"])},"change .js-copyright :checkbox":handleOption("copyright"),"change .js-pron :checkbox":handleOption("porn"),"change .js-violence :checkbox":handleOption("violent"),"change .js-spam :checkbox":handleOption("spam"),"change .js-other :checkbox":handleOption("other"),"change .js-contest :checkbox":handleOption("contest","against rules")}),ph.utils.once(this.complainPopup,"open",function(){that._initComplainPhoto()})}nodes.detailsPopup&&(this.detailsPopup=nb.block(nodes.detailsPopup,{"click .js-model":ph.metrika.countLink(function(){that.metrikaCounter(["EXIF","go to market"])}),"click .js-model-shots":ph.metrika.countLink(function(){that.metrikaCounter(["EXIF","go to search"])})}),ph.utils.once(this.detailsPopup,"open",function(){that._initDetails()})),this._callbacks={onPhotoChange:function(){that.blogCode&&(that.blogCode.reset(),that.blogCode.updateCode())},onBlogCodeSave:function(){that.blogCodePopup&&(that.blogCodePopup.trigger("close"),that.metrikaCounter(["code for blog","copy code button"]))},onBlogCodeOpen:function(){that.blogCode&&(that.blogCode.applyPrefs(),that.metrikaCounter(["code for blog","show",ph.metrika.mode()]))},onBlogCodeClose:function(){that.blogCode&&blogCode.reset()}}}},toggleExif:function(evt){var popup=this.detailsPopup,more=$(".js-more:visible",this.$node)[0];popup&&more&&(popup.$node.is(":visible")?popup.trigger("close"):(popup.trigger("open",{where:more,how:{where:"center top",what:"center bottom"}}),this.metrikaCounter(["EXIF","show",ph.metrika.mode(),ph.metrika.getEventSummary(evt)])))},onHtmlDestroy:function(){ph.utils.destroyBlocks(this)},onSlideshowStop:function(){var $overlay=this.$node.closest(".overlay");$overlay.removeClass("overlay_slideshow")},handleFullscreenChange:function(evt,isFullscreen){nb.popup.closeAll(),!isFullscreen&&ph.slideshow.isRunning()&&(ph.slideshow.stop(),this.toggleSlideshowButton(),this.metrikaCounter(["slideshow","exit","other"]))},_initDetails:function(){var that=this,$detailsContent=$(".js-details-content",this.detailsPopup.node),updatePopup=function(extendData){var data=no.extend({photo:that.getModelData("photo")},extendData);$detailsContent.replaceWith(ns.renderNode(data,"details")),that.detailsPopup.trigger("move")};ph.controllers.photo.details().then(function(details){updatePopup({exif:details.model.getData()})},function(){updatePopup({error:!0})})},_initComplainPhoto:function(){var that=this,complainForm=nb.block($(".js-complain",this.complainPopup.node)[0]),urlNode=$(".js-link-to-origin .input",this.complainPopup.node)[0];complainForm.on("ph-click-send-complain",function(){var formData=complainForm.getData();ph.controllers.photo.complain(formData).then(function(){complainForm.showResult()},function(details){var context=details.context;"already-exist"===context.error||"already-moderated"===context.error?complainForm.showErrorExist():complainForm.showErrorSend(),"bad-url"===context.error&&ph.errors.showError(context,{messageId:"complain-wrong-url",element:urlNode,popup:{how:{dir:"left"}}})}),that.metrikaCounter(["complain","send"])}),complainForm.on("ph-click-send-one-more",function(){complainForm.resetForm(),complainForm.showForm(),that.metrikaCounter(["complain","send one more"])})},_initShare:function(){var that=this,params=ns.page.current.params,elementId="share_"+params["author-login"]+"-"+params["image-id"]+"-"+params.mode,photoData=that.getModelData("photo"),link=ph.utils.getShareLink(photoData),title=(photoData.title||photoData.fileName)+" на Яндекс.Фотках",quickServices=["vkontakte","odnoklassniki","facebook","twitter"],serviceClasses=["js-vkontakte","js-odnoklassniki","js-facebook","js-twitter"];that._share=new Ya.share({onready:function(instance){var links=$(".b-share__link",instance._block);links.each(function(index,element){$(element).addClass("link").addClass(serviceClasses[index]).append($(element).attr("title"))}),ph.resized()},element:elementId,l10n:"ru",theme:"default",elementStyle:{type:"none",border:!1,quickServices:quickServices},link:link,title:title})},onShow:function(){this.getModel("photo").isValid()&&this.getModel("photo").on("ns-model-changed",this._callbacks.onPhotoChange),this.toggleSlideshowButton(),this.blogCode&&this.blogCodePopup&&(this.blogCode.on("saved",this._callbacks.onBlogCodeSave),this.blogCodePopup.on("open",this._callbacks.onBlogCodeOpen),this.blogCodePopup.on("close",this._callbacks.onBlogCodeClose))},onHide:function(){this.getModel("photo")&&this.getModel("photo").isValid()&&this.getModel("photo").off("ns-model-changed",this._callbacks.onPhotoChange),this.blogCode&&this.blogCodePopup&&(this.blogCode.off("saved",this._callbacks.onBlogCodeSave),this.blogCodePopup.off("open",this._callbacks.onBlogCodeOpen),this.blogCodePopup.off("close",this._callbacks.onBlogCodeClose))},onImageShow:function(){ph.slideshow.isRunning()&&ph.slideshow.run()},isFullscreen:function(){return"fullscreen"===ns.page.current.params.mode},toggleSlideshowButton:function(){if(this.isFullscreen()){var slideshow=ph.slideshow,$slideshowButton=$(".js-slideshow",this.node),$overlay=$slideshowButton.closest(".overlay"),toggle=slideshow.isRunning();$slideshowButton.toggleClass("ghost-button_pause",toggle),$overlay.toggleClass("overlay_slideshow",toggle),ph.keyboard.handleWindowBlur()}},toggleSlideshow:function(evt){var slideshowToggler=$(".js-slideshow:visible",this.$node)[0];if(slideshowToggler){var metrikaEventName;ph.slideshow.isRunning()?(ph.slideshow.stop(),this.exitFullscreen(),metrikaEventName="exit"):(this.enterFullscreen(),ph.slideshow.run(),metrikaEventName="start"),this.metrikaCounter(["slideshow",metrikaEventName,ph.metrika.getEventSummary(evt)]),this.toggleSlideshowButton()}},toggleFullscreen:function(){this.isFullscreen()?this.enterFullscreen():this.exitFullscreen()},toggleLayout:function(evt){nb.popup.closeAll();var params=ns.page.current.params,modeNew="view"===params.mode?"fullscreen":"view",url=ph.utils.generateUrl("photo",no.extend({},params,{mode:modeNew}));this.metrikaCounter(["fullscreen"===modeNew?"go to black mode":"go to white mode",ph.metrika.getEventSummary(evt)]),ns.page.go(url)},enterFullscreen:function(){ph.fullscreen.request()},exitFullscreen:function(){ph.fullscreen.exit()},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}},ph.View),ns.View.define("photo-ears",{events:{"click .js-next":"onClickNext","click .js-prev":"onClickPrev","ph-multiple-photo-album@show":"showEars","ph-single-photo-album@show":"hideEars"},shortcuts:{right:{method:"handleNextPhotoShortcut",name:"view photo: next"},j:{method:"handleNextPhotoShortcut",name:"view photo: next"},left:{method:"handlePrevPhotoShortcut",name:"view photo: prev"},k:{method:"handlePrevPhotoShortcut",name:"view photo: prev"}},methods:{onClickNext:function(evt){this.goToNextPhoto(evt),this.metrikaCounter(["go to next image",ph.metrika.mode(),"click right arrow"])
},onClickPrev:function(evt){this.goToPrevPhoto(evt),this.metrikaCounter(["go to previous image",ph.metrika.mode(),"click left arrow"])},handleNextPhotoShortcut:function(evt){this.goToNextPhoto(evt),this.metrikaCounter(["go to next image",ph.metrika.mode(),ph.metrika.getEventSummary(evt)])},handlePrevPhotoShortcut:function(evt){this.goToPrevPhoto(evt),this.metrikaCounter(["go to previous image",ph.metrika.mode(),ph.metrika.getEventSummary(evt)])},goToNextPhoto:function(evt){this._goToPhoto(evt,"ph-next-photo")},goToPrevPhoto:function(evt){this._goToPhoto(evt,"ph-prev-photo")},showEars:function(){this.$node.removeClass("_hidden")},hideEars:function(){this.$node.toggleClass("_hidden",!0)},_goToPhoto:function(evt,eventName){ns.events.trigger(eventName),evt.preventDefault(),nb.popup.closeAll()},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}},ph.View),ns.View.define("photo-edit",{events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy","ns-view-show":"onShow","click .js-rotate:not(.is-disabled)":"rotateImage","click .js-edit:not(.is-disabled)":"onClickEdit","click .js-delete:not(.is-disabled)":"onClickDelete","click .js-access":"onClickAccess"},models:ph.utils.nsViewModels({photo:{"ns-model-changed":{".flags.porno":"invalidate",".flags.commentsDisabled":"invalidate",".flags.hideOriginal":"invalidate"}},"photo-rights":{"ns-model-changed":{".canEdit":"invalidate",".canEditReason":"invalidate"}},ticket:{"ns-model-changed":"invalidate"},settings:{"ns-model-changed":{".aviaryEnabled":"invalidate"}},"image-box":{"ns-model-changed":"keepValid"}}),methods:{onHtmlInit:function(){this._nodes={$rotateButton:$(".js-rotate",this.$node),$editButton:$(".js-edit",this.$node),$deleteButton:$(".js-delete",this.$node),popupDelete:$(".js-popup-delete",this.$node)[0],popupAccessToggler:$(".js-access",this.$node)[0],$popupAccess:$(".js-popup-access",this.$node),popupAccess:$(".js-popup-access",this.$node)[0]},this.accessPopup&&this.accessPopupOpened&&this.hackMovePopup&&(this.hackMovePopup=!1,this.accessPopup.toggler=this._nodes.popupAccessToggler,this.accessPopup.where=this._nodes.popupAccessToggler,this.accessPopup.trigger("move")),ph.modelsManager.cacheFor(this.getModel("settings"),3e5)},onHtmlDestroy:function(){this.accessPopup&&this.accessPopupOpened&&(this.hackMovePopup=!0)},onShow:function(){this.accessPopup&&this.accessPopup.$node.is(":visible")&&this.$node.addClass("with-menu")},rotateImage:function(){var photo=this.getModel("photo");ns.events.trigger("ph-photo-saving"),ph.keyboard.disable();var promise=ph.controllers.photo.rotateImage(photo);promise.always(function(){ph.keyboard.enable(),ns.events.trigger("ph-photo-save-done")}),promise.then(function(){ns.events.trigger("ph-slider-redraw"),ph.redraw()}),promise.fail(function(details){var context=details.context;ph.errors.showError(context,{messageId:"error_photo-rotate-failed",persistent:!0,popup:{how:{dir:"bottom"}},data:{photo:photo.getData()}})}),this.metrikaCounter(["rotate image"])},onClickDelete:function(){var that=this;if(!this.removePopup)var removePopup=this.removePopup=nb.block(this._nodes.popupDelete,{show:function(){removePopup.state={yes:!1,cancelled:!1,x:!1}},hide:function(){removePopup.state.counted||that.countImageDelete(removePopup.state)},"click .js-cancel":function(){removePopup.state.cancelled=!0},"click .js-x":function(){removePopup.state.x=!0},"click .js-delete-agree":function(){var photo=that.getModel("photo"),promise=ph.controllers.photo.remove(photo);return removePopup.state.yes=!0,that.countImageDelete(removePopup.state),removePopup.state.counted=!0,promise.then(function(details){if(removePopup.trigger("close"),details.nextPhotoParams){var nextPhotoUrl=ph.utils.generateUrl("photo",no.extend({},ns.page.current.params,details.nextPhotoParams));ns.page.go(nextPhotoUrl,"replace").then(function(){ns.events.trigger("ph-slider-sync")})}else ns.events.trigger("ph-close-viewer")}),promise.fail(function(details){removePopup.trigger("close"),ph.errors.showError(details.context,{messageId:"error_photo-remove-failed",data:{photo:that.getModelData("photo")},persistent:!1})}),!1}})},onClickAccess:function(){var that=this;this.accessPopup||(this.accessPopup=nb.block(this._nodes.popupAccess,{open:function(){that.$node.addClass("with-menu"),that.accessPopupOpened=!0},close:function(){that.$node.removeClass("with-menu"),that.accessPopupOpened=!1},show:function(){that.metrikaCounter(["change privacy","show"])},"change .js-is-pron":function(evt){that.setPhotoParam("porno",evt.target)},"change .js-enable-comments":function(evt){that.setPhotoParam("disable-comments",evt.target)},"change .js-enable-print":function(evt){that.setPhotoParam("hide-orig",evt.target)},"click .js-invalidate-url":function(evt){that.invalidateLinks(evt.target),that.metrikaCounter(["change privacy","change url"])}}),this.initChangeUrlHelpCounter())},setPhotoParam:function(name,node){var $menuItem=$(node).closest(".toggler");if(!$menuItem.hasClass("is-disabled")){$menuItem.addClass("is-disabled");var promise=ph.controllers.photo.setParam(name,this.getModel("photo"),this.getModel("photo-rights"));promise&&(promise.always(function(){$menuItem.removeClass("is-disabled"),ph.redraw()}),this.countPropChange(name,$(node).is(":checked")))}},invalidateLinks:function(node){var that=this;this._nodes.$editButton.toggleClass("is-disabled",!0),this._nodes.$rotateButton.toggleClass("is-disabled",!0),this._nodes.$deleteButton.toggleClass("is-disabled",!0);var progressButton=nb.block($(node).closest(".menu-row")[0],null,"progress-button");progressButton.setPopup(that.accessPopup),progressButton.setProgress();var promise=ph.controllers.photo.invalidateLinks(this.getModel("photo"));promise.then(function(){progressButton.setDone(),ns.events.trigger("ph-slider-redraw"),ph.redraw()}),promise.fail(function(){progressButton.reset()})},beforeEditAsk:function(promise){this.beforeEditPopup&&(this.beforeEditPopup.destroy(),this.beforeEditPopup=null);var renderData={params:ns.page.current.params,photo:this.getModelData("photo")},node=ns.renderNode(renderData,"photo-before-edit-dialog"),willContinue=!1,beforeEditPopup=this.beforeEditPopup=nb.block(node,{"click .js-continue":function(){return willContinue=!0,beforeEditPopup.trigger("close"),promise.fulfill(),!1},"click .js-cancel":function(){return beforeEditPopup.trigger("close"),!1},close:function(){willContinue||promise.reject({name:"cancelled"})}});beforeEditPopup.trigger("open",{})},onClickEdit:function(){var that=this,photo=this.getModel("photo"),params=photo.params;if(!this.editorIsActive){ns.events.trigger("ph-photo-saving"),this.editorIsActive=!0;var openTime=+new Date;this.metrikaCounter(["edit in aviary","show aviary"]);var canEditPromise=ph.controllers.photo.canEditImage(photo),loadAviaryModulePromise=new Vow.Promise,editorFullyLoaded=new Vow.Promise;canEditPromise.then(function(details){var origSize=details.model&&details.model.get(".hiresDimension");loadAviaryModulePromise.sync(ph.loadModule("aviary")),loadAviaryModulePromise.then(function(editor){var sizeInfo=ph.utils.getClosestSize(that.getModelData("photo"),that.getModel("image-box").getDimensions()),sizeName=(sizeInfo&&sizeInfo.sizeName||"xl").toLowerCase(),urlParams=no.extend({},params,{size:sizeName}),imageProxyUrl=ph.utils.generateUrl("editor-photo",urlParams),imageProxyId="image-proxy-"+params["author-login"]+"-"+params["image-id"],onClose=function(evt,actions){actions?that.saveImage(photo,actions):ph.keyboard.enable(),editor.off("close",onClose);var time=Math.floor((+new Date-openTime)/1e3);that.metrikaCounter(["edit in aviary","time in aviary",ph.metrika.group(time,[0,5,15,60,180]),time])};ph.keyboard.disable(),editor.on("close",onClose),editorFullyLoaded.sync(editor.load(imageProxyId,imageProxyUrl,origSize))})}),canEditPromise.fail(function(details){var context=details.context;ph.errors.showError(context,{messageId:"error_image-edit-unavailable",persistent:!0,data:{photo:photo.getData()}})}),Vow.all([canEditPromise,loadAviaryModulePromise,editorFullyLoaded]).always(function(){ns.events.trigger("ph-photo-save-done"),that.editorIsActive=!1})}},saveImage:function(photo,actions){var promise;ns.events.trigger("ph-photo-saving"),promise=ph.controllers.photo.editImage(photo,actions,this.beforeEditAsk.bind(this),this.countSave.bind(this)),promise.always(function(){ph.keyboard.enable(),ns.events.trigger("ph-photo-save-done")}),promise.then(function(){ns.events.trigger("ph-slider-redraw"),ph.redraw()}),promise.fail(function(details){var errorName=no.jpath(".error.name",details);if("aborted"!==errorName){var context=details.context;ph.errors.showError(context,{messageId:"error_image-edit-failed",persistent:!0,data:{photo:photo.getData()}})}})},countSave:function(userAnswer){var userAnswerValue="no warning";userAnswer===!0?userAnswerValue="warning yes":userAnswer===!1&&(userAnswerValue="warning no"),this.metrikaCounter(["edit in aviary","save changes",userAnswerValue])},countPropChange:function(name,isSet){var hash={porno:["uncheck 18+","check 18+"],"disable-comments":["forbid comments","allow comments"],"hide-orig":["hide orig","show orig"]};this.metrikaCounter(["change privacy",hash[name][isSet?1:0]])},countImageDelete:function(info){var contextInfo=ph.metrika.getContextInfo(),mParams=["delete image","from context",contextInfo.name];contextInfo.more&&mParams.push(contextInfo.more),mParams=mParams.concat(info.yes?["yes",ph.metrika.getImageFormat(this.getModel("photo"))]:["no",info.cancelled?"button":info.x?"x":"other",ph.metrika.getImageFormat(this.getModel("photo"))]),this.metrikaCounter(mParams)},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"]),initChangeUrlHelpCounter:function(){var that=this,countShowHelpTimer=null,countShowHelp=function(){that.metrikaCounter(["change privacy","show change url help"]),countShowHelpTimer=null};this._nodes.$popupAccess.on("mouseenter",".js-invalidate-url-help",function(){countShowHelpTimer=setTimeout(countShowHelp,1e3)}),this._nodes.$popupAccess.on("mouseleave",".js-invalidate-url-help",function(){countShowHelpTimer&&(clearTimeout(countShowHelpTimer),countShowHelpTimer=null)})}}}),ns.View.define("photo-flags",{models:ph.utils.nsViewModels({photo:{"ns-model-changed":{".flags.porno":"invalidate"}}})}),ns.View.define("send-to-contest",{params:{"author-login":null,"image-id":null,mode:null},models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},photo:{"ns-model-changed":{".title":"invalidate",".access.privilege":"invalidate"}},"photo-more":{"ns-model-changed":{".contestBindings":"invalidate"}},tags:{"ns-model-changed":"invalidate"},"photo-rights":{"ns-model-changed":{".activeContest":"invalidate"}},ticket:{"ns-model-changed":"invalidate"}}),events:{"ns-view-htmlinit":"onHtmlInit","ns-view-htmldestroy":"onHtmlDestroy"},methods:{onHtmlInit:function(){var that=this;this._nodes={$popupToggler:this.$node,sendToContest:$(".js-send-to-contest",this.node)[0],revokeFromContest:$(".js-revoke-from-contest",this.node)[0]},this._nodes.sendToContest&&(this.sendBlock=nb.block(this._nodes.sendToContest,{send:this.sendToContest.bind(this)},"send-to-contest"),this.sendBlockPopup=nb.block(this._nodes.sendToContest,{open:this.setFields.bind(this),show:function(){that.metrikaCounter(["send to contest","show",ph.metrika.mode()])}},"islands-popup")),this._nodes.revokeFromContest&&(this.revokeBlock=nb.block(this._nodes.revokeFromContest,{revoke:this.revokeFromContest.bind(this)},"revoke-from-contest"),this.revokeBlockPopup=nb.block(this._nodes.revokeFromContest,{show:function(){that.metrikaCounter(["revoke from contest","show",ph.metrika.mode()])}},"islands-popup"))},onHtmlDestroy:function(){this.sendBlock&&this.sendBlock.destroy(),this.sendBlockPopup&&this.sendBlockPopup.destroy(),this.revokeBlock&&this.revokeBlock.destroy(),this.revokeBlockPopup&&this.revokeBlockPopup.destroy()},setFields:function(){this.sendBlock.setFields({title:this.getModel("photo").get(".title"),tags:this.getModel("tags").get(".tags.tag.name")})},sendToContest:function(evt,data){var that=this;this.sendBlockPopup.trigger("close");var promise=ph.controllers.photo.sendToContest(data,this.getModel("photo"),this.getModel("tags"));promise.always(ph.redraw),promise.fail(function(details){var context=details.context;ph.errors.showError(context,{messageId:"error_send-to-contest",persistent:!0,data:{photo:that.getModelData("photo")},ok:function(){ph.actions.restorePage(context).then(ph.redraw).then(function(){that._nodes.$popupToggler.trigger("click")})},cancel:function(){ph.redraw()}})})},revokeFromContest:function(evt,contestId){var photoData=this.getModelData("photo");this.revokeBlockPopup.trigger("close");var promise=ph.controllers.photo.revokeFromContest(contestId,this.getModel("photo"));promise.then(function(){ph.redraw()}),promise.fail(function(details){var context=details.context;ph.redraw(),ph.errors.showError(context,{messageId:"error_revoke-from-contest",persistent:!0,data:{photo:photoData},ok:function(){context.pageLeft&&ph.actions.restorePage(context).then(ph.redraw)}})})},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}}),function(){ph.R.Comments={},ph.R.Comments.showError=function(context,errorId,node){ph.errors.showError(context,{messageId:errorId,element:node,popup:{how:{dir:"left"}}})},ph.R.Comments.getAvatarUrl=function(uid){return ph.utils.getAvatarUrl(uid)},function(){var cx=React.addons.classSet,getAvatarUrl=ph.R.Comments.getAvatarUrl,CommentBase={getClassSet:function(){var comment=this.props.comment.getData();return cx({comment:!0,"comment-with-back":!0,comment_deleted:comment.deleted,comment_thread:this.props.isThreadStart,comment_sub:comment.level>0,"comment_from-moderator":!comment.deleted&&comment.immortal,"comment_commenter-deleted":!comment.deleted&&comment.commenter&&comment.commenter.deleted,"comment_commenter-banned":this.props.isCommenterBanned,"comment_is-current":this.props.isCurrent})},getFlags:function(){var comment=this.props.comment.getData(),details=this.props.details,authorUid=details.authorUid,currentUserUid=details.currentUserUid,commenterUid=comment.commenter?comment.commenter.uid:-1,isAuthor=currentUserUid==authorUid;return{canDelete:(currentUserUid==commenterUid||isAuthor)&&!comment.immortal,canBan:isAuthor&&comment.commenter&&commenterUid!=currentUserUid,isCommenter:currentUserUid==commenterUid,isAuthor:isAuthor}}},Comment=React.createClass({displayName:"Comment",mixins:[CommentBase],componentDidMount:function(){this.collapseComment(),this.props.isCurrent&&this.props.isReplyMode&&this.handleReplyClick()},componentWillUnmount:function(){$(this.refs.text.getDOMNode()).trigger("destroy")},collapseComment:function(){if(!this.initialCollapseDone){this.initialCollapseDone=!0;var that=this,$commentBodyParentNode=$(this.refs.text.getDOMNode()),$commentBodyNode=$commentBodyParentNode.find(".js-comment-body"),$expander=$(".js-expand",$commentBodyParentNode).removeClass("is-hidden");$commentBodyNode.dotdotdot({ellipsis:" ...",wrap:"word",fallbackToLetter:!0,height:100,after:$expander,callback:function(isTruncated){$expander=$(".js-expand",$commentBodyParentNode),isTruncated?$expander.on("click",function(){$commentBodyNode.trigger("destroy"),$(this).addClass("is-hidden"),that.props.onCommentExpand()}):$expander.addClass("is-hidden")}})}},handleReplyClick:function(evt){this.props.onClickReply(this.props.comment,this.props.threadRefName),evt&&this.props.metrikaCounter(["comments","reply","click on reply"])},handleDeleteClick:function(){this.props.onClickDelete(this.props.comment);var flags=this.getFlags();this.props.metrikaCounter(["comments","delete",this.props.comment.get(".parentId")?"reply":"comment",flags.isCommenter?"by comment owner":flags.isAuthor?"by image owner":"UNKNOWN"])},getCommenterInfo:function(comment){var commenter=comment.get(".commenter");if(!commenter)return{name:""};var commenterName=commenter.displayName||commenter.login||comment.get(".login")||"",commenterUrl=null;return commenter&&!commenter.deleted&&(commenterUrl=ph.utils.generateUrl("user-profile",{"author-login":commenter.login})),{name:commenterName,url:commenterUrl}},handleCommenterNameClick:ph.metrika.countLink(function(){this.props.metrikaCounter(["go to commenter page","click on name"])}),handleCommenterImageClick:ph.metrika.countLink(function(){this.props.metrikaCounter(["go to commenter page","click on userpic"])}),render:function(){var comment=this.props.comment.getData(),commenterDeleted=no.jpath(".commenter.deleted",comment),avatarUrl=getAvatarUrl(commenterDeleted?null:no.jpath(".commenter.uid",comment)),commenterInfo=this.getCommenterInfo(this.props.comment),parentCommenerInfo=this.props.parentComment?this.getCommenterInfo(this.props.parentComment):null,commentUrl=this.props.generateCommentUrl(comment.id);return React.createElement("div",{className:this.getClassSet(),"data-comment-id":comment.id},commenterInfo.url?React.createElement("a",{className:"userpic ns-action",href:commenterInfo.url,onClick:this.handleCommenterImageClick,"data-click-action":"metrika-count","data-dblclick-action":"metrika-count",style:{backgroundImage:"url("+avatarUrl+")"}}):React.createElement("div",{className:"userpic",style:{backgroundImage:"url("+avatarUrl+")"}}),React.createElement("div",{className:"comment__body"},this.getFlags().canDelete?React.createElement("div",{className:"comment__delete",onClick:this.handleDeleteClick,title:"Удалить комментарий"}):null,React.createElement("div",{className:"comment__author-container"},React.createElement("span",{className:"comment__author"},commenterInfo.url?React.createElement("a",{className:"unlike-link ns-action",href:commenterInfo.url,onClick:this.handleCommenterNameClick,"data-click-action":"metrika-count","data-dblclick-action":"metrika-count"},commenterInfo.name):commenterInfo.name),parentCommenerInfo?React.createElement("span",{className:"comment__parent-author",dangerouslySetInnerHTML:{__html:"&nbsp;&rarr; "+ns.entityify(parentCommenerInfo.name)}}):null),React.createElement("div",{className:"comment__text",ref:"text"},React.createElement("span",{className:"js-comment-body",dangerouslySetInnerHTML:{__html:ph.utils.nl2br(ph.utils.escape(comment.content))}}),React.createElement("span",{className:"js-expand is-hidden"}," ",React.createElement("span",{className:"link",title:"Показать комментарий полностью"},"Ещё"))),React.createElement("div",{className:"comment__footer"},React.createElement("a",{className:"comment__date ns-action",href:commentUrl,"data-click-action":"fix-url","data-params":JSON.stringify({url:commentUrl})},ph.utils.formatDateRelative(comment.updateTime)),this.props.canReply?React.createElement("span",{className:"comment__reply"},React.createElement("a",{className:"link js-comment-reply",onClick:this.handleReplyClick},"Ответить")):null)))}}),CommentDeleted=React.createClass({displayName:"CommentDeleted",mixins:[CommentBase],handleBanClick:function(){this.props.comment.set(".commenter-ban-in-progress",!0),this.forceUpdate(),this.props.onClickBan(this.props.comment),this.props.metrikaCounter(["comments","block user"])},render:function(){var canBan=this.getFlags().canBan,comment=this.props.comment.getData(),banInProgress=comment["commenter-ban-in-progress"],commenterBanned=this.props.isCommenterBanned,deletedRecently=comment["deleted-recently"],showBanLink=canBan&&deletedRecently&&!banInProgress&&!commenterBanned,showBanInProgress=banInProgress,showBanned=commenterBanned,deletedHeaderClasses=cx({"comment-deleted-header":!0,"comment-deleted-header_extra":showBanLink||showBanInProgress||showBanned});return React.createElement("div",{className:this.getClassSet(),"data-comment-id":comment.id},React.createElement("div",{className:"comment__body"},React.createElement("div",{className:"comment__text"},React.createElement("span",{className:deletedHeaderClasses},"Комментарий удалён"),showBanLink?React.createElement("span",{className:"comment__action unlike-link",onClick:this.handleBanClick},"Заблокировать автора"):null,showBanInProgress?React.createElement("span",{className:"comment__action progress-button_progress"},"Заблокировать автора"):null,showBanned?React.createElement("span",{className:"comment__action progress-button_done"},"Автор заблокирован"):null)))}});ph.R.Comments.Comment=Comment,ph.R.Comments.CommentDeleted=CommentDeleted}(),function(){var cx=React.addons.classSet,Comment=ph.R.Comments.Comment,CommentDeleted=ph.R.Comments.CommentDeleted,CommentsThread=React.createClass({displayName:"CommentsThread",getDefaultProps:function(){return{showExpandedCount:2}},getInitialState:function(){return{collapsed:this.props.comments.length>this.props.showExpandedCount&&!this.props.expanded}},expandThread:function(){this.setState({collapsed:!1},this.onThreadExpand)},onThreadExpand:function(){this.props.onThreadExpand(this.props.comments.length)},render:function(){for(var isThreadStart,isLastInThread,isAuthorComment,isCurrentUserComment,isRestComment,comment,commentId,commenterUid,commentHash,parentComment,isCommenterBanned,isReplyPermitted,canReply,that=this,threadRefName=this.props.threadRefName,commentsTotal=this.props.comments.length,details=this.props.details,currentCommentId=this.props.currentCommentId,renderCount=this.state.collapsed?this.props.showExpandedCount:commentsTotal,isThread=commentsTotal>1,collapsedCount=commentsTotal-this.props.showExpandedCount,collapsed=this.state.collapsed&&commentsTotal>this.props.showExpandedCount,authorUid=details.authorUid,currentUserUid=details.currentUserUid,podCommentPermit=this.props.podCommentPermit,threadHash=this.props.threadHash,comments=[],i=0;renderCount>i&&commentsTotal>i;i++)comment=this.props.comments[i],commentId=comment.get(".id"),commenterUid=comment.get(".commenter.uid"),parentComment=this.props.commentsHash[comment.get(".parentId")],isCommenterBanned=this.props.banList[commenterUid],commentHash=threadHash[commentId],isThreadStart=isThread&&0===i,isLastInThread=i===commentsTotal-1,isAuthorComment=commenterUid==authorUid,isCurrentUserComment=commenterUid==currentUserUid,isRestComment=!isAuthorComment&&!isCurrentUserComment,isReplyPermitted="all"===podCommentPermit||"reply"===podCommentPermit&&commentHash.isPodGood&&commentHash.isAuthorComment&&!commentHash.hasReplies,canReply=details.canComment&&isReplyPermitted,comments.push(comment.get(".deleted")?React.createElement(CommentDeleted,{key:commentId,comment:comment,details:details,isThreadStart:isThreadStart,isCommenterBanned:isCommenterBanned,onClickBan:that.props.onClickBan,metrikaCounter:this.props.metrikaCounter}):React.createElement(Comment,{key:commentId,comment:comment,details:details,threadRefName:threadRefName,isThreadStart:isThreadStart,isCommenterBanned:isCommenterBanned,canReply:canReply,currentCommentId:currentCommentId,isCurrent:commentId==currentCommentId,isReplyMode:this.props.isReplyMode,parentComment:parentComment,onClickReply:that.props.onClickReply,onClickDelete:that.props.onClickDelete,onCommentExpand:that.props.onCommentExpand,generateCommentUrl:this.props.generateCommentUrl,metrikaCounter:this.props.metrikaCounter}));var threadClasses=cx({"comments-thread":!0,"comments-thread_with-indention":this.props.indent});return React.createElement("div",{className:threadClasses},comments,collapsed?React.createElement("div",{className:"comment comment-with-back comment_sub"},React.createElement("div",{className:"comment__body"},React.createElement("div",{className:"comment__text link",onClick:this.expandThread},"Показать ещё ",ph.utils.plural(collapsedCount,"","$0 ответ","$0 ответа","$0 ответов")))):null)}});ph.R.Comments.CommentsThread=CommentsThread}(),function(){var showError=ph.R.Comments.showError,Captcha=React.createClass({displayName:"Captcha",getResponse:function(){return(this.refs.reply.getDOMNode().value||"").trim()},setFocus:function(){$(this.refs.reply.getDOMNode()).focus()},clearInput:function(){$(this.refs.reply.getDOMNode()).val("")},showError:function(context,errorId){showError(context,errorId,this.refs.reply.getDOMNode())},handleCaptchaImageClick:function(){this.props.reloadCaptcha(),this.props.metrikaCounter(["comments","captcha","reload by click"])},handleMouseDown:function(){this.props.metrikaCounter(["comments","captcha","focus by click"])},render:function(){return React.createElement("div",{className:"comment__body comment__body_editor"},React.createElement("div",{className:"captcha-row captcha-row_pic"},React.createElement("img",{className:"captcha-image",src:this.props.data.imageurl,alt:"Картинка с цифрами",title:"Показать другую картинку",onClick:this.handleCaptchaImageClick})),React.createElement("div",{className:"captcha-row captcha-row_field"},React.createElement("input",{className:"small-input",type:"text",placeholder:"Введите цифры",ref:"reply",onKeyDown:this.props.handleCaptchaResponseKeyDown,onMouseDown:this.handleMouseDown,maxLength:"20"})))}});ph.R.Comments.Captcha=Captcha}(),function(){var LoadMoreBase={renderExpander:function(label){return React.createElement("div",{className:"comment comment_expander"},React.createElement("div",{className:"comment__left"},this.props.showProgress?React.createElement("span",{className:"progress-button_progress"},"Загрузка комментариев"):React.createElement("span",{className:"unlike-link",onClick:this.props.onClick},label)),React.createElement("div",{className:"comment__right comment_expander_count"},this.props.count+" из "+this.props.total))}},LoadPrevComments=React.createClass({displayName:"LoadPrevComments",mixins:[LoadMoreBase],render:function(){return this.renderExpander("Показать предыдущие")}}),LoadNextComments=React.createClass({displayName:"LoadNextComments",mixins:[LoadMoreBase],render:function(){return this.renderExpander("Показать следующие")}});ph.R.Comments.LoadPrevComments=LoadPrevComments,ph.R.Comments.LoadNextComments=LoadNextComments}(),function(){var cx=React.addons.classSet,StickyPanel=React.createClass({displayName:"StickyPanel",getInitialState:function(){return{stickyAds:null,stickyEditor:!1,editorMinHeight:0}},componentDidMount:function(){this.updateHeight()},componentDidUpdate:function(){this.updateHeight()},updateHeight:function(){var innerHeight=$(this.refs.inner.getDOMNode()).outerHeight();this.state.editorMinHeight!=innerHeight&&this.setState({editorMinHeight:innerHeight},this.stickEditor)},stickEditor:function(){var adsOffset=this.getAdsOffset(),$placeholder=$(this.refs.placeholder.getDOMNode()),top=$placeholder.offset().top,height=$placeholder.outerHeight(),editorPlaceholderBottom=top+height+adsOffset,viewportHeight=this.getViewportHeight(),stickyEditor=editorPlaceholderBottom-viewportHeight>=1;this.state.stickyEditor!==stickyEditor&&this.setState({stickyEditor:stickyEditor})},getAdsOffset:function(){var stickyAds,adsOffsetConst=150;return stickyAds=null==this.state.stickyAds?!0:this.state.stickyAds,stickyAds?adsOffsetConst:0},toggleStickyAds:function(stickyAds){this.state.stickyAds!==stickyAds?this.setState({stickyAds:stickyAds},this.stickEditor):this.stickEditor()},getEditorHeight:function(){return this.state.editorMinHeight},getViewportHeight:function(){var $viewport=$(this.getDOMNode()).closest(".js-panel");return $viewport.height()},render:function(){var classes=cx({"comment-editor-placeholder":!0,"with-ads":this.state.stickyAds,fixed:this.state.stickyEditor,"with-message":this.props.withMessage});return React.createElement("div",{className:classes,ref:"placeholder",style:{minHeight:this.state.editorMinHeight}},React.createElement("div",{className:"comment-editor-wrapper"},React.createElement("div",{className:"comment-editor-cover",ref:"inner"},this.props.children)))}});ph.R.Comments.StickyPanel=StickyPanel}(),function(){var getSpecialKeyName=function(evt){return evt.altKey?"alt":evt.ctrlKey?"ctrl":evt.shiftKey?"shift":evt.metaKey?"meta":"UNKNOWN"},cx=React.addons.classSet,showError=ph.R.Comments.showError,getAvatarUrl=ph.R.Comments.getAvatarUrl,Captcha=ph.R.Comments.Captcha,ReplyForm=React.createClass({displayName:"ReplyForm",getInitialState:function(){return{message:"",disabled:!1}},setReplyComment:function(comment,threadRefName){this.setState({commentToReply:comment,commentToReplyThreadRefName:threadRefName}),setTimeout(function(){this.setFocus()}.bind(this),1)},handleChange:function(evt){this.setState({message:evt.target.value})},showCaptcha:function(captchaData,callback){callback=callback||function(){},this.setState({captcha:captchaData},callback),this.clearCaptchaReplyInput(),this.props.metrikaCounter(["comments","captcha","show"])},handleCommentKeyDown:function(evt){var info=this.getKeyboardInfo(evt);info.isEnter&&!info.isSpecialPressed?(evt.preventDefault(),this.onReply("keyboard")):info.isEnter&&this.props.metrikaCounter(["comments",this.state.commentToReply?"reply":"new comment","add new line",getSpecialKeyName(evt)+" + enter"])},handleCaptchaResponseKeyDown:function(evt){var info=this.getKeyboardInfo(evt);info.isEnter&&(evt.preventDefault(),this.onReply(),this.props.metrikaCounter(["comments","captcha","enter"]))},getKeyboardInfo:function(evt){return{isEnter:13===evt.which,isSpecialPressed:evt.altKey||evt.ctrlKey||evt.metaKey||evt.shiftKey}},handleReplyButtonClick:function(evt){evt.stopPropagation(),this.onReply("button")},isCommentEmpty:function(){return!this.state.message.trim()},onReply:function(via){if(!this.isCommentEmpty()){var data={commentBody:this.state.message.trim()};if(this.state.captcha&&(data.captchaInfo={key:this.state.captcha.token,reply:this.refs.captcha.getResponse()},!data.captchaInfo.reply))return void this.setFocusOnCaptcha();this.setState({disabled:!0}),via&&this.props.metrikaCounter(["comments",this.state.commentToReply?"reply":"new comment",this.state.commentToReply?"post reply":"post comment",via]),this.props.onReply(data,this.state.commentToReply)}},cancelReply:function(){this.props.onCancelReply(),this.setState({commentToReply:null,commentToReplyThreadRefName:null}),this.props.metrikaCounter(["comments","reply","cancel reply via x"])},enable:function(){this.setState({disabled:!1})},reset:function(){var newState={captcha:null,disabled:!1,message:"",commentToReply:null,commentToReplyThreadRefName:null};this.setState(newState,this.resetInputHeight)},resetInputHeight:function(){if(this.refs.input){var block=nb.block(this.refs.input.getDOMNode(),null,"textarea-autoheight");block&&block.updateHeight()}},setFocus:function(){this.refs.input&&this.refs.input.getDOMNode().focus()},setFocusOnCaptcha:function(){this.refs.captcha&&(this.refs.captcha.clearInput(),this.refs.captcha.setFocus())},clearCaptchaReplyInput:function(){this.refs.captcha&&this.refs.captcha.clearInput()},showError:function(context,errorId,elementName){var ref=this.refs[elementName];ns.assert(ref,"comments",'Unknown element "%s"',elementName),"captcha"===elementName?this.refs.captcha&&this.refs.captcha.showError(context,errorId):showError(context,errorId,ref.getDOMNode())},handleMouseDown:function(){this.props.metrikaCounter(["comments",this.state.commentToReply?"reply":"new comment","focus by click"])},render:function(){return this.props.message?this.renderMessage():this.renderForm()},renderMessage:function(){var messageClasses=cx({comment:!0,comments_message:!this.props.isPodMessage,comments_message_long:this.props.isPodMessage});return React.createElement("div",{key:"reply-form-message",className:messageClasses,dangerouslySetInnerHTML:{__html:this.props.message}})},renderForm:function(){var replyToName=null;this.state.commentToReply&&(replyToName=this.state.commentToReply.get(".commenter.displayName || .commenter.login || .login")||"");var enableAddButton=!this.state.disabled&&!this.isCommentEmpty(),editorClasses=cx({"editor-body":!0,"editor_reply-mode":!!replyToName}),addButtonClasses=cx({"comment_add-button":!0,"comment_add-button_enabled":enableAddButton});return React.createElement("div",{className:"comment comment_editor"},React.createElement("div",{className:"userpic",style:{backgroundImage:"url("+getAvatarUrl(this.props.details.currentUserUid)+")"}}),React.createElement("label",{className:editorClasses},replyToName?React.createElement("div",{className:"comment-reply-name"},React.createElement("span",null,"Кому: "+replyToName+" "),React.createElement("span",{className:"comment-reply-name-remove",onClick:this.cancelReply})):null,React.createElement("label",{className:"small-field comment-text",ref:"inputContainer"},React.createElement("span",{className:"field-content"},React.createElement("textarea",{className:"input-controller",ref:"input",placeholder:"Оставьте комментарий","data-nb":"textarea-autoheight",rows:"1",value:this.state.message,onFocus:this.props.onReplyInputFocus,onKeyDown:this.handleCommentKeyDown,onKeyUp:this.props.handleHeightChange,onChange:this.handleChange,onMouseDown:this.handleMouseDown,disabled:this.state.disabled}),React.createElement("span",{className:"input-view",dangerouslySetInnerHTML:{__html:"&nbsp;"}})),React.createElement("div",{className:addButtonClasses,title:"Добавить комментарий",onClick:enableAddButton?this.handleReplyButtonClick:null},React.createElement("span",{className:"comment_add-icon"})))),this.state.captcha?React.createElement(Captcha,{data:this.state.captcha,ref:"captcha",reloadCaptcha:this.props.reloadCaptcha,handleCaptchaResponseKeyDown:this.handleCaptchaResponseKeyDown,metrikaCounter:this.props.metrikaCounter}):null)
}});ph.R.Comments.ReplyForm=ReplyForm}();var cx=React.addons.classSet,CommentsThread=ph.R.Comments.CommentsThread,LoadNextComments=ph.R.Comments.LoadNextComments,LoadPrevComments=ph.R.Comments.LoadPrevComments,StickyPanel=ph.R.Comments.StickyPanel,ReplyForm=ph.R.Comments.ReplyForm,Comments=React.createClass({displayName:"Comments",getInitialState:function(){return{nextCount:this.props.initialState.nextCount,prevCount:this.props.initialState.prevCount,currentCommentId:this.props.initialState.currentCommentId,isReplyMode:this.props.initialState.setReplyMode,podCommentPermit:this.props.details.podCommentPermit,loadingNext:!1,loadingPrev:!1}},componentDidMount:function(){this.state.currentCommentId&&this.scrollToComment(this.state.currentCommentId)},componentDidUpdate:function(){this._restoreScrollPosition(),this.stickEditor(),this.props.onRedraw()},hasNextCommentsCollapsed:function(){return this.state.nextCount>0},stickEditor:function(){this.refs.panel&&this.refs.panel.stickEditor()},toggleStickyAds:function(toggle){this.refs.panel&&this.refs.panel.toggleStickyAds(toggle)},updateEditorHeight:function(){this.refs.panel&&this.refs.panel.updateHeight()},onClickReply:function(comment,threadRefName){this.refs.replyForm&&(this.refs.replyForm.setReplyComment(comment,threadRefName),this.setState({currentCommentId:comment.get(".id"),isReplyMode:!0}))},onCancelReply:function(){this.setState({currentCommentId:null,isReplyMode:!1})},resetReplyForm:function(){this.refs.replyForm&&this.refs.replyForm.reset(),this.setState({currentCommentId:null,isReplyMode:!1})},enableReplyForm:function(){this.refs.replyForm&&this.refs.replyForm.enable()},onClickDelete:function(comment){this.props.onDelete(comment)},onClickBan:function(comment){this.props.onBan(comment)},onThreadExpand:function(commentsCount){this.stickEditor(),this.props.metrikaCounter(["comments","expand thread",ph.metrika.group(commentsCount,[1,2,3,4,5,10,20]),commentsCount])},onCommentExpand:function(){this.stickEditor(),this.props.metrikaCounter(["comments","expand comment"])},getThreads:function(){for(var comment,commentId,parentCommentId,commenterUid,commentHash,parentCommentHash,prevAuthorCommentHash,prevCurrentUserCommentHash,isRootComment,isLastComment,isCommenterBanned,isCommentDeleted,isAuthorComment,isCurrentUserComment,isPodGood,comments=this.props.comments.models,authorUid=this.props.details.authorUid,currentUserUid=this.props.details.currentUserUid,currentCommentId=this.state.currentCommentId,threads=[],banList={},prevThread=null,thread={id:null,comments:[],commentsHash:{},threadHash:{},isFirst:!0,isLast:!1,expanded:!1},i=0;i<comments.length;i++)comment=comments[i],commentId=comment.get(".id"),parentCommentId=comment.get(".parentId"),commenterUid=comment.get(".commenter.uid"),isCommenterBanned=comment.get(".commenterBanned"),isCommentDeleted=comment.get(".deleted"),parentCommentHash=thread.threadHash[parentCommentId],isRootComment=!parentCommentId,isLastComment=i===comments.length-1,isAuthorComment=commenterUid==authorUid,isCurrentUserComment=commenterUid==currentUserUid,isRootComment&&(prevAuthorCommentHash=null,prevCurrentUserCommentHash=null),isPodGood=!parentCommentHash&&isCurrentUserComment||parentCommentHash&&parentCommentHash.isPodGood&&parentCommentHash.isAuthorComment&&isCurrentUserComment||parentCommentHash&&parentCommentHash.isPodGood&&parentCommentHash.isCurrentUserComment&&isAuthorComment,commentHash={hasReplies:!1,isAuthorComment:isAuthorComment,isCurrentUserComment:isCurrentUserComment,isPodGood:isPodGood},parentCommentHash&&isCurrentUserComment&&!isCommentDeleted&&(parentCommentHash.hasReplies=!0),isAuthorComment&&prevAuthorCommentHash&&prevCurrentUserCommentHash&&(prevAuthorCommentHash.hasReplies=!0),isAuthorComment&&(prevAuthorCommentHash=commentHash,prevCurrentUserCommentHash=null),isCurrentUserComment&&(prevCurrentUserCommentHash=commentHash),commenterUid&&isCommenterBanned&&(banList[commenterUid]=!0),isRootComment&&(thread.comments.length&&(threads.push(this.createThread(thread,prevThread,banList)),prevThread=thread,thread={}),thread.id=commentId,thread.comments=[],thread.commentsHash={},thread.threadHash={}),thread.comments.push(comment),thread.commentsHash[commentId]=comment,thread.threadHash[commentId]=commentHash,commentId==currentCommentId&&(thread.expanded=!0),isLastComment&&thread.comments.length&&(thread.isLast=!0,threads.push(this.createThread(thread,prevThread,banList)));return threads},createThread:function(thread,prevThread,banList){var refName;refName=thread.isFirst?"firstThread":thread.isLast?"lastThread":"thread."+thread.id;var indent=prevThread&&prevThread.comments.length>1&&thread.comments.length>1;return React.createElement(CommentsThread,{ref:refName,key:thread.id,threadId:thread.id,threadRefName:refName,comments:thread.comments,commentsHash:thread.commentsHash,threadHash:thread.threadHash,banList:banList,details:this.props.details,podCommentPermit:this.state.podCommentPermit,currentCommentId:this.state.currentCommentId,isReplyMode:this.state.isReplyMode,expanded:thread.expanded,lastThread:thread.isLast,indent:indent,onClickReply:this.onClickReply,onClickDelete:this.onClickDelete,onClickBan:this.onClickBan,onThreadExpand:this.onThreadExpand,onCommentExpand:this.onCommentExpand,generateCommentUrl:this.props.generateCommentUrl,metrikaCounter:this.props.metrikaCounter})},scrollToComment:function(commentId){var $viewport=$(this.getDOMNode()).closest(".js-panel"),$commentBox=$(document.querySelector('[data-comment-id="'+commentId+'"]'));if($commentBox.length){var adsOffset=0,editorHeight=0,viewportHeight=0;this.refs.panel&&(adsOffset=this.refs.panel.getAdsOffset(),editorHeight=this.refs.panel.getEditorHeight(),viewportHeight=this.refs.panel.getViewportHeight());var commentBottom=$commentBox.offset().top+$commentBox.outerHeight()+adsOffset,viewportScrollTop=$viewport.scrollTop(),newScrollTop=viewportScrollTop+commentBottom+editorHeight-viewportHeight;ns.events.trigger("ph-panel-scroll-off"),$viewport.animate({scrollTop:newScrollTop},300,function(){ns.events.trigger("ph-panel-scroll-on")})}},showCaptcha:function(captchaData,callback){this.refs.replyForm&&this.refs.replyForm.showCaptcha(captchaData,callback)},setFocusOnReply:function(){this.refs.replyForm&&this.refs.replyForm.setFocus()},showCaptchaError:function(context,errorId){this.refs.replyForm&&(this.refs.replyForm.showError(context,errorId,"captcha"),this.refs.replyForm.setFocusOnCaptcha())},showCommentError:function(context,errorId){this.refs.replyForm&&this.refs.replyForm.showError(context,errorId,"inputContainer")},handleResize:function(){this.refs.panel&&this.refs.panel.updateHeight()},setCounts:function(counts){var stateDelta={};counts.next<this.state.nextCount&&(stateDelta.nextCount=counts.next),counts.prev<this.state.prevCount&&(stateDelta.prevCount=counts.prev),counts.wasNextLoaded?stateDelta.loadingNext=!1:stateDelta.loadingPrev=!1,this._saveScrollPosition(),this.setState(stateDelta)},commentAddedUpdate:function(){var commentToReplyThread,replyForm=this.refs.replyForm;replyForm&&replyForm.state.commentToReply&&replyForm.state.commentToReplyThreadRefName&&(commentToReplyThread=this.refs[replyForm.state.commentToReplyThreadRefName],commentToReplyThread&&commentToReplyThread.setState({collapsed:!1})),this._saveScrollPosition(),this.forceUpdate()},commentsAreHidden:function(){return this.props.details.hideComments},_saveScrollPosition:function(){var firstThread=this.refs.firstThread;if(firstThread){var viewportNode=$(this.getDOMNode()).closest(".js-panel")[0],firstThreadNode=firstThread.getDOMNode();this.keepScrollThreadId=firstThread.props.threadId,this.keepScrollThreadTop=firstThreadNode.offsetTop-viewportNode.scrollTop}},_restoreScrollPosition:function(){var threadId=this.keepScrollThreadId,threadTop=this.keepScrollThreadTop;if(this.keepScrollThreadId=null,this.keepScrollThreadTop=null,threadId){var thread=this.refs["thread."+threadId];if(thread){var viewportNode=$(this.getDOMNode()).closest(".js-panel")[0],threadNode=thread.getDOMNode();ns.events.trigger("ph-skip-panel-scroll"),viewportNode.scrollTop=threadNode.offsetTop-threadTop}}},loadMore:function(dir){return function(){var loadNext=0>dir;loadNext?(this.props.loadMore(this.refs.firstThread.props.threadId,-this.props.loadMoreCount),this.setState({loadingNext:!0})):(this.props.loadMore(this.refs.lastThread.props.threadId,this.props.loadMoreCount),this.setState({loadingPrev:!0})),this.props.metrikaCounter(["comments",loadNext?"show next comments":"show previous comments"])}.bind(this)},handleHeightChange:function(){this.refs.panel&&this.refs.panel.updateHeight()},updatePodCommentPermit:function(podCommentPermit){this.setState({podCommentPermit:podCommentPermit})},render:function(){var loadedCount,total,threads,commentsClasses,allCommentsAreLoaded,message,details=this.props.details,podCommentPermit=this.state.podCommentPermit,showPodRestrictionMessage="none"===podCommentPermit||"reply"===podCommentPermit&&!this.state.isReplyMode,isPodMessage=!1;details.hideComments?message=details.commentsHiddenMessage:showPodRestrictionMessage?(message=details.podCommentsRestrictedMessage,isPodMessage=!0):details.canComment||(message=details.commentsDisabledMessage);var showMessage=!!message,replyForm=React.createElement(ReplyForm,{ref:"replyForm",details:details,message:message,isPodMessage:isPodMessage,onReplyInputFocus:this.props.onReplyInputFocus,onReply:this.props.onReply,onCancelReply:this.onCancelReply,reloadCaptcha:this.props.reloadCaptcha,handleHeightChange:this.handleHeightChange,metrikaCounter:this.props.metrikaCounter});return details.hideComments?React.createElement("div",null,React.createElement(StickyPanel,{withMessage:showMessage,ref:"panel"},replyForm)):(loadedCount=this.props.comments.models.length,total=+this.props.comments.get(".totalWithChildren"),allCommentsAreLoaded=loadedCount>=total,threads=this.getThreads(),commentsClasses=cx({"comments-container":!0,comments_empty:0===threads.length}),React.createElement("div",{className:commentsClasses},this.state.nextCount>0&&!allCommentsAreLoaded?React.createElement(LoadNextComments,{count:loadedCount,total:total,onClick:this.loadMore(-1),showProgress:this.state.loadingNext}):null,this.getThreads(),this.state.prevCount>0&&!allCommentsAreLoaded?React.createElement(LoadPrevComments,{count:loadedCount,total:total,onClick:this.loadMore(1),showProgress:this.state.loadingPrev}):null,React.createElement(StickyPanel,{withMessage:showMessage,ref:"panel"},replyForm)))}});ph.R.Comments.Block=Comments}(),function(){ns.View.define("comments",{params:ph.params.commentsViewParams,models:ph.utils.nsViewModels({auth:{"ns-model-changed":"invalidate"},ticket:{"ns-model-changed":"invalidate"},preferences:{"ns-model-changed":{'.preferences.preference.[.name == "hide-ads"]':"invalidate"}},photo:{"ns-model-changed":{".flags.porno":"invalidate",".flags.blocked":"invalidate",".askAlbumPassword":"invalidate"}},"photo-rights":{"ns-model-changed":{".canComment.userSpecific":"invalidate"}},comments:{"ns-model-changed":"keepValid","ns-model-insert":"keepValid","ns-model-remove":"keepValid"},"app-state":{"ns-model-changed":{".is-adult":"invalidate"}},"photos-ads-state":{"ns-model-changed":{".disabled":"onAdsDisabledToggle",".reload":"onAdsReload",".loaded":"onAdsLoadedChange",".":"keepValid"}},"comments-state":{"ns-model-changed":"keepValid"}}),events:{"ns-view-init":"onInit","ns-view-htmlinit":"onHtmlInit","ns-view-show":"onShow","ns-view-htmldestroy":"onHtmlDestroy",click:"onCommentsInteract","ph-panel-scroll@show":"onScroll","ph-resize@show":"onResize","ph-page-change@show":"onPageChange"},methods:{onInit:function(){this._messages={commentsHidden:ns.renderString({},"comments_state-hidden"),disabledForUser:ns.renderString({},"comments_state-disabled-for-user"),disabledForImage:ns.renderString({},"comments_state-disabled-for-image"),bannedByAuthor:ns.renderString({},"comments_state-user-banned-by-author"),bannedByModerator:ns.renderString({},"comments_state-user-banned-by-moderator"),readonlyMode:ns.renderString({},"comments_state-readonly"),commentsUnavailable:ns.renderString({},"comments_state-unavailable"),podCommentsNone:ns.renderString({},"comments_state-pod-comments-none"),podCommentsRestricted:ns.renderString({},"comments_state-pod-comments-restricted")}},onHtmlInit:function(){this.areAdsDisabledByUser=this.getModel("preferences").isSet("hide-ads")},onShow:function(){var that=this;this._ensureCommentsComponent(function(){that.countOnShow(),that.updateAds()})},onHtmlDestroy:function(){this._destroyCommentsComponent()},onScroll:function(evt,isUserScroll){isUserScroll&&this.onCommentsInteract(),this.commentsComponent&&this.commentsComponent.stickEditor()},onCommentsInteract:function(){this.getModel("comments-state").hideAds(),this.updateAds()},onAdsReload:function(){this.getModel("comments-state").showAds(),this.updateAds(),this.keepValid()},onAdsLoadedChange:function(){var hasAds=this.getModel("photos-ads-state").get(".loaded"),isShowAdsSet=this.getModel("comments-state").get(".show-ads");isShowAdsSet&&!hasAds&&this.getModel("comments-state").hideAds(),this.updateAds(),this.keepValid()},onResize:function(){this.commentsComponent&&(this.commentsComponent.handleResize(),this.commentsComponent.stickEditor())},onAdsDisabledToggle:function(){this.updateAds(),this.keepValid()},updateAds:function(){var showAds=this.getModel("comments-state").get(".show-ads");"undefined"==typeof showAds&&(showAds=this.getModel("photos-ads-state").get(".loaded"),this.getModel("comments-state").set(".show-ads",showAds)),showAds=showAds&&!this.areAdsDisabledByUser,this.commentsComponent&&this.commentsComponent.toggleStickyAds(showAds),ns.events.trigger("ph-comments-ads-state-change",showAds),this._movePopups()},onReplyInputFocus:function(){var that=this;if(!ph.noAuthRedirect(this.getModel("auth"))){var promise=ph.controllers.user.getPreferences();promise.then(function(context){var caughtInSpam=context.model.isSet("caught-in-spam");caughtInSpam&&!that.captchaVisible&&that.showCaptcha()})}},showCaptcha:function(callback){var that=this;callback=callback||function(){},ph.controllers.comments.getCaptcha().then(function(context){that.captchaVisible=!0,that.commentsComponent.showCaptcha(context.model.getData(),function(){that._movePopups(),callback()})})},hideCaptcha:function(){this.captchaVisible=!1},deleteComment:function(commentToDelete){var that=this,photoRights=this.getModel("photo-rights"),photo=this.getModel("photo");ph.controllers.comments.removeComment(commentToDelete,photoRights,photo).then(function(){that._updatePodCommentPermit(),that.commentsComponent.forceUpdate(),that.commentsComponent.stickEditor()},function(details){ph.errors.showError(details.context,{messageId:"error_could-not-remove-comment",persistent:!0})})},banCommentAuthor:function(comment){var that=this;ph.controllers.comments.banCommentAuthor(comment).then(function(){that.commentsComponent.forceUpdate()},function(details){that.commentsComponent.forceUpdate(),ph.errors.showError(details.context,{messageId:"error_user-ban-failed",persistent:!0})})},loadMore:function(fromCommentId,count){var that=this,promise=ph.controllers.comments.loadComments(fromCommentId,count);promise.then(function(context){var loadedComments=context.model.models,wasNextLoaded=0>count;wasNextLoaded?that.getModel("comments").insert(loadedComments,0):that.getModel("comments").insert(loadedComments),that.commentsComponent.setCounts({next:context.model.get(".totalWithChildrenBefore"),prev:context.model.get(".totalWithChildrenAfter"),wasNextLoaded:wasNextLoaded})}),this.getModel("photos-ads-state").countShow()},reply:function(data,parentComment){var that=this,commentBody=data.commentBody,captchaInfo=data.captchaInfo,preferences=this.getModel("preferences"),photoRights=this.getModel("photo-rights"),photo=this.getModel("photo"),promise=ph.controllers.comments.addComment(commentBody,captchaInfo,parentComment,preferences,photoRights,photo);promise.then(function(context){var comment=context.model,commentId=comment.get(".id");if(that.captchaVisible&&that.hideCaptcha(),that.commentsComponent.hasNextCommentsCollapsed()&&!parentComment){var addedCommentUrl=that.generateCommentUrl(commentId);return void ns.page.go(addedCommentUrl)}that._insertComment(comment,parentComment),that.commentsComponent.commentAddedUpdate(),that._updatePodCommentPermit(),that.commentsComponent.resetReplyForm(),that.commentsComponent.setFocusOnReply()}),promise.fail(function(details){var context=details.context,errorName=no.jpath(".error.name",context)||"";"spam"===errorName?that.showCaptcha():"captcha-check-failed"===errorName?that.showCaptcha(function(){that.commentsComponent.showCaptchaError(context,"error_captcha-invalid"),that.metrikaCounter(["comments","captcha","wrong captcha"])}):(that.hideCaptcha(),that.commentsComponent.showCommentError(context,"error_could-not-add-comment")),that.commentsComponent.enableReplyForm()})},generateCommentUrl:function(commentId){return ph.utils.generateUrl(ns.page.current.page,no.extend({},ns.page.current.params,{"comment-id":commentId}))},_insertComment:function(comment,parentComment){var index,commentModel,commentsModel=this.getModel("comments"),comments=commentsModel.models;if(parentComment)index=ph.utils.getIndexOfLastChild(comments,parentComment.get(".id"))+1;else{index=0;for(var i=0;i<comments.length;i++)if(commentModel=comments[i],commentModel.get(".immortal"))index=i+1;else if(!commentModel.get(".parentId"))break}commentsModel.insert(comment,index),commentsModel.set(".totalWithChildren",+commentsModel.get(".totalWithChildren")+1)},_ensureCommentsComponent:function(callback){var that=this;if(this.commentsComponent)return void callback();var commentsNode=this.$node.find(".js-comments")[0];if(commentsNode){var commentsModel=this.getModel("comments"),photoRightsModel=this.getModel("photo-rights"),photoModel=this.getModel("photo"),currentUserUid=this.getModel("auth").get(".uid.value"),authorUid=photoModel.get(".author.uid"),userSpecific=photoRightsModel.get(".canComment.userSpecific")||{},podCommentPermit=photoRightsModel.get(".canComment.userSpecific.podCommentPermit")||"all",photoIs18Plus=1==photoModel.get(".flags.porno"),photoIsBlocked=photoModel.get(".flags.blocked")||"image is blocked"==no.jpath(".name",photoModel.getError()),photoIsPassworded=photoModel.get(".askAlbumPassword"),photoIsPrivate="access denied"==no.jpath(".name",photoModel.getError()),isCommentingAvailable=photoRightsModel.get(".canComment.can")&&!photoRightsModel.get(".canComment.commentServantReadOnly"),canCommentFlag=isCommentingAvailable||!currentUserUid,needConfirmation18Plus=photoIs18Plus&&currentUserUid!=authorUid&&!ph.utils.isAdult(currentUserUid),disableComments=userSpecific.userBanned||userSpecific.imageCommentsDisabled||userSpecific.commentsDisabledForUser||photoIsBlocked,hideComments="none"===podCommentPermit||disableComments||needConfirmation18Plus||photoIsPassworded||photoIsPrivate,details={currentUserUid:currentUserUid,authorUid:authorUid,hideComments:hideComments,canComment:canCommentFlag&&!disableComments,podCommentPermit:podCommentPermit,commentsHiddenMessage:this._getCommentsHiddenMessage(photoRightsModel),commentsDisabledMessage:this._getCommentsDisabledMessage(photoRightsModel),podCommentsRestrictedMessage:this._messages.podCommentsRestricted},initialState={nextCount:commentsModel.get(".totalWithChildrenBefore"),prevCount:commentsModel.get(".totalWithChildrenAfter"),currentCommentId:ph.params.hiddenParams["comment-id"],setReplyMode:!!ph.params.hiddenParams["comment-reply"]};React.render(React.createElement(ph.R.Comments.Block,{comments:commentsModel,details:details,initialState:initialState,loadMoreCount:25,loadMore:this.loadMore.bind(this),onReplyInputFocus:this.onReplyInputFocus.bind(this),onReply:this.reply.bind(this),onDelete:this.deleteComment.bind(this),onBan:this.banCommentAuthor.bind(this),onRedraw:this.updateAds.bind(this),reloadCaptcha:this.showCaptcha.bind(this),generateCommentUrl:this.generateCommentUrl.bind(this),metrikaCounter:this.metrikaCounter.bind(this)}),commentsNode,function(){that.commentsComponent=this,callback()})}},_destroyCommentsComponent:function(){this.commentsComponent&&(React.unmountComponentAtNode(this.node),this.commentsComponent=null)},_updatePodCommentPermit:function(){if(this.commentsComponent){var podCommentPermit=this.getModel("photo-rights").get(".canComment.userSpecific.podCommentPermit")||"all";this.commentsComponent.updatePodCommentPermit(podCommentPermit)}},_getCommentsDisabledMessage:function(photoRights){if(!photoRights)return this._messages.commentsUnavailable;var userSpecific=photoRights.get(".canComment.userSpecific")||{},readonlyMessage=photoRights.get(".canComment.commentServantReadOnly")?this._messages.readonlyMode:null;return this._message(userSpecific)||readonlyMessage||this._messages.commentsUnavailable},_getCommentsHiddenMessage:function(photoRights){if(!photoRights)return this._messages.commentsHidden;var userSpecific=photoRights.get(".canComment.userSpecific")||{};return this._message(userSpecific)||this._messages.commentsHidden},_message:function(userSpecific){return"none"===userSpecific.podCommentPermit?this._messages.podCommentsNone:userSpecific.imageCommentsDisabled?this._messages.disabledForImage:userSpecific.userBanned?"by-image-author"===userSpecific.userBanTypeO?this._messages.bannedByAuthor:this._messages.bannedByModerator:userSpecific.commentsDisabledForUser?this._messages.disabledForUser:null},_movePopups:ph.utils.lazyCallback(100,function(){ph.resized()}),onPageChange:function(){this.counted=!1},countOnShow:function(){if(!this.counted){if(this.commentsComponent.commentsAreHidden())this.metrikaCounter(["comments","show total on load","hidden"]);else{var count=(this.getModel("comments").get(".comments.comment")||[]).length;this.metrikaCounter(["comments","show total on load",ph.metrika.group(count,[0,1,5,10,20,50,100,300,500,1e3]),count])}this.counted=!0}},metrikaCounter:ph.metrika.generateMetrikaCounter(["desktop web","interface elements","image viewer"])}})}(),ns.View.define("ads",{params:{},events:{"ns-view-htmlinit":"onHtmlInit","ns-view-touch":"onRepaint","ph-resize@show":"initTenacity","ph-panel-scroll@show":"stickBanner","ph-page-change@show":"onPageChange","ph-comments-ads-state-change@show":"onCommentsAdsStateChange"},models:ph.utils.nsViewModels({preferences:{"ns-model-changed":{'.preferences.preference.[.name == "hide-ads"]':"onAdsToggle"}},"photos-ads-state":{"ns-model-touched":"keepValid","ns-model-changed":{".loading":"reloadAds",".disabled":"syncAdsState"}}}),methods:{onHtmlInit:function(){this._nodes={$viewport:this.$node.closest(".js-panel"),$banner:this.$node.find(".js-banner"),$bannerWrapper:this.$node.find(".js-banner-wrapper"),$bannerPlaceholder:this.$node.find(".js-banner-placeholder")},this.adOffset=0,this._initialRenderDone=!1,this._fixed=this._nodes.$bannerPlaceholder.hasClass("fixed"),this.areAdsDisabledByUser=this.getModel("preferences").isSet("hide-ads")},onRepaint:function(){this._initialRenderDone||(this._initialRenderDone=!0,this.getState().countShow()),this.syncAdsState()},onPageChange:function(){this.getState().countShow()},onCommentsAdsStateChange:function(evt,showAds){var that=this;showAds?this.showAds():this.hideAds(),setTimeout(function(){that.stickBanner()},0)},onAdsToggle:function(){var hideAds=this.getModel("preferences").isSet("hide-ads");this.areAdsDisabledByUser=hideAds,hideAds?this.getState().disableAds():this.getState().enableAds(),this.keepValid()},getState:function(){return this.getModel("photos-ads-state")},reloadAds:function(){var photosAdsState=this.getState();this.areAdsDisabledByUser||ph.loadModule("ads").then(function(){Ya.Context.AdvManager.render({blockId:"R-94178-6",renderTo:"yandex_ad_R-94178-6",async:!0,onRender:function(){photosAdsState.setNewAdsLoaded(),photosAdsState.enableAds()}},function(){photosAdsState.handleAdsLoadFail(),photosAdsState.disableAds()})})},syncAdsState:function(){this.getState().areAdsDisabled()?this._disableAds():this._enableAds()},_enableAds:function(){this._nodes.$bannerPlaceholder.removeClass("is-hidden"),this.initTenacity()},_disableAds:function(){this._nodes.$bannerPlaceholder.addClass("is-hidden"),this.initTenacity()},showAds:function(){this.adOffset=150,this._nodes.$bannerPlaceholder.addClass("with-ads")},hideAds:function(){this.adOffset=0,this._nodes.$bannerPlaceholder.removeClass("with-ads")},initTenacity:function(){this.areAdsDisabledByUser||(this.updateBannerHeight(),this.stickBanner())},updateBannerHeight:function(){this.viewportHeight=this._nodes.$viewport.height(),this.bannerHeight=this._nodes.$banner.outerHeight(),this._nodes.$bannerPlaceholder.css("min-height",this.bannerHeight),this.bannerPlaceholderHeight=this._nodes.$bannerPlaceholder.outerHeight()},stickBanner:function(){if(!this.areAdsDisabledByUser){var bannerPlaceholderOffset=this._nodes.$bannerPlaceholder.offset();if(bannerPlaceholderOffset){var bannerPlaceholderBottom=bannerPlaceholderOffset.top+this.bannerPlaceholderHeight-(this.bannerPlaceholderHeight-this.adOffset),toggle=bannerPlaceholderBottom>this.viewportHeight?!0:!1;toggle!==this._fixed&&(this._fixed=toggle,this._nodes.$bannerPlaceholder.toggleClass("fixed",toggle))}}}}}),ns.View.define("scroll-memory",{params:{},events:{"ns-view-show":"restoreScroll","ph-page-change@show":"saveScroll","ph-restore-scroll@show":"restoreScroll"},methods:{restoreScroll:function(){this.scrollTop>=0&&($(document).scrollTop(this.scrollTop),this.scrollTop=-1)},saveScroll:function(){this.scrollTop=$(document).scrollTop()}}}),ph.controllers={},ph.controllers.isOk=function(model){return"ok"===no.jpath(".result",model.getData())},ph.controllers.getTicket=function(){return ns.Model.get("ticket").getData()},function(){var isOk=ph.controllers.isOk;ph.controllers.photo={saveTitle:function(newTitle,photo){var promise=new Vow.Promise,params=ns.page.current.params,oldTitle=photo.get(".title");return photo.set(".title",this.escapeUserInput(newTitle)),ph.actions["do"]("do-photo-title-edit",{"author-login":params["author-login"],"image-id":params["image-id"],title:newTitle,ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){promise.fulfill(context)},fail:function(context){photo.set(".title",oldTitle),promise.reject({newTitle:newTitle,oldTitle:oldTitle,context:context})}}),promise},saveDescription:function(newDescription,photoMore){var promise=new Vow.Promise,params=ns.page.current.params,oldDescription=photoMore.getData().description;return photoMore.set(".description",this.escapeUserInput(newDescription)),ph.actions["do"]("do-photo-description-edit",{"author-login":params["author-login"],"image-id":params["image-id"],description:newDescription,ticket:ph.controllers.getTicket()},{check:isOk,done:function(model){promise.fulfill(model)},fail:function(context){photoMore.set(".description",oldDescription),promise.reject({newDescription:newDescription,oldDescription:oldDescription,context:context})}}),promise},toggleLike:function(photo,photoRights,animateHeart){if(!photoRights.get(".actions.canLike"))return null;var promise=new Vow.Promise,params=photo.params,oldData={count:photo.get(".likeCount"),like:!!photoRights.get(".options.like")},newData={count:oldData.count+(oldData.like?-1:1),like:!oldData.like};return photo.set(".likeCount",newData.count),photoRights.set(".options.like",newData.like),animateHeart="undefined"==typeof animateHeart?!0:animateHeart,photoRights.set(".options.likeAnimate",animateHeart&&newData.like),ph.actions["do"]("do-like-set",{"author-login":params["author-login"],"image-id":params["image-id"],operation:newData.like?"SET":"UNSET",ticket:ph.controllers.getTicket()},{check:isOk,done:function(){promise.fulfill()},fail:function(context){photo.set(".likeCount",oldData.count),photoRights.set(".options.like",oldData.like),promise.reject({newData:newData,oldData:oldData,context:context})}}),promise},acceptAgreement:function(){var auth=ns.Model.get("auth"),promise=new Vow.Promise;return auth.hasProfile()?promise.fulfill():ph.actions["do"]("do-agreement-accept",{ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){auth.invalidate(),promise.fulfill({context:context})},fail:function(context){promise.reject({context:context})}}),promise},toggleFavorite:function(photoRights){if(!photoRights.get(".actions.canFavorite"))return null;var promise=new Vow.Promise,acceptAgreement=this.acceptAgreement(),params=ns.page.current.params,oldValue=photoRights.get(".options.favorite"),newValue=!oldValue;return photoRights.set(".options.favorite",newValue),acceptAgreement.then(function(){ph.actions["do"]("do-favorite-set",{"author-login":params["author-login"],"image-id":params["image-id"],operation:newValue?"SET":"UNSET",ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){promise.fulfill({context:context})},fail:function(context){photoRights.set(".options.favorite",oldValue),promise.reject({newValue:newValue,oldValue:oldValue,context:context})}})}),acceptAgreement.fail(function(details){photoRights.set(".options.favorite",oldValue),promise.reject({newValue:newValue,oldValue:oldValue,context:details.context})}),promise},toggleFollow:function(profile){var acceptAgreement=this.acceptAgreement(),promise=new Vow.Promise,authorId=profile.get(".user.uid"),authorLogin=profile.get(".user.login"),oldValue=!!profile.get(".viewerUserRelation.userIsFavoriteAuthorOfViewer"),newValue=!oldValue;return acceptAgreement.then(function(){var paramsNew={ticket:ph.controllers.getTicket()};profile.set(".viewerUserRelation.userIsFavoriteAuthorOfViewer",newValue);var action=oldValue?"do-user-unfollow":"do-user-follow",paramName=oldValue?"author-ids":"author-login",paramValue=oldValue?authorId:authorLogin;paramsNew[paramName]=paramValue,ph.actions["do"](action,paramsNew,{check:isOk,done:function(context){promise.fulfill({context:context})},fail:function(context){profile.set(".viewerUserRelation.userIsFavoriteAuthorOfViewer",oldValue),promise.reject({context:context})}})}),acceptAgreement.fail(function(details){promise.reject({context:details.context})}),promise},setParam:function(name,photo,photoRights){var photoData=photo.getData(),nameField="",valueOld=null,valueNew=null,valueNewModel=null,invalidatePhoto=!1,invalidatePhotoRights=!1;switch(name){case"access-rights":nameField=".access.privilege",valueOld=no.jpath(nameField,photoData),valueNew="public"===valueOld?"private":"public",valueNewModel="public"===valueOld?"owner":"public",invalidatePhotoRights=!0;break;case"porno":nameField=".flags.porno",valueOld=no.jpath(nameField,photoData),valueNew=!valueOld,valueNewModel=valueNew,invalidatePhotoRights=!0;break;case"disable-comments":nameField=".flags.commentsDisabled",valueOld=no.jpath(nameField,photoData),valueNew=!valueOld,valueNewModel=valueNew;break;case"hide-orig":nameField=".flags.hideOriginal",valueOld=no.jpath(nameField,photoData),valueNew=!valueOld,valueNewModel=valueNew,invalidatePhoto=!0;break;default:return null}var promise=new Vow.Promise,paramsNew={};return paramsNew.ticket=ph.controllers.getTicket(),paramsNew["image-id"]=no.jpath(".imageId",photoData),paramsNew[name]=valueNew,photo.set(nameField,valueNewModel),ph.actions["do"]("do-photo-edit",paramsNew,{check:isOk,done:function(context){var refreshModels=[];invalidatePhoto&&refreshModels.push(photo),invalidatePhotoRights&&refreshModels.push(photoRights),ns.request.models(refreshModels,{forced:!0}).then(function(){promise.fulfill({context:context})}).fail(function(){invalidatePhoto&&photo.invalidate(),invalidatePhotoRights&&photoRights.invalidate(),promise.reject({context:context})})},fail:function(context){photo.set(nameField,valueOld),promise.reject({context:context})}}),promise},invalidateLinks:function(photo){var that=this,promise=new Vow.Promise,params=ns.page.current.params;return ph.actions["do"]("do-photo-edit",{"image-id":photo.get(".imageId"),"invalidate-links":!0,ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){photo.invalidate(),that._invalidateImageModels(params),promise.fulfill({context:context})
},fail:function(context){promise.reject({context:context})}}),promise},vote:function(like,contest){var promise=new Vow.Promise,acceptAgreement=this.acceptAgreement();return acceptAgreement.then(function(){ph.actions.get("do-contest-vote",{vote:like?1:0,"vote-key":contest.get(".voteKey"),"contest-id":contest.get(".contestId"),ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){promise.fulfill({context:context})},fail:function(context){promise.reject({context:context})}})}),acceptAgreement.fail(function(details){promise.reject({context:details.context})}),promise},checkPassword:function(photo,password){var promise=new Vow.Promise,photoData=photo.getData(),params=ns.page.current.params;if(""===(password||"").trim()){var context=ph.actions.createContext({name:"empty password"});return promise.reject({context:context}),promise}return ph.actions["do"]("do-password-check",{ticket:ph.controllers.getTicket(),password:password,"album-id":photoData.albumId,"author-id":photoData.author.uid},{check:isOk,done:function(context){ns.Model.get("photo",params).invalidate(),ns.Model.get("album-info",params).invalidate(),ns.Model.get("photo-more",params).invalidate(),ns.Model.get("photo-rights",params).invalidate(),ns.Model.get("tags",params).invalidate(),ns.Model.get("slider-context",params).invalidate(),promise.fulfill({context:context})},fail:function(context){promise.reject({context:context})}}),promise},setGte18:function(auth){var uid=auth.get(".uid.value")||"0";return ph.utils.setIsAdult(uid),Vow.fulfill(ph.actions.createContext())},complain:function(data){var promise=new Vow.Promise,params=ns.page.current.params,types=[],dict={copyright:data.contestId?"CONTEST_PLAGIARISM":"PLAGIARISM",contest:"NOT_SUITABLE_FOR_CONTEST",porn:"PORNO",violence:"VIOLENCE",spam:"SPAM",other:"OTHER"};for(var name in dict)dict.hasOwnProperty(name)&&data[name]&&types.push(dict[name]);return ph.actions["do"]("do-photo-complain",{"author-login":params["author-login"],"image-id":params["image-id"],types:types.join(","),url:data.linkToOrigin,comment:data.matter,"contest-id":data.contestId,ticket:ph.controllers.getTicket()},{check:function(model){return no.jpath(".complete",model.getData())},done:function(){promise.fulfill()},fail:function(context){promise.reject({context:context})}}),promise},editTags:function(tagsString,models){var tagsArrayDirty=[];tagsString.split(",").forEach(function(element){var tag=element.trim();tag&&tagsArrayDirty.push(tag.toLocaleLowerCase())});var onlyUnique=function(value,index,self){return self.indexOf(value)===index},tagsArray=tagsArrayDirty.filter(onlyUnique),tagsData={tags:{tag:[]}};tagsArray.forEach(function(element){tagsData.tags.tag.push({name:element,tagger:models.photo.getData().author,declined:!1})});var tagsDataOld=models.tags.getData(),tagNames=no.jpath(".tags.tag.name",tagsDataOld)||[],tagsDataStringOld=tagNames.join(","),tagsDataString=tagsArray.join(","),promise=new Vow.Promise;if(models.tags.setData(tagsData),tagsArray.length>30)return models.tags.setData(tagsDataOld),promise.reject(),promise;if(tagsDataString===tagsDataStringOld)return promise.fulfill({pageUrl:ns.page.currentUrl}),promise;var params=ns.page.current.params;return ph.actions["do"]("do-tag-edit",{"author-login":params["author-login"],"image-id":params["image-id"],tags:tagsDataString,ticket:ph.controllers.getTicket()},{check:function(model){return no.jpath(".tags.tag",model.getData())?!0:!1},done:function(context){models.tags.setData(context.model.getData()),promise.fulfill(context)},fail:function(context){models.tags.setData(tagsDataOld),promise.reject(context)}}),promise},details:function(){var promise=new Vow.Promise,params=ns.page.current.params;return ph.actions.get("exif",{"author-login":params["author-login"],"image-id":params["image-id"]},{check:function(model){return!model.error},done:function(context){promise.fulfill(context)},fail:function(context){promise.reject(context)}}),promise},views:function(){var promise=new Vow.Promise,params=ns.page.current.params;return ph.actions.get("views",{"author-login":params["author-login"],"image-id":params["image-id"],referers:!0},{check:function(model){return!model.error},done:function(context){promise.fulfill(context)},fail:function(context){promise.reject(context)}}),promise},geoBind:function(geoData,photoMore){var promise=new Vow.Promise,params=ns.page.current.params,photoMoreData=photoMore.getData(),oldData=null;return photoMoreData.boundCoord&&(oldData={lat:photoMoreData.boundCoord.latitude,lon:photoMoreData.boundCoord.longitude,mapType:photoMoreData.boundCoord.mapType,zoom:photoMoreData.boundCoord.zoomlevel||photoMoreData.boundCoord.zoomLevel}),photoMore.set(".boundCoord.latitude",geoData.lat),photoMore.set(".boundCoord.longitude",geoData.lon),photoMore.set(".boundCoord.mapType",geoData.mapType),photoMore.set(".boundCoord.zoomLevel",geoData.zoom),ph.actions["do"]("do-geo-bind",{"author-login":params["author-login"],"image-id":params["image-id"],ticket:ph.controllers.getTicket(),latitude:geoData.lat,longitude:geoData.lon,mapType:geoData.mapType,zoomLevel:geoData.zoom},{check:isOk,done:function(context){promise.fulfill({context:context})},fail:function(context){oldData?(photoMore.set(".boundCoord.latitude",oldData.lat),photoMore.set(".boundCoord.longitude",oldData.lon),photoMore.set(".boundCoord.mapType",oldData.mapType),photoMore.set(".boundCoord.zoomLevel",oldData.zoom)):photoMore.deleteData(".boundCoord"),promise.reject({context:context,newData:geoData,oldData:oldData})}}),promise},geoUnbind:function(photoMore){var photoMoreData=photoMore.getData();if(!photoMoreData.boundCoord)return null;var promise=new Vow.Promise,params=ns.page.current.params,oldData={lat:photoMoreData.boundCoord.latitude,lon:photoMoreData.boundCoord.longitude,mapType:photoMoreData.boundCoord.mapType,zoom:photoMoreData.boundCoord.zoomlevel||photoMoreData.boundCoord.zoomLevel};return photoMore.deleteData(".boundCoord"),ph.actions["do"]("do-geo-unbind",{"author-login":params["author-login"],"image-id":params["image-id"],ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){promise.fulfill({context:context})},fail:function(context){oldData&&(photoMore.set(".boundCoord.latitude",oldData.lat),photoMore.set(".boundCoord.longitude",oldData.lon),photoMore.set(".boundCoord.mapType",oldData.mapType),photoMore.set(".boundCoord.zoomLevel",oldData.zoom)),promise.reject({context:context,oldData:oldData})}}),promise},remove:function(photo){var promise=new Vow.Promise,params=photo.params,nextPhotoParams=null,_remove=function(){ph.actions["do"]("do-photo-remove",{"image-id":params["image-id"],ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){ph.modelsManager.cleanup("photo",params),promise.fulfill({context:context,nextPhotoParams:nextPhotoParams})},fail:function(context){promise.reject({context:context})}})};return ph.controllers.slider.getPhotoNearContext(params).then(function(context){nextPhotoParams={"author-login":context.model.get(".next.author.login"),"image-id":context.model.get(".next.imageId")},nextPhotoParams["author-login"]&&nextPhotoParams["image-id"]&&!ph.utils.matchParams(params,nextPhotoParams,["author-login","image-id"])||(nextPhotoParams=null),_remove()},function(){_remove()}),promise},escapeUserInput:function(str){return ns.entityify(str)},sendToContest:function(data,photo,tags){var that=this,promise=new Vow.Promise,params=photo.params,oldTitle=photo.get(".title");return photo.set(".title",this.escapeUserInput(data.title)),ph.actions["do"]("do-send-to-contest",{"author-login":params["author-login"],"image-id":params["image-id"],title:data.title,tags:data.tags,"contest-id":data.contestId,ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){tags.invalidate(),that._invalidateContestModels(params),promise.fulfill(context)},fail:function(context){photo.set(".title",oldTitle),tags.invalidate(),that._invalidateContestModels(params),promise.reject({context:context})}}),promise},revokeFromContest:function(contestId,photo){var that=this,promise=new Vow.Promise,params=photo.params;return ph.actions["do"]("do-revoke-from-contest",{"author-login":params["author-login"],"image-id":params["image-id"],"contest-id":contestId,ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){that._invalidateContestModels(params),promise.fulfill(context)},fail:function(context){that._invalidateContestModels(params),promise.reject({context:context})}}),promise},rotateImage:function(photo){var that=this,promise=new Vow.Promise,params=ns.page.current.params;return ph.actions["do"]("do-photo-rotate",{ticket:ph.controllers.getTicket(),"image-id":params["image-id"],angle:-90},{check:isOk,done:function(context){photo.invalidate(),that._invalidateImageModels(params),promise.fulfill(context)},fail:function(context){promise.reject({context:context})}}),promise},canEditImage:function(){var promise=new Vow.Promise,params=ns.page.current.params;return ph.actions["do"]("do-image-can-edit",{ticket:ph.controllers.getTicket(),"image-id":params["image-id"]},{check:isOk,done:function(context){promise.fulfill(context)},fail:function(context){promise.reject({context:context})}}),promise},editImage:function(photo,actions,beforeEditCallback,metrikaCountCallback){var that=this,promise=new Vow.Promise,params=ns.page.current.params;ns.assert(beforeEditCallback,"photo-controller","beforeEditCallback must be set"),ns.assert(metrikaCountCallback,"photo-controller","metrikaCountCallback must be set");var task=new ph.ImageEditTask(photo,actions,ph.controllers.getTicket(),beforeEditCallback,metrikaCountCallback);return task.run().then(function(){photo.invalidate(),that._invalidateImageModels(params),promise.fulfill(ph.actions.createContext())},function(error){promise.reject(ph.actions.createContext(error))}),promise},saveToDisk:function(photo){var promise=new Vow.Promise,startContext=ph.actions.createContext(null,photo),params=ph.params.hiddenParams,ticket=params.sd&&params.sk?params.sk:ph.controllers.getTicket(),task=new ph.saveToDiskTask(photo,ticket);return task.run().then(function(context){promise.fulfill(startContext.copyData({model:context.model}))},function(error){promise.reject(startContext.copyData({error:error}))}),promise},_invalidateContestModels:function(params){var authorLogin=params["author-login"],filter=function(m){return m.params["author-login"]===authorLogin};ns.Model.invalidate("photo-rights",filter),ns.Model.invalidate("photo-more",filter)},_invalidateImageModels:function(params){ns.Model.invalidate("photo-lite",function(m){return ph.utils.matchParams(params,m.params,["author-login","image-id"])})}}}(),function(){ph.controllers.slider={getPhotoNearContext:function(params){var promise=new Vow.Promise;return params=params||ns.page.current.params,ph.actions.get("photo-near-context",params,{done:function(context){promise.fulfill(context)},fail:function(context){promise.reject({context:context})}}),promise},getPhotoPosition:function(params){var promise=new Vow.Promise;return params=params||ns.page.current.params,ph.actions.get("photo-position",params,{check:function(model){var data=model.getData(),position=no.jpath(".position",data),albumId=no.jpath(".albumId",data);return"undefined"!=typeof position&&"undefined"!=typeof albumId},done:function(context){promise.fulfill(context)},fail:function(context){promise.reject({context:context})}}),promise},getAlbumPage:function(params){var promise=new Vow.Promise;return ph.actions.get("do-get-context-page",params,{check:function(model){return!model.error&&!!model.models},done:function(context){promise.fulfill(context)},fail:function(context){promise.reject({context:context})}}),promise}}}(),function(){var isOk=ph.controllers.isOk;ph.controllers.comments={addComment:function(commentBody,captchaInfo,parentComment,preferences,photoRights,photo){var that=this,promise=new Vow.Promise,params=ns.page.current.params,displayName=ns.Model.get("auth").get(".photo-profile.user.displayName"),parentCommentId=parentComment?parentComment.get(".id"):null,parentLevel=parentComment?parentComment.get(".level"):-1,captchaKey=captchaInfo?captchaInfo.key:null,captchaReply=captchaInfo?captchaInfo.reply:null,so=ns.Model.getValid("comment-add-so",params),soValue=so?so.getData():null;return ph.actions["do"]("do-comment-add",{"author-login":params["author-login"],"image-id":params["image-id"],content:commentBody,"parent-comment-id":parentCommentId,"cap-key":captchaKey,"cap-rep":captchaReply,"display-name":displayName,so:soValue,ticket:ph.controllers.getTicket()},{check:function(model){return!!no.jpath(".models[0].data.id",model)},done:function(context){var comment=context.model.models[0];comment.set(".level",parentLevel+1),context.model=comment,so&&so.invalidate(),that._invalidateCommentsAfterModify(params);var refreshModels=[preferences];photo.get(".flags.wasPhotoOfDay")&&refreshModels.push(photoRights),ns.request.models(refreshModels,{forced:!0}).always(function(){promise.fulfill(context)})},fail:function(context){var error=context.model&&context.model.getError();error&&error.so&&ns.Model.get("comment-add-so",params).setData(error.so);var comment=context.model&&context.model.models?context.model.models[0]:null;context.model=comment,context.error=context.error||comment&&comment.get(".error");var errorName=no.jpath(".error.name",context);"spam"===errorName||"captcha-check-failed"===errorName?ns.request.models([preferences],{forced:!0}).always(function(){promise.reject({context:context})}):promise.reject({context:context})}}),promise},getCaptcha:function(){var promise=new Vow.Promise;return ph.actions["do"]("do-captcha-get",{ticket:ph.controllers.getTicket()},{check:function(model){var data=model.getData();return no.jpath(".imageurl",data)&&no.jpath(".token",data)},done:function(context){promise.fulfill(context)},fail:function(context){promise.reject({context:context})}}),promise},removeComment:function(commentModel,photoRights,photo){var that=this,promise=new Vow.Promise,params=ns.page.current.params;return ph.actions["do"]("do-comment-delete",{"author-login":params["author-login"],"image-id":params["image-id"],"comment-id":commentModel.getData().id,ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){commentModel.set(".deleted",!0),commentModel.set(".deleted-recently",!0),that._invalidateCommentsAfterModify(params),photo.get(".flags.wasPhotoOfDay")?ns.request.models([photoRights],{forced:!0}).always(function(){promise.fulfill(context)}):promise.fulfill(context)},fail:function(context){promise.reject({context:context})}}),promise},banCommentAuthor:function(commentModel){var that=this,promise=new Vow.Promise,params=ns.page.current.params;return ph.actions["do"]("do-user-ban",{"user-ids":commentModel.get(".commenter.uid"),ticket:ph.controllers.getTicket()},{check:isOk,done:function(context){commentModel.set(".commenterBanned",!0),commentModel.set(".commenter-ban-in-progress",!1),that._invalidateCommentsAfterModify(params),promise.fulfill(context)},fail:function(context){commentModel.set(".commenter-ban-in-progress",!1),promise.reject({context:context})}}),promise},loadComments:function(fromCommentId,count){var promise=new Vow.Promise,pageParams=ns.page.current.params;return ph.actions.get("comments-more",{"author-login":pageParams["author-login"],"image-id":pageParams["image-id"],"comment-id":fromCommentId,count:count},{check:function(model){return model&&model.models},done:function(context){promise.fulfill(context)},fail:function(context){promise.reject({context:context})}}),promise},_invalidateCommentsAfterModify:function(params){var currentCommentId=ph.params.hiddenParams["comment-id"];ns.Model.invalidate("comments",function(m){var modelParams=m.getRequestParams();return ph.utils.matchParams(modelParams,params,["author-login","image-id"])&&modelParams["comment-id"]!=currentCommentId})}}}(),function(){var localPrefs,cookieName="local_prefs";ph.controllers.user={checkUnread:function(){var promise=new Vow.Promise;return ph.actions["do"]("do-get-unread-mail",{ticket:ph.controllers.getTicket()},{check:function(model){return model?!!model.getData():!1},fail:function(context){promise.reject(context)},done:function(context){promise.fulfill(context)}}),promise},getPreferences:function(){var promise=new Vow.Promise;return ph.actions.get("preferences",{},{check:function(model){return!!no.jpath(".preferences",model.getData())},done:function(context){promise.fulfill(context)},fail:function(context){promise.reject({context:context})}}),promise},setLocalPref:function(name,value){return localPrefs||(localPrefs=this._getLocalPrefs()),localPrefs[name]=value,this._saveLocalPrefs(),Vow.fulfill()},getLocalPref:function(name){return localPrefs||(localPrefs=this._getLocalPrefs()),Vow.fulfill(localPrefs[name])},_getLocalPrefs:function(){return JSON.parse(ph.utils.getCookie(cookieName)||"{}")},_saveLocalPrefs:function(){ph.utils.setCookie(cookieName,JSON.stringify(localPrefs),{expires:365,path:"/"})}}}(),function(){var toolsListCustom="enhance,effects,frames,stickers,crop,orientation,focus,brightness,contrast,saturation,warmth,sharpness,colorsplash,draw,text,redeye,whiten,blemish",Editor=function(){};no.extend(Editor.prototype,ns.Events),Editor.prototype.init=function(){var that=this,promise=new Vow.Promise;return this.editor=new Aviary.Feather({apiVersion:3,apiKey:"YANDEX_DISK",theme:"minimum",tools:toolsListCustom,enableCORS:!0,language:"ru",onLoad:function(){promise.fulfill(that),that.trigger("loaded")},onSaveButtonClicked:function(){return that.actions=that.editor.getActionList(),that.close(),!1},onReady:function(){that.trigger("ready"),that.initialActions=that.editor.getActionList()},onClose:function(isDirty){isDirty=isDirty&&that.actions!==that.initialActions,that.trigger("close",isDirty?that.actions:null),that.actions=null,that.initialActions=null},onError:function(error){that.trigger("error",(error||{}).message)}}),promise},Editor.prototype.load=function(imageId,imageUrl,origSize){var that=this,fullyLoadedPromise=new Vow.Promise,options={image:imageId};return origSize&&(options.hiresWidth=origSize.width,options.hiresHeight=origSize.height),this._preloadImage(imageId,imageUrl,function(){that.editor.launch(options),fullyLoadedPromise.fulfill()}),fullyLoadedPromise},Editor.prototype.close=function(){this.editor.close(),this._cleanup()},Editor.prototype._preloadImage=function(imageId,imageUrl,callback){this._cleanup(),this.$imagePlaceholder=$('<img id="'+imageId+'" src="'+imageUrl+'" class="image-proxy" />').appendTo(document.body),ph.utils.imgOnLoad(this.$imagePlaceholder,callback)},Editor.prototype._cleanup=function(){this.$imagePlaceholder&&(this.$imagePlaceholder.remove(),this.$imagePlaceholder=null)},ph.Editor=Editor}();var requirejs,require,define;!function(Z){function H(b){return"[object Function]"===L.call(b)}function I(b){return"[object Array]"===L.call(b)}function y(b,c){if(b){var d;for(d=0;d<b.length&&(!b[d]||!c(b[d],d,b));d+=1);}}function M(b,c){if(b){var d;for(d=b.length-1;d>-1&&(!b[d]||!c(b[d],d,b));d-=1);}}function s(b,c){return ga.call(b,c)}function l(b,c){return s(b,c)&&b[c]}function F(b,c){for(var d in b)if(s(b,d)&&c(b[d],d))break}function Q(b,c,d,h){return c&&F(c,function(c,j){(d||!s(b,j))&&(h&&"string"!=typeof c?(b[j]||(b[j]={}),Q(b[j],c,d,h)):b[j]=c)}),b}function u(b,c){return function(){return c.apply(b,arguments)}}function aa(b){throw b}function ba(b){if(!b)return b;var c=Z;return y(b.split("."),function(b){c=c[b]}),c}function A(b,c,d,h){return c=Error(c+"\nhttp://requirejs.org/docs/errors.html#"+b),c.requireType=b,c.requireModules=h,d&&(c.originalError=d),c}function ha(b){function c(a,f,b){var e,m,c,g,d,h,j,i=f&&f.split("/");e=i;var n=k.map,p=n&&n["*"];if(a&&"."===a.charAt(0))if(f){for(e=l(k.pkgs,f)?i=[f]:i.slice(0,i.length-1),f=a=e.concat(a.split("/")),e=0;f[e];e+=1)if(m=f[e],"."===m)f.splice(e,1),e-=1;else if(".."===m){if(1===e&&(".."===f[2]||".."===f[0]))break;e>0&&(f.splice(e-1,2),e-=2)}e=l(k.pkgs,f=a[0]),a=a.join("/"),e&&a===f+"/"+e.main&&(a=f)}else 0===a.indexOf("./")&&(a=a.substring(2));if(b&&n&&(i||p)){for(f=a.split("/"),e=f.length;e>0;e-=1){if(c=f.slice(0,e).join("/"),i)for(m=i.length;m>0;m-=1)if((b=l(n,i.slice(0,m).join("/")))&&(b=l(b,c))){g=b,d=e;break}if(g)break;!h&&p&&l(p,c)&&(h=l(p,c),j=e)}!g&&h&&(g=h,d=j),g&&(f.splice(0,d,g),a=f.join("/"))}return a}function d(a){z&&y(document.getElementsByTagName("script"),function(f){return f.getAttribute("data-requiremodule")===a&&f.getAttribute("data-requirecontext")===i.contextName?(f.parentNode.removeChild(f),!0):void 0})}function h(a){var f=l(k.paths,a);return f&&I(f)&&1<f.length?(d(a),f.shift(),i.require.undef(a),i.require([a]),!0):void 0}function $(a){var f,b=a?a.indexOf("!"):-1;return b>-1&&(f=a.substring(0,b),a=a.substring(b+1,a.length)),[f,a]}function n(a,f,b,e){var m,B,g=null,d=f?f.name:null,h=a,j=!0,k="";return a||(j=!1,a="_@r"+(L+=1)),a=$(a),g=a[0],a=a[1],g&&(g=c(g,d,e),B=l(r,g)),a&&(g?k=B&&B.normalize?B.normalize(a,function(a){return c(a,d,e)}):c(a,d,e):(k=c(a,d,e),a=$(k),g=a[0],k=a[1],b=!0,m=i.nameToUrl(k))),b=!g||B||b?"":"_unnormalized"+(M+=1),{prefix:g,name:k,parentMap:f,unnormalized:!!b,url:m,originalName:h,isDefine:j,id:(g?g+"!"+k:k)+b}}function q(a){var f=a.id,b=l(p,f);return b||(b=p[f]=new i.Module(a)),b}function t(a,f,b){var e=a.id,m=l(p,e);!s(r,e)||m&&!m.defineEmitComplete?(m=q(a),m.error&&"error"===f?b(m.error):m.on(f,b)):"defined"===f&&b(r[e])}function v(a,f){var b=a.requireModules,e=!1;f?f(a):(y(b,function(f){(f=l(p,f))&&(f.error=a,f.events.error&&(e=!0,f.emit("error",a)))}),e||j.onError(a))}function w(){R.length&&(ia.apply(G,[G.length-1,0].concat(R)),R=[])}function x(a){delete p[a],delete T[a]}function E(a,f,b){var e=a.map.id;a.error?a.emit("error",a.error):(f[e]=!0,y(a.depMaps,function(e,c){var g=e.id,d=l(p,g);d&&!a.depMatched[c]&&!b[g]&&(l(f,g)?(a.defineDep(c,r[g]),a.check()):E(d,f,b))}),b[e]=!0)}function C(){var a,f,b,e,m=(b=1e3*k.waitSeconds)&&i.startTime+b<(new Date).getTime(),c=[],g=[],j=!1,l=!0;if(!U){if(U=!0,F(T,function(b){if(a=b.map,f=a.id,b.enabled&&(a.isDefine||g.push(b),!b.error))if(!b.inited&&m)h(f)?j=e=!0:(c.push(f),d(f));else if(!b.inited&&b.fetched&&a.isDefine&&(j=!0,!a.prefix))return l=!1}),m&&c.length)return b=A("timeout","Load timeout for modules: "+c,null,c),b.contextName=i.contextName,v(b);l&&y(g,function(a){E(a,{},{})}),m&&!e||!j||!z&&!da||V||(V=setTimeout(function(){V=0,C()},50)),U=!1}}function D(a){s(r,a[0])||q(n(a[0],null,!0)).init(a[1],a[2])}function J(a){var a=a.currentTarget||a.srcElement,b=i.onScriptLoad;return a.detachEvent&&!W?a.detachEvent("onreadystatechange",b):a.removeEventListener("load",b,!1),b=i.onScriptError,(!a.detachEvent||W)&&a.removeEventListener("error",b,!1),{node:a,id:a&&a.getAttribute("data-requiremodule")}}function K(){var a;for(w();G.length;){if(a=G.shift(),null===a[0])return v(A("mismatch","Mismatched anonymous define() module: "+a[a.length-1]));D(a)}}var U,X,i,N,V,k={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},p={},T={},Y={},G=[],r={},S={},L=1,M=1;return N={require:function(a){return a.require?a.require:a.require=i.makeRequire(a.map)},exports:function(a){return a.usingExports=!0,a.map.isDefine?a.exports?a.exports:a.exports=r[a.map.id]={}:void 0},module:function(a){return a.module?a.module:a.module={id:a.map.id,uri:a.map.url,config:function(){var b=l(k.pkgs,a.map.id);return(b?l(k.config,a.map.id+"/"+b.main):l(k.config,a.map.id))||{}},exports:r[a.map.id]}}},X=function(a){this.events=l(Y,a.id)||{},this.map=a,this.shim=l(k.shim,a.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},X.prototype={init:function(a,b,c,e){e=e||{},this.inited||(this.factory=b,c?this.on("error",c):this.events.error&&(c=u(this,function(a){this.emit("error",a)})),this.depMaps=a&&a.slice(0),this.errback=c,this.inited=!0,this.ignore=e.ignore,e.enabled||this.enabled?this.enable():this.check())},defineDep:function(a,b){this.depMatched[a]||(this.depMatched[a]=!0,this.depCount-=1,this.depExports[a]=b)},fetch:function(){if(!this.fetched){this.fetched=!0,i.startTime=(new Date).getTime();var a=this.map;if(!this.shim)return a.prefix?this.callPlugin():this.load();i.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return a.prefix?this.callPlugin():this.load()}))}},load:function(){var a=this.map.url;S[a]||(S[a]=!0,i.load(this.map.id,a))},check:function(){if(this.enabled&&!this.enabling){var a,b,c=this.map.id;b=this.depExports;var e=this.exports,m=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){if(this.defining=!0,1>this.depCount&&!this.defined){if(H(m)){if(this.events.error&&this.map.isDefine||j.onError!==aa)try{e=i.execCb(c,m,b,e)}catch(d){a=d}else e=i.execCb(c,m,b,e);if(this.map.isDefine&&((b=this.module)&&void 0!==b.exports&&b.exports!==this.exports?e=b.exports:void 0===e&&this.usingExports&&(e=this.exports)),a)return a.requireMap=this.map,a.requireModules=this.map.isDefine?[this.map.id]:null,a.requireType=this.map.isDefine?"define":"require",v(this.error=a)}else e=m;this.exports=e,this.map.isDefine&&!this.ignore&&(r[c]=e,j.onResourceLoad)&&j.onResourceLoad(i,this.map,this.depMaps),x(c),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var a=this.map,b=a.id,d=n(a.prefix);this.depMaps.push(d),t(d,"defined",u(this,function(e){var m,d;d=this.map.name;var g=this.map.parentMap?this.map.parentMap.name:null,h=i.makeRequire(a.parentMap,{enableBuildCallback:!0});this.map.unnormalized?(e.normalize&&(d=e.normalize(d,function(a){return c(a,g,!0)})||""),e=n(a.prefix+"!"+d,this.map.parentMap),t(e,"defined",u(this,function(a){this.init([],function(){return a},null,{enabled:!0,ignore:!0})})),(d=l(p,e.id))&&(this.depMaps.push(e),this.events.error&&d.on("error",u(this,function(a){this.emit("error",a)})),d.enable())):(m=u(this,function(a){this.init([],function(){return a},null,{enabled:!0})}),m.error=u(this,function(a){this.inited=!0,this.error=a,a.requireModules=[b],F(p,function(a){0===a.map.id.indexOf(b+"_unnormalized")&&x(a.map.id)}),v(a)}),m.fromText=u(this,function(e,c){var d=a.name,g=n(d),B=O;c&&(e=c),B&&(O=!1),q(g),s(k.config,b)&&(k.config[d]=k.config[b]);try{j.exec(e)}catch(ca){return v(A("fromtexteval","fromText eval for "+b+" failed: "+ca,ca,[b]))}B&&(O=!0),this.depMaps.push(g),i.completeLoad(d),h([d],m)}),e.load(a.name,h,m,k))})),i.enable(d,this),this.pluginMaps[d.id]=d},enable:function(){T[this.map.id]=this,this.enabling=this.enabled=!0,y(this.depMaps,u(this,function(a,b){var c,e;if("string"==typeof a){if(a=n(a,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[b]=a,c=l(N,a.id))return void(this.depExports[b]=c(this));this.depCount+=1,t(a,"defined",u(this,function(a){this.defineDep(b,a),this.check()})),this.errback&&t(a,"error",u(this,this.errback))}c=a.id,e=p[c],!s(N,c)&&e&&!e.enabled&&i.enable(a,this)})),F(this.pluginMaps,u(this,function(a){var b=l(p,a.id);b&&!b.enabled&&i.enable(a,this)})),this.enabling=!1,this.check()},on:function(a,b){var c=this.events[a];c||(c=this.events[a]=[]),c.push(b)},emit:function(a,b){y(this.events[a],function(a){a(b)}),"error"===a&&delete this.events[a]}},i={config:k,contextName:b,registry:p,defined:r,urlFetched:S,defQueue:G,Module:X,makeModuleMap:n,nextTick:j.nextTick,onError:v,configure:function(a){a.baseUrl&&"/"!==a.baseUrl.charAt(a.baseUrl.length-1)&&(a.baseUrl+="/");var b=k.pkgs,c=k.shim,e={paths:!0,config:!0,map:!0};F(a,function(a,b){e[b]?"map"===b?(k.map||(k.map={}),Q(k[b],a,!0,!0)):Q(k[b],a,!0):k[b]=a}),a.shim&&(F(a.shim,function(a,b){I(a)&&(a={deps:a}),!a.exports&&!a.init||a.exportsFn||(a.exportsFn=i.makeShimExports(a)),c[b]=a}),k.shim=c),a.packages&&(y(a.packages,function(a){a="string"==typeof a?{name:a}:a,b[a.name]={name:a.name,location:a.location||a.name,main:(a.main||"main").replace(ja,"").replace(ea,"")}}),k.pkgs=b),F(p,function(a,b){!a.inited&&!a.map.unnormalized&&(a.map=n(b))}),(a.deps||a.callback)&&i.require(a.deps||[],a.callback)},makeShimExports:function(a){return function(){var b;return a.init&&(b=a.init.apply(Z,arguments)),b||a.exports&&ba(a.exports)}},makeRequire:function(a,f){function d(e,c,h){var g,k;return f.enableBuildCallback&&c&&H(c)&&(c.__requireJsBuild=!0),"string"==typeof e?H(c)?v(A("requireargs","Invalid require call"),h):a&&s(N,e)?N[e](p[a.id]):j.get?j.get(i,e,a,d):(g=n(e,a,!1,!0),g=g.id,s(r,g)?r[g]:v(A("notloaded",'Module name "'+g+'" has not been loaded yet for context: '+b+(a?"":". Use require([])")))):(K(),i.nextTick(function(){K(),k=q(n(null,a)),k.skipMap=f.skipMap,k.init(e,c,h,{enabled:!0}),C()}),d)}return f=f||{},Q(d,{isBrowser:z,toUrl:function(b){var d,f=b.lastIndexOf("."),g=b.split("/")[0];return-1!==f&&("."!==g&&".."!==g||f>1)&&(d=b.substring(f,b.length),b=b.substring(0,f)),i.nameToUrl(c(b,a&&a.id,!0),d,!0)},defined:function(b){return s(r,n(b,a,!1,!0).id)},specified:function(b){return b=n(b,a,!1,!0).id,s(r,b)||s(p,b)}}),a||(d.undef=function(b){w();var c=n(b,a,!0),f=l(p,b);delete r[b],delete S[c.url],delete Y[b],f&&(f.events.defined&&(Y[b]=f.events),x(b))}),d},enable:function(a){l(p,a.id)&&q(a).enable()},completeLoad:function(a){var b,c,e=l(k.shim,a)||{},d=e.exports;for(w();G.length;){if(c=G.shift(),null===c[0]){if(c[0]=a,b)break;b=!0}else c[0]===a&&(b=!0);D(c)}if(c=l(p,a),!b&&!s(r,a)&&c&&!c.inited){if(k.enforceDefine&&(!d||!ba(d)))return h(a)?void 0:v(A("nodefine","No define call for "+a,null,[a]));D([a,e.deps||[],e.exportsFn])}C()},nameToUrl:function(a,b,c){var e,d,h,g,i,n;if(j.jsExtRegExp.test(a))g=a+(b||"");else{for(e=k.paths,d=k.pkgs,g=a.split("/"),i=g.length;i>0;i-=1){if(n=g.slice(0,i).join("/"),h=l(d,n),n=l(e,n)){I(n)&&(n=n[0]),g.splice(0,i,n);break}if(h){a=a===h.name?h.location+"/"+h.main:h.location,g.splice(0,i,a);break}}g=g.join("/"),g+=b||(/\?/.test(g)||c?"":".js"),g=("/"===g.charAt(0)||g.match(/^[\w\+\.\-]+:/)?"":k.baseUrl)+g}return k.urlArgs?g+((-1===g.indexOf("?")?"?":"&")+k.urlArgs):g},load:function(a,b){j.load(i,a,b)},execCb:function(a,b,c,e){return b.apply(e,c)},onScriptLoad:function(a){("load"===a.type||ka.test((a.currentTarget||a.srcElement).readyState))&&(P=null,a=J(a),i.completeLoad(a.id))},onScriptError:function(a){var b=J(a);return h(b.id)?void 0:v(A("scripterror","Script error for: "+b.id,a,[b.id]))}},i.require=i.makeRequire(),i}var j,w,x,C,J,D,P,K,q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/gm,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=Array.prototype.splice,z=!("undefined"==typeof window||!navigator||!window.document),da=!z&&"undefined"!=typeof importScripts,ka=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,W="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),E={},t={},R=[],O=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(H(requirejs))return;t=requirejs,requirejs=void 0}"undefined"!=typeof require&&!H(require)&&(t=require,require=void 0),j=requirejs=function(b,c,d,h){var q,n="_";return!I(b)&&"string"!=typeof b&&(q=b,I(c)?(b=c,c=d,d=h):b=[]),q&&q.context&&(n=q.context),(h=l(E,n))||(h=E[n]=j.s.newContext(n)),q&&h.configure(q),h.require(b,c,d)},j.config=function(b){return j(b)},j.nextTick="undefined"!=typeof setTimeout?function(b){setTimeout(b,4)}:function(b){b()},require||(require=j),j.version="2.1.8",j.jsExtRegExp=/^\/|:|\?|\.js$/,j.isBrowser=z,w=j.s={contexts:E,newContext:ha},j({}),y(["toUrl","undef","defined","specified"],function(b){j[b]=function(){var c=E._;return c.require[b].apply(c,arguments)}}),z&&(x=w.head=document.getElementsByTagName("head")[0],C=document.getElementsByTagName("base")[0])&&(x=w.head=C.parentNode),j.onError=aa,j.createNode=function(b){var c=b.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return c.type=b.scriptType||"text/javascript",c.charset="utf-8",c.async=!0,c},j.load=function(b,c,d){var h=b&&b.config||{};
if(z)return h=j.createNode(h,c,d),h.setAttribute("data-requirecontext",b.contextName),h.setAttribute("data-requiremodule",c),!h.attachEvent||h.attachEvent.toString&&0>h.attachEvent.toString().indexOf("[native code")||W?(h.addEventListener("load",b.onScriptLoad,!1),h.addEventListener("error",b.onScriptError,!1)):(O=!0,h.attachEvent("onreadystatechange",b.onScriptLoad)),h.src=d,K=h,C?x.insertBefore(h,C):x.appendChild(h),K=null,h;if(da)try{importScripts(d),b.completeLoad(c)}catch(l){b.onError(A("importscripts","importScripts failed for "+c+" at "+d,l,[c]))}},z&&M(document.getElementsByTagName("script"),function(b){return x||(x=b.parentNode),(J=b.getAttribute("data-main"))?(q=J,t.baseUrl||(D=q.split("/"),q=D.pop(),fa=D.length?D.join("/")+"/":"./",t.baseUrl=fa),q=q.replace(ea,""),j.jsExtRegExp.test(q)&&(q=J),t.deps=t.deps?t.deps.concat(q):[q],!0):void 0}),define=function(b,c,d){var h,j;"string"!=typeof b&&(d=c,c=b,b=null),I(c)||(d=c,c=null),!c&&H(d)&&(c=[],d.length&&(d.toString().replace(la,"").replace(ma,function(b,d){c.push(d)}),c=(1===d.length?["require"]:["require","exports","module"]).concat(c))),O&&((h=K)||(P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),function(b){return"interactive"===b.readyState?P=b:void 0}),h=P),h&&(b||(b=h.getAttribute("data-requiremodule")),j=E[h.getAttribute("data-requirecontext")])),(j?j.defQueue:R).push([b,c,d])},define.amd={jQuery:!0},j.exec=function(b){return eval(b)},j(t)}}(this),window.requirejs=requirejs,window.require=require,window.define=define,function(){ns.router.baseDir="/next",ns.router.regexps.id="[A-Za-z_][A-Za-z0-9_.-]*",ns.router.regexps.string=".+",ns.router.regexps["view-mode"]="view|fullscreen",ns.router.regexps["context-type"]="calendar|top|search|contest|tag|recent|popular";var secretParamsList=["sk","sd"],secretParams={},isParamsInList=function(params,list){for(var param in params)if(params.hasOwnProperty(param)&&list.indexOf(param)>-1)return!0;return!1},getSafeParams=function(params,list){var safeParams={};for(var param in params)params.hasOwnProperty(param)&&(list.indexOf(param)>-1?secretParams[param]=params[param]:safeParams[param]=params[param]);return safeParams},removeSecretParams=function(params){if(!isParamsInList(params,secretParamsList))return null;var safeParams=getSafeParams(params,secretParamsList),url=ns.router.generateUrl("photo",safeParams);return url.substring(ns.router.baseDir.length,url.length)},rewriteParams=function(params){var _params=no.extend({},params);ph.params.hiddenParams={};for(var param in secretParams)secretParams.hasOwnProperty(param)&&(ph.params.hiddenParams[param]=secretParams[param]);secretParams={},_params["author-login"]&&(_params["author-login"]=ph.utils.normalizeLogin(_params["author-login"])),_params["search-author"]&&(_params["search-author"]=ph.utils.normalizeLogin(_params["search-author"]));var commentId=_params["comment-id"];return commentId&&(0===commentId.indexOf("child-")&&(commentId=commentId.substr(6)),ph.params.hiddenParams["comment-id"]=commentId,delete _params["comment-id"]),_params["comment-reply"]&&(ph.params.hiddenParams["comment-reply"]=_params["comment-reply"],delete _params["comment-reply"]),_params},routesApp={redirect:{"/{context:context-type}":function(params){var context=params.context||"",goodContext={"":!0,recent:!0,popular:!0};return goodContext[context]?null:"/404"}},rewriteParams:{photo:rewriteParams,index:rewriteParams,"contest-vote":rewriteParams},route:{"/contest-vote/{contest-id:int}/":"contest-vote","/404":"not-found","/{context:context-type=recent}":"index"}},routesPhoto={"/{context:context-type==search}/{search-text:string}/users/{author-login}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/{context:context-type==search}/{search-text:string}/users/{author-login}/{mode:view-mode}/{image-id:int}/":"photo","/{context:context-type==contest}/{contest-id:int}/users/{author-login}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/{context:context-type==contest}/{contest-id:int}/users/{author-login}/{mode:view-mode}/{image-id:int}/":"photo","/users/{author-login}/{context:context-type==tag}/{tag:string}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/users/{author-login}/{context:context-type==tag}/{tag:string}/{mode:view-mode}/{image-id:int}/":"photo","/{context:context-type}/users/{author-login}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/{context:context-type}/users/{author-login}/{mode:view-mode}/{image-id:int}/":"photo","/users/{author-login}/album/{album-id:int}/{mode:view-mode}/{image-id:int}/":"photo","/users/{author-login}/{mode:view-mode}/{image-id:int}/":"photo"},assignRoutes=function(to,from){for(var route in from)from.hasOwnProperty(route)&&(to.route[route]=from[route],to.redirect[route]=removeSecretParams);return to};ns.router.routes=assignRoutes(routesApp,routesPhoto)}();var serverRender,serverRender=function(){};return{_:_,no:no,Vow:Vow,React:React,moment:moment,yr:yr,ph:ph,ns:ns,nb:nb,render:serverRender}};!function(){initApp()}(),function(){var lazyRedraw=ph.utils.lazyCallback(100,function(){return ns.page.go(ns.page.currentUrl,"preserve")});ph.redraw=function(){var promise=new Vow.Promise;return lazyRedraw().then(function(details){promise.sync(details.returned)}),promise}}(),ph.resized=function(){nb.trigger("ph-resize"),ns.events.trigger("ph-resize")},ph.listenToResize=function(){$(window).bind("resize",ph.utils.lazyCallback(100,function(){ph.resized()}))},ph.scrolled=function(){nb.trigger("ph-scroll"),ns.events.trigger("ph-scroll")},ph.listenToScroll=function(){$(document).bind("scroll",ph.utils.lazyCallback(100,function(){ph.scrolled()}))},ph.initActions=function(){ns.action.define("fix-url",function(actionName,params){params&&params.url&&ns.history.replaceState(params.url)}),ns.action.define("metrika-count",function(){return!0})},ph.init=function(){if(ph.utils.init(),ph.utils.initDateFunctions(),ph.initModules(),ph.initActions(),ph.listenToResize(),ph.listenToScroll(),ph.fullscreen.init(),ph.utils.listenToPageChange(),ph.keyboard.init(),ph.metrika.init(),ph.statface.init(),ns.init(),"function"==typeof window.__nsInit){var url=ns.page.getCurrentUrl(),route=ns.router(url);route.page===ns.R.REDIRECT&&(route=ns.router(route.redirect)),ns.page._setCurrent(route,url),window.__nsInit();var layout=ns.layout.page(route.page,route.params),update=new ns.Update(ns.MAIN_VIEW,layout,route.params),node=$("body")[0];update.reconstruct(node).then(function(){ph.redraw()})}else ph.redraw()},$(function(){ph.init()});